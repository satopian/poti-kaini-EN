/*
    litaChix
    https://github.com/satopian/ChickenPaint_Be
    by satopian
    Customized from ChickenPaint by Nicholas Sherlock.
    GNU GENERAL PUBLIC LICENSE
    Version 3, 29 June 2007
    <http://www.gnu.org/licenses/>
*/
/*
    ChickenPaint

    ChickenPaint is a translation of ChibiPaint from Java to JavaScript
    by Nicholas Sherlock / Chicken Smoothie.

    ChibiPaint is Copyright (c) 2006-2008 Marc Schefer

    ChickenPaint is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    ChickenPaint is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with ChickenPaint. If not, see <http://www.gnu.org/licenses/>.
*/
!function(){function Ja(a){return a&&a.__esModule?a.default:a}function xa(a){for(var c in xa.DEFAULTS)xa.DEFAULTS.hasOwnProperty(c)&&(this[c]=xa.DEFAULTS[c]);for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c])}function Ca(a,c,d,b){this.left=a;this.top=c;this.right=d;this.bottom=b}function Uc(a,c){this.width=0|a;this.height=0|c}function Vc(a,c){var d=document.createElement("canvas");return d.width=a,d.height=c,d}function te(a,c){return document.createElement("canvas").getContext("2d").createImageData(a,
c)}function I(a,c){"number"==typeof a?(Uc.call(this,a,c),this.imageData=te(this.width,this.height)):(Uc.call(this,a.width,a.height),this.imageData=a);this.data=this.imageData.data}function df(a,c,d,b){var h,p=0,g=[0,0,0,0];var e=0;for(h=0;h<b&&h<d;h++){for(var k=0;k<I.BYTES_PER_PIXEL;k++)g[k]+=a[e++];p++}h=0;for(k=0;k<d;k++){if(k+b<d){e=(k+b)*I.BYTES_PER_PIXEL;for(var l=0;l<I.BYTES_PER_PIXEL;l++)g[l]+=a[e++];p++}for(e=0;e<I.BYTES_PER_PIXEL;e++)c[h++]=Math.round(g[e]/p);if(k-b>=0){e=(k-b)*I.BYTES_PER_PIXEL;
for(l=0;l<I.BYTES_PER_PIXEL;l++)g[l]-=a[e++];p--}}}function ef(a,c){if(0==(c%=4))return a;let d=Vc(0,0),b=d.getContext("2d");switch(c%2==0?(d.width=a.width,d.height=a.height):(d.width=a.height,d.height=a.width),c){case 1:b.rotate(Math.PI/2);b.drawImage(a,0,-a.height);break;case 2:b.rotate(Math.PI);b.drawImage(a,-a.width,-a.height);break;case 3:b.rotate(-Math.PI/2);b.drawImage(a,-a.width,0);break;default:return a}return d}function $a(a="",c=0){db.call(this,a);this.layers=[];this.expanded=!0;this.blendMode=
c}function qg(a,c){return a+c}function Pa(a,c,d){Uc.call(this,a,c);this.createBitmap(a,c,d)}function ff(a,c,d,b){var h,p=0,g=0;for(h=0;h<b&&h<d;h++)g+=a[h],p++;h=0;for(let e=0;e<d;e++)e+b<d&&(g+=a[e+b],p++),c[h++]=Math.round(g/p),e-b>=0&&(g-=a[e-b],p--)}function Q(){}function db(a){this.name=a||"";this.parent=null;this.lockAlpha=!1;this.alpha=100;this.visible=!0;this.blendMode=Q.LM_NORMAL;this.mask=null;this.maskVisible=this.maskLinked=!0;this.maskThumbnail=null;this.useLegacyMultiply=!1}function Fa(a,
c,d){db.call(this,d);a>0&&c>0?this.image=new I(a,c):this.image=null;this.clip=!1;this.imageThumbnail=null}function zd(a,c,d){d?(this.isGroup=d instanceof $a,this.image=d.image,this.mask=d.getEffectiveMask(),this.layer=d,this.blendMode=d.blendMode,this.alpha=d.alpha,this.visible=d.visible):(this.isGroup=!0,this.image=null,this.mask=null,this.layer=null,this.blendMode=Q.LM_PASSTHROUGH,this.alpha=100,this.visible=!0);this.dirtyRect=new Ca(0,0,a,c);this.layers=[];this.parent=null;this.clip=!1}function ue(a,
c,d,b){function h(){return l.length>0?l.pop():new I(c,d)}function p(m){if(0==m.layers.length)return null;if(1==m.layers.length&&(null==m.mask||null==m.layers[0].mask)){let n=m.layers[0];return n.alpha=Math.round(m.alpha*n.alpha/100),m.blendMode!=Q.LM_PASSTHROUGH&&(n.blendMode=m.blendMode),n.mask=m.mask||n.mask,m.layer&&f.set(m.layer,n),n}return m.blendMode==Q.LM_PASSTHROUGH&&100==m.alpha&&null==m.mask?m.layers:(m.image=h(),m)}function g(m){let n=new zd(c,d,m);return f.set(m,n),n}function e(m,n){m&&
(m.dirtyRect.union(n),e(m.parent,n))}let k,l=[],f=new Map;this.invalidateLayerRect=function(m,n){e(f.get(m),n)};this.buildTree=function(){if(!k){if(k=function q(n){if(0==n.getEffectiveAlpha())return null;let t=g(n);for(var u=0;u<n.layers.length;u++){let A=n.layers[u];var v=n.layers[u+1];if(A instanceof Fa&&v&&v.clip){v=new zd(c,d,null);v.blendMode=A.blendMode;v.alpha=100;v.clip=!0;v.addChildren(g(A));for(u+=1;u<n.layers.length;u++)if(n.layers[u].clip)n.layers[u].getEffectiveAlpha()>0&&v.addChildren(g(n.layers[u]));
else break;A.getEffectiveAlpha()>0&&t.addChildren(p(v));--u}else A instanceof $a?t.addChildren(q(A)):A.getEffectiveAlpha()>0&&t.addChildren(g(A))}return p(t)}(a)){if(Array.isArray(k)||b&&(k.alpha<100||k.mask)){let n=k;(k=new zd(c,d)).blendMode=Array.isArray(n)?Q.LM_NORMAL:n.blendMode;k.alpha=100;k.image=h();k.addChildren(n)}}else(k=new zd(c,d,{image:h(),blendMode:Q.LM_NORMAL,alpha:100,getEffectiveMask:()=>null,visible:!0})).image.clearAll(0);l=[]}};this.resetTree=function(){k&&(!function q(n){if(n.isGroup)for(let t of(n.image&&
l.push(n.image),n.layers))q(t)}(k),k=null,f.clear())};this.layerPropertyChanged=function(m,n){let q=f.get(m);q&&q.visible==m.visible&&q.alpha==m.alpha&&null==q.mask==(null==m.getEffectiveMask())&&q.blendMode==Q.LM_PASSTHROUGH==(m.blendMode==Q.LM_PASSTHROUGH)&&"clip"!==n?(q.blendMode=m.blendMode,e(q,new Ca(0,0,c,d))):this.resetTree()};this.blendTree=function(){return function q(n){if(!n||!n.isGroup)return n;let t=n.dirtyRect;var u=!0,v=!0;if(n.blendMode==Q.LM_PASSTHROUGH&&n.parent&&t.union(n.parent.dirtyRect),
t.isEmpty())return n;if(n.blendMode==Q.LM_PASSTHROUGH&&n.parent){u=!1;var A=n.image;var C=n.parent.image;t.getWidth()==A.width&&t.getHeight()==A.height?A.copyPixelsFrom(C):Q.replaceOntoFusionWithOpaqueLayer(A,C,100,t)}for(A=0;A<n.layers.length;A++){var x=q(n.layers[A]);if(u){u=n.image;C=x.image;var F=x.alpha,w=t;x=x.mask;if(100!=F||x||w.getWidth()!=u.width||w.getHeight()!=u.height){let G="replaceOntoFusionWith";100==F?G+="OpaqueLayer":G+="TransparentLayer";x&&(G+="Masked");Q[G](u,C,F,w,x)}else u.copyPixelsFrom(C);
!0;u=!1}else v=v&&n.image.hasAlphaInRect(t),Q.fuseImageOntoImage(n.image,v,x.image,x.alpha,x.blendMode,t,x.mask)}n.clip&&(v=n.layers[0],v.alpha<100?v.mask?Q.replaceAlphaOntoFusionWithTransparentLayerMasked(n.image,v.image,v.alpha,t,v.mask):Q.replaceAlphaOntoFusionWithTransparentLayer(n.image,v.image,v.alpha,t):v.mask?Q.replaceAlphaOntoFusionWithOpaqueLayerMasked(n.image,v.image,100,t,v.mask):Q.replaceAlphaOntoFusionWithOpaqueLayer(n.image,v.image,100,t));return n.dirtyRect.makeEmpty(),n}(k)}}function rg(){function a(f){if(null!=
h&&f.curSize==p&&f.curSqueeze==g&&f.curAngle==e&&f.tip==k)return h;switch(f.tip){case xa.TIP_ROUND_AIRBRUSH:!function(m,n){if(n.curSize<1){var q=n.curSize/2;m[0]=0|Math.min(255,Math.PI*q*q*255)}else{q=n.curSize;var t=q/2,u=n.curSize/2*(n.curSize/2),v=1+10*n.curSqueeze,A=Math.cos(n.curAngle);n=Math.sin(n.curAngle);var C=0;for(let w=0;w<q;w++)for(let G=0;G<q;G++){var x=G+.5-t;let H=w+.5-t;var F=(x*A-H*n)*v;x=H*A+x*n;F=F*F+x*x;F<=u?m[C++]=~~(255*(1-F/u)):m[C++]=0}}}(c,f);break;case xa.TIP_ROUND_AA:!function(m,
n){if(n.curSize<1){var q=n.curSize/2;m[0]=0|Math.min(255,Math.PI*q*q*255)}else{var t=n.curSize;q=Math.ceil(t);var u=q/2,v=t/2;v*=v;var A=Math.pow((t-2)/2,2);t=Math.pow((t+2)/2,2);var C=1+10*n.curSqueeze,x=Math.cos(n.curAngle);n=Math.sin(n.curAngle);var F=0;for(let B=0;B<q;B++)for(let O=0;O<q;O++){var w=O+.5-u,G=B+.5-u,H=(w*x-G*n)*C;w=G*x+w*n;H=H*H+w*w;if(H<=A)m[F++]=255;else if(H>t)m[F++]=0;else{H=0;for(w=0;w<4;w++)for(G=0;G<4;G++){var P=O+.25*G-u;let T=B+.25*w-u,L=(P*x-T*n)*C;P=T*x+P*n;L*L+P*P<=
v&&(H+=1)}m[F++]=Math.min(16*H,255)}}}}(c,f);break;case xa.TIP_ROUND_PIXEL:!function(m,n){let q=Math.max(n.curSize,1),t=q/2,u=n.curSize/2*(n.curSize/2),v=1+10*n.curSqueeze,A=Math.cos(n.curAngle);n=Math.sin(n.curAngle);let C=0;for(let F=0;F<q;F++)for(let w=0;w<q;w++){var x=w+.5-t;let G=F+.5-t,H=(x*A-G*n)*v;x=G*A+x*n;H*H+x*x<=u?m[C++]=255:m[C++]=0}}(c,f);break;case xa.TIP_SQUARE_AA:!function(m,n){if(n.curSize<1){var q=n.curSize/2;m[0]=0|Math.min(255,Math.PI*q*q*255)}else{q=n.curSize;var t=q/2,u=n.curSize*
Math.sin(Math.PI/4),v=u/2/(1+10*n.curSqueeze);u/=2;var A=v-1,C=u-1,x=v+1,F=u+1,w=Math.cos(n.curAngle);n=Math.sin(n.curAngle);var G=0;for(let P=0;P<q;P++)for(let B=0;B<q;B++){var H=B+.5-t;let O=P+.5-t,T=Math.abs(H*w-O*n);H=Math.abs(O*w+H*n);if(T<=A&&H<=C)m[G++]=255;else if(T>x||H>F)m[G++]=0;else{let L=0;for(let ja=0;ja<4;ja++)for(let V=0;V<4;V++)T=Math.abs((H=B+(V+.5)*.25-t)*w-(O=P+(ja+.5)*.25-t)*n),H=Math.abs(O*w+H*n),T<=v&&H<=u&&L++;m[G++]=Math.min(16*L,255)}}}}(c,f);break;case xa.TIP_SQUARE_PIXEL:!function(m,
n){if(n.curSize<2)m[0]=255;else{var q=n.curSize,t=q/2,u=n.curSize*Math.sin(Math.PI/4),v=u/2/(1+10*n.curSqueeze);u/=2;var A=Math.cos(n.curAngle);n=Math.sin(n.curAngle);var C=0;for(let x=0;x<q;x++)for(let F=0;F<q;F++){let w=F+.5-t,G=x+.5-t,H=Math.abs(G*A+w*n);Math.abs(w*A-G*n)<=v&&H<=u?m[C++]=255:m[C++]=0}}}(c,f)}return h=c,p=f.curSize,k=f.tip,g=f.curSqueeze,e=f.curAngle,c}let c=new Uint8Array(160801),d=new Uint8Array(161604),b=[new Float32Array(402),new Float32Array(402)],h=null,p,g,e,k,l=this;this.getDab=
function(f,m,n){let q={alpha:n.curAlpha,width:Math.ceil(n.curSize),height:Math.ceil(n.curSize)},t=n.isAA&&n.tip!=xa.TIP_ROUND_PIXEL;t&&(q.width++,q.height++);f=f-q.width/2+.5;m=m-q.height/2+.5;let u=Math.floor(f),v=Math.floor(m);return t?q.brush=function(A,C,x){var F=a(A);let w=A.curSize;A=Math.ceil(A.curSize)+1;let G=(1-C)*(1-x),H=C*(1-x),P=C*x,B=(1-C)*x,O=0;C=0;x=b[0];let T=b[1];x.fill(0);for(let ja=0;ja<w;ja++){var L=0;for(T[0]=0;L<w;L++,O++,C++){let V=F[O];d[C]=x[L]+V*G+.5|0;x[L+1]+=V*H;T[L]+=
V*B;T[L+1]=V*P}d[C++]=x[L]+.5|0;L=x;x=T;T=L}for(F=0;F<A;F++,C++)d[C]=x[F]+.5|0;return d}(n,f-u,m-v):q.brush=a(n),q.x=u,q.y=v,n.texture>0&&null!=this.texture&&(q.brush==c&&(d.set(c),q.brush=d),!function(A,C){C=Math.floor(255*C);let x=l.texture,F=A.x%x.width,w=A.y%x.height,G=0,H,P;F<0&&(F+=x.width);w<0&&(w+=x.height);for(let B=0;B<A.height;B++){H=w*x.width+F;P=w*x.width+x.width;for(let O=0;O<A.width;O++)A.brush[G]=~~(A.brush[G]*(x.data[H]*C/255^255)/255),G++,++H==P&&(H-=x.width);++w==x.height&&(w=0)}}(q,
n.texture)),q};this.setTexture=function(f){this.texture=f}}function ve(a,c,d){this.bmp=a;this.x=c;this.y=d}function Ld(a){if(0==a.saturation)return a.value<<16|a.value<<8|a.value;var c=a.hue/60;c-=Math.floor(c);var d=a.saturation/255,b=~~(a.value*(1-d)),h=~~(a.value*(1-d*c));c=~~(a.value*(1-d*(1-c)));switch(~~(a.hue/60)){case 0:return a.value<<16|c<<8|b;case 1:return h<<16|a.value<<8|b;case 2:return b<<16|a.value<<8|c;case 3:return b<<16|h<<8|a.value;case 4:return c<<16|b<<8|a.value;case 5:return a.value<<
16|b<<8|h;default:return 0}}function jb(a){this.value=this.saturation=this.hue=this.rgb=0;this.setRgb(a||0)}function sg(){var a,c=!1;this.nextGaussian=function(){if(c)return c=!1,a;do var d=(b=2*Math.random()-1)*b+(h=2*Math.random()-1)*h;while(d>=1||0==d);var b,h;d=Math.sqrt(-2*Math.log(d)/d);return a=h*d,c=!0,b*d}}function qb(){this.setToIdentity()}function tc(a,c,d){this.r=a;this.g=c;this.b=d}function gf(a){let c=0;for(let d=0;d<a.length;d++)c+=a[d];return c/a.length}function hf(a,c){let d=a.data;
if(c.left>0)for(var b=c.top;b<c.bottom;b++){var h=b*a.width,p=h;h=d[h+c.left];for(var g=0;g<c.left;g++,p++)d[p]=h}if(c.right<a.width)for(b=c.top;b<c.bottom;b++)for(p=b*a.width+c.right,h=d[p-1],g=c.right;g<a.width;g++,p++)d[p]=h;b=0;for(p=0;p<c.top;p++)for(h=c.top*a.width,g=0;g<a.width;g++,h++,b++)d[b]=d[h];b=c.bottom*a.width;for(p=c.bottom;p<a.width;p++)for(h=(c.bottom-1)*a.width,g=0;g<a.width;g++,h++,b++)d[b]=d[h]}function Md(a,c){return a+c}function jf(a){return a?a.width*a.height*4:0}function ec(a,
c){function d(D){mb=!1;(xc.size>0||nb.size>0)&&(D?e():kb||setTimeout(e,1E3))}function b(){X.emitEvent("changeSelection",[])}function h(D){X.emitEvent("updateRegion",[D])}function p(){X.emitEvent("changeStructure");va.resetTree();u();h(X.getBounds())}function g(D,N,W){X.emitEvent("changeLayer",[D]);W||(va.layerPropertyChanged(D,N),h(X.getBounds()))}function e(){for(let D of xc)D.rebuildImageThumbnail(),X.emitEvent("changeLayerImageThumb",[D]);for(let D of nb)D.rebuildMaskThumbnail(),X.emitEvent("changeLayerMaskThumb",
[D]);xc.clear();kb&&(clearTimeout(kb),kb=null)}function k(D,N,W,Y){Array.isArray(D)||(D=[D]);D.forEach(aa=>va.invalidateLayerRect(aa,N));let da=!1;if(W)for(let aa of(sa.union(N),D))aa instanceof Fa&&(xc.add(aa),da=!0);Y&&(z.union(N),D.forEach(aa=>{nb.add(aa);Ha&&Ha.layer==aa&&Ha.invalidateRect(N)}),da=!0);da&&(kb&&(clearTimeout(kb),kb=null),mb||(kb=setTimeout(e,1E3)));h(N)}function l(D,N){k(D,N,!ma,ma)}function f(){return ma?ea.mask:ea.image}function m(){if(!ca.isEmpty()){if(ma){var D=ea.mask;lb.brushMode==
xa.BRUSH_MODE_ERASE?ba[xa.BRUSH_MODE_PAINT].mergeOntoMask(D,M,4278190080):ba[lb.brushMode].mergeOntoMask(D,M,255&Tb)}else{D=ea.image;let N=ea.getLockAlpha();lb.brushMode==xa.BRUSH_MODE_ERASE&&N?ba[xa.BRUSH_MODE_PAINT].mergeOntoImage(D,ia,16777215):ba[lb.brushMode].mergeOntoImage(D,ia,Tb);N&&D.copyAlphaFrom(ia,ca)}ca.makeEmpty()}}function n(){ea instanceof Fa&&!sa.isEmpty()&&(ia.copyBitmapRect(ea.image,sa.left,sa.top,sa),sa.makeEmpty())}function q(){ea.mask&&!z.isEmpty()&&(M.copyBitmapRect(ea.mask,
z.left,z.top,z),z.makeEmpty())}function t(){ma?q():n()}function u(){let D=X.getBounds();sa.set(D);z.set(D)}function v(D){X.setHasUnsavedChanges(!0);Gb.length>0&&(Gb=[]);0!==hb.length&&hb[hb.length-1].merge(D)?hb[hb.length-1].noChange()&&hb.pop():(hb.length>=30&&hb.shift(),X.compactUndo(),hb.push(D))}function A(D,N){D||N||(D=!ma,N=ma);let W=pa.clone(),Y=D?ia.copyRectXOR(ea.image,W):null,da=N?M.copyRectXOR(ea.mask,W):null;this.layer=ea;pa.makeEmpty();this.redo=this.undo=function(){Y&&this.layer.image.setRectXOR(Y,
W);da&&this.layer.mask.setRectXOR(da,W);k(this.layer,W,null!=Y,null!=da)};this.getMemoryUsed=function(aa,wa){return(Y?Y.length:0)+(da?da.length:0)}}function C(D){let N=D.maskLinked,W=D.maskVisible;this.undo=function(){D.setMask(null);D.maskLinked=N;D.maskVisible=W;p();X.setActiveLayer(D,!1)};this.redo=function(){let Y=new Pa(X.width,X.height,8);Y.clearAll(255);D.maskLinked=!0;D.maskVisible=!0;D.setMask(Y);p();X.setActiveLayer(D,!0)};this.redo()}function x(D,N){let W=D.mask,Y,da=!1;Y=N&&D instanceof
Fa?D.image.clone():null;da=ea==D&&ma;this.undo=function(){D.setMask(W);Y&&(D.image.copyPixelsFrom(Y),k(D,D.image.getBounds(),!0,!1));da&&X.setActiveLayer(D,!0);p()};this.redo=function(){Y&&(Q.multiplyAlphaByMask(D.image,100,D.mask),k(D,X.getBounds(),!0,!1));da&&X.setActiveLayer(D,!1);D.setMask(null);p()};this.redo()}function F(D,N,W){let Y=W instanceof Fa&&W.clip,da=D.layers[N],aa=da instanceof Fa&&da.clip,wa=ma;this.undo=function(){D.removeLayer(W);let Ma=D.layers[N-1]||D.layers[0]||D;da instanceof
Fa&&(da.clip=aa);W instanceof Fa&&(W.clip=Y);p();X.setActiveLayer(Ma,wa)};this.redo=function(){D.insertLayer(N,W);aa&&(W instanceof Fa?W.clip=!0:da.clip=!1);p();X.setActiveLayer(W,!1)};this.redo()}function w(D){let N=D.clone(),W=ma;this.undo=function(){N.parent.removeLayer(N);p();X.setActiveLayer(D,W)};this.redo=function(){let Y=D.name;Y.endsWith(" Copy")||(Y+=" Copy");N.name=Y;D.parent.insertLayer(D.parent.indexOf(D)+1,N);p();X.setActiveLayer(N,!1)};this.redo()}function G(D){let N=D.parent,W=N.indexOf(D),
Y=ma,da=0;if(D instanceof Fa&&!D.clip)for(let aa=W+1;aa<N.layers.length;aa++)if(N.layers[aa]instanceof Fa&&N.layers[aa].clip)da++;else break;this.undo=function(){N.insertLayer(W,D);for(let aa=0;aa<da;aa++)N.layers[aa+W+1].clip=!0;p();X.setActiveLayer(D,Y)};this.redo=function(){var aa;for(aa=0;aa<da;aa++)N.layers[aa+W+1].clip=!1;N.removeLayerAtIndex(W);aa=0==N.layers.length?D.parent:N.layers[Math.max(W-1,0)];p();X.setActiveLayer(aa,!1)};this.getMemoryUsed=function(aa,wa){return aa?0:D.getMemoryUsed()};
this.redo()}function H(D){let N=D.parent.indexOf(D),W=ma,Y=new Fa(X.width,X.height,"");this.undo=function(){D.parent.setLayerAtIndex(N,D);p();X.setActiveLayer(D,W)};this.redo=function(){D.parent.setLayerAtIndex(N,Y);p();X.setActiveLayer(Y,!1)};this.getMemoryUsed=function(aa,wa){return aa?0:D.getMemoryUsed()};var da=new ue(D,X.width,X.height,!1);da.buildTree();da=da.blendTree();Y.name=D.name;Y.alpha=da.alpha;Y.image=da.image;Y.blendMode=da.blendMode;Y.mask=da.mask;Y.blendMode==Q.LM_PASSTHROUGH&&(Y.blendMode=
Q.LM_NORMAL);this.redo()}function P(D){let N=D.parent,W=N.layers[N.indexOf(D)-1],Y=new Fa(X.width,X.height,""),da=ma;this.undo=function(){let aa=N.indexOf(Y);N.removeLayerAtIndex(aa);N.insertLayer(aa,D);N.insertLayer(aa,W);p();X.setActiveLayer(D,da)};this.redo=function(){if(W.clip||!D.clip)Y.copyFrom(W),D.getEffectiveAlpha()>0&&(Y.mask?Q.multiplyAlphaByMask(Y.image,Y.alpha,Y.mask):Q.multiplyAlphaBy(Y.image,Y.alpha),Q.fuseImageOntoImage(Y.image,!0,D.image,D.alpha,D.blendMode,D.getBounds(),D.mask));
else{var aa=new $a;aa.layers=[W,D];aa.parent=null;aa.name="Temporary Group";aa=new ue(aa,X.width,X.height,!1);aa.buildTree();Y.image=aa.blendTree().image}Y.name=W.name;Y.alpha=100;Y.blendMode=W.blendMode;Y.mask=null;aa=N.indexOf(W);N.removeLayerAtIndex(aa);N.removeLayerAtIndex(aa);N.insertLayer(aa,Y);p();X.setActiveLayer(Y,!1)};this.getMemoryUsed=function(aa,wa){return aa?0:D.getMemoryUsed()+Y.getMemoryUsed()};this.redo()}function B(D=!1){let N=X.getActiveLayer(),W=Z.layers.slice(0),Y=new Fa(X.width,
X.height,"");this.undo=function(){Z.layers=W.slice(0);p();X.setActiveLayer(N,!1)};this.redo=function(){let da=X.fusionLayers();Y.copyImageFrom(da);Y.setName(X.getDefaultLayerName(!1));D?Z.layers=W.slice(0):Z.clearLayers();Z.addLayer(Y);p();X.setActiveLayer(Y,!1)};this.getMemoryUsed=function(da,aa){return W.map(wa=>wa.getMemoryUsed()).reduce(Md,0)};this.redo()}function O(D,N=Q.LM_NORMAL){if(!ma){var W=X.getActiveLayer(),Y=Z.layers.slice(0),da=new Fa(X.width,X.height,"");this.undo=function(){Z.layers=
Y.slice(0);p();X.setActiveLayer(W,!1)};this.redo=function(){var aa=X.fusionLayers();da.copyImageFrom(aa);da.setName(X.getDefaultLayerName(!1));da.setBlendMode(N);Z.layers=Y.slice(0);Z.addLayer(da);p();X.setActiveLayer(da,!1);aa=X.getSelectionAutoSelect();let wa=f();wa&&(t(),pa=aa.clone(),D(wa,aa),l(ea,aa))};this.redo()}}function T(D,N,W){let Y=D.parent,da=D.parent.indexOf(D),aa=ma,wa=Y.layers[Y.indexOf(D)+1],Ma=N.layers[W],ab=D instanceof Fa&&D.clip,Xb=!!ab&&D.getClippingBase(),Ub=0,Ob=0;if(D instanceof
Fa&&!D.clip)for(var Kb=da+1;Kb<Y.layers.length;Kb++)if(Y.layers[Kb]instanceof Fa&&Y.layers[Kb].clip)Ub++;else break;else if(D instanceof $a)for(Kb=W;Kb<N.layers.length;Kb++)if(N.layers[Kb]instanceof Fa&&N.layers[Kb].clip)Ob++;else break;this.undo=function(){D.parent.removeLayer(D);var vb=wa?Y.indexOf(wa):Y.layers.length;Y.insertLayer(vb,D);D instanceof Fa&&(D.clip=ab);for(vb=0;vb<Ub;vb++)Y.layers[vb+da+1].clip=!0;for(vb=0;vb<Ob;vb++)N.layers[vb+W].clip=!0;p();X.setActiveLayer(D,aa)};this.redo=function(){for(var vb=
0;vb<Ub;vb++)Y.layers[vb+da+1].clip=!1;D.parent.removeLayer(D);vb=Ma?N.indexOf(Ma):N.layers.length;N.insertLayer(vb,D);for(var Vb=0;Vb<Ob;Vb++)N.layers[Vb+vb+1].clip=!1;D instanceof Fa&&(D.clip&&D.getClippingBase()!=Xb&&(D.clip=!1),Ma instanceof Fa&&Ma.clip&&(D.clip=!0));for(Vb=0;Vb<Ob;Vb++)N.layers[Vb+vb+1].clip=!1;p();X.setActiveLayer(D,!1)};this.redo()}function L(D,N){let W=D.substring(0,1).toUpperCase()+D.substring(1),Y=function(da,aa){Array.isArray(da)||(da=[da]);this.layers=da;this.from=this.layers.map(wa=>
wa["get"+W]());this.to=aa;this.redo()};return Y.prototype=Object.create(Yb.prototype),Y.prototype.constructor=Y,Y.prototype.undo=function(){this.layers.forEach((da,aa)=>da["set"+W](this.from[aa]));this.layers.forEach(da=>g(da,D,!N))},Y.prototype.redo=function(){this.layers.forEach(da=>da["set"+W](this.to));this.layers.forEach(da=>g(da,D,!N))},Y.prototype.merge=function(da){var aa;if(aa=da instanceof Y)a:{aa=this.layers;var wa=da.layers;if(aa.length!=wa.length)aa=!1;else{for(let Ma=0;Ma<aa.length;Ma++)if(aa[Ma]!=
wa[Ma]){aa=!1;break a}aa=!0}}return!!aa&&(this.to=da.to,!0)},Y.prototype.noChange=function(){for(let da=0;da<this.from.length;da++)if(this.from[da]!=this.to)return!1;return!0},Y}function ja(D,N){D=D.clone();N=N.clone();this.undo=function(){X.setSelection(D);h(X.getBounds())};this.redo=function(){X.setSelection(N);h(X.getBounds())};this.noChange=function(){return D.equals(N)}}function V(D,N,W){let Y=N?D.mask:D.image,da=Y.cloneRect(W);W=W.clone();this.undo=function(){Y.copyBitmapRect(da,W.left,W.top,
da.getBounds());X.setActiveLayer(D,N);X.setSelection(W);k(D,W,!N,N)};this.redo=function(){N?Y.clearRect(W,0):Y.clearRect(W,16777215);ob=new ve(da,W.left,W.top);X.setActiveLayer(D,N);X.emptySelection();k(D,W,!N,N)};this.getMemoryUsed=function(aa,wa){return da==wa?0:da.getMemorySize()};this.redo()}function ha(D){let N=X.getSelection(),W=ma,Y=new Fa(X.width,X.height,X.getDefaultLayerName(!1)),da=ea,aa=da.parent;this.undo=function(){aa.removeLayer(Y);X.setSelection(N);p();X.setActiveLayer(da,W)};this.redo=
function(){var wa=aa.indexOf(da);let Ma=D.bmp.getBounds(),ab,Xb;(aa.insertLayer(wa+1,Y),Ma.isInside(X.getBounds())?(ab=D.x,Xb=D.y):(ab=(X.width-D.bmp.width)/2|0,Xb=(X.height-D.bmp.height)/2|0),D.bmp instanceof Pa)?(wa=new I(D.bmp.width,D.bmp.height),wa.copyPixelsFromGreyscale(D.bmp),Y.image.copyBitmapRect(wa,ab,Xb,Ma)):Y.image.copyBitmapRect(D.bmp,ab,Xb,Ma);X.emptySelection();p();X.setActiveLayer(Y,!1)};this.getMemoryUsed=function(wa,Ma){return D.bmp==Ma?0:D.bmp.getMemorySize()};this.redo()}a|=0;
c|=0;let Z=new $a("Root",Q.LM_NORMAL),va=new ue(Z,a,c,!0),ia=new I(a,c),sa=new Ca(0,0,a,c),M=new Pa(a,c,8),z=new Ca(0,0,a,c),K=new Pa(a,c,32),ca=new Ca(0,0,0,0),na=new rg,X=this,ba=[],ea=Z,ma=!1,Ha=null,pa=new Ca(0,0,0,0),za=!1,rb=new Ca(0,0,0,0),bb=null,Pb=new sg,Ia=null,ob=null,hb=[],Gb=[],lb=null,wb=0,uc=0,Lb=0,yb=!1,mb=!1,nb=new Set,xc=new Set,kb=null,Tb=0,oc="smooth";this.texture=null;this.getLayersRoot=function(){return Z};this.getSelectionAutoSelect=function(){return rb.isEmpty()?this.getBounds():
this.getSelection()};this.getSelection=function(){return rb.clone()};this.setHasUnsavedChanges=function(D){D!=za&&(za=D,this.emitEvent("unsavedChanges",[D]))};this.getHasUnsavedChanges=function(){return za};this.isAddLayerMaskAllowed=function(){return!ea.mask};this.addLayerMask=function(){this.isAddLayerMaskAllowed()&&v(new C(ea))};this.isRemoveLayerMaskAllowed=function(){return null!==ea.mask};this.removeLayerMask=function(){this.isRemoveLayerMaskAllowed()&&v(new x(ea,!1))};this.isApplyLayerMaskAllowed=
function(){return null!==ea.mask&&ea instanceof Fa};this.applyLayerMask=function(D){this.isApplyLayerMaskAllowed()&&v(new x(ea,!0))};this.addLayer=function(D){let N,W;if(ea instanceof $a&&ea.expanded?(N=ea,W=ea.layers.length):W=(N=ea.parent).layers.indexOf(ea)+1,"group"===D){for(;N.layers[W]instanceof Fa&&N.layers[W].clip;)W++;D=new $a(this.getDefaultLayerName(!0),Q.LM_PASSTHROUGH)}else(D=new Fa(this.width,this.height,this.getDefaultLayerName(!1))).image.clearAll(16777215);return v(new F(N,W,D)),
D};this.addLayerObject=function(D,N){D.addLayer(N);D==Z&&1==Z.layers.length&&(ea=N);p()};this.addLayerGroupObject=function(D,N,W){let Y=[];for(let da=0;da<W;da++)Y.unshift(D.layers.pop());Y.forEach(da=>N.addLayer(da));this.addLayerObject(D,N)};this.isRemoveLayerAllowed=function(){return ea instanceof Fa?Z.getLinearizedLayerList(!1).some(D=>D instanceof Fa&&D!=ea):ea instanceof $a&&Z.getLinearizedLayerList(!1).some(D=>D instanceof Fa&&!D.hasAncestor(ea))};this.removeLayer=function(){return!!this.isRemoveLayerAllowed()&&
(v(new G(ea)),!0)};this.duplicateLayer=function(){v(new w(ea))};this.isMergeDownAllowed=function(){let D=ea.parent.indexOf(ea);return D>0&&ea instanceof Fa&&ea.parent.layers[D-1]instanceof Fa};this.mergeDown=function(){this.isMergeDownAllowed()&&v(new P(ea))};this.isMergeGroupAllowed=function(){return ea instanceof $a&&ea.getEffectiveAlpha()>0};this.mergeGroup=function(){this.isMergeGroupAllowed()&&v(new H(ea))};this.isMergeAllLayersAllowed=function(){return Z.getLinearizedLayerList(!1).length>1};
this.mergeAllLayers=function(D=!1){this.isMergeAllLayersAllowed()&&v(new B(D))};this.relocateLayer=function(D,N,W){D&&N&&D!=N&&!N.hasAncestor(D)&&v(new T(D,N,W))};this.setLayerVisibility=function(D,N){let W=[];if(D.ancestorsAreVisible())D.visible!=N&&v(new fc(D,N));else{for(;null!=D;D=D.parent)D.visible||W.push(D);v(new fc(W,!0))}};this.expandLayerGroup=function(D,N){D.expanded!=N&&(D.expanded=N,!N&&ea.hasAncestor(D)&&this.setActiveLayer(D,!1),g(D,"expanded",!0))};this.setLayerAlpha=function(D){ea.getAlpha()!=
D&&v(new Ic(ea,D))};this.setLayerMaskLinked=function(D){ea.maskLinked!=D&&v(new yc(ea,D))};this.setLayerMaskVisible=function(D,N){D.maskVisible!=N&&v(new ac(D,N))};this.setLayerBlendMode=function(D){ea.getBlendMode()!=D&&(D!=Q.LM_PASSTHROUGH||ea instanceof $a)&&v(new Wc(ea,D))};this.setLayerName=function(D,N){D.getName()!=N&&v(new hc(D,N))};this.paintDab=function(D,N,W,Y=!1){if(lb){lb.applyPressure(W,Y);lb.scattering>0&&(D+=Pb.nextGaussian()*lb.curScattering/4,N+=Pb.nextGaussian()*lb.curScattering/
4);W=ba[lb.brushMode];D=na.getDab(D,N,lb);var da=new Ca(0,0,D.width,D.height);N=new Ca(0,0,D.width,D.height);if(N.translate(D.x,D.y),X.getBounds().clipSourceDest(da,N),!N.isEmpty()){pa.union(N);Y=ma?ea.mask:ea.image;var aa=yb&&!ma?bb:Y,wa=ma?null:X.getSelection();if(!wa||wa.isEmpty())W.paintDab(Y,N,aa,lb,da,D,Tb);else{da=N.getIntersection(wa,!0);if(!da||da.isEmpty()||(da.left=Math.max(0,da.left),da.top=Math.max(0,da.top),da.right=Math.min(Y.width,da.right),da.bottom=Math.min(Y.height,da.bottom),da.isEmpty()))return;
wa=new Ca(da.left-D.x,da.top-D.y,da.left-D.x+da.getWidth(),da.top-D.y+da.getHeight());W.paintDab(Y,da,aa,lb,wa,D,Tb)}!ma&&W.noMergePhase&&ea.getLockAlpha()&&Y.copyAlphaFrom(ia,N);W.wantsOutputAsInput&&(m(),yb&&!ma&&X.fusionLayers());l(ea,N)}}};this.getDefaultLayerName=function(D){let N=D?"Group ":"Layer ";D=D?/^Group [0-9]+$/:/^Layer [0-9]+$/;let W=0,Y=Z.getLinearizedLayerList(!1);for(let da=0;da<Y.length;da++){let aa=Y[da];D.test(aa.name)&&(W=Math.max(W,parseInt(aa.name.substring(N.length),10)))}return N+
(W+1)};this.addBackgroundLayer=function(){let D=new Fa(X.width,X.height,this.getDefaultLayerName(!1));D.image.clearAll(4294967295);this.addLayerObject(this.getLayersRoot(),D)};this.addDefaultLayer=function(){let D=new Fa(X.width,X.height,this.getDefaultLayerName(!1));D.image.clearAll(16777215);this.addLayerObject(this.getLayersRoot(),D);this.setActiveLayer(D,!1)};this.fusionLayers=function(){m();va.buildTree();return bb=va.blendTree().image};this.upgradeMultiplyLayers=function(D){let N=this.getLayersRoot().getLinearizedLayerList(!1,
[]),W=-1;for(var Y=0;Y<N.length;Y++){var da=N[Y];if(!(da instanceof Fa)||da.mask||da.blendMode>Q.LM_LAST_CHIBIPAINT)throw Error("Bad layer type during multiply upgrade");da.blendMode===Q.LM_MULTIPLY&&(W=Y)}if(-1!==W){Y=new I(this.width,this.height);let aa=da=!0,wa=this.getBounds();Y.clearAll(wa,16777215);for(let Ma=0;Ma<=W;Ma++){let ab=N[Ma];aa||(da=da&&Y.hasAlphaInRect(wa));ab.blendMode===Q.LM_MULTIPLY&&("bake"===D?!da&&ab.getEffectiveAlpha()>0&&(100===ab.alpha?Q.upgradeMultiplyOfOpaqueLayer(Y,ab.image,
100,wa):Q.upgradeMultiplyOfTransparentLayer(Y,ab.image,ab.alpha,wa),ab.setBlendMode(Q.LM_MULTIPLY2)):da&&ab.setBlendMode(Q.LM_MULTIPLY2));ab.getEffectiveAlpha()>0&&(aa=!1,Q.fuseImageOntoImage(Y,da,ab.image,ab.alpha,ab.blendMode,wa,null))}}};this.isCreateClippingMaskAllowed=function(){var D=ea.parent.indexOf(ea);D=ea.parent.layers[D-1];return ea instanceof Fa&&!ea.clip&&D instanceof Fa};this.createClippingMask=function(){this.isCreateClippingMaskAllowed()&&v(new qa(ea,!0))};this.isReleaseClippingMaskAllowed=
function(){return ea instanceof Fa&&ea.clip};this.releaseClippingMask=function(){this.isReleaseClippingMaskAllowed()&&v(new qa(ea,!1))};this.setActiveLayer=function(D,N){if(D){let W=(N=D.mask&&N)!=ma;if(ea!=D||W){let Y=ea;ea=D;ma=N;u();this.emitEvent("changeActiveLayer",[Y,D,ma]);W&&this.emitEvent("editModeChanged",[ma?ec.EDITING_MODE_MASK:ec.EDITING_MODE_IMAGE]);Ha&&Ha.layer==Y&&(N?Ha.setLayer(D):this.closeMaskView())}}};this.closeMaskView=function(){Ha.close();Ha=null};this.toggleMaskView=function(){return null!=
Ha&&Ha.isOpen()?this.closeMaskView():Ha=ea.mask?new tg(ea,m):null,Ha};this.selectTopmostVisibleLayer=function(){let D=Z.getLinearizedLayerList(!1);for(var N=D.length-1;N>=0;N--)if(D[N]instanceof Fa&&D[N].getEffectiveAlpha()>0)return void this.setActiveLayer(D[N],!1);for(N=D.length-1;N>=0;N--)if(D[N]instanceof Fa)return void this.setActiveLayer(D[N],!1);this.setActiveLayer(D[D.length-1],!1)};this.getActiveLayer=function(){return ea};this.isEditingMask=function(){return ma};this.isActiveLayerDrawable=
function(){return ma&&ea.mask||!ma&&ea instanceof Fa};this.getUndoMemoryUsed=function(){let D=0;for(let N of Gb)D+=N.getMemoryUsed(!0,null);for(let N of hb)D+=N.getMemoryUsed(!1,null);return D};this.isUndoAllowed=function(){return hb.length>0};this.isRedoAllowed=function(){return Gb.length>0};this.undo=function(){if(this.isUndoAllowed()){this.setHasUnsavedChanges(!0);var D=hb.pop();D.undo();Gb.push(D)}};this.redo=function(){if(this.isRedoAllowed()){this.setHasUnsavedChanges(!0);var D=Gb.pop();D.redo();
hb.push(D)}};this.performIdleTasks=function(){t();m();va.buildTree()};this.compactUndo=function(){hb.length>0&&hb[hb.length-1].compact()};this.clearHistory=function(){hb=[];Gb=[]};this.colorPicker=function(D,N){return ma&&ea.mask?jb.greyToRGB(ea.mask.getPixel(~~D,~~N)):16777215&bb.getPixel(~~D,~~N)};this.setSelection=function(D){rb.set(D);rb.roundNearest();rb.clipTo(this.getBounds())};this.emptySelection=function(){rb.makeEmpty()};this.floodFill=function(D,N,W=0,Y=255,da=!0){da=!ma&&da?this.fusionLayers():
null;let aa=f();aa&&(t(),pa=this.getBounds(),aa.floodFillWithBorder(~~D,~~N,4278190080|Tb,W,Y,da),v(new A),l(ea,this.getBounds()))};this.gradientFill=function(D,N,W,Y,da){let aa=this.getSelectionAutoSelect(),wa=f();wa&&(t(),pa=aa.clone(),wa.gradient(aa,D,N,W,Y,da,!1),this.getLayerLockAlpha()&&wa instanceof I&&wa.copyAlphaFrom(ia,aa),v(new A),l(ea,aa))};this.fill=function(D,N){let W=this.getSelectionAutoSelect(),Y=f(),da=this.texture;if(Y){t();pa=W.clone();if(da&&!N){N=da.width;let ab=da.height,Xb=
W.right-W.left,Ub=W.bottom-W.top;for(let Ob=0;Ob<Ub;Ob++)for(let Kb=0;Kb<Xb;Kb++){var aa,wa,Ma;let vb=W.left+Kb,Vb=W.top+Ob,Jc=1-da.data[Vb%ab*N+vb%N]/255,Mb=(255&((aa=D)>>24&255)*(wa=Jc)+((Ma=Y.getPixel(vb,Vb))>>24&255)*(1-wa))<<24|(255&(aa>>16&255)*wa+(Ma>>16&255)*(1-wa))<<16|(255&(aa>>8&255)*wa+(Ma>>8&255)*(1-wa))<<8|255&(255&aa)*wa+(255&Ma)*(1-wa);Y.setPixel(vb,Vb,Mb)}}else Y.clearRect(W,D);v(new A);l(ea,W)}};this.clear=function(D=!0){ma?this.fill(0,D):this.fill(16777215,D)};this.flip=function(D){let N=
this.getSelection(),W=N.isEmpty();var Y=W&&ea instanceof Fa&&ea.mask&&ea.maskLinked;let da=(!ma||Y)&&ea instanceof Fa;Y=(ma||Y)&&ea.mask;D=D?"copyRegionHFlip":"copyRegionVFlip";(da||Y)&&(W&&(N=this.getBounds()),pa=N.clone(),da&&(n(),ea.image[D](N,ia)),Y&&(q(),ea.mask[D](N,M)),v(new A(da,Y)),k(ea,N,da,Y))};this.hFlip=function(){this.flip(!0)};this.vFlip=function(){this.flip(!1)};this.monochromaticNoise=function(){let D=this.getSelectionAutoSelect(),N=f();N&&(t(),pa=D.clone(),N.fillWithNoise(D,Tb),
v(new A),l(ea,D))};this.isColorNoiseAllowed=function(){return!this.isEditingMask()&&this.isActiveLayerDrawable()};this.isNotEditingMask=function(){return!this.isEditingMask()};this.isNotEditingMaskAndDrawable=function(){return!this.isEditingMask()&&this.isActiveLayerDrawable()};this.colorNoise=function(){if(this.isColorNoiseAllowed()){let D=this.getSelectionAutoSelect();t();pa=D.clone();ea.image.fillWithColorNoise(D);v(new A(!0,!1));k(ea,D,!0,!1)}};this.invert=function(){let D=this.getSelectionAutoSelect(),
N=f();N&&(t(),pa=D.clone(),N.invert(D),v(new A),l(ea,D))};this.brightnessToOpacity=function(){if(!ma){var D=this.getSelectionAutoSelect(),N=f();N&&(t(),pa=D.clone(),N.brightnessToOpacity(D),v(new A),l(ea,D))}};this.boxBlur=function(D,N,W,Y=!1){if(Y)return void v(new O(function(aa,wa){for(let Ma=0;Ma<W;Ma++)aa.boxBlur(wa,D,N)}));Y=this.getSelectionAutoSelect();let da=f();if(da){t();pa=Y.clone();for(let aa=0;aa<W;aa++)da.boxBlur(Y,D,N);v(new A);l(ea,Y)}};this.chromaticAberration=function(D,N,W=!1){if(!ma){if(W)return void v(new O(function(da,
aa){da.chromaticAberration(aa,D,N)}));W=this.getSelectionAutoSelect();var Y=f();Y&&(t(),pa=W.clone(),Y.chromaticAberration(W,D,N),v(new A),l(ea,W))}};this.edge=function(D,N){if(!ma){var W=this.getSelectionAutoSelect(),Y=f();Y&&(t(),pa=W.clone(),Y.edge(W,D,Tb,N),v(new A),l(ea,W))}};this.monoHalftone=function(D,N=!1){if(N)return void v(new O(function(Y,da){Y.monoHalftone(da,D,Tb,.85)}));N=this.getSelectionAutoSelect();let W=f();W&&(t(),pa=N.clone(),W.monoHalftone(N,D,Tb,.85),v(new A),l(ea,N))};this.colorHalftone=
function(D,N=!1){if(!ma){if(N)return void v(new O(function(Y,da){Y.colorHalftone(da,D,.85)},Q.LM_MULTIPLY2));N=this.getSelectionAutoSelect();var W=f();W&&(t(),pa=N.clone(),W.colorHalftone(N,D,.85),v(new A),l(ea,N))}};this.mosaic=function(D,N=!1){if(N)return void v(new O(function(Y,da){Y.mosaic(da,D)}));N=this.getSelectionAutoSelect();let W=f();W&&(t(),pa=N.clone(),W.mosaic(N,D),v(new A),l(ea,N))};this.rectangleSelection=function(D){D=D.clone();D.clipTo(this.getBounds());v(new ja(this.getSelection(),
D));this.setSelection(D)};this.move=function(D,N,W){if(N|=0,0!=(D|=0)||0!=N){var Y=hb.length>0?hb[hb.length-1]:null;!W&&Y instanceof vc&&Y.layer==this.getActiveLayer()?(Y.amend(D,N),Gb=[],this.setHasUnsavedChanges(!0)):(D=new vc(D,N,W),v(D),D.redo())}};this.setTransformInterpolation=function(D){oc=D;Ia instanceof Qb&&Ia.setInterpolation(D)};this.transformAffineAbort=function(){Ia instanceof Qb&&(Ia.undo(),Ia=null,d(!0))};this.transformAffineBegin=function(){if(Ia instanceof Qb)return{transform:Ia.getTransform(),
rect:Ia.getInitialTransformRect(),selection:Ia.getInitialSelectionRect()};let D=new qb,N;return(N=new Qb(D,oc)).getInitialTransformRect().isEmpty()?null:(Ia=N,mb=!0,{transform:D,rect:N.getInitialTransformRect(),selection:N.getInitialSelectionRect()})};this.transformAffineFinish=function(){Ia instanceof Qb&&(v(Ia),Ia=null,d(!0))};this.transformAffineAmend=function(D){Ia instanceof Qb&&Ia.amend(D)};this.isCopySelectionAllowed=this.isCutSelectionAllowed=function(){return!this.getSelection().isEmpty()&&
null!==f()};this.cutSelection=function(){this.isCutSelectionAllowed()&&v(new V(ea,ma,this.getSelection()))};this.copySelection=function(){if(this.isCopySelectionAllowed()){let D=X.getSelection();ob=new ve(f().cloneRect(D),D.left,D.top)}};this.isCopySelectionMergedAllowed=function(){return!this.getSelection().isEmpty()};this.copySelectionMerged=function(){if(this.isCopySelectionMergedAllowed()){let D=X.getSelection();ob=new ve(this.fusionLayers().cloneRect(D),D.left,D.top)}};this.isPasteClipboardAllowed=
function(){return!this.isClipboardEmpty()};this.pasteClipboard=function(){this.isPasteClipboardAllowed()&&v(new ha(ob))};this.getClipboard=function(){return ob};this.setClipboard=function(D){ob=D};this.isClipboardEmpty=function(){return null==ob};this.setSampleAllLayers=function(D){yb=D};this.getLayerLockAlpha=function(){return this.getActiveLayer().getLockAlpha()};this.setLayerLockAlpha=function(D){ea.getLockAlpha()!=D&&v(new Zb(ea,D))};this.setForegroundColor=function(D){Tb=D};this.setBrush=function(D){lb=
D};this.setBrushTexture=function(D){na.setTexture(D);this.texture=D};this.beginStroke=function(D,N,W){return null!==lb&&!!this.isActiveLayerDrawable()&&(t(),pa.makeEmpty(),K.clearAll(0),ca.makeEmpty(),wb=D,uc=N,Lb=W,mb=!0,ba[lb.brushMode].beginStroke(),this.paintDab(D,N,W,!0),!0)};this.continueStroke=function(D,N,W){if(null!=lb){var Y=D-wb,da=N-uc,aa=Math.sqrt(Y*Y+da*da),wa=Math.max(lb.minSpacing,lb.curSize*lb.spacing);if(aa>=wa){Y/=aa;da/=aa;let Ma=(W-Lb)/aa,ab=wa;for(;ab<=aa;)this.paintDab(wb+Y*
ab,uc+da*ab,Lb+Ma*ab),ab+=wa;wb=D;uc=N;Lb=W}}};this.endStroke=function(){null!=lb&&(m(),ba[lb.brushMode].endStroke(),pa.clipTo(this.getBounds()),pa.isEmpty()||(v(new A),t()),d(!1))};this.hasAlpha=function(){return bb.hasAlpha()};this.getFlatPNG=function(D){return this.fusionLayers(),bb.getAsPNG(D)};this.getFlatPNGBuffer=function(D){return this.fusionLayers(),bb.getAsPNGBuffer(D)};A.prototype=Object.create(Yb.prototype);A.prototype.constructor=A;C.prototype=Object.create(Yb.prototype);C.prototype.constructor=
C;x.prototype=Object.create(Yb.prototype);x.prototype.constructor=x;F.prototype=Object.create(Yb.prototype);F.prototype.constructor=F;w.prototype=Object.create(Yb.prototype);w.prototype.constructor=w;G.prototype=Object.create(Yb.prototype);G.prototype.constructor=G;H.prototype=Object.create(Yb.prototype);H.prototype.constructor=H;P.prototype=Object.create(Yb.prototype);P.prototype.constructor=P;B.prototype=Object.create(Yb.prototype);B.prototype.constructor=B;O.prototype=Object.create(Yb.prototype);
O.prototype.constructor=O;T.prototype=Object.create(Yb.prototype);T.prototype.constructor=T;let Ic=L("alpha",!0),Wc=L("blendMode",!0),fc=L("visible",!0),qa=L("clip",!0),ac=L("maskVisible",!0),hc=L("name",!1),Zb=L("lockAlpha",!1),yc=L("maskLinked",!1);ja.prototype=Object.create(Yb.prototype);ja.prototype.constructor=ja;class La extends Yb{undo(){let D=[];this.dstRect.isEmpty()||D.push(this.dstRect);this.erasesSourceRect&&(D.push(this.srcRect),D=Ca.union(D));this.movingLayers.forEach(N=>{this.hasFullUndo?
D.forEach(W=>{N.moveImage&&N.layer.image.copyBitmapRect(N.imageUndo,W.left,W.top,W);N.moveMask&&N.layer.mask.copyBitmapRect(N.maskUndo,W.left,W.top,W)}):(N.moveImage&&N.imageRect.forEach((W,Y)=>{N.layer.image.copyBitmapRect(W,Y.left,Y.top,W.getBounds())}),N.moveMask&&N.maskRect.forEach((W,Y)=>{N.layer.mask.copyBitmapRect(W,Y.left,Y.top,W.getBounds())}))});k(this.movingLayers.map(N=>N.layer),D.reduce((N,W)=>N.getUnion(W),new Ca(0,0,0,0)),!0,!0);this.dstRect.makeEmpty();X.setSelection(this.fromSelection);
X.setActiveLayer(this.layer,this.fromMaskMode);b()}getMemoryUsed(D,N){return this.movingLayers.map(function(W){return[W.imageUndo,W.maskUndo,W.imageRect,W.maskRect].map(Y=>Y?Y.getMemorySize():0).reduce(Md,0)}).reduce(Md,0)}buildFullUndo(){this.hasFullUndo||(this.movingLayers.forEach(function(D){D.moveImage&&(D.imageUndo=D.layer.image.clone());D.moveMask&&(D.maskUndo=D.layer.mask.clone());D.imageRect.clear();D.maskRect.clear()}),this.hasFullUndo=!0)}compact(){if(this.hasFullUndo){let D=[];this.dstRect.isEmpty()||
D.push(this.dstRect);this.erasesSourceRect&&(D.push(this.srcRect),D=Ca.union(D));this.movingLayers.forEach(N=>{N.imageRect.clear();N.maskRect.clear();D.forEach(W=>{N.moveImage&&N.imageRect.set(W,N.imageUndo.cloneRect(W));N.moveMask&&N.maskRect.set(W,N.maskUndo.cloneRect(W))});N.imageUndo=null;N.maskUndo=null});this.hasFullUndo=!1}}constructor(){super();this.layer=ea;this.fromSelection=X.getSelection();this.fromMaskMode=ma;this.movingWholeLayer=this.fromSelection.isEmpty();this.movingImage=!ma||this.movingWholeLayer&&
this.layer.maskLinked;this.movingMask=ma||this.movingWholeLayer&&this.layer.maskLinked;this.erasesSourceRect=this.hasFullUndo=!1;this.dstRect=new Ca(0,0,0,0);this.movingLayers=[{layer:this.layer,moveImage:this.layer instanceof Fa&&this.movingImage,moveMask:null!==this.layer.mask&&this.movingMask,imageRect:new Map,maskRect:new Map}];this.layer instanceof $a&&this.movingImage&&this.movingWholeLayer&&(this.movingLayers=this.movingLayers.concat(this.layer.getLinearizedLayerList(!1).map(Y=>({layer:Y,moveImage:Y instanceof
Fa,moveMask:null!==Y.mask&&Y.maskLinked,imageRect:new Map,maskRect:new Map}))));let D=new Ca(0,0,0,0);if(this.movingWholeLayer){this.srcRect=X.getBounds();for(var N=0;N<this.movingLayers.length&&!D.equals(this.srcRect);N++){var W=this.movingLayers[N];W.moveMask&&D.union(W.layer.mask.getValueBounds(this.srcRect,255));W.moveImage&&D.union(W.layer.image.getNonTransparentBounds(this.srcRect))}}else for(this.srcRect=this.fromSelection.clone(),N=0;N<this.movingLayers.length&&!D.equals(this.srcRect);N++)W=
this.movingLayers[N],W.moveMask&&D.union(W.layer.mask.getValueBounds(this.srcRect,0)),W.moveImage&&D.union(W.layer.image.getNonTransparentBounds(this.srcRect));this.srcRect=D}}class Qb extends La{buildFullUndo(){if(!this.hasFullUndo){super.buildFullUndo();this.movingLayers.forEach(W=>{if(W.moveImage){var Y=Vc(this.srcRect.getWidth(),this.srcRect.getHeight());Y.getContext("2d").putImageData(W.layer.image.getImageData(),-this.srcRect.left,-this.srcRect.top,this.srcRect.left,this.srcRect.top,this.srcRect.getWidth(),
this.srcRect.getHeight());W.imageSourceCanvas=Y}W.moveMask&&(Y=Vc(this.srcRect.getWidth(),this.srcRect.getHeight()),Y.getContext("2d").putImageData(W.layer.mask.getImageData(this.srcRect.left,this.srcRect.top,this.srcRect.getWidth(),this.srcRect.getHeight()),0,0),W.maskSourceCanvas=Y)});this.composeCanvas=Vc(X.width,X.height);this.composeCanvasContext=this.composeCanvas.getContext("2d",{willReadFrequently:!0});let D="smooth"===this.interpolation,N=this.composeCanvasContext;N&&(N.imageSmoothingEnabled=
D);this.junk=this.composeCanvasContext.getImageData(0,0,1,1)}}redo(){this.buildFullUndo();var D=this.dstRect.clone();let N=this.srcRect.toPoints();this.affineTransform.transformPoints(N);this.dstRect.set(Ca.createBoundingBox(N).roundContain().clipTo(X.getBounds()));let W=Ca.subtract(this.dstRect,this.srcRect),Y=Ca.subtract(D.isEmpty()?this.srcRect:this.srcRect.getIntersection(D),this.dstRect),da=this.srcRect.getIntersection(this.dstRect),aa=Ca.subtract(D,[this.dstRect,this.srcRect]);D=this.srcRect.getUnion(this.dstRect).getUnion(D);
(this.movingLayers.forEach(wa=>{if(Y.forEach(Ma=>{wa.moveImage&&wa.layer.image.clearRect(Ma,16777215);wa.moveMask&&(this.movingWholeLayer?wa.layer.mask.clearRect(Ma,255):wa.layer.mask.clearRect(Ma,0))}),!this.dstRect.isEmpty()){if(wa.moveImage){let Ma=wa.imageUndo.getImageData();W.forEach(ab=>{this.composeCanvasContext.putImageData(Ma,0,0,ab.left,ab.top,ab.getWidth(),ab.getHeight())});this.composeCanvasContext.clearRect(da.left,da.top,da.getWidth(),da.getHeight());this.composeCanvasContext.save();
this.composeCanvasContext.setTransform(this.affineTransform.m[0],this.affineTransform.m[1],this.affineTransform.m[2],this.affineTransform.m[3],this.affineTransform.m[4],this.affineTransform.m[5]);this.composeCanvasContext.drawImage(wa.imageSourceCanvas,this.srcRect.left,this.srcRect.top);this.composeCanvasContext.restore();wa.layer.image.copyBitmapRect(new I(this.composeCanvasContext.getImageData(this.dstRect.left,this.dstRect.top,this.dstRect.getWidth(),this.dstRect.getHeight())),this.dstRect.left,
this.dstRect.top,new Ca(0,0,this.dstRect.getWidth(),this.dstRect.getHeight()))}wa.moveMask&&(W.forEach(Ma=>{this.composeCanvasContext.putImageData(wa.layer.mask.getImageData(Ma.left,Ma.top,Ma.getWidth(),Ma.getHeight()),Ma.left,Ma.top)}),this.movingWholeLayer?this.composeCanvasContext.fillStyle="#FFF":this.composeCanvasContext.fillStyle="#000",this.composeCanvasContext.fillRect(da.left,da.top,da.getWidth(),da.getHeight()),this.composeCanvasContext.save(),this.composeCanvasContext.setTransform(this.affineTransform.m[0],
this.affineTransform.m[1],this.affineTransform.m[2],this.affineTransform.m[3],this.affineTransform.m[4],this.affineTransform.m[5]),this.composeCanvasContext.drawImage(wa.maskSourceCanvas,this.srcRect.left,this.srcRect.top),this.composeCanvasContext.restore(),wa.layer.mask.pasteImageData(this.composeCanvasContext.getImageData(this.dstRect.left,this.dstRect.top,this.dstRect.getWidth(),this.dstRect.getHeight()),this.dstRect.left,this.dstRect.top))}aa.forEach(Ma=>{wa.moveImage&&wa.layer.image.copyBitmapRect(wa.imageUndo,
Ma.left,Ma.top,Ma);wa.moveMask&&wa.layer.mask.copyBitmapRect(wa.maskUndo,Ma.left,Ma.top,Ma)})}),k(this.movingLayers.map(wa=>wa.layer),D,!0,!0),this.fromSelection.isEmpty())||(D=this.fromSelection.toPoints(),this.affineTransform.transformPoints(D),(D=Ca.createBoundingBox(D)).roundNearest(),X.setSelection(D),b());X.setActiveLayer(this.layer,this.fromMaskMode)}amend(D){this.hasFullUndo||this.undo();this.affineTransform=D.clone();this.redo()}setInterpolation(D){if(D!=this.interpolation){this.interpolation=
D;D="smooth"===this.interpolation;let N=this.composeCanvasContext;N&&(N.imageSmoothingEnabled=D);this.undo();this.redo()}}compact(){super.compact();this.composeCanvasContext=this.composeCanvas=null;this.movingLayers.forEach(D=>D.imageSourceCanvas=null)}getMemoryUsed(D,N){D=super.getMemoryUsed(D,N);return D+=jf(this.composeCanvas),D+=this.movingLayers.map(W=>jf(W.imageSourceCanvas)).reduce(Md,0)}getTransform(){return this.affineTransform.clone()}getInitialTransformRect(){return this.srcRect.clone()}getInitialSelectionRect(){return this.fromSelection.clone()}constructor(D,
N){super();this.erasesSourceRect=!0;this.affineTransform=D.clone();this.interpolation=N||"smooth";this.composeCanvasContext=this.composeCanvas=null}}class vc extends La{redo(){var D=this.dstRect.clone();let N,W,Y=D.clone(),da=null;(this.buildFullUndo(),this.dstRect.set(this.srcRect),this.dstRect.translate(this.offsetX,this.offsetY),N=this.dstRect.clone(),this.dstRect.clipTo(X.getBounds()),this.erasesSourceRect?(da=D.isEmpty()?this.srcRect:this.srcRect.getIntersection(D),Y.union(da),W=D.subtract(this.srcRect)):
W=[D],this.movingLayers.forEach(aa=>{da&&(aa.moveImage&&aa.layer.image.clearRect(da,16777215),aa.moveMask&&aa.layer.mask.clearRect(da,255*!!this.movingWholeLayer));W.forEach(function(wa){aa.moveImage&&aa.layer.image.copyBitmapRect(aa.imageUndo,wa.left,wa.top,wa);aa.moveMask&&aa.layer.mask.copyBitmapRect(aa.maskUndo,wa.left,wa.top,wa)});aa.moveImage&&Q.normalFuseImageOntoImageAtPosition(aa.layer.image,aa.imageUndo,N.left,N.top,this.srcRect);aa.moveMask&&aa.layer.mask.copyBitmapRect(aa.maskUndo,N.left,
N.top,this.srcRect)}),Y.union(this.dstRect),k(this.movingLayers.map(aa=>aa.layer),Y,!0,!0),this.fromSelection.isEmpty())||(D=this.fromSelection.clone(),D.translate(this.offsetX,this.offsetY),X.setSelection(D),b())}amend(D,N){this.hasFullUndo||this.undo();this.offsetX+=D;this.offsetY+=N;this.redo()}constructor(D,N,W){super();this.offsetX=D;this.offsetY=N;this.erasesSourceRect=!W}}V.prototype=Object.create(Yb.prototype);V.prototype.constructor=V;ha.prototype=Object.create(Yb.prototype);ha.prototype.constructor=
ha;ba=[gd,ug,vg,wg,Ad,xg,yg,zg].map(D=>new D(K,ca));this.width=a;this.height=c}function gb(a,c,d){this.data=a;this.eof=!1;this.start=void 0===c?0:c;this.end=void 0===d?a.length:d;this.pos=this.start}function Ag(a,c){return we(a,c||{},0,0)}function Bg(a,c){return Nd(a,{i:2},c&&c.out,c&&c.dictionary)}function kf(a,c){c||={};var d=xe();d.p(a);a=we(a,c,c.dictionary?6:2,4);return lf(a,c),ye(a,a.length-4,d.d()),a}function mf(a,c){return Nd(a.subarray(nf(a,c&&c.dictionary),-4),{i:2},c&&c.out,c&&c.dictionary)}
function ze(a){this.version=a.readU32BE();this.width=a.readU32BE();this.height=a.readU32BE();this.layersNb=a.readU32BE()}function Od(a){let c=[,,,,];for(let d=0;d<c.length;d++)c[d]=String.fromCharCode(a.readByte());if(this.chunkType=c.join(""),this.chunkSize=a.readU32BE(),a.eof)throw"Truncated chunk";}function of(a){return{major:a>>16&65535,minor:65535&a}}function Ae(a,c){let d=new gb(new Uint8Array(Od.HEADER_LENGTH+c));return d.writeString(a),d.writeU32BE(c),d}function pf(a,c={}){async function d(m){let n;
var q=f;if(null!==q&&0!==q.length)if(null===m||0===m.length)m=q;else{var t=new Uint8Array(q.length+m.length);m=(t.set(q,0),t.set(m,q.length),t)}for(f=m;f;){if(e<f.length)f=f.subarray(e),e=0;else{e-=f.length;f=null;break}switch(b){case 0:if(f.length<Od.HEADER_LENGTH)break;if(l=new Od(n=new gb(f)),f=f.subarray(n.pos),k)if(l.chunkType=="ZEND")b=45;else{l.chunkType=="LAYR"?(b=2,g=new Cg(l,k.width,k.height)):l.chunkType=="GRUP"?(b=3,g=new Dg(l,k.width,k.height)):(console.log("Unknown chunk type '"+l.chunkType+
"', attempting to skip..."),e=l.chunkSize);continue}else if(l.chunkType=="HEAD"){b=1;continue}else b=5;break;case 1:if(f.length<l.chunkSize)break;if(of((k=new ze(n=new gb(f))).version).major>0){b=5;break}p=(h=new ec(k.width,k.height)).getLayersRoot();e=l.chunkSize;b=0;continue;case 2:if(f=g.decode(f),g.done){h.addLayerObject(p,g.layer);b=0;await Be();continue}break;case 3:if(f=g.decode(f),g.done){h.addLayerGroupObject(p,g.layer,g.childLayers);b=0;await Be();continue}}break}}let b=0,h=null,p=null,
g,e=0,k=null,l=null,f=null;return(new Promise(function(m){if(a instanceof ArrayBuffer)m(a);else{let n=new FileReader;n.onload=function(){m(this.result)};n.readAsArrayBuffer(a)}})).then(m=>new Promise(function(n,q){var t,u,v;let A=new Uint8Array(m);(function(C){for(let x=0;x<8;x++)if(C[x]!="CHIBIOEK".charCodeAt(x))return!1;return!0})(A)?(t=A.subarray(8),u=async(C,x)=>{C?q("Fatal error decompressing ChibiFile: "+C):(await d(x),45==b?(!1!==c.upgradeMultiplyLayers&&k.version<10&&h.upgradeMultiplyLayers(c.upgradeMultiplyLayers),
h.selectTopmostVisibleLayer(),n(h)):q("Fatal error decoding ChibiFile structure."))},v||(v=u,u={}),"function"!=typeof v&&$b(7),qf(t,u,[Eg,Fg,function(){return[mf]}],function(C){return Pd(mf(C.data[0],rf(C.data[1])))},5,v)):q("This doesn't appear to be a ChibiPaint layers file, is it damaged?")}))}function hd(){}function Bd(a){function c(p,g){null===g?h.emitEvent("loadingProgress",[1,"Loading your "+p.friendly+"..."]):h.emitEvent("loadingProgress",[g,"Loading your "+p.friendly+" ("+Math.round(100*
g)+"%)..."])}var d=[],b={},h=this;a.loadChibiFileUrl&&(""+a.loadChibiFileUrl).length>0?d.push({url:a.loadChibiFileUrl,friendly:"drawing layers",name:"layers",required:!0}):a.loadImageUrl&&(""+a.loadImageUrl).length>0&&d.push({url:a.loadImageUrl,friendly:"drawing",name:"flat",required:!0});a.loadSwatchesUrl&&d.push({url:a.loadSwatchesUrl,friendly:"color swatches",name:"swatches",required:!1,noProgress:!0});this.load=function(){function p(){g.required?h.emitEvent("loadingFailure",["Failed to load your "+
g.friendly+", please try again later."]):h.load()}if(0==d.length)return void h.emitEvent("loadingComplete",[b]);var g=d.shift(),e=new XMLHttpRequest;e.addEventListener("progress",function(k){c(g,k.lengthComputable&&!g.noProgress?k.loaded/k.total:null)},!1);e.addEventListener("load",function(k){if(200==this.status){let l=this.response;h.emitEvent("loadingProgress",[1,"Starting litaChix..."]);setTimeout(function(){(function(f,m){switch(f.name){case "flat":return new Promise(function(n,q){let t=new Blob([m],
{type:"image/png"}),u=window.URL.createObjectURL(t);if(u){let v=new Image;v.onload=function(){let A=new ec(this.width,this.height),C=new Fa(0,0,"Layer 1");C.image=I.createFromImage(v);A.addLayerObject(A.getLayersRoot(),C);v=null;window.URL.revokeObjectURL(u);n(A)};v.src=u}else q(null)});case "swatches":return(f=(new hd).read(m))?Promise.resolve(f):Promise.reject(null);case "layers":return pf(m);default:return Promise.reject("Unexpected resource type '"+f.name+"'")}})(g,l).then(function(f){b[g.name]=
f;h.load()},function(){h.emitEvent("loadingFailure",["Failed to read your "+g.friendly])})},0)}else p()},!1);e.addEventListener("error",p);c(g,g.noProgress?null:0);e.open("GET",g.url,!0);e.responseType="arraybuffer";e.send()}}function Cc(a){if(a>2147483647)throw RangeError('The value "'+a+'" is invalid for option "size"');a=new Uint8Array(a);return Object.setPrototypeOf(a,oa.prototype),a}function oa(a,c,d){if("number"==typeof a){if("string"==typeof c)throw TypeError('The "string" argument must be of type string. Received type number');
return Ce(a)}return sf(a,c,d)}function sf(a,c,d){if("string"==typeof a){var b=c;if(("string"!=typeof b||""===b)&&(b="utf8"),!oa.isEncoding(b))throw TypeError("Unknown encoding: "+b);c=0|tf(a,b);d=Cc(c);a=d.write(a,b);return a!==c&&(d=d.slice(0,a)),d}if(ArrayBuffer.isView(a))return zc(a,Uint8Array)?(a=new Uint8Array(a),uf(a.buffer,a.byteOffset,a.byteLength)):De(a);if(null==a)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+
typeof a);if(zc(a,ArrayBuffer)||a&&zc(a.buffer,ArrayBuffer)||"u">typeof SharedArrayBuffer&&(zc(a,SharedArrayBuffer)||a&&zc(a.buffer,SharedArrayBuffer)))return uf(a,c,d);if("number"==typeof a)throw TypeError('The "value" argument must not be of type number. Received type number');b=a.valueOf&&a.valueOf();if(null!=b&&b!==a)return oa.from(b,c,d);if(oa.isBuffer(a)){b=0|Ee(a.length);var h=Cc(b);b=(0===h.length||a.copy(h,0,0,b),h)}else void 0!==a.length?((b="number"!=typeof a.length)||(b=a.length,b=b!=
b),b=b?Cc(0):De(a)):b="Buffer"===a.type&&Array.isArray(a.data)?De(a.data):void 0;if(b)return b;if("u">typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return oa.from(a[Symbol.toPrimitive]("string"),c,d);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);}function vf(a){if("number"!=typeof a)throw TypeError('"size" argument must be of type number');if(a<0)throw RangeError('The value "'+
a+'" is invalid for option "size"');}function Ce(a){return vf(a),Cc(a<0?0:0|Ee(a))}function De(a){for(var c=a.length<0?0:0|Ee(a.length),d=Cc(c),b=0;b<c;b+=1)d[b]=255&a[b];return d}function uf(a,c,d){var b;if(c<0||a.byteLength<c)throw RangeError('"offset" is outside of buffer bounds');if(a.byteLength<c+(d||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(b=void 0===c&&void 0===d?new Uint8Array(a):void 0===d?new Uint8Array(a,c):new Uint8Array(a,c,d),oa.prototype),
b}function Ee(a){if(a>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|a}function tf(a,c){if(oa.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||zc(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);var d=a.length,b=arguments.length>2&&!0===arguments[2];if(!b&&0===d)return 0;for(var h=!1;;)switch(c){case "ascii":case "latin1":case "binary":return d;
case "utf8":case "utf-8":return Fe(a).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*d;case "hex":return d>>>1;case "base64":return wf(a).length;default:if(h)return b?-1:Fe(a).length;c=(""+c).toLowerCase();h=!0}}function Gg(a,c,d){var b,h,p=!1;if((void 0===c||c<0)&&(c=0),c>this.length||((void 0===d||d>this.length)&&(d=this.length),d<=0||(d>>>=0)<=(c>>>=0)))return"";for(a||="utf8";;)switch(a){case "hex":return function(g,e,k){var l=g.length;(!e||e<0)&&(e=0);(!k||k<0||k>l)&&
(k=l);for(l="";e<k;++e)l+=Hg[g[e]];return l}(this,c,d);case "utf8":case "utf-8":return xf(this,c,d);case "ascii":return function(g,e,k){var l="";for(k=Math.min(g.length,k);e<k;++e)l+=String.fromCharCode(127&g[e]);return l}(this,c,d);case "latin1":case "binary":return function(g,e,k){var l="";for(k=Math.min(g.length,k);e<k;++e)l+=String.fromCharCode(g[e]);return l}(this,c,d);case "base64":return b=c,h=d,0===b&&h===this.length?yf(this):yf(this.slice(b,h));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return function(g,
e,k){g=g.slice(e,k);e="";for(k=0;k<g.length-1;k+=2)e+=String.fromCharCode(g[k]+256*g[k+1]);return e}(this,c,d);default:if(p)throw TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase();p=!0}}function Xc(a,c,d){var b=a[c];a[c]=a[d];a[d]=b}function zf(a,c,d,b,h){var p;if(0===a.length)return-1;if("string"==typeof d?(b=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),(p=d*=1)!=p&&(d=h?0:a.length-1),d<0&&(d=a.length+d),d>=a.length){if(h)return-1;d=a.length-1}else if(d<0)if(h)d=0;else return-1;
if("string"==typeof c&&(c=oa.from(c,b)),oa.isBuffer(c))return 0===c.length?-1:Af(a,c,d,b,h);if("number"==typeof c)return(c&=255,"function"==typeof Uint8Array.prototype.indexOf)?h?Uint8Array.prototype.indexOf.call(a,c,d):Uint8Array.prototype.lastIndexOf.call(a,c,d):Af(a,[c],d,b,h);throw TypeError("val must be string, number or Buffer");}function Af(a,c,d,b,h){function p(l,f){return 1===g?l[f]:l.readUInt16BE(f*g)}var g=1,e=a.length,k=c.length;if(void 0!==b&&("ucs2"===(b=String(b).toLowerCase())||"ucs-2"===
b||"utf16le"===b||"utf-16le"===b)){if(a.length<2||c.length<2)return-1;g=2;e/=2;k/=2;d/=2}if(h)for(b=-1;d<e;d++)if(p(a,d)===p(c,-1===b?0:d-b)){if(-1===b&&(b=d),d-b+1===k)return b*g}else-1!==b&&(d-=d-b),b=-1;else for(d+k>e&&(d=e-k);d>=0;d--){e=!0;for(b=0;b<k;b++)if(p(a,d+b)!==p(c,b)){e=!1;break}if(e)return d}return-1}function xf(a,c,d){d=Math.min(a.length,d);for(var b=[];c<d;){var h,p,g=a[c],e=null,k=g>239?4:g>223?3:g>191?2:1;if(c+k<=d)switch(k){case 1:g<128&&(e=g);break;case 2:(192&(h=a[c+1]))==128&&
(p=(31&g)<<6|63&h)>127&&(e=p);break;case 3:h=a[c+1];var l=a[c+2];(192&h)==128&&(192&l)==128&&(p=(15&g)<<12|(63&h)<<6|63&l)>2047&&(p<55296||p>57343)&&(e=p);break;case 4:h=a[c+1];l=a[c+2];var f=a[c+3];(192&h)==128&&(192&l)==128&&(192&f)==128&&(p=(15&g)<<18|(63&h)<<12|(63&l)<<6|63&f)>65535&&p<1114112&&(e=p)}null===e?(e=65533,k=1):e>65535&&(e-=65536,b.push(e>>>10&1023|55296),e=56320|1023&e);b.push(e);c+=k}a=b.length;if(a<=4096)return String.fromCharCode.apply(String,b);d="";for(h=0;h<a;)d+=String.fromCharCode.apply(String,
b.slice(h,h+=4096));return d}function Rb(a,c,d){if(a%1!=0||a<0)throw RangeError("offset is not uint");if(a+c>d)throw RangeError("Trying to access beyond buffer length");}function ic(a,c,d,b,h,p){if(!oa.isBuffer(a))throw TypeError('"buffer" argument must be a Buffer instance');if(c>h||c<p)throw RangeError('"value" argument is out of bounds');if(d+b>a.length)throw RangeError("Index out of range");}function Bf(a,c,d,b,h){c*=1;d>>>=0;if(!h&&(d+4>a.length||d<0))throw RangeError("Index out of range");return Cf(a,
c,d,b,23,4),d+4}function Df(a,c,d,b,h){c*=1;d>>>=0;if(!h&&(d+8>a.length||d<0))throw RangeError("Index out of range");return Cf(a,c,d,b,52,8),d+8}function Fe(a,c){c=c||1/0;for(var d,b=a.length,h=null,p=[],g=0;g<b;++g){if((d=a.charCodeAt(g))>55295&&d<57344){if(!h){if(d>56319||g+1===b){(c-=3)>-1&&p.push(239,191,189);continue}h=d;continue}if(d<56320){(c-=3)>-1&&p.push(239,191,189);h=d;continue}d=(h-55296<<10|d-56320)+65536}else h&&(c-=3)>-1&&p.push(239,191,189);if(h=null,d<128){if(--c<0)break;p.push(d)}else if(d<
2048){if((c-=2)<0)break;p.push(d>>6|192,63&d|128)}else if(d<65536){if((c-=3)<0)break;p.push(d>>12|224,d>>6&63|128,63&d|128)}else if(d<1114112){if((c-=4)<0)break;p.push(d>>18|240,d>>12&63|128,d>>6&63|128,63&d|128)}else throw Error("Invalid code point");}return p}function wf(a){return function(c){var d=c.length;if(d%4>0)throw Error("Invalid string. Length must be a multiple of 4");var b=c.indexOf("=");-1===b&&(b=d);d=[b,b===d?0:4-b%4];var h=d[0];d=d[1];b=new Ig((h+d)*3/4-d);var p=0,g=d>0?h-4:h;for(h=
0;h<g;h+=4){var e=pc[c.charCodeAt(h)]<<18|pc[c.charCodeAt(h+1)]<<12|pc[c.charCodeAt(h+2)]<<6|pc[c.charCodeAt(h+3)];b[p++]=e>>16&255;b[p++]=e>>8&255;b[p++]=255&e}return 2===d&&(e=pc[c.charCodeAt(h)]<<2|pc[c.charCodeAt(h+1)]>>4,b[p++]=255&e),1===d&&(e=pc[c.charCodeAt(h)]<<10|pc[c.charCodeAt(h+1)]<<4|pc[c.charCodeAt(h+2)]>>2,b[p++]=e>>8&255,b[p++]=255&e),b}(function(c){if((c=(c=c.split("=")[0]).trim().replace(Jg,"")).length<2)return"";for(;c.length%4!=0;)c+="=";return c}(a))}function Qd(a,c,d,b){for(var h=
0;h<b&&!(h+d>=c.length)&&!(h>=a.length);++h)c[h+d]=a[h];return h}function zc(a,c){return a instanceof c||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===c.name}function Ge(){throw Error("setTimeout has not been defined");}function He(){throw Error("clearTimeout has not been defined");}function Ef(a){if(Kc===setTimeout)return setTimeout(a,0);if((Kc===Ge||!Kc)&&setTimeout)return Kc=setTimeout,setTimeout(a,0);try{return Kc(a,0)}catch(c){try{return Kc.call(null,a,0)}catch(d){return Kc.call(this,
a,0)}}}function Kg(){id&&Yc&&(id=!1,Yc.length?Dc=Yc.concat(Dc):Rd=-1,Dc.length&&Ff())}function Ff(){if(!id){var a=Ef(Kg);id=!0;for(var c=Dc.length;c;){Yc=Dc;for(Dc=[];++Rd<c;)Yc&&Yc[Rd].run();Rd=-1;c=Dc.length}Yc=null;id=!1;(function(d){if(Lc===clearTimeout)return clearTimeout(d);if((Lc===He||!Lc)&&clearTimeout)return Lc=clearTimeout,clearTimeout(d);try{Lc(d)}catch(b){try{return Lc.call(null,d)}catch(h){return Lc.call(this,d)}}})(a)}}function Gf(a,c){this.fun=a;this.array=c}function Ec(){}async function Ie(a,
c){return new Promise((d,b)=>{let h=indexedDB.open("litaChixDB",1);h.onupgradeneeded=p=>{p=p.target.result;p.objectStoreNames.contains("chibiResults")||p.createObjectStore("chibiResults")};h.onsuccess=()=>{let p,g=h.result,e=g.transaction("chibiResults",a),k=c(e.objectStore("chibiResults"));k.onsuccess=()=>{p=k.result};e.oncomplete=()=>{g.close();d(p)};e.onabort=()=>{g.close();b(e.error||Error("Transaction aborted"))};e.onerror=()=>{g.close();b(e.error)}};h.onerror=()=>b(h.error)})}async function Lg(a,
c){let d={bytes:a,swatches:c,savedAt:Date.now()};try{let b=await Ie("readwrite",h=>h.put(d,"latest_backup"));return localStorage.setItem("has_chibi_autosave_flag","true"),b}catch(b){throw console.log("Failed to save to IndexedDB:",b),b;}}async function Mg(){return await Ie("readonly",a=>a.get("latest_backup"))||null}async function Je(){return localStorage.removeItem("has_chibi_autosave_flag"),Ie("readwrite",a=>a.delete("latest_backup"))}function Ke(a){(a=a.split(/[-_]/,1)[0].toLowerCase())in Le?(Sd=
Le[a],Me=a):(Sd=Td,Me="en")}function U(a){return a in Sd?Sd[a]:a}function Cd(a){function c(k){null===k?g.emitEvent("savingProgress",[1,U("Saving drawing...")]):g.emitEvent("savingProgress",[k,U("Saving drawing...")+" ("+Math.round(100*k)+"%)"])}function d(k){g.emitEvent("savingFailure",[k])}async function b(k){try{let l=await h(k),f=`${(l/1024/1024).toFixed(3)}MB`,m=`${a.post_max_size}MB`;if(console.log("Total size of FormData:",f),console.log("post_max_size:",m),a&&a.post_max_size&&l&&!isNaN(l)&&
l>1048576*a.post_max_size)return void d(`${U("The file size exceeds the server limit.")}
${U("Limit size")}:${m}
${U("Current size")}:${f}`);console.log(U("The total size of FormData is within the acceptable range."))}catch(l){console.error("Error details:",l);d("An error occurred in the getFormDataSize function.");return}c(.5);fetch(a.url,{method:"POST",mode:"same-origin",headers:{"X-Requested-With":"chickenpaint"},body:k}).then(l=>{if(!l.ok){let f;switch(l.status){case 400:f="Bad Request";break;case 401:f="Unauthorized";break;case 403:f="Forbidden";break;case 404:f="Not Found";break;case 500:f="Internal Server Error";
break;case 502:f="Bad Gateway";break;case 503:f="Service Unavailable";break;default:f="Unknown Error"}throw Error(`${U("Network response was not OK")} ( ${U("HTTP status code")} ${l.status} : ${f} )`);}return l.text()}).then(l=>{/^CHIBIOK/.test(l)?(c(1),g.emitEvent("savingComplete"),Je()):d(l)}).catch(l=>{d(l.message)})}async function h(k){if(a.post_max_size)return k=Array.from(k.entries()).map(([l,f])=>"string"==typeof f?new Blob([`${l}=${f}`]):f),(new Blob(k)).size}async function p(k,l,f,m){let n=
new (Ja(Hf));n.file(`${k}.png`,l);f&&n.file(`${k}.chi`,f.bytes);m&&n.file(`${k}.aco`,m);l=await n.generateAsync({type:"blob"});Ja(Ud).saveAs(l,`${k}.zip`)}var g=this,e=!1;a.rotation=a.rotation||0;this.save=function(k={}){var l,f,m,n,q;let t=null!=(l=k.zip)&&l,u=null!=(f=k.saveUrl)&&f,v=null!=(m=k.savedb)&&m,A=null!=(n=k.savedbFromMenu)&&n;k=v?null:function(x){for(var F=new Uint8Array(x.length),w=0;w<x.length;w++)F[w]=x.charCodeAt(w);return F}(a.artwork.getFlatPNG(a.rotation));var C=v?null:new Blob([k],
{type:"image/png"});k=null;(function(x,F={}){let w=(F=F||{}).savedb||!1;return new Promise(async(G,H)=>{var P,B,O;let T=x.getLayersRoot().getLinearizedLayerList(!1),L=F.forceOldVersion?0:function(ha){for(let Z of ha.getLayersRoot().getLinearizedLayerList(!1))if(Z instanceof $a||Z.mask||Z.clip||Z.blendMode>Q.LM_LAST_CHIBIPAINT||Z.blendMode===Q.LM_MULTIPLY)return 10;return 0}(x),ja=0===(B=of(L)).major&&0===B.minor?"ChibiPaint v0.0":"ChickenPaint v"+B.major+"."+B.minor;B=[(P=T.length,(O=Ae("HEAD",ze.FIXED_HEADER_LENGTH)).writeU32BE(L),
O.writeU32BE(x.width),O.writeU32BE(x.height),O.writeU32BE(P),O.getAsDataArray())];for(let ha of T)B.push(function(Z){var va,ia=(new TextEncoder).encode(Z.name),sa=Z instanceof Fa,M=4*(sa?5:6),z=ia.length;let K=Ae(sa?"LAYR":"GRUP",M+z+((sa?Z.image.data.length:0)+(Z.mask?Z.mask.data.length:0))),ca=0,na;Z.visible&&(ca|=1);sa&&Z.clip&&(ca|=2);Z.mask&&(ca|=4);Z.maskLinked&&(ca|=8);Z.maskVisible&&(ca|=16);Z.lockAlpha&&(ca|=64);!sa&&Z.expanded&&(ca|=32);Z.blendMode===Q.LM_MULTIPLY2?(na=Q.LM_MULTIPLY,ca|=
128):na=Z.blendMode;K.writeU32BE(M+z);K.writeU32BE(na);K.writeU32BE(Z.alpha);K.writeU32BE(ca);K.writeU32BE(ia.length);sa||K.writeU32BE(Z.layers.length);K.data.set(ia,K.pos);K.pos+=ia.length;if(sa){ia=K.pos;sa=K.data;M=Z.image.data;for(z=0;z<M.length;z+=I.BYTES_PER_PIXEL)sa[ia++]=M[z+I.ALPHA_BYTE_OFFSET],sa[ia++]=M[z+I.RED_BYTE_OFFSET],sa[ia++]=M[z+I.GREEN_BYTE_OFFSET],sa[ia++]=M[z+I.BLUE_BYTE_OFFSET];K.pos=ia}return Z.mask&&(va=Z.mask,K.data.set(va.data,K.pos),K.pos+=va.data.length),K.getAsDataArray()}(ha)),
await Be();B.push(Ae("ZEND",0).getAsDataArray());P=new Uint8Array(B.reduce((ha,Z)=>ha+Z.length,0));O=0;for(V of B)P.set(V,O),O+=V.length;var V={level:w?1:6};B=(ha,Z)=>{if(ha)return void H(ha);ha=new Uint8Array(8);for(var va=0;va<8;va++)ha[va]="CHIBIOEK".charCodeAt(va);"u">typeof Blob?G({bytes:new Blob([ha,Z],{type:"application/octet-stream"}),version:ja}):(va=new Uint8Array(ha.length+Z.length),va.set(ha,0),va.set(Z,ha.length),G({bytes:va,version:ja}))};"function"!=typeof B&&$b(7);qf(P,V,[Ng,Og,function(){return[kf]}],
function(ha){return Pd(kf(ha.data[0],ha.data[1]))},4,B)})})(a.artwork,{savedb:v}).then(function(x){if(e)return void g.emitEvent("savingFailure");if(q=a.swatches?new Blob([(new hd).write(a.swatches)],{type:"application/octet-stream"}):null,a.url){var F=new FormData;F.append("beginMarker","This marker ensures the upload wasn't truncated");F.append("painter","ChickenPaint v2.0");F.append("picture",C);C=null;x?(F.append("chibifileFormat",x.version),F.append("chibifile",x.bytes),F.append("rotation",""+
a.rotation)):F.append("rotation","0");q&&(F.append("swatches",q),q=null);F.append("endMarker","This marker ensures the upload wasn't truncated");b(F)}else F="oekaki_"+(new Date).toISOString().split(".")[0].replace(/[^0-9]/g,"_"),u||v||Je(),t?p(F,C,x,q):v?(Lg(x.bytes,q),A&&alert(U("Saved to your browser's storage."))):Ja(Ud).saveAs(C,F+".png")}).catch(function(x){g.emitEvent("savingFailure")})};this.cancel=function(){e=!0}}function Pg(a,c,d){function b(){var H=l.width/2,P=l.height/2;if(f.fillStyle=
"white",f.fillRect(0,0,l.width,l.height),x==C.length){var B=t.width,O=t.height,T=Math.round(H-B/2),L=Math.round(P-O/2);f.drawImage(t,T,L);var ja=F;p||((p=document.createElement("canvas")).width=B,p.height=O,e=p.getContext("2d"));e.globalCompositeOperation="copy";e.drawImage(m,0,0);g||((g=document.createElement("canvas")).width=B,g.height=O,k=g.getContext("2d"));k.globalCompositeOperation="copy";k.drawImage(A,0,0);k.globalCompositeOperation="source-in";k.drawImage(A,0,Math.round(170*ja));e.globalCompositeOperation=
"source-over";e.drawImage(g,0,0);e.drawImage(n,0,0);e.globalCompositeOperation="screen";e.drawImage(v,0,0);e.globalCompositeOperation="multiply";e.drawImage(u,0,0);f.globalAlpha=.88;f.drawImage(p,T,L);f.globalAlpha=1;f.drawImage(q,T,L);P=Math.round(P+O/2+2)}if(""!=w)for(f.fillStyle="black",ja=w.split("\n"),B=0;B<ja.length;B++)O=ja[B],T=f.measureText(O).width,P+=28,f.fillText(O,H-T/2,P)}function h(){l.width=l.clientWidth;l.height=l.clientHeight;f.font="14pt sans-serif";b()}var p,g,e,k,l=document.createElement("canvas"),
f=l.getContext("2d"),m=new Image,n=new Image,q=new Image,t=new Image,u=new Image,v=new Image,A=new Image,C=[m,n,q,t,u,v,A],x=0,F=0,w="";d+="splash/";for(var G=0;G<C.length;G++)C[G].onload=function(){++x==C.length&&b()};m.src=d+"cup.png";v.src=d+"highlights.png";n.src=d+"lid.png";q.src=d+"lines.png";u.src=d+"shading.png";A.src=d+"smoothie.png";t.src=d+"text.png";c.on("loadingProgress",function(H,P){F=H;w=P;b()});c.on("loadingFailure",function(H){F=0;w=H;b()});c.on("loadingComplete",function(){window.removeEventListener("resize",
h);a.removeChild(l)});window.addEventListener("resize",h);l.className="chickenpaint-splash-screen";a.appendChild(l);h()}function If(a){for(var c={DELETE:46,BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27," ":32,ARROWLEFT:37,ARROWUP:38,ARROWRIGHT:39,ARROWDOWN:40,SHIFT:16,"[":219,"]":221,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,0:48,"-":189,"=":187,"+":187,";":187,META:91,LEFTMETA:91,RIGHTMETA:91,ALT:18,ALTGRAPH:18,OPTION:18,CONTROL:17},d=65;d<=90;d++)c[String.fromCharCode(d)]=d;if((a=a.toUpperCase())in c)return c[a]}
function Jf(){let a,c,d,b,h,p,g,e;this.x0=this.y0=this.x1=this.y1=this.x2=this.y2=this.x3=this.y3=0;let k=l=>{let f=3*l,m=f*l;l*=l*l;let n=2*m,q=6*l,t=this.x0-2*this.x1+this.x2,u=this.y0-2*this.y1+this.y2,v=3*(this.x1-this.x2)-this.x0+this.x3,A=3*(this.y1-this.y2)-this.y0+this.y3;a=this.x0;h=this.y0;c=(this.x1-this.x0)*f+t*m+v*l;p=(this.y1-this.y0)*f+u*m+A*l;d=t*n+v*q;g=u*n+A*q;b=v*q;e=A*q};this.compute=(l,f,m)=>{k(1/m);l[0]=a;f[0]=h;for(let n=1;n<m;n++)a+=c,h+=p,c+=d,p+=g,d+=b,g+=e,l[n]=a,f[n]=h}}
function Kf(a,c,d,b){var h,p=0;return"boolean"!=typeof c&&(b=d,d=c,c=void 0),function(){function g(){p=+new Date;d.apply(e,l)}var e=this,k=new Date-p,l=arguments;b&&!h&&g();h&&clearTimeout(h);void 0===b&&k>a?g():!0!==c&&(h=setTimeout(b?function(){h=void 0}:g,void 0===b?a-k:a))}}function Zc(a){this.points=a||[]}function xb(a,c){this.x=a;this.y=c}function Lf(a){for(var c=document.createElement("canvas"),d=c.getContext("2d"),b=d.createImageData(64,64),h=b.data,p=0,g=0;g<64;g++)for(var e=0;e<64;e++)(8&
e)!=0!=((8&g)!=0)?(h[p++]=255,h[p++]=255,h[p++]=255):(h[p++]=204,h[p++]=204,h[p++]=204),h[p++]=255;return c.width=64,c.height=64,d.putImageData(b,0,0),a.createPattern(c,"repeat")}function Vd(a,c){c+="Style";a.globalCompositeOperation="exclusion";"exclusion"==a.globalCompositeOperation?a[c]="white":(a.globalCompositeOperation="difference",a[c]="#888","difference"!=a.globalCompositeOperation&&(a[c]="black"))}function Dd(a){function c(){var u=a?d.clientHeight:d.clientWidth;m=k/(g-p)*u;u=(e-p)/(g-p)*
(u-m);h.style[a?"height":"width"]=m+"px";b.style[a?"height":"width"]=m+"px";b.style[a?"top":"left"]=u+"px"}let d=document.createElement("div"),b=document.createElement("div"),h=document.createElement("div"),p=0,g=1,e=0,k=1,l=10,f=!1,m=1,n=!1,q,t=this;this.setValues=function(u,v,A,C){e=u;k=v;p=A;g=C;c()};this.setBlockIncrement=function(u){l=u};this.setUnitIncrement=function(u){};this.getElement=function(){return d};this.getValueIsAdjusting=function(){return f};d.className="chickenpaint-scrollbar "+
(a?"chickenpaint-scrollbar-vertical":"chickenpaint-scrollbar-horizontal");b.className="chickenpaint-scrollbar-handle";b.setAttribute("touch-action","none");h.className="chickenpaint-scrollbar-handle-inner";b.appendChild(h);d.appendChild(b);b.addEventListener("pointerdown",function(u){u.stopPropagation();q=a?u.pageY-d.offsetTop-window.scrollY:u.pageX-d.offsetLeft-window.scrollX;b.setPointerCapture(u.pointerId);b.classList.add("dragging");n=!0});b.addEventListener("pointermove",function(u){n&&(f=!0,
u=a?u.pageY-d.offsetTop-window.scrollY:u.pageX-d.offsetLeft-window.scrollX,e+=(u-q)*(g-p)/((a?d.clientHeight:d.clientWidth)-m),e=Math.min(Math.max(e,p),g),q=u,t.emitEvent("valueChanged",[e]),c(),f=!1)});b.addEventListener("pointerup",function(u){if(u.stopPropagation(),n){try{b.releasePointerCapture(u.pointerId)}catch(v){}b.classList.remove("dragging");n=!1}});b.addEventListener("click",function(u){u.stopPropagation()});d.addEventListener("click",function(u){this==d&&((a?u.pageY-d.offsetTop-window.scrollY:
u.pageX-d.offsetLeft-window.scrollX)<parseInt(b.style[a?"top":"left"],10)?e-=l:e+=l,t.emitEvent("valueChanged",[e]),c())})}function Wb(){this.modes=[]}function Wd(a){function c(){}function d(){}function b(){this.shouldPaintBrushPreview=!1;this.oldPreviewRect=null}function h(){b.call(this);this.smoothMouse={x:0,y:0}}function p(){var E,S;this.mouseDown=function(ka,ya,Ga){if(!this.capture&&0==ya&&!ka.altKey&&!Ja(Va).isPressed("space")&&A())return this.capture=!0,E=S={x:mb+.5,y:nb+.5},this.eraseBrushPreview(),
!0};this.mouseDrag=function(ka){if(this.capture){var ya=new Ca(Math.min(E.x,S.x)-1-1,Math.min(E.y,S.y)-1-1,Math.max(E.x,S.x)+1+1+1,Math.max(E.y,S.y)+1+1+1);if(S={x:mb+.5,y:nb+.5},ka.shiftKey){var Ga=Math.PI/4;ka=Math.round(Math.atan2(S.y-E.y,S.x-E.x)/Ga);switch(ka){case 0:case 4:S.y=E.y;break;case 2:case 6:S.x=E.x;break;default:ka*=Ga,Ga=Math.sqrt((S.y-E.y)*(S.y-E.y)+(S.x-E.x)*(S.x-E.x)),S.x=E.x+Ga*Math.cos(ka),S.y=E.y+Ga*Math.sin(ka)}}return ya.union(new Ca(Math.min(E.x,S.x)-1-1,Math.min(E.y,S.y)-
1-1,Math.max(E.x,S.x)+1+1+1,Math.max(E.y,S.y)+1+1+1)),ca(ya),!0}this.mouseMove.call(this,ka)};this.mouseUp=function(ka,ya,Ga){if(this.capture&&0==ya)return ka=F(E),ya=F(S),this.capture=!1,this.drawLine(ka,ya),ca(new Ca(Math.min(E.x,S.x)-1-1,Math.min(E.y,S.y)-1-1,Math.max(E.x,S.x)+1+1+1,Math.max(E.y,S.y)+1+1+1)),!0};this.paint=function(){this.capture?(za.lineWidth=1,za.beginPath(),za.moveTo(E.x,E.y),za.lineTo(S.x,S.y),za.stroke()):b.prototype.paint.call(this)};b.call(this)}function g(){let E=0,S,ka,
ya,Ga;this.mouseDown=function(ta,Na,eb){if(!this.capture&&0==Na&&!ta.altKey&&!Ja(Va).isPressed("space")&&A())return ta=F({x:mb,y:nb}),E=0,S=ka=ya=Ga=ta,this.capture=!0,this.eraseBrushPreview(),!0};this.mouseDrag=function(ta){if(this.capture&&0===E)return ya=Ga=F({x:mb,y:nb}),ba.repaintAll(),!0;this.mouseMove.call(this,ta)};this.mouseUp=function(ta,Na,eb){if(this.capture&&0==Na){switch(E){case 0:E=1;break;case 1:E=2;break;case 2:this.capture=!1;Na=S;eb=ka;let Hb=ya,lc=Ga;ta=new Jf;ta.x0=Na.x;ta.y0=
Na.y;ta.x1=eb.x;ta.y1=eb.y;ta.x2=Hb.x;ta.y2=Hb.y;ta.x3=lc.x;ta.y3=lc.y;Na=Array(500);eb=Array(500);ta.compute(Na,eb,500);Ia.beginStroke(Na[0],eb[0],1);for(ta=1;ta<500;ta++)Ia.continueStroke(Na[ta],eb[ta],1);Ia.endStroke();ba.repaintAll()}return!0}};this.mouseMove=function(ta,Na){if(this.capture)return ta=F({x:mb,y:nb}),1==E?ka=ta:2==E&&(ya=ta),ba.repaintAll(),!0;b.prototype.mouseMove.call(this,ta,Na)};this.paint=function(){if(this.capture){var ta=new Jf;let Na=H(S),eb=H(ka),Hb=H(ya),lc=H(Ga);ta.x0=
Na.x;ta.y0=Na.y;ta.x1=eb.x;ta.y1=eb.y;ta.x2=Hb.x;ta.y2=Hb.y;ta.x3=lc.x;ta.y3=lc.y;let Fc=Array(100),jc=Array(100);ta.compute(Fc,jc,100);za.beginPath();za.moveTo(Fc[0],jc[0]);for(ta=1;ta<100;ta++)za.lineTo(Fc[ta],jc[ta]);za.moveTo(~~Na.x,~~Na.y);za.lineTo(~~eb.x,~~eb.y);za.moveTo(~~Hb.x,~~Hb.y);za.lineTo(~~lc.x,~~lc.y);za.stroke()}else b.prototype.paint.call(this)};b.call(this)}function e(){var E;this.mouseDown=function(S,ka,ya){return!!this.capture||(Ja(Va).isPressed("space")||(0!=ka||this.transient&&
!S.altKey)&&2!=ka?void(this.transient&&aa.pop()):(E=ka,this.capture=!0,u("crosshair"),this.mouseDrag(S),!0))};this.mouseDrag=function(S){if(this.capture)return S=F({x:mb,y:nb}),Ia.isPointWithin(S.x,S.y)&&a.setCurColor(new jb(Ia.colorPicker(S.x,S.y))),!0};this.mouseUp=function(S,ka,ya){if(this.capture&&ka==E)return E=-1,this.capture=!1,u("default"),this.transient&&aa.pop(),!0};this.enter=function(){c.prototype.enter.call(this);E=-1}}function k(){var E,S,ka,ya;this.keyDown=function(Ga){if(!Ga.ctrlKey&&
!Ga.metaKey&&" "===Ga.key)return this.capture||u("grab"),!0};this.keyUp=function(Ga){if(this.transient&&1!=ya&&" "===Ga.key)return u("default"),aa.pop(),!0};this.mouseDown=function(Ga,ta,Na){return!!this.capture||(1==ta||Ja(Va).isPressed("space")&&!Ga.ctrlKey&&!Ga.metaKey&&0==ta||!this.transient&&0==ta?(this.capture=!0,ya=ta,E=Ga.pageX,S=Ga.pageY,ka=ba.getOffset(),u("grab"),!0):void(this.transient&&aa.pop()))};this.mouseDrag=function(Ga){if(this.capture)return ba.setOffset(ka.x+Ga.pageX-E,ka.y+Ga.pageY-
S),!0};this.mouseUp=function(Ga,ta,Na){if(this.capture&&ta==ya)return ya=-1,this.capture=!1,aa.peek()!==this||(this.transient&&!Ja(Va).isPressed("space")?(u("default"),aa.pop()):u("grab"),!0)};this.enter=function(){u("grab")}}function l(){}function f(){var E,S=new Ca(0,0,0,0),ka=-1;let ya=!1;this.mouseDown=function(Ga,ta,Na){Na=a.mainGUI.getPaletteManager().palettes.brush.getElement().querySelector("#chickenpaint-s-maintainAspectCheckbox");if(Na&&Na instanceof HTMLInputElement&&(ya=Na.checked),!this.capture&&
0==ta&&!Ga.altKey&&!Ja(Va).isPressed("space"))return Ga=w({x:mb,y:nb}),ka=ta,S.makeEmpty(),E=Ga,ba.repaintAll(),this.capture=!0,!0};this.mouseDrag=function(Ga){if(!this.capture)return!1;let ta=w({x:mb,y:nb});Ga=Ga.shiftKey||ya;let Na=~~Math.max(Math.abs(ta.x-E.x),Math.abs(ta.y-E.y));return ta.x>=E.x?(S.left=E.x,S.right=(Ga?E.x+Na:ta.x)+1):(S.left=Ga?E.x-Na:ta.x,S.right=E.x+1),ta.y>=E.y?(S.top=E.y,S.bottom=(Ga?E.y+Na:ta.y)+1):(S.top=Ga?E.y-Na:ta.y,S.bottom=E.y+1),ba.repaintAll(),!0};this.mouseUp=function(Ga,
ta,Na){if(this.capture&&ta==ka)return Ia.rectangleSelection(S),S.makeEmpty(),ba.repaintAll(),this.capture=!1,ka=-1,!0};this.paint=function(){S.isEmpty()||(za.lineWidth=1,O(za,B(S)))}}function m(){var E,S,ka=!1;this.mouseDown=function(ya,Ga,ta){if(!this.capture&&0==Ga&&!Ja(Va).isPressed("space")&&v())return E=F({x:mb,y:nb}),S=ya.altKey,ka=!0,this.capture=!0,!0};this.mouseDrag=Kf(25,function(ya){if(this.capture){ya=F({x:mb,y:nb});var Ga=ya.x-E.x,ta=ya.y-E.y,Na=~~Ga,eb=~~ta;return(0!=Na||0!=eb)&&(Ia.move(Na,
eb,S&&ka),ka=!1),E.x=ya.x-(Ga-Na),E.y=ya.y-(ta-eb),!0}});this.mouseUp=function(ya,Ga,ta){if(this.capture&&0==Ga)return this.capture=!1,this.transient&&aa.pop(),!0}}function n(){function E(Aa,Ka){return{x:(Aa.x+Ka.x)/2,y:(Aa.y+Ka.y)/2}}function S(Aa){return{x:Math.round(Aa.x),y:Math.round(Aa.y)}}function ka(Aa,Ka){for(var Qa=0;Qa<Aa.points.length;Qa++)if((Ka.x-Aa.points[Qa].x)*(Ka.x-Aa.points[Qa].x)+(Ka.y-Aa.points[Qa].y)*(Ka.y-Aa.points[Qa].y)<=49)return 2*Qa;for(Qa=0;Qa<Aa.points.length;Qa++){var fb=
Aa.points[Qa],ib=Aa.points[(Qa+1)%Aa.points.length];ib=new xb(ib.x-fb.x,ib.y-fb.y);fb=new xb(Ka.x-fb.x,Ka.y-fb.y);var qc=ib.getLength(),Mc=ib.getScaled(1/qc);qc=fb.getScaled(1/qc);Mc=Mc.getDotProduct(qc);if(Mc>=0&&Mc<=1&&(ib.scale(Mc),(ib.x-fb.x)*(ib.x-fb.x)+(ib.y-fb.y)*(ib.y-fb.y)<=49))return 2*Qa+1}return Aa.containsPoint(Ka)?-3:-2}function ya(){var Aa=eb.getTransformed(wb),Ka=ka(Aa,{x:mb,y:nb});switch(Ka){case 0:case 2:case 4:case 6:Ka=~~(Ka/2);let Qa=Aa.points[Ka],fb=Aa.points[(Ka+1)%4];Ga(xb.subtractPoints(Aa.points[(Ka+
3)%4],Qa).normalize().add(xb.subtractPoints(fb,Qa).normalize()));break;case 1:case 3:case 5:case 7:Ga(xb.subtractPoints(Aa.points[(~~(Ka/2)+1)%4],Aa.points[~~(Ka/2)]).getPerpendicular());break;case -3:Ja(Va).isPressed("r")||Ja(Va).isPressed("space")||u("move");break;case -2:Ja(Va).isPressed("r")||Ja(Va).isPressed("space")||u("grab");break;default:u("default")}}function Ga(Aa){Aa=Math.floor(Math.atan2(-Aa.y,Aa.x)/(Math.PI/4)+.5);switch(Aa<0&&(Aa+=4),Aa){default:Aa="ew-resize";break;case 1:Aa="nesw-resize";
break;case 2:Aa="ns-resize";break;case 3:Aa="nwse-resize"}u(Aa)}var ta,Na,eb,Hb,lc,Fc,jc=-1;let Xd=!1;this.mouseDown=function(Aa,Ka,Qa){Qa=a.mainGUI.getPaletteManager().palettes.brush.getElement().querySelector("#chickenpaint-t-maintainAspectCheckbox");if(Qa&&Qa instanceof HTMLInputElement&&(Xd=Qa.checked),!this.capture&&0==Ka&&!Aa.altKey&&!Ja(Va).isPressed("space"))return jc=ka(eb.getTransformed(wb),{x:mb,y:nb}),lc=F(Hb={x:mb,y:nb}),this.capture=!0,ya(),!0};this.mouseDrag=Kf(40,function(Aa){if(this.capture){var Ka=
{x:mb,y:nb};switch(jc){case -3:Aa=S(F(Ka));var Qa=xb.subtractPoints(Aa,lc);Ka=Qa.getTruncated();Qa=Qa.subtract(Ka);var fb=new qb;fb.translate(Ka.x,Ka.y);ta.preMultiply(fb);lc=xb.subtractPoints(Aa,Qa);break;case -2:fb=Math.PI/4;Qa=eb.getCenter();var ib=H(Qa),qc=Math.atan2(Ka.y-ib.y,Ka.x-ib.x)-Math.atan2(Hb.y-ib.y,Hb.x-ib.x);ib=new qb;Fc+=qc;Aa=Aa.shiftKey?-ta.decompose().rotate+Math.round(Fc/fb)*fb:qc;mc&&(Aa=-Aa);ib.rotateAroundPoint(Aa,Qa.x,Qa.y);ta.preMultiply(ib);Hb=Ka;break;case 0:case 2:case 4:case 6:fb=
~~(jc/2);Qa=Na.points[fb];ib=ta.getInverted().getTransformedPoint(S(F(Ka)));Ka=Na.points[(fb+2)%4];fb=(ib.x-Ka.x)/(Qa.x-Ka.x);Qa=(ib.y-Ka.y)/(Qa.y-Ka.y);if(.001>Math.abs(fb)||.001>Math.abs(Qa)||isNaN(fb)||isNaN(Qa))return!0;if(Xd||Aa.shiftKey)Qa=fb=Aa=Math.max(fb,Qa);ta.scaleAroundPoint(fb,Qa,Ka.x,Ka.y);break;case 1:case 5:case 3:case 7:Aa=~~(jc/2);ib=E(Na.points[Aa],Na.points[(Aa+1)%4]);Ka=ta.getInverted().getTransformedPoint(S(F(Ka)));Aa=E(Na.points[(Aa+2)%4],Na.points[(Aa+3)%4]);ib=xb.subtractPoints(ib,
Aa);Ka=xb.subtractPoints(Ka,Aa);qc=ib.getLength();Ka=ib.getDotProduct(Ka)/qc/qc;if(.001>Math.abs(Ka)||isNaN(Ka))return!0;1==jc||5==jc?(Qa=1,fb=Ka):(Qa=Ka,fb=1);ta.scaleAroundPoint(Qa,fb,Aa.x,Aa.y)}return eb=Na.getTransformed(ta),Ia.transformAffineAmend(ta),ba.repaintAll(),!0}});this.mouseUp=function(Aa,Ka,Qa){if(this.capture&&0==Ka)return this.capture=!1,jc=-1,!0};this.mouseMove=function(){this.capture||ya()};this.paint=function(){var Aa=eb.getTransformed(wb).points,Ka=Array(2*Aa.length);for(var Qa=
0;Qa<Aa.length;Qa++)Ka[Qa]=Aa[Qa];for(let ib=0;ib<Aa.length;ib++){Qa=Aa[ib];var fb=Aa[(ib+1)%Aa.length];Ka[ib+Aa.length]={x:(Qa.x+fb.x)/2,y:(Qa.y+fb.y)/2}}Vd(za,"fill");for(Qa=0;Qa<Ka.length;Qa++)za.fillRect(Ka[Qa].x-3,Ka[Qa].y-3,7,7);O(za,Aa)};this.keyDown=function(Aa){if("Enter"===Aa.key){if(!Xb&&!Ub)return a.actionPerformed({action:"CPTransformAccept"}),!0}else if("Escape"===Aa.key)return a.actionPerformed({action:"CPTransformReject"}),!0};this.enter=function(){c.prototype.enter.call(this);var Aa,
Ka=Ia.transformAffineBegin();ta=Ka.transform;Ka.rect;(Aa=Ka.selection).isEmpty()&&(Aa=Ka.rect.clone());eb=(Na=new Zc(Aa.toPoints())).getTransformed(ta);jc=-1;Fc=0;ba.repaintAll()};this.leave=function(){c.prototype.leave.call(this);ba.repaintAll()};this.moveByKey=function(Aa,Ka){var Qa;if(ta){var fb=new qb;fb.translate(Aa,Ka);ta.preMultiply(fb);eb=Na.getTransformed(ta);Ia.transformAffineAmend(ta);null==(Qa=this.repaintAll)||Qa.call(this)}}}function q(){var E,S,ka=0,ya=!1,Ga=-1;this.mouseDown=function(ta,
Na,eb){return!!this.capture||(!this.transient&&0==Na&&!ta.altKey&&!Ja(Va).isPressed("space")||0==Na&&!ta.altKey&&!Ja(Va).isPressed("space")&&Ja(Va).isPressed("r")?(E={x:mb,y:nb},ka=ba.getRotation(),S=wb.clone(),mc&&Z(S),ya=!1,this.capture=!0,Ga=Na,u("grab"),!0):void(this.transient&&aa.pop()))};this.mouseDrag=function(ta){if(this.capture){var Na=pa.clientWidth/2,eb=pa.clientHeight/2;ta=pa.width/2;var Hb=pa.height/2;Na=Math.atan2(nb-eb,mb-Na)-Math.atan2(E.y-eb,E.x-Na);eb=new qb;return eb.rotateAroundPoint(Na,
ta,Hb),eb.multiply(S),ba.setRotation(ka+Na),ba.setOffset(~~eb.getTranslateX(),~~eb.getTranslateY()),ya=!0,!0}};this.enter=function(){u("grab")};this.mouseUp=function(ta,Na,eb){if(this.capture&&Na==Ga){if(ya){ta=Math.round(lb/(Math.PI/2))*Math.PI/2;if(Math.abs(lb-ta)<5/180*Math.PI){eb=ta-ka;ta=pa.width/2;Na=pa.height/2;let Hb=new qb;Hb.rotateAroundPoint(eb,ta,Na);Hb.multiply(S);ba.setRotation(ka+eb);ba.setOffset(~~Hb.getTranslateX(),~~Hb.getTranslateY());ba.repaintAll()}ba.emitEvent("canvasRotated90",
[ba.getRotation90()])}else ba.resetRotation();return this.capture=!1,this.transient&&!Ja(Va).isPressed("r")?(u("default"),aa.pop()):u("grab"),!0}};this.keyUp=function(ta){if(this.transient&&1!=Ga&&"r"===ta.key.toLowerCase())return u("default"),aa.pop(),!0};this.keyDown=function(ta){if("r"===ta.key.toLowerCase())return!0}}function t(){p.call(this)}function u(E){pa.getAttribute("data-cursor")!=E&&pa.setAttribute("data-cursor",E)}function v(){var E=Ia.getActiveLayer();return E.visible&&E.ancestorsAreVisible()?
0!=E.alpha||(a.showLayerNotification(E,U("Whoops! This layer's opacity is currently 0%"),"opacity"),!1):(a.showLayerNotification(E,U("Whoops! This layer is currently hidden"),"layer"),!1)}function A(){var E=Ia.getActiveLayer();return E instanceof $a&&!Ia.isEditingMask()?(a.showLayerNotification(E,U("Whoops! You can't draw on a group"),"layer"),!1):v()}function C(E,S,ka,ya,Ga){E.setValues(-Ga,ya,S-ya-Ga+ka/4,S+ka-Ga-ka/4);E.setBlockIncrement(Math.max(1,~~(.66*ya)));E.setUnitIncrement(Math.max(1,~~(.05*
ya)))}function x({resetViewFlip:E=!1}={}){(wb.setToIdentity(),wb.translate(hb,Gb),wb.scale(ob,ob),wb.rotate(lb),mc&&!E&&Z(wb),null==Ma||null==ab||Ma.getValueIsAdjusting()||ab.getValueIsAdjusting())||(E=T(new Ca(0,0,rb.width,rb.height)),C(Ma,E.left,E.getWidth(),pa.clientWidth,ba.getOffset().x),C(ab,E.top,E.getHeight(),pa.clientHeight,ba.getOffset().y));ba.repaintAll()}function F(E){return wb.getInverted().getTransformedPoint(E)}function w(E){E=F(E);return E.x=Math.floor(E.x),E.y=Math.floor(E.y),E}
function G(E){var S=pa.getBoundingClientRect();return{x:E.x-S.left-window.pageXOffset,y:E.y-S.top-window.pageYOffset}}function H(E){return wb.getTransformedPoint(E)}function P(E){E=H(E);return E.x=Math.round(E.x),E.y=Math.round(E.y),E}function B(E){var S=H({x:(E.left+E.right)/2,y:(E.top+E.bottom)/2});E=E.toPoints();for(var ka=0;ka<E.length;ka++)E[ka]=P(E[ka]),E[ka].x+=.5*Math.sign(S.x-E[ka].x),E[ka].y+=.5*Math.sign(S.y-E[ka].y);return E}function O(E,S){E.beginPath();E.moveTo(S[0].x,S[0].y);for(var ka=
1;ka<S.length;ka++)E.lineTo(S[ka].x,S[ka].y);E.lineTo(S[0].x,S[0].y);E.stroke()}function T(E){var S=P({x:E.left-1,y:E.top-1}),ka=P({x:E.left-1,y:E.bottom}),ya=P({x:E.right,y:E.top-1});E=P({x:E.right,y:E.bottom});S=new Ca(Math.min(Math.min(S.x,ka.x),Math.min(ya.x,E.x)),Math.min(Math.min(S.y,ka.y),Math.min(ya.y,E.y)),Math.max(Math.max(S.x,ka.x),Math.max(ya.x,E.x))+1,Math.max(Math.max(S.y,ka.y),Math.max(ya.y,E.y))+1);return S.grow(2,2),S}function L(){var E=pa.width,S=pa.height,ka=H({x:Ia.width/2,y:Ia.height/
2});ba.setOffset(Math.round(hb+E/2-ka.x),Math.round(Gb+S/2-ka.y))}function ja(E,S,ka){if(E=Math.max(.1,Math.min(8,E)),ba.getZoom()!=E){var ya=ba.getOffset();ba.setOffset(ya.x+~~((S-ya.x)*(1-E/ba.getZoom())),ya.y+~~((ka-ya.y)*(1-E/ba.getZoom())));ba.setZoom(E);ba.repaintAll()}}function V(E,S=!0){let ka=pa.clientWidth,ya=pa.clientHeight;S&&(S=parseFloat(E),.01>Math.abs(S-1)?E=1:.2>Math.abs(S-2)?E=2:.08>Math.abs(S-.5)&&(E=.5));ja(E,ka/2,ya/2)}function ha(E){return"mouse"===E.pointerType&&0!==E.buttons&&
0===E.pressure?1:"touch"===E.pointerType?(0!==E.pressure&&(Wc=!0),Wc)?2*E.pressure:1:2*E.pressure}function Z(E){let S=Ia.width/2;E.translate(S,0);E.scale(-1,1);E.translate(-S,0)}function va(E){let S=E[0].pageX-E[1].pageX;E=E[0].pageY-E[1].pageY;return Math.sqrt(S*S+E*E)}function ia(E){Nc=E.touches.length;oc&&2===Nc&&(jd=va(E.touches),Yd=ba.getZoom(),E.preventDefault())}function sa(E){Nc=E.touches.length}function M(E){if(Nc=E.touches.length,oc&&2===Nc){let S=va(E.touches)/jd,ka=G({x:(E.touches[0].pageX+
E.touches[1].pageX)/2,y:(E.touches[0].pageY+E.touches[1].pageY)/2});ja(Yd*S,ka.x,ka.y)}E.preventDefault()}function z(E){if(!(X||=pa.getBoundingClientRect(),Tb&&!Ic&&"touch"===E.pointerType||Nc>1&&"touch"===E.pointerType||Ja(Va).isPressed("z")||E.ctrlKey&&Ja(Va).isPressed("space"))){mb=E.clientX-X.left;nb=E.clientY-X.top;var S=Mb?ha(E):0;(1&E.buttons)!=0!=kb[0]&&(kb[0]=!kb[0],kb[0]?aa.mouseDown(E,0,S):aa.mouseUp(E,0,S));(2&E.buttons)!=0!=kb[2]&&(kb[2]=!kb[2],kb[2]?aa.mouseDown(E,2,S):aa.mouseUp(E,
2,S));(4&E.buttons)!=0!=kb[1]&&(kb[1]=!kb[1],kb[1]?aa.mouseDown(E,1,S):aa.mouseUp(E,1,S));Mb?aa.mouseDrag(E,S):aa.mouseMove(E,S);Tb||"pen"!==E.pointerType||(Tb=!0)}}function K(){ac||(ac=!0,window.requestAnimationFrame(function(){ba.paint()}))}function ca(E){qa.union(E);K()}function na(){fc=Ia.getBounds();ba.repaintAll()}let X,ba=this,ea=document.createElement("div"),ma=document.createElement("div"),Ha=document.createElement("div"),pa=document.createElement("canvas"),za=pa.getContext("2d"),rb=document.createElement("canvas"),
bb=rb.getContext("2d"),Pb=Lf(za),Ia=a.getArtwork(),ob=1,hb=0,Gb=0,lb=0,wb=new qb,uc=!1,Lb=!1,yb=32,mb=0,nb=0,xc=!1,kb=[!1,!1,!1],Tb=!1,oc=!1,Ic=!1,Wc=!1,fc=Ia.getBounds(),qa=new Ca(0,0,0,0),ac=!1,hc,Zb,yc,La,Qb,vc,D,N,W,Y,da=[],aa=new Wb,wa,Ma=new Dd(!1),ab=new Dd(!0),Xb=null,Ub=null,Ob=0,Kb=255,vb=!0,Vb=!0,Jc=0,Mb=!1;Math.sign=Math.sign||function(E){return 0==(E*=1)||isNaN(E)?E:E>0?1:-1};c.prototype.transient=!1;c.prototype.capture=!1;c.prototype.enter=function(){u("default")};c.prototype.leave=
function(){this.capture=!1};c.prototype.mouseMove=c.prototype.paint=c.prototype.mouseDown=c.prototype.mouseDrag=c.prototype.mouseUp=c.prototype.keyDown=c.prototype.suspend=c.prototype.resume=c.prototype.keyUp=function(){};d.prototype=Object.create(c.prototype);d.prototype.constructor=d;d.prototype.mouseDown=function(E,S,ka){var ya=Ja(Va).isPressed("space");ya||2!=S&&(0!=S||E.ctrlKey||E.metaKey||!E.altKey)?ya||0!=S||E.altKey||!Ja(Va).isPressed("r")?1!=S&&(E.altKey||E.ctrlKey||E.metaKey||Ja(Va).isPressed("z")||
!ya||0!=S)||(aa.push(La,!0),aa.peek().mouseDown(E,S,ka)):(aa.push(Qb,!0),aa.peek().mouseDown(E,S,ka)):(aa.push(yc,!0),aa.peek().mouseDown(E,S,ka))};let nc=null;d.prototype.keyDown=function(E){if(!E.altKey&&(!E.ctrlKey&&!E.metaKey&&Ja(Va).isPressed("z")||E.ctrlKey&&Ja(Va).isPressed("space")))return u("zoom-in"),aa.peek()===wa&&(nc=wa,aa.pop()),E.preventDefault(),!0;if("r"===E.key.toLowerCase()&&" "!==E.key)return aa.push(Qb,!0),aa.peek().keyDown(E),!0;if(" "===E.key&&(!E.ctrlKey&&!E.metaKey||"z"!==
E.key.toLowerCase()))return aa.push(La,!0),aa.peek().keyDown(E),E.preventDefault(),!0;if(aa.peek()===N||aa.peek()===W){if("Enter"===E.key){if(Xb||Ub)return;a.actionPerformed({action:"CPTransform"});E.preventDefault()}}else if((aa.peek()===La||aa.peek()===Qb)&&"Enter"===E.key){if(Xb||Ub)return;a.actionPerformed({action:"CPResetZoomAndRotation"});E.preventDefault()}return!1};d.prototype.keyUp=function(E){" "!==E.key&&"control"!==E.key.toLowerCase()&&"z"!==E.key.toLowerCase()||(u("default"),nc&&(aa.setUserMode(nc),
nc=null),E.preventDefault())};b.prototype=Object.create(c.prototype);b.prototype.constructor=b;b.prototype.getBrushPreviewOval=function(){let E=a.getBrushSize()*ob/2;return new Ca(mb-E,nb-E,mb+E,nb+E)};b.prototype.queueBrushPreview=function(){if(aa.peek()==this){this.shouldPaintBrushPreview=!0;var E=this.getBrushPreviewOval();E.grow(2,2);null!=this.oldPreviewRect&&(E.union(this.oldPreviewRect),this.oldPreviewRect=null);ca(E)}};b.prototype.eraseBrushPreview=function(){this.shouldPaintBrushPreview=
!1;null!=this.oldPreviewRect&&(ca(this.oldPreviewRect),this.oldPreviewRect=null)};b.prototype.mouseMove=function(E,S){this.queueBrushPreview()};b.prototype.enter=function(){c.prototype.enter.call(this);xc&&this.queueBrushPreview()};b.prototype.leave=function(){c.prototype.leave.call(this);this.eraseBrushPreview()};b.prototype.suspend=b.prototype.leave;b.prototype.resume=b.prototype.enter;b.prototype.paint=function(){if(this.shouldPaintBrushPreview){this.shouldPaintBrushPreview=!1;var E=this.getBrushPreviewOval();
za.beginPath();za.arc((E.left+E.right)/2,(E.top+E.bottom)/2,E.getWidth()/2,0,2*Math.PI);za.stroke();E.grow(2,2);null==this.oldPreviewRect?this.oldPreviewRect=E:this.oldPreviewRect.union(E)}};h.prototype=Object.create(b.prototype);h.prototype.constructor=h;h.prototype.mouseDown=function(E,S,ka){if(!this.capture&&0==S&&!E.altKey&&!Ja(Va).isPressed("space")&&A()&&(E=F({x:mb,y:nb}),this.eraseBrushPreview(),Ia.beginStroke(E.x,E.y,ka)))return this.capture=!0,this.smoothMouse=E,!0};h.prototype.mouseDrag=
function(E,S){if(("number"!=typeof navigator.maxTouchPoints||navigator.maxTouchPoints<3)&&b.prototype.mouseMove.call(this,E,S),this.capture){E=F({x:mb,y:nb});var ka=Math.min(.999,Math.pow(a.getBrushInfo().smoothing,.3));let ya=1-ka;return this.smoothMouse.x=ya*E.x+ka*this.smoothMouse.x,this.smoothMouse.y=ya*E.y+ka*this.smoothMouse.y,Ia.continueStroke(this.smoothMouse.x,this.smoothMouse.y,S),!0}this.mouseMove(E)};h.prototype.mouseUp=function(E,S,ka){if(this.capture)return 0==S&&(this.capture=!1,Ia.endStroke()),
!0};p.prototype=Object.create(b.prototype);p.prototype.constructor=p;p.prototype.drawLine=function(E,S){Ia.beginStroke(E.x,E.y,1);Ia.continueStroke(S.x,S.y,1);Ia.endStroke()};g.prototype=Object.create(b.prototype);g.prototype.constructor=g;e.prototype=Object.create(c.prototype);e.prototype.constructor=e;k.prototype=Object.create(c.prototype);k.prototype.constructor=k;this.setGrowFillArea=function(E=0){Ob=Number(E)};this.setFoodFillAlpha=function(E=255){Kb=Number(E)};this.setFloodFillReferAllLayers=
function(E){vb=!!E};l.prototype=Object.create(c.prototype);l.prototype.constructor=l;l.prototype.mouseDown=function(E,S,ka){if(0==S&&!E.altKey&&!Ja(Va).isPressed("space")&&A())return E=F({x:mb,y:nb}),Ia.isPointWithin(E.x,E.y)&&(Ia.floodFill(E.x,E.y,Ob,Kb,vb),ba.repaintAll()),!0};f.prototype=Object.create(c.prototype);f.prototype.constructor=f;m.prototype=Object.create(c.prototype);m.prototype.constructor=m;m.prototype.mouseMove=function(E){return aa.peek()!==this||(Ja(Va).isPressed("r")&&Ja(Va).isPressed("space")||
u("move"),!0)};m.prototype.enter=function(){Ja(Va).isPressed("r")&&Ja(Va).isPressed("space")||u("move")};n.prototype=Object.create(c.prototype);n.prototype.constructor=n;this.setModalShown=function(E){(Xb=!!E)||(Ub=!0,setTimeout(()=>Ub=!1,300))};document.addEventListener("keydown",function(E){let S=aa.peek(),ka=function(ta){if(!Xb){if(!ta)return null;switch(ta.toLowerCase()){case "arrowup":return{dx:0,dy:-1};case "arrowdown":return{dx:0,dy:1};case "arrowleft":return{dx:-1,dy:0};case "arrowright":return{dx:1,
dy:0};default:return null}}}(E.key);if(ka){var {dx:ya,dy:Ga}=ka;(mc&&(ya=-ya),S===Y)?(Y.moveByKey(ya,Ga),E.preventDefault()):S===W&&(Ia.move(ya,Ga,E.altKey),E.preventDefault())}});q.prototype=Object.create(c.prototype);q.prototype.constructor=q;t.prototype=Object.create(p.prototype);t.prototype.constructor=t;t.prototype.drawLine=function(E,S){Ia.gradientFill(Math.round(E.x),Math.round(E.y),Math.round(S.x),Math.round(S.y),a.getCurGradient())};t.prototype.queueBrushPreview=function(){};this.setZoom=
function(E){ob=E;x()};this.getZoom=function(){return ob};this.setGridSize=function(E){yb=Math.max(Math.round(E),1);this.repaintAll()};this.getGridSize=function(){return yb};this.setOffset=function(E,S){isNaN(E)||isNaN(S)?console.log("Bad offset"):(hb=E,Gb=S,x())};this.getOffset=function(){return{x:hb,y:Gb}};this.setInterpolation=function(E){uc=E;za&&(za.imageSmoothingEnabled=E);this.repaintAll()};this.setRotation=function(E){lb=E%(2*Math.PI);x()};this.setRotationOnCenter=function(E){let S=pa.width/
2,ka=pa.height/2;var ya=E-lb;let Ga=Math.cos(ya);ya=Math.sin(ya);let ta=hb-S,Na=Gb-ka;hb=S+ta*Ga-Na*ya;Gb=ka+ta*ya+Na*Ga;lb=E%(2*Math.PI);x()};this.getRotation=function(){return lb};this.getRotationDegrees=function(){return(180*this.getRotation()/Math.PI+180+360)%360-180};this.setRotationDegrees=function(E){this.setRotationOnCenter(E*Math.PI/180)};this.getRotation90=function(){var E=Math.round(this.getRotation()/Math.PI*2);return(E%=4)<0&&(E+=4),E};this.zoomIn=function(){V(1.41*this.getZoom())};this.zoomOut=
function(){V(.7092*this.getZoom())};this.zoom100=function(){V(1);L()};this.zoomOnCenter=(E,S=!1)=>{V(E,S)};this.resetRotation=function(){var E=pa.width/2,S=pa.height/2,ka=new qb;ka.rotateAroundPoint(-this.getRotation(),E,S);ka.multiply(wb);mc&&Z(ka);this.setOffset(~~ka.getTranslateX(),~~ka.getTranslateY());this.setRotation(0);ba.emitEvent("canvasRotated90",[0])};this.resetZoomAndRotation=function(){this.zoom100();this.resetRotation();mc=!1;x({resetViewFlip:!0})};this.isPanOrRotateMode=function(){return oc};
let wc=!1,mc=!1;this.toggleViewFlip=()=>(mc?(mc=!1,x({resetViewFlip:!0})):(Z(wb),mc=!0,ba.repaintAll()),mc);let Ed=!1,$c=0,Oc=0;pa.addEventListener("pointerdown",E=>{!E.altKey&&(!E.ctrlKey&&!E.metaKey&&Ja(Va).isPressed("z")||E.ctrlKey&&Ja(Va).isPressed("space"))&&"touch"!==E.pointerType&&(Ed=!0,$c=E.clientX);(E.ctrlKey||E.metaKey)&&E.altKey&&1===E.buttons&&(E.clientX,Oc=E.clientX)});pa.addEventListener("pointermove",E=>{if(!E.altKey&&(!E.ctrlKey&&!E.metaKey&&Ja(Va).isPressed("z")||E.ctrlKey&&Ja(Va).isPressed("space"))&&
Ed&&"touch"!==E.pointerType&&1===E.buttons){var S=E.clientX-$c;if(Math.abs(S)>10){var ka=G({x:E.pageX,y:E.pageY});ja(ba.getZoom()*(S>0?1.15:1/1.15),ka.x,ka.y);$c=E.clientX}E.preventDefault()}(E.ctrlKey||E.metaKey)&&E.altKey&&1===E.buttons&&(S=E.clientX-Oc,Oc=E.clientX,ka=a.getBrushSize(),a.setBrushSize(ka+(ka<=10?S*(.08+.17*Math.pow(Math.min(1,Math.max(0,(ka-1)/9)),1.5)):.5*S)),E.preventDefault())});pa.addEventListener("pointerup",E=>{"touch"!==E.pointerType&&(Ed=!1)});let jd=0,Yd=1,Nc=0,kd=0,ld=
0,ad=!1,bd=null;this.getElement=function(){return ea};this.repaintAll=function(){qa.left=0;qa.top=0;qa.right=pa.width;qa.bottom=pa.height;K()};this.paint=function(){var E=!1;if(ac=!1,qa.isEmpty()||(za.save(),za.clipTo&&(za.beginPath(),qa.left|=0,qa.top|=0,za.rect(qa.left,qa.top,Math.ceil(qa.getWidth()),Math.ceil(qa.getHeight())),za.clip()),E=!0),!fc.isEmpty()){var S=hc&&hc.isOpen()?hc.getImageData():Ia.fusionLayers().getImageData();bb.putImageData(S,0,0,fc.left,fc.top,fc.getWidth(),fc.getHeight());
fc.makeEmpty()}za.fillStyle="#606060";za.fillRect(0,0,pa.width,pa.height);za.save();za.setTransform(wb.m[0],wb.m[1],wb.m[2],wb.m[3],wb.m[4],wb.m[5]);za.fillStyle=Pb;za.fillRect(0,0,Ia.width,Ia.height);za.drawImage(rb,0,0,rb.width,rb.height);za.restore();Vd(za,"stroke");za.lineWidth=1;S=Ia.getSelection().isEmpty();if(Vb!==S&&a.mainGUI.getPaletteManager().updateDeselectIcon(),Vb=S,!(S||aa.peek()instanceof f&&aa.peek().capture)){if(![vc,La,Qb,Y,yc].includes(aa.peek())){S=B(Ia.getSelection());S[0].x;
S[1].x;S[2].x;S[3].x;S[0].y;S[1].y;S[2].y;S[3].y;S[0].x;S[1].x;S[2].x;S[3].x;S[0].y;S[1].y;S[2].y;S[3].y;za.save();za.globalCompositeOperation="source-over";za.fillStyle="rgba(96, 96, 96, 0.035)";za.beginPath();za.rect(0,0,pa.width,pa.height);za.moveTo(S[0].x,S[0].y);for(var ka=1;ka<S.length;ka++)za.lineTo(S[ka].x,S[ka].y);za.closePath();za.fill("evenodd");za.restore()}za.setLineDash([3,2]);O(za,B(Ia.getSelection()));za.setLineDash([])}if(Lb&&(S=Ia.getBounds(),ob*yb>2)){za.beginPath();for(ka=yb-1;ka<
S.right;ka+=yb){var ya=H({x:ka,y:S.top}),Ga=H({x:ka,y:S.bottom});za.moveTo(ya.x+.5,ya.y+.5);za.lineTo(Ga.x+.5,Ga.y+.5)}for(ka=yb-1;ka<S.bottom;ka+=yb)ya=H({x:0,y:ka}),Ga=H({x:S.right,y:ka}),za.moveTo(ya.x+.5,ya.y+.5),za.lineTo(Ga.x+.5,Ga.y+.5);za.stroke()}aa.paint(za);za.globalCompositeOperation="source-over";E&&(qa.makeEmpty(),za.restore())};this.showGrid=function(E){Lb=E;this.repaintAll()};this.resize=function(E,S){E-=Ha.offsetHeight;E=Math.floor(E);pa.style.height=E+"px";pa.width=pa.clientWidth;
pa.height=E;X=null;S||L();this.setInterpolation(uc);this.repaintAll()};a.on("toolChange",function(E,S){S=da[S.strokeMode];for(var ka=0;ka<aa.modes.length;ka++)if(aa.modes[ka]instanceof b){aa.modes[ka].leave();aa.modes[ka]=S;aa.modes[ka].enter();break}wa=S;Jc=E});a.on("modeChange",function(E){switch(E){case la.M_DRAW:var S=wa;break;case la.M_FLOODFILL:S=vc;break;case la.M_GRADIENTFILL:S=D;break;case la.M_RECT_SELECTION:S=N;break;case la.M_MOVE_TOOL:S=W;break;case la.M_ROTATE_CANVAS:S=Qb;break;case la.M_PAN_CANVAS:S=
La;break;case la.M_COLOR_PICKER:S=yc;break;case la.M_TRANSFORM:S=Y}oc=E===la.M_PAN_CANVAS||E===la.M_ROTATE_CANVAS;Ic=E===la.M_MOVE_TOOL||E===la.M_ROTATE_CANVAS||E===la.M_PAN_CANVAS;oc?(pa.addEventListener("touchstart",ia,{passive:!1}),pa.addEventListener("touchend",sa,{passive:!1}),pa.addEventListener("touchmove",M,{passive:!1})):(pa.removeEventListener("touchstart",ia),pa.removeEventListener("touchend",sa),pa.removeEventListener("touchmove",M));aa.setUserMode(S);ba.repaintAll()});a.on("maskViewOpened",
function(E){hc&&hc.off("changeLayer",na);(hc=E).on("changeLayer",na);na()});Zb=new d;yc=new e;La=new k;Qb=new q;vc=new l;D=new t;N=new f;W=new m;Y=new n;wa=(da=[new h,new p,new g])[xa.STROKE_MODE_FREEHAND];aa.setDefaultMode(Zb);aa.setUserMode(wa);rb.width=Ia.width;rb.height=Ia.height;pa.width=800;pa.height=900;pa.className="chickenpaint-canvas";pa.setAttribute("touch-action","none");za.setLineDash||(za.setLineDash=function(){});pa.addEventListener("contextmenu",function(E){E.preventDefault()});pa.addEventListener("mouseenter",
function(){xc=!0});pa.addEventListener("mouseleave",function(){xc=!1;kb[0]||kb[2]||kb[1]||ba.repaintAll()});pa.addEventListener("pointerdown",function(E){Mb=!0;Tb&&!Ic&&"touch"===E.pointerType||Ja(Va).isPressed("z")||(pa.setPointerCapture(E.pointerId),X=pa.getBoundingClientRect(),mb=E.clientX-X.left,nb=E.clientY-X.top,kb[0]=!1,kb[2]=!1,kb[1]=!1,kb[E.button]=!0,aa.mouseDown(E,E.button,ha(E)))});pa.addEventListener("pointermove",function(E){if(Mb&&aa.peek()instanceof h&&[0,1,2,3,4].includes(Jc)&&32>=
a.getBrushSize()){var S,ka;for(let ya of null!=(ka=null==(S=E.getCoalescedEvents)?void 0:S.call(E))?ka:[E])z(ya)}else z(E)});pa.addEventListener("pointerup",function(E){Mb=!1;let S=++kd-ld>=60,ka=ad&&kd>ld;(S||ka)&&(console.log("Auto-saving..."),a.actionPerformed({action:"CPSaveDB"}),ld=kd,ad=!1,bd&&(ad=!1,clearTimeout(bd)),bd=setTimeout(()=>{ad=!0},12E4));kb[0]=!1;kb[2]=!1;kb[1]=!1;aa.mouseUp(E,E.button,0);pa.releasePointerCapture(E.pointerId)});pa.addEventListener("wheel",function(E){if(0!=E.deltaY){if(!wc||
Math.abs(E.deltaY)>20){let S;S=E.deltaY>0?1/1.15:1.15;let ka=G({x:E.pageX,y:E.pageY}),ya=F(ka);Ia.isPointWithin(ya.x,ya.y)?ja(ba.getZoom()*S,ka.x,ka.y):ja(ba.getZoom()*S,hb+~~(Ia.width*ob/2),Gb+~~(Ia.height*ob/2));wc=wc||setTimeout(function(){wc=!1},50)}E.preventDefault()}},{passive:!1});document.addEventListener("keydown",function(E){aa.keyDown(E)});document.addEventListener("keyup",function(E){"alt"===E.key.toLowerCase()&&E.preventDefault();aa.keyUp(E)});document.addEventListener("visibilitychange",
function(){let E=pa.height+Ha.offsetHeight;pa.width=1;pa.height=1;ba.resize(E,!0)},!1);window.addEventListener("scroll",function(){X=null});pa.addEventListener("mousedown",function(E){1==E.button&&E.preventDefault()});Ia.on("changeSelection",function(){ba.repaintAll()});Ia.on("updateRegion",function(E){fc.union(E);ca(T(fc))});Ma.on("valueChanged",function(E){var S=ba.getOffset();ba.setOffset(-E,S.y)});ab.on("valueChanged",function(E){var S=ba.getOffset();ba.setOffset(S.x,-E)});this.setInterpolation(!0);
var md=document.createElement("div");md.className="chickenpaint-canvas-container-wrapper";md.appendChild(pa);ma.className="chickenpaint-canvas-container-top";ma.appendChild(md);ma.appendChild(ab.getElement());Ha.className="chickenpaint-canvas-container-bottom";Ha.appendChild(Ma.getElement());ea.appendChild(ma);ea.appendChild(Ha);a.setCanvas(this)}function Sb(a,c,d,b){function h(G){if(("dragStart"===A||"dragging"===A)&&0!==G.buttons){var H,P;let B=G.pageX-C.x;G=G.pageY-C.y;"dragStart"==A&&(H={x:B,
y:G},P=v,(H.x-P.x)*(H.x-P.x)+(H.y-P.y)*(H.y-P.y)>25)&&(A="dragging");"dragging"==A&&F.setLocation(B,G)}}function p(G){if("dragging"===A||"dragStart"===A){"dragStart"===A&&(G.stopPropagation(),G.preventDefault(),setTimeout(()=>{F.setLocation(v.x,v.y);F.toggleCollapse()},100));A=!1;try{G.target.releasePointerCapture(G.pointerId)}catch(H){console.error(H)}}m.removeEventListener("pointermove",h);m.removeEventListener("pointerup",p)}function g(G){G.stopPropagation();G.preventDefault();"vertResize"===A&&
F.setHeight(G.pageY-f.offsetTop-x)}function e(G){null==t||t.releasePointerCapture(G.pointerId);A=!1;t.removeEventListener("pointermove",g);t.removeEventListener("pointerup",e)}function k(G){G.stopPropagation();G.preventDefault();"horzResize"==A&&F.setWidth(G.pageX-f.offsetLeft)}function l(G){u.releasePointerCapture(G.pointerId);A=!1;u.removeEventListener("pointermove",k);u.removeEventListener("pointerup",l)}a.getSmallScreenMode()&&U(d+" (shorter)")!==d+" (shorter)"?this.title=U(d+" (shorter)"):this.title=
U(d);b=b||{};this.name=c;this.resizeVert=b.resizeVert||!1;this.resizeHorz=b.resizeHorz||!1;let f=document.createElement("div"),m=document.createElement("div"),n=document.createElement("i");d=document.createElement("button");let q=document.createElement("div"),t=null,u=null,v,A,C,x=0,F=this;this.getElement=function(){return f};this.getBodyElement=function(){return q};this.getWidth=function(){return f.offsetWidth};this.getHeight=function(){return f.offsetHeight};this.getX=function(){return parseInt(f.style.left,
10)||0};this.getY=function(){return parseInt(f.style.top,10)||0};this.setLocation=function(G,H){f.style.left=G+"px";f.style.top=H+"px"};this.setWidth=function(G){f.style.width=G+"px"};this.setHeight=function(G){f.style.height=G+"px"};this.setSize=function(G,H){this.setWidth(G);this.setHeight(H)};this.setCollapseDownwards=function(G){b.collapseDownwards=G};this.toggleCollapse=function(G){var H;if(void 0===G)G=!f.classList.contains("collapsed");else if(f.classList.contains("collapsed")===G)return;var P=
null==(H=f.closest(".chickenpaint"))?void 0:H.querySelector(".chickenpaint-canvas");H=P?P.clientHeight:window.innerHeight;P=this.getHeight();P=this.getY()+P;(f.classList.toggle("collapsed",G),n.classList.toggle("icon-angle-down",!G),n.classList.toggle("icon-angle-up",G),G)?b.collapseDownwards&&this.setLocation(this.getX(),Math.min(P,H)-this.getHeight()):(G=this.getHeight(),b.collapseDownwards?this.setLocation(this.getX(),Math.max(P-G,0)):this.getY()+G>H&&this.setLocation(this.getX(),Math.max(H-G,
0)))};this.userIsDoneWithUs=function(){a.getSmallScreenMode()&&this.toggleCollapse(!0)};n.className="collapse-icon fas icon-angle-down";d.type="button";d.className="btn btn-close";d.textContent="";d.tabIndex=-1;f.className="chickenpaint-palette chickenpaint-palette-"+c;m.className="chickenpaint-palette-head";m.setAttribute("touch-action","none");c=document.createElement("div");let w=document.createElement("h5");c.className="modal-header";w.className="modal-title";w.appendChild(document.createTextNode(this.title));
w.appendChild(n);c.appendChild(w);c.appendChild(d);m.appendChild(c);q.className="chickenpaint-palette-body";f.appendChild(m);f.appendChild(q);this.resizeVert&&((t=document.createElement("div")).className="chickenpaint-resize-handle-vert",t.addEventListener("pointerdown",function(G){G.stopPropagation();G.preventDefault();A="vertResize";x=G.pageY-f.offsetTop-f.offsetHeight;t.setPointerCapture(G.pointerId);t.addEventListener("pointermove",g);t.addEventListener("pointerup",e)}),f.appendChild(t));this.resizeHorz&&
((u=document.createElement("div")).className="chickenpaint-resize-handle-horz",u.addEventListener("pointerdown",function(G){G.stopPropagation();G.preventDefault();A="horzResize";u.setPointerCapture(G.pointerId);u.addEventListener("pointermove",k);u.addEventListener("pointerup",l)}),f.appendChild(u));m.addEventListener("pointerdown",function(G){0==G.button&&(G.stopPropagation(),G.preventDefault(),"BUTTON"==G.target.nodeName?F.emitEvent("paletteVisChange",[F,!1]):(v={x:parseInt(f.style.left,10)||0,
y:parseInt(f.style.top,10)||0},C={x:G.pageX-f.offsetLeft,y:G.pageY-f.offsetTop},A=a.getSmallScreenMode()?"dragStart":"dragging",G.target.setPointerCapture(G.pointerId)),m.addEventListener("pointermove",h),m.addEventListener("pointerup",p))})}function Zd(a){function c(g){"LI"==this.nodeName&&(g=b[parseInt(this.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:g.command}))}Sb.call(this,a,"tool","Tools");let d=this,b=[{className:"chickenpaint-tool-rect-selection",command:"CPRectSelection",
toolTip:"Marquee",shortcut:"m",mode:la.M_RECT_SELECTION},{className:"chickenpaint-tool-move",command:"CPMoveTool",toolTip:"Move tool",shortcut:"v",mode:la.M_MOVE_TOOL},{className:"chickenpaint-tool-flood-fill",command:"CPFloodFill",toolTip:"Flood fill",shortcut:"f",mode:la.M_FLOODFILL},{className:"chickenpaint-tool-gradient-fill",command:"CPGradientFill",toolTip:"Gradient fill",shortcut:"g",mode:la.M_GRADIENTFILL},{className:"chickenpaint-tool-color-picker",command:"CPColorPicker",toolTip:"Color picker",
shortcut:"i",mode:la.M_COLOR_PICKER},{className:"chickenpaint-tool-blur",command:"CPBlur",toolTip:"Blur",shortcut:"u",mode:la.M_DRAW,tool:la.T_BLUR},{className:"chickenpaint-tool-pencil",command:"CPPencil",toolTip:"Pencil",shortcut:"n",mode:la.M_DRAW,tool:la.T_PENCIL},{className:"chickenpaint-tool-pen",command:"CPPen",toolTip:"Pen",selected:!0,shortcut:"b",mode:la.M_DRAW,tool:la.T_PEN},{className:"chickenpaint-tool-airbrush",command:"CPAirbrush",toolTip:"Airbrush",shortcut:"a",mode:la.M_DRAW,tool:la.T_AIRBRUSH},
{className:"chickenpaint-tool-water",command:"CPWater",toolTip:"Waterpaint",shortcut:"w",mode:la.M_DRAW,tool:la.T_WATER},{className:"chickenpaint-tool-eraser",command:"CPEraser",toolTip:"Eraser",shortcut:"e",mode:la.M_DRAW,tool:la.T_ERASER},{className:"chickenpaint-tool-soft-eraser",command:"CPSoftEraser",toolTip:"Soft eraser",shortcut:"s",mode:la.M_DRAW,tool:la.T_SOFTERASER},{className:"chickenpaint-tool-smudge",command:"CPSmudge",toolTip:"Smudge",shortcut:"d",mode:la.M_DRAW,tool:la.T_SMUDGE},{className:"chickenpaint-tool-blender",
command:"CPBlender",toolTip:"Blender",shortcut:"c",mode:la.M_DRAW,tool:la.T_BLENDER},{className:"chickenpaint-tool-dodge",command:"CPDodge",toolTip:"Dodge (tool)",shortcut:"o",mode:la.M_DRAW,tool:la.T_DODGE},{className:"chickenpaint-tool-burn",command:"CPBurn",toolTip:"Burn (tool)",shortcut:"p",mode:la.M_DRAW,tool:la.T_BURN},{className:"chickenpaint-tool-rotate-canvas",command:"CPRotateCanvas",commandDoubleClick:"CPResetCanvasRotation",toolTip:"Rotate canvas",mode:la.M_ROTATE_CANVAS},{className:"chickenpaint-tool-pan-canvas",
command:"CPPanCanvas",toolTip:"Grab canvas",mode:la.M_PAN_CANVAS}],h=document.createElement("ul");a.on("modeChange",function(g){let e=d.getBodyElement();(e.querySelectorAll("li").forEach(function(k){k.classList.remove("selected")}),g==la.M_DRAW)?(g=e.querySelector(`li[data-tool="${a.getCurTool()}"]`))&&g.classList.add("selected"):(g=e.querySelector(`li[data-mode="${g}"]`))&&g.classList.add("selected")});a.on("toolChange",function(g){let e=d.getBodyElement();a.getCurMode()==la.M_DRAW&&(e.querySelectorAll("li").forEach(function(k){k.classList.remove("selected")}),
(g=e.querySelector(`li[data-tool="${g}"]`))&&g.classList.add("selected"))});let p=d.getBodyElement();for(let g in h.className="chickenpaint-tools list-unstyled",b)!function(e){let k=b[e],l=document.createElement("li"),f=document.createElement("div");l.className="chickenpaint-toolbar-button "+k.className;l.setAttribute("data-buttonIndex",e);l.setAttribute("data-mode",k.mode);void 0!==k.tool&&l.setAttribute("data-tool",k.tool);l.title=U(k.toolTip);k.shortcut&&(l.title+=" ("+k.shortcut.toUpperCase()+
")",Ja(Va)(k.shortcut,function(){return c.call(l),!1}));k.selected&&(l.className+=" selected");f.className="chickenpaint-toolbar-button-icon";l.appendChild(f);h.appendChild(l)}(g);h.addEventListener("click",function(g){let e=g.target.closest("li");e&&c.call(e,g)});h.addEventListener("dblclick",function(g){if(g=g.target.closest("li"))g=b[parseInt(g.getAttribute("data-buttonIndex"),10)],g.commandDoubleClick&&a.actionPerformed({action:g.commandDoubleClick})});p.appendChild(h)}function $d(a){Sb.call(this,
a,"misc","Misc");this.flipButton=null;let c=this,d=[{className:"chickenpaint-tool-zoom-in",command:"CPZoomIn",toolTip:"Zoom in"},{className:"chickenpaint-tool-zoom-out",command:"CPZoomOut",toolTip:"Zoom out"},{className:"chickenpaint-tool-zoom-100",command:"CPZoom100",toolTip:"Zoom 100%"},{className:"chickenpaint-tool-flip-horizontal",command:"CPViewHFlip",toolTip:"Flip View Horizontal"},{className:"chickenpaint-tool-undo",command:"CPUndo",toolTip:"Undo"},{className:"chickenpaint-tool-redo",command:"CPRedo",
toolTip:"Redo"},{className:"chickenpaint-tool-send",command:"CPSend",toolTip:"Save Oekaki"}];!function(){let b=c.getBodyElement(),h=document.createElement("ul");for(let p in h.className="chickenpaint-misc-tools list-unstyled",d){let g=d[p],e=document.createElement("li"),k=document.createElement("div");"CPSend"!=g.command||a.isActionSupported("CPContinue")||(g.toolTip="Post Oekaki",g.className="chickenpaint-tool-send-and-end");e.className="chickenpaint-toolbar-button "+g.className;e.setAttribute("data-buttonIndex",
p);e.setAttribute("title",U(g.toolTip));k.className="chickenpaint-toolbar-button-icon";e.appendChild(k);h.appendChild(e);"chickenpaint-tool-flip-horizontal"===g.className&&(c.flipButton=e)}h.addEventListener("click",function(p){if(p=p.target.closest("li"))p=d[parseInt(p.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:p.command})});b.appendChild(h)}()}function ae(a){Sb.call(this,a,"stroke","Stroke");let c=[{className:"chickenpaint-tool-freehand",command:"CPFreeHand",toolTip:U("Free-hand"),
selected:!0},{className:"chickenpaint-tool-line",command:"CPLine",toolTip:U("Straight line")},{className:"chickenpaint-tool-bezier",command:"CPBezier",toolTip:U("Bezier curve")}],d=this.getBodyElement(),b=document.createElement("ul");for(let h in b.className="chickenpaint-stroke-tools list-unstyled",c){let p=c[h],g=document.createElement("li"),e=document.createElement("div");g.className="chickenpaint-toolbar-button "+p.className;g.setAttribute("data-buttonIndex",h);g.setAttribute("title",p.toolTip);
p.selected&&(g.className+=" selected");e.className="chickenpaint-toolbar-button-icon";g.appendChild(e);b.appendChild(g)}b.addEventListener("click",function(h){if(h=h.target.closest("li"))h=c[parseInt(h.getAttribute("data-buttonIndex"),10)],a.actionPerformed({action:h.command})});d.appendChild(b);a.on("toolChange",function(h,p){h=document.querySelector(".chickenpaint-tool-freehand");let g=document.querySelector(".chickenpaint-tool-line"),e=document.querySelector(".chickenpaint-tool-bezier");h&&h.classList.toggle("selected",
p.strokeMode==xa.STROKE_MODE_FREEHAND);g&&g.classList.toggle("selected",p.strokeMode==xa.STROKE_MODE_LINE);e&&e.classList.toggle("selected",p.strokeMode==xa.STROKE_MODE_BEZIER)})}function bc(a,c,d){return c in a?Object.defineProperty(a,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[c]=d,a}function be(a){Sb.call(this,a,"color","Color (picker)");let c=new Mf(a),d=new Nf(a,c);a=new Qg(a);let b=this.getBodyElement(),h=document.createElement("div");h.className="chickenpaint-colorpicker-top";
h.appendChild(c.getElement());h.appendChild(d.getElement());b.appendChild(h);b.appendChild(a.getElement())}function Qg(a){function c(p,g,e){for(;p.length<e;)p=g+p;return p}function d(){h.style.backgroundColor="#"+c(Number(b).toString(16),"0",6)}let b=0,h=document.createElement("div");this.getElement=function(){return h};a.on("colorChange",function(p){b=p.getRgb();d()});h.className="chickenpaint-colorpicker-show";h.addEventListener("click",function(p){p.preventDefault();p="#"+c(Number(b).toString(16),
"0",6);if(null!=(p=window.prompt(U("Please enter a color in hex format"),p)))try{(p.match(/^#/)||p.match(/^$/))&&(p=p.substring(1));let g=parseInt(p,16);a.setCurColor(new jb(g))}catch(g){}});d()}function nd(a,c){function d(){var g=b.width;h.clearRect(0,0,g,b.height);h.beginPath();h.arc(g/2+1,g/2+1,Math.max(g/2,1)-2,0,2*Math.PI);p.state?h.fill():h.stroke()}var b=document.createElement("canvas"),h=b.getContext("2d"),p=this;this.state=a||!1;this.setValue=function(g){this.state!=g&&(this.state=g,this.emitEvent("valueChange",
[g]),d())};this.getElement=function(){return b};b.addEventListener("mousedown",function(g){p.setValue(!p.state)});b.title=c||"";b.className="chickenpaint-checkbox";b.width=20;b.height=20;b.fillStyle="black";b.strokeStyle="black";d()}function Nb(a,c,d,b,h=150,p=3){function g(){let v=l.width||h,A=l.height,C="string"==typeof u.title?U(u.title):u.title(u.value),x=3*window.devicePixelRatio,F=.75*l.height;if(d)f.save(),f.fillStyle="white",f.fillRect(0,0,v,A),f.fillStyle="black",f.fillText(C,x,F),f.beginPath(),
u.value>=m/2?f.rect(v/2,0,(u.value-m/2)*v/m,A):f.rect(u.value*v/m,0,(m/2-u.value)*v/m,A),f.fill(),f.clip(),f.fillStyle="white";else{var w=(u.value-a)/m;b&&(w=Math.pow(w,1/p));w*=v;f.save();f.save();f.fillStyle="black";f.beginPath();f.rect(0,0,w,A);f.fill();f.clip();f.fillStyle="white";f.fillText(C,x,F);f.restore();f.fillStyle="white";f.beginPath();f.rect(w,0,v,A);f.fill();f.clip();f.fillStyle="black"}f.fillText(C,x,F);f.restore()}function e(v){let A=l.clientWidth,C=l.getBoundingClientRect().left+
window.scrollX;v=(v.pageX-C)/A;b&&(v=Math.pow(Math.max(v,0),p));u.setValue(v*m+a)}function k(v){switch(n){case 1:return e(v);case 2:var A=u.title();if(!A.includes(U("Brush size"))&&!A.includes(U("Opacity")))return e(v);A=(v.pageX-q)/4;if(0!==A){A=u.value+A;let C=Math.floor(A);u.setValue(C);q=v.pageX-(A-C)*4}}}let l=document.createElement("canvas"),f=l.getContext("2d"),m=c-a,n=0,q,t=!1,u=this;this.value=void 0;this.title="";d=d||!1;l.addEventListener("pointerup",v=>{if(0===n)return l.releasePointerCapture(v.pointerId),
l.removeEventListener("pointermove",k);if(0!==n)switch(n){case 1:0!==v.button||v.shiftKey||(n=0);break;case 2:(2==v.button||0===v.button&&v.shiftKey)&&(n=0);break;default:return}return l.releasePointerCapture(v.pointerId),l.removeEventListener("pointermove",k)});this.setValue=function(v){v=~~Math.max(a,Math.min(c,v));this.value!=v&&(this.value=v,this.emitEvent("valueChange",[this.value]),t?g():(t=!0,this.resize()))};this.getElement=function(){return l};this.resize=function(){l.width=l.clientWidth||
h;l.height=l.clientHeight||20;window.devicePixelRatio>1&&(l.style.height=l.height+"px",l.width*=window.devicePixelRatio,l.height*=window.devicePixelRatio);f.font=.47*l.height+"pt sans-serif";g()};l.addEventListener("pointerdown",function(v){0===n&&(2===v.button||0===v.button&&v.shiftKey?(n=2,q=v.pageX):(n=1,e(v)),l.setPointerCapture(v.pointerId),l.addEventListener("pointermove",k))});l.addEventListener("contextmenu",function(v){v.preventDefault()});l.setAttribute("touch-action","none");l.className=
"chickenpaint-slider";"devicePixelRatio"in window||(window.devicePixelRatio=1)}function Fd(a,c,d){function b(){for(var f=e.style,m=Number(p.getRgb()).toString(16);m.length<6;)m="0"+m;f.backgroundColor="#"+m}let h=this,p=new jb(0),g=255,e=document.createElement("div");this.getElement=function(){return e};this.setColor=function(f){p.isEqual(f)||(p.copyFrom(f),b(),this.emitEvent("colorChange",[p]))};this.setAlpha=function(f){f!=g&&(g=f,b(),this.emitEvent("alphaChange",[g]))};this.getColorRgb=function(){return p.getRgb()};
this.getAlpha=function(){return g};this.setCurColor=this.setColor;e.className="chickenpaint-color-pick-swatch";a&&p.copyFrom(a);c&&(g=c);let k=new zb.Popover(e,{html:!0,content:function(){let f,m,n,q,t;return window.addEventListener("mousedown",l),f=document.createElement("div"),m=document.createElement("div"),n=new Mf(h,p),q=new Nf(h,n,p.getHue()),t=new Nb(0,255),f.className="chickenpaint-color-pick-panel",m.className="chickenpaint-colorpicker-top",m.appendChild(n.getElement()),m.appendChild(q.getElement()),
f.appendChild(m),t.value=g,t.title=function(u){return U("Opacity: ")+u},t.on("valueChange",function(u){h.setAlpha(u)}),f.appendChild(t.getElement()),setTimeout(function(){t.resize()},0),f},trigger:"manual",placement:"bottom",container:d||!1}),l=function(f){var m=f.target;m=m.closest(".popover-body")||m.classList.contains("chickenpaint-color-pick-panel")||m.classList.contains("chickenpaint-colorpicker-select")||m.classList.contains("chickenpaint-colorpicker-slider");f.preventDefault();m||k.hide()};
e.addEventListener("click",function(f){f.preventDefault();k.toggle()});e.addEventListener("hidden.bs.popover",function(){window.removeEventListener("mousedown",l)});b()}function Ne(a,c){let d=document.createElement("div");return d.className="chickenpaint-checkbox-slider-group",d.appendChild(a.getElement()),d.appendChild(c.getElement()),d}function Of(a,c){for(let d in c)if(c.hasOwnProperty(d)){let b=document.createElement("option");b.appendChild(document.createTextNode(U(c[d])));b.value=d;a.appendChild(b)}}
function Rg(a){function c(){p.gradient(p.getBounds(),0,0,p.width,0,k,!0);e.putImageData(p.imageData,0,0,0,0,150,32);b.fillRect(0,0,d.width,d.height);b.drawImage(g,0,0)}let d=document.createElement("canvas"),b=d.getContext("2d"),h=Lf(b),p=new I(150,32),g=document.createElement("canvas"),e=g.getContext("2d"),k=a.getCurGradient();this.getElement=function(){return d};a.on("gradientChange",function(l){k=l;c()});d.width=g.width=150;d.height=g.height=32;d.className="chickenpaint-gradient-preview";b.fillStyle=
h;c()}function od(a){function c(){b.getElement().style.display="none";h.getElement().style.display="none";p.getElement().style.display="none";g.getElement().style.display="none";e.getElement().style.display="none";k.getElement().style.display="none"}function d(m){c();let n=g.getElement().querySelector(".form-check");switch(n&&(n.style.display="none"),m){case la.M_GRADIENTFILL:h.getElement().style.display="block";break;case la.M_TRANSFORM:p.getElement().style.display="block";break;case la.M_RECT_SELECTION:g.getElement().style.display=
"block";n instanceof HTMLElement&&(n.style.display="");break;case la.M_MOVE_TOOL:g.getElement().style.display="block";break;case la.M_ROTATE_CANVAS:case la.M_PAN_CANVAS:e.getElement().style.display="block";break;case la.M_FLOODFILL:k.getElement().style.display="block";break;default:b.getElement().style.display="block"}}Sb.call(this,a,"brush","Tool options");let b=new Sg(a),h=new Tg(a),p=new Ug(a),g=new Vg(a),e=new Wg(a),k=new Xg(a),l=this.getBodyElement();l.addEventListener("touchmove",m=>{m.preventDefault()},
{passive:!1});l.appendChild(b.getElement());l.appendChild(h.getElement());l.appendChild(p.getElement());l.appendChild(g.getElement());l.appendChild(e.getElement());l.appendChild(k.getElement());let f=null;a.on("modeChange",function(m){f=m;d(m)});document.addEventListener("keydown",m=>{"r"!==m.key.toLocaleLowerCase()&&(m.ctrlKey||"z"!==m.key.toLocaleLowerCase())&&" "!==m.key||(c(),e.getElement().style.display="block")});document.addEventListener("keyup",m=>{"r"!==m.key.toLocaleLowerCase()&&"z"!==m.key.toLocaleLowerCase()&&
" "!==m.key||(c(),d(f))})}function Sg(a){let c=[1,2,3,4,5,6,7,8,9,10,15,20,25,30,35,40,45,50,60,70,80,90,100,125,150,175,200],d=document.createElement("div"),b=document.createElement("select"),h=new nd(!1,U("Control brush opacity with pen pressure")),p=new Nb(1,255,!1,!0),g=new nd(!0,U("Control brush size with pen pressure")),e=new Nb(1,200,!1,!0),k=new nd(!1,U("Control brush scattering with pen pressure")),l=new Nb(0,1E3,!1,!0),f=new Nb(0,100,!1,!0),m=new Nb(0,100,!1,!0),n=new Nb(0,100,!1,!0),q=
new Nb(0,100,!1,!0),t=new od.CPBrushPreview(a);this.getElement=function(){return d};p.title=function(u){return U("Opacity")+": "+u};p.on("valueChange",function(u){a.setAlpha(u)});e.title=function(u){return U("Brush size")+": "+u};e.on("valueChange",function(u){a.setBrushSize(u)});f.title=function(u){return U("Color")+": "+u+"%"};f.on("valueChange",function(u){a.getBrushInfo().resat=u/100;a.callToolListeners()});m.title=function(u){return U("Blend")+": "+u+"%"};m.on("valueChange",function(u){a.getBrushInfo().bleed=
u/100;a.callToolListeners()});n.title=function(u){return U("Spacing")+": "+u+"%"};n.on("valueChange",function(u){a.getBrushInfo().spacing=u/100;a.callToolListeners()});l.title=function(u){return U("Scattering")+": "+u+"%"};l.on("valueChange",function(u){a.getBrushInfo().scattering=u/100;a.callToolListeners()});q.title=function(u){return U("Smoothing")+": "+u+"%"};q.on("valueChange",function(u){a.getBrushInfo().smoothing=u/100;a.callToolListeners()});k.on("valueChange",function(u){a.getBrushInfo().pressureScattering=
u;a.callToolListeners()});h.on("valueChange",function(u){a.getBrushInfo().pressureAlpha=u;a.callToolListeners()});g.on("valueChange",function(u){a.getBrushInfo().pressureSize=u;a.callToolListeners()});b.addEventListener("change",function(u){a.getBrushInfo().tip=parseInt(b.value,10);b.blur()});window.addEventListener("keydown",u=>{b.blur()});b.className="form-control form-control-sm";b.tabIndex=-1;Of(b,["Round Pixelated","Round Hard Edge","Round Soft","Square Pixelated","Square Hard Edge"]);d.appendChild(b);
d.appendChild(t.getElement());d.appendChild(Ne(g,e));d.appendChild(Ne(h,p));d.appendChild(f.getElement());d.appendChild(m.getElement());d.appendChild(n.getElement());d.appendChild(Ne(k,l));d.appendChild(q.getElement());h.setValue(a.getBrushInfo().pressureAlpha);p.setValue(a.getAlpha());g.setValue(a.getBrushInfo().pressureSize);e.setValue(a.getBrushSize());k.setValue(a.getBrushInfo().pressureScattering);l.setValue(~~(100*a.getBrushInfo().scattering));b.value=a.getBrushInfo().tip;f.setValue(~~(100*
a.getBrushInfo().resat));m.setValue(~~(100*a.getBrushInfo().bleed));n.setValue(~~(100*a.getBrushInfo().spacing));q.setValue(~~(100*a.getBrushInfo().smoothing));a.on("toolChange",function(u,v){p.setValue(v.alpha);e.setValue(v.size);g.setValue(v.pressureSize);h.setValue(v.pressureAlpha);b.value=v.tip;k.setValue(v.pressureScattering);~~(100*v.resat)!=f.value&&f.setValue(~~(100*v.resat));~~(100*v.bleed)!=m.value&&m.setValue(~~(100*v.bleed));~~(100*v.spacing)!=n.value&&n.setValue(~~(100*v.spacing));~~(100*
v.scattering)!=l.value&&l.setValue(~~(100*v.scattering));~~(100*v.smoothing)!=q.value&&q.setValue(~~(100*v.smoothing))});Ja(Va)("1,2,3,4,5,6,7,8,9,0",function(u,v){u=parseInt(v.shortcut,10);0==u&&(u=10);a.setAlpha(Math.round(u/10*255))});Ja(Va)("{,[",function(){let u=a.getBrushSize();for(let v=c.length-1;v>=0;v--)if(u>c[v]){a.setBrushSize(c[v]);break}});Ja(Va)("},]",function(){let u=a.getBrushSize();for(let v=0;v<c.length;v++)if(u<c[v]){a.setBrushSize(c[v]);break}})}function Tg(a){function c(){let e=
[p.getAlpha()<<24|p.getColorRgb(),g.getAlpha()<<24|g.getColorRgb()];a.setCurGradient(e)}var d;let b=document.createElement("div");var h=new Rg(a);let p=new Fd(new jb(16777215&a.getCurGradient()[0]),a.getCurGradient()[0]>>>24,b),g=new Fd(new jb(16777215&a.getCurGradient()[1]),a.getCurGradient()[1]>>>24,b);this.getElement=function(){return b};b.className="chickenpaint-gradient-panel";b.style.display="none";p.on("colorChange",c);p.on("alphaChange",c);g.on("colorChange",c);g.on("alphaChange",c);(d=document.createElement("p")).textContent=
U("Gradient");b.appendChild(d);b.appendChild(h.getElement());(d=document.createElement("div")).className="chickenpaint-gradient-colors";(h=document.createElement("div")).className="chickenpaint-gradient-start-color";h.appendChild(p.getElement());d.appendChild(h);(h=document.createElement("div")).className="chickenpaint-gradient-end-color";h.appendChild(g.getElement());d.appendChild(h);b.appendChild(d)}function pd(a,c){let d=a.textContent;if(a.textContent="",a.classList.add("d-flex","align-items-center",
"justify-content-center","position-relative"),a.style.paddingLeft="0.35rem",c){let b=document.createElement("span");b.className=`md-panel ${c}`;b.style.flex="0 0 auto";b.style.marginRight="0";a.prepend(b)}c=document.createElement("span");c.textContent=d;c.style.flex="1 1 auto";c.style.textAlign="center";a.appendChild(c)}function Ug(a){var c={smooth:U("Smooth"),sharp:U("Sharp")};let d=document.createElement("div"),b=document.createElement("button"),h=document.createElement("button");var p=document.createElement("select");
this.getElement=function(){return d};d.className="chickenpaint-transform-panel";d.style.display="none";b.type="button";h.type="button";b.className="btn btn-primary btn-block";h.className="btn btn-light btn-block";b.textContent=U("Apply transform");h.textContent=U("Cancel");pd(b,"icon-md-circle");pd(h,"icon-md-close");p.addEventListener("change",function(l){a.setTransformInterpolation(this.value)});p.className="form-control chickenpaint-transform-interpolation";Of(p,c);c=document.createElement("div");
let g=document.createElement("label");g.textContent=U("Transform style");c.className="form-group";c.appendChild(g);c.appendChild(p);d.appendChild(c);p=document.createElement("div");p.appendChild(b);p.appendChild(h);p.className="form-group";d.appendChild(p);let {wrapper:e,checkbox:k}=Oe("chickenpaint-t-maintainAspectCheckbox",U("Constrain"),!0);d.appendChild(e);b.addEventListener("click",function(l){a.actionPerformed({action:"CPTransformAccept"});l.preventDefault()});h.addEventListener("click",function(l){a.actionPerformed({action:"CPTransformReject"});
l.preventDefault()});k.addEventListener("change",()=>{k.blur()})}function Vg(a){let c=document.createElement("div");var d=document.createElement("div");let b=document.createElement("label"),h=document.createElement("button"),p=document.createElement("button"),g=document.createElement("button");this.getElement=function(){return c};c.className="chickenpaint-selection-panel";c.style.display="none";d.className="form-group";b.textContent=U("Selection");d.appendChild(b);h.type="button";h.className="btn btn-light btn-block";
h.textContent=U("Fill");h.addEventListener("click",function(e){a.actionPerformed({action:"CPFill"});e.preventDefault()});pd(h,"icon-md-ink_selection");d.appendChild(h);p.type="button";p.className="btn btn-light btn-block deselectButton";p.textContent=U("Deselect");p.addEventListener("click",function(e){a.actionPerformed({action:"CPDeselectAll"});e.preventDefault()});pd(p,"icon-md-deselect");d.appendChild(p);g.type="button";g.className="btn btn-primary btn-block";g.textContent=U("Transform");g.addEventListener("click",
function(e){a.actionPerformed({action:"CPTransform"});e.preventDefault()});pd(g,"icon-md-resize");d.appendChild(g);c.appendChild(d);({wrapper:d}=Oe("chickenpaint-s-maintainAspectCheckbox",U("Constrain"),!1));c.appendChild(d)}function Oe(a,c,d=!1){let b=document.createElement("input");b.type="checkbox";b.id=a;b.className="form-check-input";b.checked=d;b.style.outline="none";b.style.boxShadow="none";b.tabIndex=-1;d=document.createElement("label");d.className="form-check-label";d.setAttribute("for",
a);d.textContent=c;a=document.createElement("div");return a.className="form-check",a.appendChild(b),a.appendChild(d),{wrapper:a,checkbox:b}}function Wg(a){var c;let d,b=document.createElement("div"),h=document.createElement("div"),p=document.createElement("label"),g=document.createElement("button"),e=new Nb(10,800,!1,!0,180,3.13),k=new Nb(-180,180,!1,!1,180);b.className="chickenpaint-pan-panel";b.style.display="none";b.appendChild(e.getElement());h.className="form-group";p.textContent=U("Zoom and Rotate");
h.appendChild(p);h.appendChild(p);b.appendChild(h);g.type="button";g.className="btn btn-primary btn-block";g.style.outline="none";g.textContent=U("Reset View");g.addEventListener("click",function(t){a.actionPerformed({action:"CPResetZoomAndRotation"});t.preventDefault()});pd(g,"icon-md-restart_alt");h.appendChild(g);b.appendChild(h);e.title=function(t){return U("Zoom")+": "+t+"%"};k.title=function(t){return U("Rotation")+": "+t+"\u00b0"};e.on("valueChange",function(t){a.zoomOnCenter(t/100)});k.on("valueChange",
function(t){a.setRotationDegrees(t)});b.appendChild(e.getElement());b.appendChild(k.getElement());this.getElement=function(){return b};e.setValue(100*a.getZoom());k.setValue(a.getRotationDegrees());document.addEventListener("wheel",t=>{t.preventDefault();l()},{passive:!1});let l=(c=()=>{e.setValue(100*a.getZoom());k.setValue(a.getRotationDegrees())},function(...t){clearTimeout(d);d=setTimeout(()=>c.apply(this,t),12)}),f=t=>a.isPanOrRotateMode()||Ja(Va).isPressed("space")||Ja(Va).isPressed("r")||Ja(Va).isPressed("z"),
m=t=>t instanceof HTMLCanvasElement&&t.classList.contains("chickenpaint-canvas"),n=!1;document.addEventListener("pointerdown",t=>{!f(t)||(n=!0,m(t.target)&&l())});document.addEventListener("pointermove",t=>{n&&f(t)&&m(t.target)&&l()});document.addEventListener("pointerup",t=>{n=!1;!f(t)||m(t.target)&&l()});Ja(Va)("=,-",function(){l()});let q=!0;Ja(Va)("ctrl+0,alt+0,r,z,space,enter",function(){q&&(q=!1,l())});document.addEventListener("keyup",t=>{q=!0});document.addEventListener("click",t=>{t.target instanceof
HTMLElement&&!(t.target instanceof HTMLCanvasElement)&&l()})}function Xg(a){let c=document.createElement("div");var d=document.createElement("div");let b=document.createElement("label"),h=new Nb(0,5,!1,!1,180),p=new Nb(0,255,!1,!1,180);c.className="chickenpaint-floodFill-panel";c.style.display="none";c.appendChild(h.getElement());d.className="form-group";b.textContent=U("Flood fill");d.appendChild(b);c.appendChild(d);h.title=function(k){return U("Grow fill area")+": "+k};p.title=function(k){return U("Opacity")+
": "+k};h.on("valueChange",function(k){a.setGrowFillArea(k)});p.on("valueChange",function(k){a.setFoodFillAlpha(k)});d=document.createElement("div");d.className="form-group";d.appendChild(h.getElement());d.appendChild(p.getElement());c.appendChild(d);let {wrapper:g,checkbox:e}=Oe("chickenpaint-floodFillreferAllLayersCheckbox",U("Refer all layers"),!0);g.classList.add("mb-1");c.appendChild(g);e.addEventListener("change",()=>{e.blur();a.setFloodFillReferAllLayers(e.checked)});this.getElement=function(){return c};
h.setValue(2);p.setValue(255)}function Yg(a){a.preventDefault();a.stopPropagation()}function kc(a){let c=document.createElement("span");return c.className="fa "+a,c}function Pe(a){let c=document.createElement("span");return c.className="chickenpaint-icon chickenpaint-icon-"+a,c}function Pf(a,c){let d=document.createElement("div"),b=document.createElement("label");return b.tabIndex=-1,a.tabIndex=-1,d.className="form-check",a.className="form-check-input",b.className="form-check-label",b.setAttribute("for",
a.id),b.appendChild(a),b.appendChild(document.createTextNode(c)),d.appendChild(a),d.appendChild(b),d}function ce(a){function c(){let x=h.getActiveLayer();x.getAlpha()!=l.value&&l.setValue(x.getAlpha());let F=h.getActiveLayer();for(;f.lastChild;)f.removeChild(f.lastChild);for(let w=Q.LM_FIRST;w<=Q.LM_LAST;w++)if(w!=Q.LM_MULTIPLY2&&(w==F.blendMode||w===Q.LM_PASSTHROUGH&&F instanceof $a||w<=Q.LM_LAST_CHIBIPAINT)){let G=document.createElement("option");G.appendChild(document.createTextNode(U(Q.BLEND_MODE_DISPLAY_NAMES[w])));
w!==Q.LM_MULTIPLY||F.blendMode===w||F.useLegacyMultiply?G.value=w:G.value=Q.LM_MULTIPLY2;f.appendChild(G)}x.getBlendMode()!=parseInt(f.value,10)&&(f.value=x.getBlendMode());x.getLockAlpha()!=q.checked&&(q.checked=x.getLockAlpha());(function(){var w=h.getActiveLayer();let G=h.isEditingMask();w={"image-layer":w instanceof Fa,"layer-group":w instanceof $a,"clipping-mask":w instanceof Fa&&w.clip,"no-clipping-mask":w instanceof Fa&&!w.clip,"no-clipping-mask-or-is-group":!(w instanceof Fa)||!w.clip,mask:w&&
null!==w.mask,"no-mask":w&&null===w.mask,"mask-enabled":w&&null!==w.mask&&w.maskVisible,"mask-disabled":w&&null!==w.mask&&!w.maskVisible,isNotEditingMask:w&&!G,isEditingMask:w&&null!==w.mask&&G};for(let H of"mask no-mask isEditingMask isNotEditingMask clipping-mask no-clipping-mask-or-is-group image-layer layer-group".split(" "))for(let P of u.getElementsByClassName("chickenpaint-action-require-"+H))P.style.display=w[H]?"inline-block":"none";u.querySelectorAll("[data-action]").forEach(function(H){let P=
H.getAttribute("data-action");H.classList.toggle("disabled",!a.isActionAllowed(P))})})()}function d(){h=this;k.resize();c()}Sb.call(this,a,"layers","Layers",{resizeHorz:!0,resizeVert:!0});let b=this,h=a.getArtwork(),p=null,g=this.getBodyElement(),e=this.getElement(),k=new function(){function x(M){let z=Z.querySelectorAll(".chickenpaint-layer");return z[z.length-1-M]}function F(M){if(!M)return-1;M=M.closest(".chickenpaint-layer");if(!M)return-1;let z=Array.from(Z.querySelectorAll(".chickenpaint-layer"));
return z.length-1-z.indexOf(M)}function w(){var M;if(2===V.state){var z=e.getBoundingClientRect();var K=!0;var ca=!0;if(V.dropTarget=function(ba,ea){var ma=Z.querySelectorAll(".chickenpaint-layer");ba={layer:p[p.length-1],displayIndex:p.length-1,direction:"over"};for(var Ha=0;Ha<ma.length;Ha++){let pa=ma[ma.length-1-Ha].getBoundingClientRect();if(0===Ha&&ea>pa.bottom){ba=h.getLayersRoot().layers[0];ba={layer:ba,displayIndex:p.indexOf(ba),direction:"under"};break}if(ea>=pa.top){ma=p[Ha];let za=pa.bottom-
pa.top;ba={layer:ma,displayIndex:Ha};ma instanceof $a?ea>=pa.top+.75*za?ma.expanded&&ma.layers.length>0?(ba.layer=ma.layers[ma.layers.length-1],ba.displayIndex--,ba.direction="over"):ba.direction="under":ea>=pa.top+.25*za?ma.expanded&&ma.layers.length>0?(ba.layer=ma.layers[ma.layers.length-1],ba.displayIndex--,ba.direction="over"):ba.direction="inside":ba.direction="over":ba.direction=ea>=pa.top+.5*za?"under":"over";break}}return ba.layer.parent===V.layer.parent&&("over"===ba.direction||"under"===
ba.direction)&&(ea=ba.layer.parent,Ha=ea.indexOf(ba.layer),"over"===ba.direction&&ea.layers[Ha+1]===V.layer||"under"===ba.direction&&ea.layers[Ha-1]===V.layer||ba.layer===V.layer)?null:V.layer instanceof $a&&(ba.layer===V.layer&&"inside"===ba.direction||ba.layer.hasAncestor(V.layer))?null:ba}(V.dragX,V.dragY),V.dropTarget){var na=x(V.dropTarget.displayIndex);switch(V.dropTarget.direction){case "over":case "under":Z.appendChild(V.dropBetweenMarkerElem);K=V.dropTarget.layer.getDepth()-1;var X;na=na.getBoundingClientRect();
if("under"===V.dropTarget.direction&&V.dropTarget.layer instanceof $a&&V.dropTarget.layer.expanded){for(X=V.dropTarget.displayIndex-1;X>=0&&p[X].hasAncestor(V.dropTarget.layer);X--);X=x(X+1).getBoundingClientRect().bottom}else X=na.bottom;K=na.left-z.left+(K>0?26+16*K:0);V.dropBetweenMarkerElem.style.left=K+"px";V.dropBetweenMarkerElem.style.width=na.right-z.left-K+"px";V.dropBetweenMarkerElem.style.top=("over"===V.dropTarget.direction?na.top-1:X+1)-z.top+"px";Z.querySelectorAll(".chickenpaint-layer-drop-target").forEach(ea=>
ea.classList.remove("chickenpaint-layer-drop-target"));K=!1;break;case "inside":let ba=Z.querySelectorAll(".chickenpaint-layer");ba.forEach((ea,ma)=>{ea.classList.toggle("chickenpaint-layer-drop-target",ba.length-1-ma===V.dropTarget.displayIndex)});ca=!1}}ca&&Z.querySelectorAll(".chickenpaint-layer-drop-target").forEach(ba=>ba.classList.remove("chickenpaint-layer-drop-target"));K&&(null==(M=V.dropBetweenMarkerElem)||M.remove());V.frameElem.style.top=V.dragY-z.top-parseInt(V.frameElem.style.height,
10)/2+"px"}else null==(z=V.dropBetweenMarkerElem)||z.remove(),null==(ca=V.frameElem)||ca.remove()}function G(M){let z=M.getImageThumbnail().getAsCanvas(va);return z.title=U("Image"),z.className="chickenpaint-layer-thumbnail chickenpaint-layer-image-thumbnail",z.style.maxWidth=z.width/z.height*25+"px",M!=h.getActiveLayer()||h.isEditingMask()||(z.className+=" active"),z}function H(M){let z=M.getMaskThumbnail().getAsCanvas(va);(z.title=U("Layer mask"),z.className="chickenpaint-layer-thumbnail chickenpaint-layer-mask-thumbnail",
z.style.maxWidth=z.width/z.height*25+"px",M==h.getActiveLayer()&&h.isEditingMask()&&(z.className+=" active"),M.maskVisible)||(z.className+=" disabled",(M=z.getContext("2d")).strokeStyle="red",M.lineWidth=3,M.moveTo(5,5),M.lineTo(z.width-5,z.height-5),M.moveTo(z.width-5,5),M.lineTo(5,z.height-5),M.stroke());return z}function P(M,z){let K=document.createElement("div");var ca=document.createElement("div");let na=document.createElement("div");var X=document.createElement("div");let ba=document.createElement("div"),
ea=document.createElement("div"),ma=document.createElement("div");if(K.className="chickenpaint-layer list-group-item",z==h.getActiveLayer()&&(K.className+=" active"),ca.className="chickenpaint-layer-eye",z.ancestorsAreVisible()||(ca.className+=" chickenpaint-layer-eye-hidden-ancestors"),ca.style.marginRight=2+16*(z.getDepth()-1)+"px",z.visible?(K.className+=" chickenpaint-layer-visible",ca.appendChild(kc("icon-eye"))):(K.className+=" chickenpaint-layer-hidden",ca.appendChild(kc("icon-eye-slash"))),
K.appendChild(ca),na.className="chickenpaint-layer-description",z instanceof Fa){if(z.clip&&(K.className+=" chickenpaint-layer-clipped",X.appendChild(kc("icon-level-down-alt fa-flip-horizontal"))),z.lockAlpha)ca=Pe("lock-alpha"),ca.title=U("Transparency locked"),ea.appendChild(ca)}else z instanceof $a&&(K.className+=" chickenpaint-layer-group",z.expanded?(K.className+=" chickenpaint-layer-group-expanded",X.appendChild(kc("icon-folder-open chickenpaint-layer-group-toggle"))):(K.className+=" chickenpaint-layer-group-collapsed",
X.appendChild(kc("icon-folder chickenpaint-layer-group-toggle"))));X.childNodes.length&&(X.className="chickenpaint-layer-icons",K.appendChild(X));try{z instanceof Fa&&K.appendChild(G(z)),z.mask&&K.appendChild(H(z))}catch(Ha){console.log("Failed to create layer thumb")}X=z.name&&z.name.length>0?z.name:"(unnamed "+(z instanceof $a?"group":"layer")+")";return ba.innerText=X,ba.setAttribute("title",X),ba.className="chickenpaint-layer-name",ma.innerText=U(Q.BLEND_MODE_DISPLAY_NAMES[z.blendMode])+": "+
z.alpha+"%",ma.className="chickenpaint-layer-blend",na.appendChild(ba),na.appendChild(ma),K.appendChild(na),ea.className="chickenpaint-layer-status",K.appendChild(ea),K.setAttribute("data-display-index",""+M),K}function B(M){if(M>-1){let z=p[M];M=x(M);z&&M&&m.show(z,M)}}function O(M){2===V.state?(V.layerElem.classList.remove("chickenpaint-layer-dragging"),V.dropTarget&&("inside"===V.dropTarget.direction?a.actionPerformed({action:"CPRelocateLayer",layer:V.layer,toGroup:V.dropTarget.layer,toIndex:V.dropTarget.layer.layers.length}):
a.actionPerformed({action:"CPRelocateLayer",layer:V.layer,toGroup:V.dropTarget.layer.parent,toIndex:V.dropTarget.layer.parent.indexOf(V.dropTarget.layer)+ +("over"===V.dropTarget.direction)})),V.dropTarget=null,V.state=0,w()):V.state=0;sa&&(clearTimeout(sa),sa=null);Z.releasePointerCapture(M.pointerId);Z.removeEventListener("pointermove",L);Z.removeEventListener("pointerup",O)}function T(){V.state=2;V.frameElem=document.createElement("div");V.frameElem.className="chickenpaint-layer-drag-frame";V.frameElem.style.width=
V.layerElem.offsetWidth+"px";V.frameElem.style.height=V.layerElem.offsetHeight+"px";V.dropBetweenMarkerElem=document.createElement("div");V.dropBetweenMarkerElem.className="chickenpaint-layer-drop-between-mark";V.layerElem.classList.add("chickenpaint-layer-dragging");Z.appendChild(V.frameElem)}function L(M){M=M.clientY;switch(V.state){case 3:if(Math.abs(M-V.dragY)>5)V.state=4;else break;case 4:Z.scrollTop=V.initialScrollTop+V.dragY-M;break;case 1:if(Math.abs(M-V.dragY)>5)T();else break;case 2:V.dragY=
M,w()}}function ja(M,z,K){try{let ca=M.querySelector("."+(K?"chickenpaint-layer-mask-thumbnail":"chickenpaint-layer-image-thumbnail"));ca&&ca.replaceWith(K?H(z):G(z))}catch(ca){console.log("Error rebuilding thumbnail: ",ca)}}let V={state:0,layer:null,layerElem:null,dragX:0,dragY:0,initialScrollTop:0,dropTarget:null,dropBetweenMarkerElem:null,frameElem:null},ha=document.createElement("div"),Z=document.createElement("div"),va=0,ia=!1,sa=null;for(let M of(this.buildLayers=function(){let z=(p=h.getLayersRoot().getLinearizedLayerList(!0)).map((ca,
na)=>P(na,ca)),K=document.createDocumentFragment();Z.innerHTML="";for(let ca=z.length-1;ca>=0;ca--)K.appendChild(z[ca]);Z.appendChild(K);w()},this.layerChanged=function(z){let K=p.indexOf(z),ca=x(K);!ca||z instanceof $a&&(z.expanded!=ca.classList.contains("chickenpaint-layer-group-expanded")||z.visible!=ca.classList.contains("chickenpaint-layer-visible"))?this.buildLayers():ca.replaceWith(P(K,z))},this.setRotation90=function(z){if(va!==z)for(va=z,z=0;z<p.length;z++){let K=p[z],ca=x(z);ca&&(ja(ca,
K,!1),K.mask&&ja(ca,K,!0))}},this.layerImageThumbChanged=function(z){let K=x(p.indexOf(z));K&&ja(K,z,!1)},this.layerMaskThumbChanged=function(z){let K=x(p.indexOf(z));K&&(z.mask?ja(K,z,!0):(z=K.querySelector(".chickenpaint-layer-mask-thumbnail"))&&z.remove())},this.activeLayerChanged=function(z,K){Z.querySelectorAll(".active").forEach(na=>{na.classList.remove("active")});var ca=x(p.indexOf(z));ca.classList.add("active");z=ca.querySelector(".chickenpaint-layer-image-thumbnail");ca=ca.querySelector(".chickenpaint-layer-mask-thumbnail");
z&&z.classList.toggle("active",!K);ca&&ca.classList.toggle("active",K)},this.resize=function(){b.dismissNotification();this.buildLayers()},this.getElement=function(){return ha},this.revealLayer=function(z){z=x(z);let K=z.getBoundingClientRect(),ca=Z.getBoundingClientRect();return Z.scrollTop=Math.max(Math.min(Math.max(Z.scrollTop,Z.scrollTop+K.bottom-ca.bottom),Z.scrollTop+K.top-ca.top),0),z},e.id="chickenpaint-layer-pop",ha.className="chickenpaint-layers-widget",ha.addEventListener("contextmenu",
z=>z.preventDefault(),!0),Z.className="list-group",Z.addEventListener("dblclick",function(z){0===z.button&&z.target.closest(".chickenpaint-layer-description")&&!z.target.closest("input")&&(B(F(z.target)),z.preventDefault())}),Z.addEventListener("pointerdown",function(z){let K=F(z.target.closest(".chickenpaint-layer"));if(-1!==K){let ca=p[K];if(0===z.button&&z.target.closest(".chickenpaint-layer-eye"))a.actionPerformed({action:"CPSetLayerVisibility",layer:ca,visible:!ca.visible});else if(0===z.button&&
ca instanceof $a&&z.target.closest(".chickenpaint-layer-group-toggle"))a.actionPerformed({action:"CPExpandLayerGroup",group:ca,expand:!ca.expanded});else{let na=h.getActiveLayer()!==ca;if(ia=null!==z.target.closest(".chickenpaint-layer-mask-thumbnail")||ca instanceof $a&&null!==ca.mask&&na,0===z.button&&z.shiftKey&&!z.ctrlKey&&!z.metaKey&&ia)a.actionPerformed({action:"CPSetMaskVisible",layer:ca,visible:!ca.maskVisible});else{let X,ba;(X=0===z.button||na?ia:h.isEditingMask(),ba=h.isEditingMask()!==
X,(na||ba)&&a.actionPerformed({action:"CPSetActiveLayer",layer:ca,mask:X}),X&&z.altKey)?a.actionPerformed({action:"CPToggleMaskView"}):X&&!z.shiftKey&&(z.ctrlKey||z.metaKey)?a.actionPerformed({action:"CPApplyLayerMask"}):X&&z.shiftKey&&(z.ctrlKey||z.metaKey)?a.actionPerformed({action:"CPRemoveLayerMask"}):0===z.button?("pen"===z.pointerType||"touch"===z.pointerType?(V.state=3,V.initialScrollTop=Z.scrollTop,sa&&clearTimeout(sa),sa=setTimeout(()=>{3===V.state&&(T(),V.dragY=z.clientY,w())},800)):V.state=
1,V.dropTarget=null,V.layer=ca,V.layerElem=x(K),V.dragX=z.clientX,V.dragY=z.clientY,Z.setPointerCapture(z.pointerId),Z.addEventListener("pointermove",L),Z.addEventListener("pointerup",O)):2===z.button&&!na&&(z.preventDefault(),-1!=F(z.target)&&(B(F(z.target)),z.preventDefault()))}}}}),Z.setAttribute("touch-action","none"),["ontouchstart","ontouchmove","ontouchend","ontouchcancel"]))Z.addEventListener(M,Yg);ha.appendChild(Z)},l=new Nb(0,100,!1,!1,208),f=document.createElement("select"),m=new function(){let x=
null,F="",w=document.createElement("input"),G=this;this.hide=function(){x=null;let H=w.parentNode;H&&(H.removeChild(w),H.textContent=F)};this.renameAndHide=function(){x&&x.name!==w.value&&a.actionPerformed({action:"CPSetLayerName",layer:x,name:w.value});this.hide()};this.show=function(H,P){w.value=F=(x=H).name;(H=P.querySelector(".chickenpaint-layer-name"))&&H.parentNode&&(P=H.firstChild)&&P.nodeType===Node.TEXT_NODE&&(H.removeChild(P),H.appendChild(w));w.select()};w.type="text";w.className="chickenpaint-layer-rename form-control input-sm";
w.addEventListener("keydown",function(H){H.stopPropagation()});w.addEventListener("keydown",function(H){"Enter"===H.key&&G.renameAndHide();H.stopPropagation()});w.addEventListener("keyup",function(H){"Escape"===H.key&&G.hide();H.stopPropagation()});w.addEventListener("blur",function(H){x&&G.renameAndHide()})},n=document.createElement("input"),q=document.createElement("input"),t=!1,u,v=this.setSize,A=this.setWidth,C=this.setHeight;this.setSize=function(x,F){v.call(this,x,F);this.dismissNotification();
l.resize()};this.setWidth=function(x){A.call(this,x);l.resize();k.resize()};this.setHeight=function(x){C.call(this,x);k.resize()};this.setRotation90=function(x){k.setRotation90(x)};this.dismissNotification=function(){document.querySelectorAll(".chickenpaint-layer[aria-describedby], .chickenpaint-slider[aria-describedby]").forEach(x=>{(x=zb.Popover.getInstance(x))&&x.dispose()});t&&(clearTimeout(t),t=!1)};this.showNotification=(x,F,w)=>{let G=p.indexOf(x);x=h.getActiveLayer()==x&&"opacity"==w?l.getElement():
k.revealLayer(G);this.dismissNotification();(new zb.Popover(x,{html:!1,content:F,placement:"left",trigger:"manual",fallbackPlacement:[],boundary:"window",container:b.getElement()})).show();t=setTimeout(()=>{t=!1;this.dismissNotification()},Math.max(Math.round(70*F.length),3E3))};f.className="form-control form-control-sm";f.tabIndex=-1;f.title=U("Layer blending mode");f.addEventListener("change",function(x){a.actionPerformed({action:"CPSetLayerBlendMode",blendMode:parseInt(f.value,10)});f.blur()});
window.addEventListener("keydown",x=>{f.blur()});g.appendChild(f);l.title=function(x){return U("Opacity")+": "+x+"%"};l.on("valueChange",function(x){a.actionPerformed({action:"CPSetLayerAlpha",alpha:x})});g.appendChild(l.getElement());n.id="chickenpaint-chk-sample-all-layers";n.type="checkbox";n.addEventListener("click",function(x){h.setSampleAllLayers(n.checked);document.activeElement.blur()});g.appendChild(Pf(n,U("Blend all layers")));q.id="chickenpaint-chk-lock-alpha";q.type="checkbox";q.addEventListener("click",
function(x){a.actionPerformed({action:"CPSetLayerLockAlpha",lock:q.checked});document.activeElement.blur()});g.appendChild(Pf(q,U("Lock transparency")));g.appendChild(k.getElement());u=function(){var x=[{title:"Add layer",icon:kc("icon-file"),action:"CPAddLayer"},{title:"Add group",icon:kc("icon-folder"),action:"CPAddGroup"},{title:"Merge down",icon:kc("icon-md-download"),action:"CPLayerMergeDown",require:["image-layer"]},{title:"Merge group",icon:kc("icon-md-collapse_all"),action:"CPGroupMerge",
require:["layer-group"]},{title:"Clip to the layer below",icon:kc("icon-level-down-alt fa-flip-horizontal"),action:"CPCreateClippingMask",require:"no-clipping-mask-or-is-group"},{title:"Unclip from the layer below",icon:kc("icon-level-down-alt fa-flip-horizontal"),action:"CPReleaseClippingMask",require:"clipping-mask"},{title:"Add layer mask",icon:Pe("mask"),action:"CPAddLayerMask",require:["no-mask"]},{title:"Apply mask",icon:Pe("mask"),action:"CPApplyLayerMask",require:["mask"]},{title:"Duplicate",
icon:kc("icon-clone"),action:"CPLayerDuplicate"},{title:"Delete layer mask",icon:kc("icon-trash"),action:"CPRemoveLayerMask",require:"isEditingMask"},{title:"Delete layer",icon:kc("icon-trash"),action:"CPRemoveLayer",require:"isNotEditingMask"}];let F=document.createElement("ul");for(let w of(F.className="chickenpaint-layer-buttons list-unstyled",x))x=document.createElement("li"),x.setAttribute("data-action",w.action),x.className="chickenpaint-small-toolbar-button "+(w.require?"chickenpaint-action-require-"+
w.require:""),x.title=U(w.title),x.appendChild(w.icon),x.addEventListener("click",function(){a.actionPerformed({action:w.action})}),F.appendChild(x);return F}();g.appendChild(u);h.on("changeActiveLayer",function(x,F,w){k.activeLayerChanged(F,w);c()});h.on("changeLayer",function(x){h=this;b.dismissNotification();k.layerChanged(x);c()});h.on("changeStructure",d);h.on("changeLayerMaskThumb",function(x){h=this;k.layerMaskThumbChanged(x)});h.on("changeLayerImageThumb",function(x){h=this;k.layerImageThumbChanged(x)});
a.on("layerNotification",this.showNotification.bind(this));d.call(h)}function Zg(){this.table=new Uint8Array(256);this.loadIdentity=function(){for(var a=0;a<256;a++)this.table[a]=a};this.loadBrightnessContrast=function(a,c){c=c>0?1/(1.0001-c):1+c;a=.5-.5*c+a;for(var d=0;d<256;d++)this.table[d]=Math.min(255,Math.max(~~(255*(d/255*c+a)),0))};this.invert=function(){for(var a=0;a<256;a++)this.table[a]=255-this.table[a]}}function Qf(a,c){let d=document.createElement("div"),b=document.createElement("label");
return d.className="form-check",a.className="form-check-input",b.className="form-check-label",b.setAttribute("for",a.id),b.appendChild(a),b.appendChild(document.createTextNode(c)),d.appendChild(a),d.appendChild(b),d}function de(a){function c(H){for(let P=0;P<H.length;P++){let B=new e(H[P],32,32);B.on("click",function(){n=this.texture;g()});F.appendChild(B.getElement())}}function d(H){let P=new Pa(H,H,8);for(let B=1;B<H*H;B++)P.data[B]=255;return P}function b(H){let P=2*H,B=new Pa(P,P,8);for(let O=
0;O<P;O++)for(let T=0;T<P;T++)B.data[O+T*P]=255*((~~(O/H)+~~(T/H))%2!=0);return B}function h(H,P){let B=new Pa(P,P,8);for(let O=0;O<P*P;O++)~~(O%P)>=H&&(B.data[O]=255);return B}function p(H,P){let B=new Pa(P,P,8);for(let O=0;O<P*P;O++)O/P>=H&&(B.data[O]=255);return B}function g(){if(null!=n){q=n.clone();t&&q.mirrorHorizontally();let B=new Zg;B.loadBrightnessContrast(v,A);u&&B.invert();if(1!==C){var H=q,P=C;let O=Math.max(1,Math.floor(H.width*P)),T=Math.max(1,Math.floor(H.height*P)),L=new Pa(O,T,H.bitDepth),
ja=255,V=0;for(let ha=0;ha<T;ha++)for(let Z=0;Z<O;Z++){let va=H.data[Math.floor(ha/P)*H.width+Math.floor(Z/P)];L.data[ha*O+Z]=va;va<ja&&(ja=va);va>V&&(V=va)}q=ja===V?H:L}q.applyLUT(B)}else q=null;a.getArtwork().setBrushTexture(q);null!=x&&x.updateTexture()}function e(H,P,B){let O=document.createElement("canvas"),T=O.getContext("2d"),L=this;this.setTexture=function(ja){this.texture=ja;this.paint()};this.getElement=function(){return O};this.paint=function(){null!=this.texture?T.fillStyle=T.createPattern(this.texture.getAsCanvas(),
"repeat"):T.fillStyle="white";T.fillRect(0,0,O.width,O.height)};O.addEventListener("click",function(){L.emit("click")});O.width=P;O.height=B;this.setTexture(H)}var k;let l,f,m;Sb.call(this,a,"textures","Textures");let n,q,t=!1,u=!1,v=0,A=0,C=1,x,F=document.createElement("div"),w=this.getBodyElement();e.prototype=Object.create(Ja(Ib).prototype);e.prototype.constructor=e;x=new function(){function H(){L.checked=u;ja.checked=t;V.setValue(100*v+100);ha.setValue(100*A+100);Z.setValue(100*C)}let P,B,O,T=
document.createElement("div"),L=document.createElement("input"),ja=document.createElement("input"),V=new Nb(0,200,!0),ha=new Nb(0,200,!0),Z=new Nb(50,800,!1,!0,150,3.9),va=new e(null,64,64),ia=document.createElement("button"),sa,M=new zb.Popover(ia,{html:!0,content:()=>sa,trigger:"manual",placement:"right",container:w,fallbackPlacements:[]});this.updateTexture=function(){ia.disabled=null==q;va.setTexture(q)};this.getElement=function(){return T};T.className="chickenpaint-texture-options";T.appendChild(va.getElement());
ia.type="button";ia.className="btn btn-light btn-sm";ia.setAttribute("data-bs-toggle","popover");ia.setAttribute("data-bs-placement","right");ia.textContent=U("Customize");(P=document.createElement("div")).className="chickenpaint-texture-controls";L.id="chickenpaint-chk-texture-invert";L.type="checkbox";L.addEventListener("click",function(z){u=this.checked;g()});P.appendChild(Qf(L,U("Inverse")));ja.id="chickenpaint-chk-texture-mirror";ja.type="checkbox";ja.addEventListener("click",function(z){t=this.checked;
g()});P.appendChild(Qf(ja,U("Mirror")));V.title=function(z){return U("Brightness")+": "+(z-100)+"%"};V.on("valueChange",function(z){v=(z-100)/100;g()});P.appendChild(V.getElement());ha.title=function(z){return U("Contrast")+": "+(z-100)+"%"};ha.on("valueChange",function(z){A=(z-100)/100;g()});P.appendChild(ha.getElement());Z.title=function(z){return U("Scale")+": "+z+"%"};Z.on("valueChange",function(z){C=z/100;g()});P.appendChild(Z.getElement());B=document.createElement("button");O=document.createElement("button");
B.textContent="Ok";B.className="btn btn-primary btn-sm";B.type="button";B.addEventListener("click",function(z){M.hide()});P.appendChild(B);P.appendChild(document.createTextNode(" "));O.textContent=U("Reset");O.className="btn btn-secondary btn-sm";O.type="button";O.addEventListener("click",function(z){A=v=0;C=1;u=t=!1;H();g()});P.appendChild(O);H();sa=P;ia.addEventListener("click",function(){M.toggle()});T.appendChild(ia);this.updateTexture()};w.appendChild(x.getElement());F.className="chickenpaint-texture-swatches";
w.appendChild(F);c((k=[null],(l=new Pa(2,2,8)).data[0]=255,l.data[3]=255,k.push(l),k.push(d(2)),k.push(d(3)),k.push(d(4)),k.push(d(6)),k.push(d(8)),k.push(h(1,2)),k.push(h(2,4)),k.push(p(1,2)),k.push(p(2,4)),k.push(b(2)),k.push(b(4)),k.push(b(8)),k.push(b(16)),k.push(function(){let H=new Pa(256,256,8);for(let P=0;P<65536;P++)H.data[P]=Math.max(0,Math.min(255,Math.floor((.65*Math.floor(256*Math.random())-128)*.65+128)));return H}()),k));k=a.getResourcesRoot()+"gfx/textures32.png?20241024.1";var G=
function(H){c(H)};f=new Image;m=[];f.onload=function(){var H=document.createElement("canvas");let P=H.getContext("2d",{willReadFrequently:!0});H.width=f.width;H.height=f.height;for(H=0;H<2;H++){P.drawImage(f,0,32*H,32,32,0,0,32,32);try{let B=P.getImageData(0,0,32,32),O=new Pa(32,32,8);for(let T=0;T<1024;T++)O.data[T]=B.data[4*T];m.push(O)}catch(B){console.log(B)}}G(m)};f.src=k}function ee(a){function c(v){let A=document.createElement("div"),C=document.createElement("button"),x=document.createElement("ul"),
F=document.createElement("span"),w=document.createElement("span"),G=this;this.getElement=function(){return A};this.setColor=function(P){C.setAttribute("data-color",P);var B=C.style;for(P=""+Number(P).toString(16);P.length<6;)P="0"+P;B.backgroundColor="#"+P};this.setColor(v);C.className="chickenpaint-color-swatch dropdown-toggle";F.className="dropdown-item";F.href="#";F.textContent=U("Remove");F.addEventListener("click",function(P){P.preventDefault();A.remove();f=!0});w.className="dropdown-item";w.href=
"#";w.textContent=U("Replace with current color");w.addEventListener("click",function(P){P.preventDefault();G.setColor(a.getCurColor().getRgb());f=!0});x.className="dropdown-menu";v=document.createElement("li");let H=document.createElement("li");v.appendChild(F);H.appendChild(w);x.appendChild(v);x.appendChild(H);A.className="chickenpaint-color-swatch-wrapper";A.appendChild(C);A.appendChild(x)}function d(v){v=new c(v);m.appendChild(v.getElement())}function b(v){let A=document.createElement("span");
return A.className="fa icon-"+v,A}var h;let p;let g,e,k;Sb.call(this,a,"swatches","Color swatches");var l=[16777215,0,16711680,65280,255,16776960];let f=!1,m=document.createElement("ul"),n=document.createElement("div"),q,t=this;this.getSwatches=function(){let v=m.querySelectorAll(".chickenpaint-color-swatch"),A=Array(v.length);for(let C=0;C<v.length;C++)A[C]=parseInt(v[C].getAttribute("data-color"),10);return A};this.setSwatches=function(v){for(;m.lastChild;)m.removeChild(m.lastChild);for(let A=0;A<
v.length;A++)d(v[A]);f=!0};this.isModified=function(){return f};m.className="chickenpaint-color-swatches list-unstyled";for(h=0;h<l.length;h++)m.appendChild((new c(l[h])).getElement());m.addEventListener("click",function(v){let A=v.target;/^<button data-color=/i.test(A.outerHTML)&&/chickenpaint-color-swatch/.test(A.className)&&0==v.button&&void 0!==A.getAttribute("data-color")&&(a.setCurColor(new jb(parseInt(A.getAttribute("data-color"),10))),v.stopPropagation(),v.preventDefault())});m.addEventListener("contextmenu",
function(v){let A=v.target;if(/^<button data-color=/i.test(A.outerHTML)&&/chickenpaint-color-swatch/.test(A.className)){v.preventDefault();var C=new zb.Dropdown(A);C.toggle();document.addEventListener("click",function w(F){C.hide();document.removeEventListener("click",w)})}});this.getBodyElement().appendChild(m);l=document.createElement("button");h=document.createElement("button");p=document.createElement("ul");var u=document.createElement("span");g=document.createElement("span");h.type="button";
h.title=U("Add the current brush color as a new swatch");h.className="btn chickenpaint-small-toolbar-button chickenpaint-color-swatch-add";h.appendChild(b("plus"));l.type="button";l.className="btn dropdown-toggle chickenpaint-small-toolbar-button chickenpaint-color-swatch-settings";l.setAttribute("data-bs-toggle","dropdown");l.appendChild(b("cog"));u.className="dropdown-item";u.href="#";u.textContent=U("Save swatches to your computer...");u.addEventListener("click",function(v){v.preventDefault();
v=new Blob([(new hd).write(t.getSwatches())],{type:"application/octet-stream"});Ja(Ud).saveAs(v,"oekakiswatches.aco")});g.className="dropdown-item";g.href="#";g.textContent=U("Load swatches from your computer...");g.addEventListener("click",function(v){v.preventDefault();q.onchange=function(){var A=this.files;if(!(A.length<1)){A=A[0];var C=new FileReader;C.onload=function(){let x=(new hd).read(this.result);null!=x&&x.length>0?t.setSwatches(x):alert(U("The swatches could not be read, did you select an .aco file?"))};
C.readAsArrayBuffer(A)}};q.click()});p.className="dropdown-menu";e=document.createElement("li");k=document.createElement("li");e.appendChild(u);k.appendChild(g);p.appendChild(e);p.appendChild(k);(u=document.createElement("div")).className="btn-group";u.appendChild(l);u.appendChild(p);h.addEventListener("click",function(v){d(a.getCurColor().getRgb());f=!0});n.className="chickenpaint-color-swatches-buttons";window.File&&window.FileReader&&window.FileList&&window.Blob&&((q=document.createElement("input")).type=
"file",q.multiple=!1,q.style.display="none",n.appendChild(u),n.appendChild(q));n.appendChild(h);this.getBodyElement().appendChild(n)}function fe(a){function c(){let f=g.closest(".chickenpaint").querySelector(".chickenpaint-canvas");return{width:f.offsetWidth,height:f.offsetHeight}}function d(f,m){let n=f.getElement();m?g.contains(n)||g.appendChild(n):g.contains(n)&&g.removeChild(n);e.emitEvent("paletteVisChange",[f.name,m])}let b={tool:new Zd(a),color:new be(a),swatches:new ee(a),stroke:new ae(a),
brush:new od(a),layers:new ce(a),misc:new $d(a),textures:new de(a)},h={tool:!1,color:!1,misc:!1};var p={color:!0,textures:!0,layers:!0};let g=document.createElement("div"),e=this,k=[],l=[];for(let f in this.palettes=b,this.showPaletteByName=function(m,n){(m=b[m])&&d(m,n)},this.togglePalettes=function(){let m=a.mainGUI.getMainMenu().getElement().querySelector('.widget-nav [data-action="CPTogglePalettes"]');if(0===l.length)g.querySelectorAll(".chickenpaint-palette").forEach(function(n){e.showPaletteByName(n.getAttribute("data-paletteName"),
!1);l.push(n)}),m.classList.remove("selected");else{for(let n=0;n<l.length;n++)e.showPaletteByName(l[n].getAttribute("data-paletteName"),!0);l=[];m.classList.add("selected")}},this.updateDeselectIcon=function(){let m=a.mainGUI.getMainMenu().getElement().querySelector(".deselectIcon");var n=b.brush.getElement();let q=n.querySelector(".icon-md-deselect");n=n.querySelector(".deselectButton");m&&q&&n&&(a.artwork.getSelection().isEmpty()?(m.style.color="",q.style.color="",n.style.boxShadow=""):(m.style.color=
"rgb(49, 130, 216)",q.style.color="rgb(49, 130, 216)",n.style.boxShadow="0 0 1px 1px rgb(49, 130, 216)"))},this.constrainPalettes=function(){let m=c();for(var n in b){let q=b[n];q.getX()+q.getWidth()/2>m.width&&q.setLocation(m.width-q.getWidth(),q.getY());q.getY()+q.getHeight()/2>m.height&&q.setLocation(q.getX(),m.height-q.getHeight())}n=m.width-b.tool.getWidth()-b.misc.getWidth()-b.stroke.getWidth()-b.color.getWidth()-b.brush.getWidth()-15>0;b.swatches.getX()+b.swatches.getWidth()==b.brush.getX()+
b.brush.getWidth()&&20>Math.abs(b.swatches.getY()-b.brush.getY())&&b.swatches.setLocation(b.brush.getX()-b.swatches.getWidth()-(n?5:1),0);b.layers.getY()+b.layers.getHeight()>m.height&&b.layers.setHeight(Math.max(m.height-b.layers.getY(),200))},this.arrangePalettes=function(){let m=c();var n=a.getSmallScreenMode();var q=a.mainGUI.getMainMenu().getElement(),t=q.querySelector('.dropdown-item[data-action="CPToggleSetSmallScreenMode"]');t&&(n?t.classList.add("selected"):t.classList.remove("selected"));
if(q=q.querySelector('.widget-nav [data-action="CPToggleSetSmallScreenMode"]'))q.className="widget-toggler mobile selected",q.dataset.checkbox="true",q.type="button",q.classList.add("selected"),q.dataset.selected="true",q.textContent="",t=document.createElement("span"),t.textContent=n?U("PC mode"):U("Mobile mode"),q.appendChild(t);n?(b.tool.setLocation(0,0),b.misc.setLocation(b.tool.getX()+b.tool.getWidth()+1,0),n=m.width-(b.tool.getWidth()+b.misc.getWidth()+b.brush.getWidth())<=16?b.misc.getY()+
b.misc.getHeight()+1:0,b.brush.setLocation(m.width-b.brush.getWidth()-15,n),b.textures.setWidth(m.width-b.textures.getX()),b.layers.setLocation(b.brush.getX()+b.brush.getWidth()-b.layers.getWidth(),b.textures.getY()-b.layers.getHeight()),n=Math.max(b.textures.getY()-330-1,370),b.layers.setHeight(n),b.layers.setWidth(218),b.stroke.setLocation(b.misc.getX(),b.misc.getY()+b.misc.getHeight()+1),b.swatches.setLocation(b.stroke.getX(),b.stroke.getY()+b.stroke.getHeight()+1)):(n=m.width-b.tool.getWidth()-
b.misc.getWidth()-b.stroke.getWidth()-b.color.getWidth()-b.brush.getWidth()-15>0,b.brush.setLocation(m.width-b.brush.getWidth()-15,0),q=b.brush.getY()+b.brush.getHeight(),q=m.height-q>300?q+2:q,b.layers.setSize(b.brush.getWidth()+30*!!n,m.height-q),b.layers.setLocation(b.brush.getX()+b.brush.getWidth()-b.layers.getWidth(),q),b.tool.setLocation(0,0),b.misc.setLocation(b.tool.getX()+b.tool.getWidth()+(n?5:1),0),n?b.stroke.setLocation(b.misc.getX()+b.misc.getWidth()+(n?5:1),0):b.stroke.setLocation(b.misc.getX(),
b.misc.getY()+b.misc.getHeight()+1),b.swatches.setLocation(Math.max(b.brush.getX()-b.swatches.getWidth()-(n?5:1),b.tool.getX()+b.tool.getWidth()),0),b.textures.setWidth(Math.min(b.layers.getX()-b.textures.getX(),490)));b.textures.setLocation(b.color.getX()+b.color.getWidth()+4,m.height-b.textures.getHeight());b.color.setLocation(0,Math.max(b.tool.getY()+b.tool.getHeight(),m.height-b.color.getHeight()))},a.on("smallScreen",function(m){for(let n in b)b[n].toggleCollapse(m&&(!(n in h)||h[n]))}),this.getElement=
function(){return g},g.className="chickenpaint-palettes",b){let m=b[f],n=m.getElement();m.on("paletteVisChange",function(){d(this,!1)});f in p&&m.setCollapseDownwards(!0);n.setAttribute("data-paletteName",f);k.push(n)}for(let f in b)p=b[f].getElement(),g.appendChild(p)}function $g(a,c){function d(e){let k,l=e.dataset.action,f="true"===e.dataset.checkbox;a.isActionAllowed(l)&&(f?(e.classList.toggle("selected"),k=e.classList.contains("selected")):k=!1,a.actionPerformed({action:l,checkbox:f,selected:k}))}
let b=document.createElement("nav");b.className="navbar navbar-expand-md bg-light";b.innerHTML='\n    <div class="navbar-upper">\n      <span class="navbar-brand">litaChix</span>\n      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#chickenpaint-main-menu-content" aria-controls="chickenpaint-main-menu-content" aria-expanded="false" aria-label="Toggle main menu">\n        <span class="navbar-toggler-icon"></span>\n      </button>\n    </div>\n    <div class="collapse navbar-collapse" id="chickenpaint-main-menu-content">\n      <div class="navbar-nav"></div>\n    </div>\n    <div class="widget-nav" id="chickenpaint-palette-toggler-content"></div>\n  ';
let h=navigator.userAgent.toLowerCase().includes("mac os");b.addEventListener("touchmove",e=>e.preventDefault(),{passive:!1});b.addEventListener("click",e=>{let k=e.target.closest("[data-action]");k&&(d(k),e.preventDefault())});var p=b.querySelector(".navbar-nav");Rf.forEach(e=>{function k(){setTimeout(()=>{let q=document.activeElement;q instanceof HTMLElement&&(q.matches('[data-bs-toggle="dropdown"]')||q.matches(".dropdown-item")||q.closest(".dropdown-menu"))&&q.blur()},10)}var l,f;let m=document.createElement("div");
m.className="nav-item dropdown";m.innerHTML=`
        <span class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">${U(e.name)}</span>
        <ul class="dropdown-menu"></ul>
      `;let n=m.querySelector(".dropdown-menu");null==(l=m.querySelector(".dropdown-toggle"))||l.addEventListener("show.bs.dropdown",()=>{let q,t;k();m.querySelectorAll("[data-action]").forEach(u=>{let v=a.isActionAllowed(u.dataset.action);u.classList.toggle("disabled",!v);"true"===u.dataset.hideIfNotAvailable&&u.classList.toggle("hidden",!v)});m.querySelectorAll(".dropdown-divider").forEach(u=>u.classList.remove("hidden"));q=Array.from(m.querySelectorAll(".dropdown-item:not(.hidden), .dropdown-divider:not(.hidden)"));
t=null;q.forEach((u,v)=>{u.classList.contains("dropdown-divider")?0===v||t?u.classList.add("hidden"):t=u:t=null});t&&t.classList.add("hidden")});null==(f=m.querySelector(".dropdown-toggle"))||f.addEventListener("hide.bs.dropdown",()=>{k()});e.children.forEach(q=>{let t;if("-"===q.name)q=document.createElement("hr"),q.className="dropdown-divider",null==n||n.appendChild(q);else if(q.action&&a.isActionSupported(q.action)){if("CPSend"===q.action&&!a.isActionSupported("CPContinue")){var u=document.createElement("hr");
u.className="dropdown-divider";null==n||n.appendChild(u);q.name=U("Post Oekaki");q.shortcut="ctrl+p"}if((t=document.createElement("span")).className="dropdown-item",t.dataset.action=q.action,t.innerHTML=`<span>${U(q.name)}</span>`,q.checkbox&&(t.dataset.checkbox="true",q.checked&&t.classList.add("selected")),q.hideIfNotAvailable&&(t.dataset.hideIfNotAvailable="true"),q.title&&(t.title=U(q.title)),q.shortcut){h&&(q.shortcut=q.shortcut.replace(/SHIFT/im,"\u21e7").replace(/ALT/im,"\u2325").replace(/CTRL/im,
"\u2318"));let v=document.createElement("small");v.className="chickenpaint-shortcut";u=(u=q.shortcut).toUpperCase().replace(/(,.+)$/,"").replace("=","+");v.textContent=h?u.replace(/([^+])\+/g,"$1"):u.replace(/([^+])\+/g,"$1 ");t.appendChild(v);Ja(Va)(q.shortcut,A=>(d(t),A.preventDefault(),A.stopPropagation(),!1))}q=document.createElement("li");q.appendChild(t);n.appendChild(q)}});p.appendChild(m)});(function(e,k){if(k.filter(l=>l.mnemonic&&a.isActionSupported(l.action)).forEach(l=>{let f=document.createElement("button");
f.className="widget-toggler selected";f.type="button";f.dataset.action=l.action;f.dataset.checkbox="true";f.dataset.selected=(!l.checked).toString();let m=document.createElement("span");m.textContent=l.mnemonic;f.appendChild(m);e.appendChild(f)}),"force"===a.fullScreenModeOptions()){let l=document.createElement("span");l.textContent="";l.className="upperIcon clear icon-md-crop_free";l.style.fontSize="25px";l.style.verticalAlign="bottom";l.title=U("Full-screen mode");l.dataset.action="CPArrangePalettes";
l.addEventListener("click",f=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()});e.appendChild(l);document.addEventListener("fullscreenchange",()=>{c.resize();requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{d(l);d(l);d(l)})})})})}if(k=k.find(l=>"CPToggleSetSmallScreenMode"===l.action)){let l=a.getSmallScreenMode(),f=document.createElement("button");f.className="widget-toggler mobile selected";f.dataset.checkbox="true";
f.type="button";f.dataset.selected="true";f.style.minWidth="110px";f.textContent="";let m=document.createElement("span");m.textContent=l?U("PC mode"):U("Mobile mode");f.appendChild(m);f.dataset.action=k.action;e.appendChild(f)}k=document.createElement("span");k.textContent="";k.className="upperIcon clear icon-md-remove_selection";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.title=U("Clear");k.dataset.action="CPClear";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className=
"upperIcon fill icon-md-ink_selection";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.title=U("Fill");k.dataset.action="CPFill";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className="upperIcon transform icon-md-resize";k.style.fontSize="25px";k.style.verticalAlign="bottom";k.title=U("Transform");k.dataset.action="CPTransform";e.appendChild(k);k=document.createElement("span");k.textContent="";k.className="upperIcon deselectIcon icon-md-deselect";k.style.fontSize=
"25px";k.style.verticalAlign="bottom";k.dataset.action="CPDeselectAll";k.title=U("Deselect");e.appendChild(k)})(b.querySelector(".widget-nav"),Rf[5].children);c.getPaletteManager().on("paletteVisChange",function(e,k){e="CPPal"+e.charAt(0).toUpperCase()+e.slice(1);[...((null==b?void 0:b.querySelectorAll(`[data-action="${e}"]`))||[])].forEach(l=>{l.classList.toggle("selected",k)})});let g=b.querySelector(".dropdown-item[data-action=CPFullScreen]");a.on("fullScreen",e=>null==g?void 0:g.classList.toggle("selected",
e));null==g||g.classList.toggle("selected",a.isFullScreen());this.getElement=()=>b}function ge(a,c){let d=document.createElement("div"),b=new Wd(a),h=new fe(a),p,g=!1,e=this;this.togglePalettes=function(){h.togglePalettes()};this.arrangePalettes=function(){setTimeout(h.arrangePalettes.bind(h),0)};this.constrainPalettes=function(){h.constrainPalettes()};this.showPalette=function(m,n){h.showPaletteByName(m,n)};this.getSwatches=function(){return h.palettes.swatches.getSwatches()};this.setSwatches=function(m){h.palettes.swatches.setSwatches(m)};
this.getPaletteManager=function(){return h};this.setRotation90=function(m){b.setRotation(m*Math.PI/2);h.palettes.layers.setRotation90(m)};this.setFullScreenMode=function(m){g!==m&&(g=m,e.resize(),e.arrangePalettes())};this.resize=function(m=!0){let n=window.innerHeight,q=p.getElement().getBoundingClientRect().height;b.resize(g?n-q:Math.min(Math.max(n-q-65,500),850),!1);m&&e.constrainPalettes()};p=new $g(a,this);this.getMainMenu=function(){return p};c.appendChild(p.getElement());d.className="chickenpaint-main-section";
d.appendChild(b.getElement());d.appendChild(h.getElement());c.appendChild(d);b.on("canvasRotated90",function(m){h.palettes.layers.setRotation90(m)});screen.orientation&&screen.orientation.addEventListener("change",m=>{this.resize();requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{a.actionPerformed({action:"CPArrangePalettes"});a.actionPerformed({action:"CPArrangePalettes"});a.actionPerformed({action:"CPArrangePalettes"})})})})});let k=document.getElementById("chickenpaint-main-menu-content");
if(document.addEventListener("show.bs.modal",()=>{k&&k.classList.contains("show")&&(new zb.Collapse(k,{toggle:!1})).hide()}),k){let m=document.querySelector(".chickenpaint .widget-nav");m&&(k.addEventListener("show.bs.collapse",n=>{m.classList.add("hidden")}),k.addEventListener("hidden.bs.collapse",n=>{m.classList.remove("hidden")}));window.addEventListener("resize",()=>{null==m||m.classList.remove("hidden")})}document.addEventListener("hidden.bs.collapse",this.resize.bind(this));window.addEventListener("resize",
this.resize.bind(this));let l=null,f=!1;(new ResizeObserver(()=>{let m=window.innerWidth>document.documentElement.clientWidth;m!==l&&(l=m,f||(f=!0,requestAnimationFrame(()=>{f=!1;this.resize(!1)})))})).observe(document.body);a.on("fullScreen",m=>this.setFullScreenMode(m));a.on("unsavedChanges",m=>{c.classList.toggle("chickenpaint-unsaved",m)});setTimeout(this.resize.bind(this),0)}function ah(a){var c=document.createElement("div");c.classList.add("modal","fade","chickenpaint-about-dialog");c.setAttribute("tabindex",
"-1");c.setAttribute("role","dialog");c.innerHTML='\n        <div class="modal-dialog">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title">About litaChix</h5>\n                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <a class="chickenpaint-on-github" target="_blank" href="https://github.com/satopian/ChickenPaint_Be" rel="noopener">\n                        <span class="icon-github"></span> litaChix on GitHub\n                    </a>\n                    <p>\n                        litaChix is a customized version of <a href="https://github.com/thenickdude/chickenpaint" target="_blank" rel="noopener">ChickenPaint</a> by satopian.\n                    </p>\n                    <p>\n                        Built on: 2026-02-15T12:40:07<br>\n                        <a href="https://www.gnu.org/licenses/" target="_blank" rel="noopener">GNU General Public License</a><br>\n                    </p>\n                    <a class="chickenpaint-on-github" target="_blank" href="https://github.com/thenickdude/chickenpaint" rel="noopener">\n                        <span class="icon-github"></span> ChickenPaint on GitHub\n                    </a>\n\n                    <p>\n                        ChickenPaint is a translation of <a href="https://github.com/thenickdude/chibipaint" target="_blank" rel="noopener">ChibiPaint</a>\n                        from Java to JavaScript by Nicholas Sherlock / Chicken Smoothie\n                    </p>\n                    <p>\n                        ChibiPaint is Copyright (c) 2006-2008 Marc Schefer. All Rights Reserved\n                    </p>\n                    <p>\n                        ChickenPaint is free software: you can redistribute it and/or modify\n                        it under the terms of the GNU General Public License as published by\n                        the Free Software Foundation, either version 3 of the License, or\n                        (at your option) any later version.\n                    </p>\n                    <p>\n                        ChickenPaint is distributed in the hope that it will be useful,\n                        but WITHOUT ANY WARRANTY; without even the implied warranty of\n                        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n                        <a target="_blank" href="https://www.gnu.org/licenses/" rel="noopener">GNU General Public License</a> for more details.\n                    </p>\n<pre class="pre-scrollable chickenpaint-third-party-licenses">Toolbar icons designed by <a target="_blank" href="https://github.com/Anteira" rel="noopener">Miglena Lapavicheva (Anteira)</a>\n    These icons are dual-licensed under <a target="_blank" href="https://spdx.org/licenses/GPL-3.0-or-later.html" rel="noopener">GPL-3.0-or-later</a> and <a target="_blank" href="https://creativecommons.org/licenses/by/3.0/" rel="noopener">CC-BY-3.0</a>\n\nIncludes these MIT-licensed libraries:\n\n    Includes the <a target="_blank" href="https://github.com/eligrey/FileSaver.js" rel="noopener">FileSaver.js</a> library\n    Copyright (c) 2016 <a target="_blank" href="https://eligrey.com/" rel="noopener">Eli Grey</a>\n\n    Includes the <a target="_blank" href="https://github.com/101arrowz/fflate" rel="noopener">fflate</a> library\n    Copyright (c) 2023 Arjun Barrett  \n\n    Includes the <a target="_blank" href="https://github.com/madrobby/keymaster" rel="noopener">keymaster.js</a> library\n    Copyright (c) 2011-2013 Thomas Fuchs\n\n    Includes the <a target="_blank" href="https://benalman.com/projects/jquery-throttle-debounce-plugin/" rel="noopener">jQuery throttle-debounce</a> library\n    Copyright (c) 2010 "Cowboy" Ben Alman\n    \n    Includes the <a target="_blank" href="https://github.com/Stuk/jszip/" rel="noopener">JSZip</a> library\n    Copyright (c) 2009-2016\n    Stuart Knightley,\n    David Duponchel,\n    Franz Buchinger,\n    Ant\u00f3nio Afonso\n\n    Includes the <a href="https://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a> library\n    Copyright (c) 2011-2025 <a href="https://github.com/twbs/bootstrap/blob/main/LICENSE" target="_blank" rel="noopener">The Bootstrap Authors</a>\n\n    MIT License\n\n    Permission is hereby granted, free of charge, to any person\n    obtaining a copy of this software and associated documentation\n    files (the "Software"), to deal in the Software without\n    restriction, including without limitation the rights to use,\n    copy, modify, merge, publish, distribute, sublicense, and/or\n    sell copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following\n    conditions:\n\n    The above copyright notice and this permission notice shall be\n    included in all copies or substantial portions of the Software.\n\n    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,\n    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT \n    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n    OTHER DEALINGS IN THE SOFTWARE.\n\nIncludes Font Awesome by Fonticons, Inc. - <a href="https://fontawesome.com/" target="_blank" rel="noopener">https://fontawesome.com/</a>\nIncludes Material Design icons by Google - <a href="https://fonts.google.com/" target="_blank" rel="noopener">https://fonts.google.com/</a>\n                    </pre>\n                </div>\n            </div>\n        </div>\n    ';
a.appendChild(c);var d=new zb.Modal(c);return c.addEventListener("hidden.bs.modal",()=>{c.remove()}),{show:function(){d.show()}}}function he(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Complete transform")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>
                        ${U("You need to finish transforming this layer before you can do that. What would you like to do with the transform?")}
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light chickenpaint-cancel-transform">${U("Cancel")}</button>
                    <button type="button" class="btn btn-light chickenpaint-reject-transform">${U("Undo transform")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-accept-transform">${U("Apply transform")}</button>
                </div>
            </div>
        </div>
    `;let b=this,h=d.querySelector(".chickenpaint-accept-transform"),p=d.querySelector(".chickenpaint-reject-transform"),g=d.querySelector(".chickenpaint-cancel-transform"),e=new zb.Modal(d);null==h||h.addEventListener("click",function(k){c.actionPerformed({action:"CPTransformAccept"});b.emitEvent("accept")});null==p||p.addEventListener("click",function(k){c.actionPerformed({action:"CPTransformReject"});b.emitEvent("reject")});null==g||g.addEventListener("click",function(k){e.hide()});this.show=function(){e.show()};
this.hide=function(){e.hide()};d.addEventListener("hidden.bs.modal",k=>{d.remove()});a.addEventListener("keydown",function f(l){"Enter"===l.key&&(e.hide(),c.actionPerformed({action:"CPTransformAccept"}),b.emitEvent("accept"),a.removeEventListener("keydown",f))});a.appendChild(d)}function bh(a){let c=document.createElement("div");c.classList.add("modal","fade","chickenpaint-shortcuts-dialog");c.tabIndex=-1;c.role="dialog";c.innerHTML=`
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Shortcuts")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>${U("Many of the menu options and painting tools have keyboard shortcuts which are written next to them or appear when you hover.")}</p>
                    <p>${U("Here are some other shortcuts which are not as obvious!")}</p>
                    <div class="chickenpaint-shortcuts-sections">
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${U("Color swatches palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Use as the drawing color")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${U("Right")}</span></dt>
                                        <dd>${U("Remove or replace a color swatch")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${U("Line drawing mode")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Snap line to nearest 45 degrees")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${U("Painting tools")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">1</span> - <span class="chickenpaint-shortcut-key">9</span>, <span class="chickenpaint-shortcut-key">0</span></span></dt>
                                        <dd>${U("Change brush opacity")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">[</span>, <span class="chickenpaint-shortcut-key">]</span></span><span class="chickenpaint-shortcut-alternate">${U("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Qe}</span> +
                                        <span class="chickenpaint-shortcut-key">${Re}</span> +  <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Change brush size")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${U("Brush palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${U("Right")}</span><span class="chickenpaint-shortcut-alternate">${U("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Adjust brush sliders more precisely")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${U("Zoom")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${ch}</span>  + <span class="chickenpaint-shortcut-key">Space</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span><dt>
                                        <dt><span class="chickenpaint-shortcut-alternate">${U("or")}</span>
                                        <span class="chickenpaint-shortcut-key">Z</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Zoom the canvas")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${U("Drawing canvas")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${U("Middle")}</span> <span class="chickenpaint-shortcut-alternate">${U("or")}</span> <span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Space</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Move the canvas around")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">R</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Rotate the canvas")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${U("Right")}</span><span class="chickenpaint-shortcut-alternate">${U("or")}</span><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Re}</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Sample the color under the cursor")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">H</span></dt>
                                        <dd>${U("Flip View Horizontal")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                        <div class="chickenpaint-shortcuts-section">
                            <h5>${U("Layers palette")}</h5>
                            <ul class="chickenpaint-shortcuts-list list-unstyled">
                                <li>
                                    <dl>
                                        <dt><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${U("Double click")}</span><span class="chickenpaint-shortcut-alternate">${U("or")}</span><span class="chickenpaint-shortcut"><span class="fa icon-mouse-pointer"></span> ${U("Right")}</span></dt>
                                        <dd>${U("Rename layer")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Toggle mask enable/disable")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Re}</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Toggle mask View")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">${Qe}</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Apply layer mask")}</dd>
                                        <dt><span class="chickenpaint-shortcut"><span class="chickenpaint-shortcut-key">Shift</span> + <span class="chickenpaint-shortcut-key">${Qe}</span> + <span class="fa icon-mouse-pointer"></span> ${U("Left")}</span></dt>
                                        <dd>${U("Delete layer mask")}</dd>
                                    </dl>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;c.querySelector(".btn-close").addEventListener("click",()=>{c.remove()});let d=new zb.Modal(c);a.appendChild(c);this.show=function(){d.show()}}function dh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Box blur")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${U("Blur amount")} (1px~200px)</label>
                            <input type="number" class="form-control chickenpaint-blur-amount" value="3" min="1" max="200">
                        </div>
                        <div class="form-group">
                            <label>${U("Iterations (1~8, larger gives smoother blur)")}</label>
                            <input type="number" class="form-control chickenpaint-blur-iterations" value="1" min="1" max="8">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${U("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${U("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-box-blur" data-bs-dismiss="modal">${U("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-blur-amount"),h=d.querySelector(".chickenpaint-blur-iterations"),p=d.querySelector(".chickenpaint-apply-box-blur"),g=new zb.Modal(d);this.show=function(){let e=document.getElementById("chickenpaint-main-menu-content");e&&e.classList.contains("show")&&(new zb.Collapse(e,{toggle:!1})).hide();c.setModalShown(!0);g.show()};p.addEventListener("click",e=>{var k;e=Math.min(200,Math.max(1,parseInt(null==b?void 0:b.value,10)||1));let l=Math.min(Math.max(parseInt(null==
h?void 0:h.value,10),1),8),f=null==(k=d.querySelector("#createMergedLayer"))?void 0:k.checked;c.getArtwork().boxBlur(e,e,l,f);c.setModalShown(!1);g.hide()});d.addEventListener("hidden.bs.modal",()=>{document.activeElement.blur();d.remove()});d.addEventListener("shown.bs.modal",()=>{b.focus()});d.addEventListener("keydown",e=>{"Enter"===e.key&&d.classList.contains("show")&&(p.click(),e.preventDefault())});a.appendChild(d)}function eh(a){let c=document.createElement("div");c.classList.add("modal","fade");
c.setAttribute("tabindex","-1");c.setAttribute("role","dialog");c.innerHTML='\n        <div class="modal-dialog" role="document">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title">Drawing tablet support</h5>\n                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n                </div>\n                <div class="modal-body">\n                    <div class="chickenpaint-tablet-support chickenpaint-pointerevents-support">\n                        <h5>\n                            Built-in support for most tablets.\n                            <small>macOS, Windows 10 or newer</small>\n                        </h5>\n                        <div class="chickenpaint-supported-browsers">\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-chrome"></span>\n                                Chrome\n                            </div>\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-edge"></span>\n                                Edge (Windows 10)\n                            </div>\n                            <div class="chickenpaint-supported-browser">\n                                <span class="icon-firefox"></span>\n                                Firefox\n                            </div>\n                        </div>\n                        <p class="chickenpaint-not-supported">\n                            Your browser doesn\'t have built-in support for drawing tablets, please try\n                            one of the other browsers listed above.\n                        </p>\n                        <p class="chickenpaint-supported alert alert-success">\n                            Your browser has built-in support for drawing tablets!\n                        </p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ';
let d=c.querySelector(".chickenpaint-pointerevents-support"),b=!!window.PointerEvent;null==d||d.classList.toggle("supported",b);null==d||d.classList.toggle("not-supported",!b);c.addEventListener("hidden.bs.modal",p=>{c.remove()});let h=new zb.Modal(c);a.appendChild(c);this.show=function(){h.show()}}function fh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Grid options")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${U("Grid size")}</label>
                            <input type="number" class="form-control chickenpaint-grid-size" value="" min="3">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${U("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-grid-settings" data-bs-dismiss="modal">${U("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-grid-size"),h=d.querySelector(".chickenpaint-apply-grid-settings"),p=new zb.Modal(d);this.show=function(){let g=document.getElementById("chickenpaint-main-menu-content");g&&g.classList.contains("show")&&(new zb.Collapse(g,{toggle:!1})).hide();p.show()};b.value=c.getGridSize();d.addEventListener("hidden.bs.modal",()=>{d.remove()});h.addEventListener("click",()=>{let g=parseInt(b.value,10);c.setGridSize(g);c.setModalShown(!1);p.hide()});d.addEventListener("shown.bs.modal",
()=>{c.setModalShown(!0);b.focus()});d.addEventListener("keydown",g=>{"Enter"===g.key&&(g.preventDefault(),h.click())});a.appendChild(d)}function gh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Chromatic aberration")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${U("Offset X")} (-64px ~ 64px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-offset-x" value="" min="-64", max="64">
                        </div>
                        <div class="form-group">
                            <label>${U("Offset Y")} (-64px ~ 64px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-offset-y" value="" min="-64", max="64">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer" checked="checked">
                    <label class="form-check-label" for="createMergedLayer">
                    ${U("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${U("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${U("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-aberration-offset-x"),h=d.querySelector(".chickenpaint-aberration-offset-y"),p=d.querySelector(".chickenpaint-apply-aberration-settings"),g=new zb.Modal(d);this.show=function(){let e=document.getElementById("chickenpaint-main-menu-content");e&&e.classList.contains("show")&&(new zb.Collapse(e,{toggle:!1})).hide();g.show()};b.value=3;h.value=3;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==p||p.addEventListener("click",()=>{var e;let k=Math.max(-64,
Math.min(64,parseInt(null==b?void 0:b.value,10)||0)),l=Math.max(-64,Math.min(64,parseInt(null==h?void 0:h.value,10)||0)),f=null==(e=d.querySelector("#createMergedLayer"))?void 0:e.checked;c.getArtwork().chromaticAberration(k,l,f);c.setModalShown(!1);g.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),null==p||p.click())});a.appendChild(d)}function hh(a,c){let d=document.createElement("div");
d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Color halftone")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${U("Dot size")} (5px ~ 512px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-dot-size" value="" min="5", max="512">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer" checked="checked">
                    <label class="form-check-label" for="createMergedLayer">
                    ${U("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${U("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${U("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-aberration-dot-size"),h=d.querySelector(".chickenpaint-apply-aberration-settings"),p=new zb.Modal(d);this.show=function(){let g=document.getElementById("chickenpaint-main-menu-content");g&&g.classList.contains("show")&&(new zb.Collapse(g,{toggle:!1})).hide();p.show()};b.value=15;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==h||h.addEventListener("click",()=>{var g;let e=Math.max(5,Math.min(512,parseInt(null==b?void 0:b.value,10)||0)),k=null==
(g=d.querySelector("#createMergedLayer"))?void 0:g.checked;c.getArtwork().colorHalftone(e,k);c.setModalShown(!1);p.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",g=>{"Enter"===g.key&&(g.preventDefault(),null==h||h.click())});a.appendChild(d)}function ih(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Mono halftone")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${U("Dot size")} (5px ~ 512px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-dot-size" value="" min="5", max="512">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${U("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${U("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${U("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-aberration-dot-size"),h=d.querySelector(".chickenpaint-apply-aberration-settings"),p=new zb.Modal(d);this.show=function(){let g=document.getElementById("chickenpaint-main-menu-content");g&&g.classList.contains("show")&&(new zb.Collapse(g,{toggle:!1})).hide();p.show()};b.value=15;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==h||h.addEventListener("click",()=>{var g;let e=Math.max(5,Math.min(512,parseInt(null==b?void 0:b.value,10)||0)),k=null==
(g=d.querySelector("#createMergedLayer"))?void 0:g.checked;c.getArtwork().monoHalftone(e,k);c.setModalShown(!1);p.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",g=>{"Enter"===g.key&&(g.preventDefault(),null==h||h.click())});a.appendChild(d)}function jh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Mosaic")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${U("Block size")} (2px~2000px)</label>
                            <input type="number" class="form-control chickenpaint-block-size" value="" min="2", max="2000">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="createMergedLayer">
                    <label class="form-check-label" for="createMergedLayer">
                    ${U("Apply to all (create merged layer)")}
                    </label>
                    </div>
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${U("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${U("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-block-size"),h=d.querySelector(".chickenpaint-apply-aberration-settings"),p=new zb.Modal(d);this.show=function(){let g=document.getElementById("chickenpaint-main-menu-content");g&&g.classList.contains("show")&&(new zb.Collapse(g,{toggle:!1})).hide();p.show()};b.value=6;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==h||h.addEventListener("click",()=>{var g;let e=parseInt(null==b?void 0:b.value,10);e=Math.max(2,Math.min(2E3,e||1));let k=null==
(g=d.querySelector("#createMergedLayer"))?void 0:g.checked;c.getArtwork().mosaic(e,k);c.setModalShown(!1);p.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",g=>{"Enter"===g.key&&(g.preventDefault(),null==h||h.click())});a.appendChild(d)}function kh(a,c){let d=document.createElement("div");d.classList.add("modal","fade");d.setAttribute("tabindex","-1");d.setAttribute("role","dialog");d.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Edge expand")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group">
                            <label>${U("Edge expand width")} (1px ~ 128px)</label>
                            <input type="number" class="form-control chickenpaint-aberration-edgeWidth" value="" min="1", max="128">
                        </div>
                    </form>
                    <div class="form-check mt-3">
                    <input class="form-check-input" type="checkbox" id="replaceWithInnerFill">
                    <label class="form-check-label" for="replaceWithInnerFill">
                    ${U("Fill Inside with edge color")}
                    </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">${U("Cancel")}</button>
                    <button type="button" class="btn btn-primary chickenpaint-apply-aberration-settings" data-bs-dismiss="modal">${U("Ok")}</button>
                </div>
            </div>
        </div>
    `;let b=d.querySelector(".chickenpaint-aberration-edgeWidth"),h=d.querySelector(".chickenpaint-apply-aberration-settings"),p=new zb.Modal(d);this.show=function(){let g=document.getElementById("chickenpaint-main-menu-content");g&&g.classList.contains("show")&&(new zb.Collapse(g,{toggle:!1})).hide();p.show()};b.value=5;d.addEventListener("hidden.bs.modal",()=>{d.remove()});null==h||h.addEventListener("click",()=>{var g;let e=Math.max(1,Math.min(128,parseInt(null==b?void 0:b.value,10)||0)),k=null==
(g=d.querySelector("#replaceWithInnerFill"))?void 0:g.checked;c.getArtwork().edge(e,k);c.setModalShown(!1);p.hide()});d.addEventListener("shown.bs.modal",()=>{c.setModalShown(!0);null==b||b.focus()});d.addEventListener("keydown",g=>{"Enter"===g.key&&(g.preventDefault(),null==h||h.click())});a.appendChild(d)}function ie(a,c,d){let b=document.createElement("div");b.className="modal fade chickenpaint-send-dialog";b.tabIndex=-1;b.setAttribute("role","dialog");b.innerHTML=`
        <div class="modal-dialog">
            <div class="modal-content" data-stage="saving">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Saving drawing...")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="chickenpaint-saving-progress-message">${U("Preparing your drawing to be saved, please wait...")}</p>
                    <pre class="chickenpaint-saving-error-message pre-scrollable" style="display: none;"></pre>
                    <div class="progress">
                        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light chickenpaint-send-cancel" data-bs-dismiss="modal">${U("Cancel")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-not-previously-posted" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <p>${U("Your drawing has been saved, would you like to post it to the forum now?")}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary chickenpaint-post-drawing" data-bs-dismiss="modal">${U("Yes, post it now")}</button>
                    <button type="button" class="btn btn-light chickenpaint-continue-drawing" data-bs-dismiss="modal">${U("No, keep drawing")}</button>
                    <button type="button" class="btn btn-light chickenpaint-exit" data-bs-dismiss="modal">${U("No, quit and I'll finish it later")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-already-posted" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <p>${U("Your drawing has been saved, would you like to view it on the forum now?")}</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary chickenpaint-post-drawing" data-bs-dismiss="modal">${U("Yes, view the post")}</button>
                    <button type="button" class="btn btn-light chickenpaint-continue-drawing" data-bs-dismiss="modal">${U("No, keep drawing")}</button>
                </div>
            </div>
            <div class="modal-content" data-stage="success-redirect" style="display:none">
                <div class="modal-header">
                    <h5 class="modal-title">${U("Drawing saved!")}</h5>
                    <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>${U("Your drawing has been saved, redirecting you to view your new post now...")}</p>
                </div>
            </div>
        </div>
    `;let h=b.querySelector(".chickenpaint-saving-progress-message"),p=b.querySelector(".chickenpaint-saving-error-message"),g=b.querySelector(".progress-bar"),e=new zb.Modal(b),k=this;d.on("savingProgress",function(f,m){h.textContent=m;g.setAttribute("aria-valuenow",100*f);g.style.width=100*f+"%"});d.on("savingComplete",function(){b.querySelector(".modal-content[data-stage='saving']").style.display="none";a.isActionSupported("CPContinue")?a.isActionSupported("CPExit")?b.querySelector(".modal-content[data-stage='success-not-previously-posted']").style.display=
"block":b.querySelector(".modal-content[data-stage='success-already-posted']").style.display="block":b.querySelector(".modal-content[data-stage='success-redirect']").style.display="block"});d.on("savingFailure",function(f){g.classList.add("progress-bar-danger");let m=U("Sorry, your drawing could not be saved, please try again later.");f&&(f=f.replace(/^CHIBIERROR\s*/,"")).length>0&&(m+=`<br><br>${U("The error returned from the server was")}:`,p.textContent=f,p.style.display="block");h.innerHTML=m});
b.querySelector(".chickenpaint-send-cancel").addEventListener("click",function(){d.cancel()});var l=b.querySelector(".chickenpaint-post-drawing");l&&l.addEventListener("click",function(){a.actionPerformed({action:"CPPost"})});(l=b.querySelector(".chickenpaint-exit"))&&(l.style.display=a.isActionSupported("CPExit")?"":"none",l.addEventListener("click",function(){alert("When you want to come back and finish your drawing, just click the 'new drawing' button again and you can choose to continue this drawing.");
a.actionPerformed({action:"CPExit"})}));b.addEventListener("hidden.bs.modal",()=>{b.remove()});c.appendChild(b);this.show=function(){e.show();k.emitEvent("shown")}}function la(a){function c(M){this.palName=M}function d(M){this.toolNum=M}function b(M){this.modeNum=M}function h(M){let z;switch(A=M==ec.EDITING_MODE_IMAGE?la.COLOR_MODE_RGB:la.COLOR_MODE_GREYSCALE,n.emitEvent("colorModeChange",[M==ec.EDITING_MODE_IMAGE?"rgb":"greyscale"]),A){case la.COLOR_MODE_RGB:z=u.clone();break;case la.COLOR_MODE_GREYSCALE:z=
new jb(jb.greyToRGB(v))}n.artwork.setForegroundColor(z.getRgb());n.emitEvent("colorChange",[z])}function p(){n.emitEvent("toolChange",[C,P[C]])}function g(M){x!=M&&(M==la.M_TRANSFORM&&(F=x),x=M,n.emitEvent("modeChange",[x]))}function e(M){g(la.M_DRAW);C=M;n.artwork.setBrush(P[M]);p()}function k(M={}){let z=new Cd({artwork:n.getArtwork(),rotation:q.getRotation90(),swatches:t.getSwatches()});z.on("savingComplete",function(){n.artwork.setHasUnsavedChanges(!1)});z.on("savingFailure",function(){alert(U("Sorry, your drawing could not be saved, Please see the error message."))});
z.save(M)}function l(M,z){m&&(m.addEventListener("dblclick",function(K){K.preventDefault();K.stopPropagation()}),n.artwork.on("editModeChanged",h),t=new ge(n,m),n.mainGUI=t,n.emitEvent("fullScreen",[H]),n.emitEvent("smallScreen",[G]),B.load(),e(la.T_PEN),t.arrangePalettes(),M&&t.setSwatches(M),z&&t.setRotation90(z),window.addEventListener("beforeunload",function(K){n.artwork.getHasUnsavedChanges()&&K.preventDefault()}),n.artwork.on("unsavedChanges",K=>{a.allowMultipleSends&&n.emitEvent("unsavedChanges",
[K])}))}let f;!function(){try{if("u">typeof navigator){let M=navigator.languages;for(let z of(Array.isArray(M)||(M=[M]),M)){let K=/^(..)([-_].+)?$/.exec(z);if(K){if(K[1]=K[1].toLowerCase(),K[1]in Le)return void Ke(z);if("en"===K[1])return void Ke("en")}}}}catch(M){console.error(M)}}();a.language&&Ke(a.language);let m=a.uiElem;document.addEventListener("keydown",M=>{((M.ctrlKey||M.metaKey)&&"+;=-shro".split("").includes(M.key.toLowerCase())||"Enter"===M.key)&&M.preventDefault()});m.addEventListener("contextmenu",
M=>{M.preventDefault();M.stopPropagation()},{passive:!1});let n=this,q,t,u=new jb(0),v=255,A=la.COLOR_MODE_RGB,C=la.T_PENCIL,x=la.M_DRAW,F=x,w=[4278190080,4294967295],G=!1,H=!1,P=((f=Array(la.T_MAX))[la.T_PENCIL]=new xa({toolNb:la.T_PENCIL,size:16,alpha:255,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:xa.TIP_ROUND_AA,brushMode:xa.BRUSH_MODE_PAINT,paintMode:xa.PAINT_MODE_OPACITY,smoothing:.02}),f[la.T_ERASER]=new xa({toolNb:la.T_ERASER,size:16,alpha:255,isAA:!0,minSpacing:.5,
spacing:.05,pressureSize:!1,pressureAlpha:!1,texture:0,tip:xa.TIP_ROUND_AA,brushMode:xa.BRUSH_MODE_ERASE,paintMode:xa.PAINT_MODE_OPACITY}),f[la.T_PEN]=new xa({toolNb:la.T_PEN,size:2,alpha:100,isAA:!0,minSpacing:.5,spacing:.05,pressureSize:!0,pressureAlpha:!1,tip:xa.TIP_ROUND_AA,brushMode:xa.BRUSH_MODE_PAINT,paintMode:xa.PAINT_MODE_FLOW,alphaScale:.5,smoothing:.02}),f[la.T_SOFTERASER]=new xa({toolNb:la.T_SOFTERASER,size:16,alpha:60,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,
texture:1,tip:xa.TIP_ROUND_AIRBRUSH,brushMode:xa.BRUSH_MODE_ERASE,paintMode:xa.PAINT_MODE_FLOW,alphaScale:.125}),f[la.T_AIRBRUSH]=new xa({toolNb:la.T_AIRBRUSH,size:50,alpha:30,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:xa.TIP_ROUND_AIRBRUSH,brushMode:xa.BRUSH_MODE_PAINT,paintMode:xa.PAINT_MODE_FLOW,alphaScale:.125}),f[la.T_DODGE]=new xa({toolNb:la.T_DODGE,size:30,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:xa.TIP_ROUND_AIRBRUSH,brushMode:xa.BRUSH_MODE_DODGE,
paintMode:xa.PAINT_MODE_FLOW,alphaScale:.125}),f[la.T_BURN]=new xa({toolNb:la.T_BURN,size:30,alpha:32,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:xa.TIP_ROUND_AIRBRUSH,brushMode:xa.BRUSH_MODE_BURN,paintMode:xa.PAINT_MODE_FLOW,alphaScale:.125}),f[la.T_WATER]=new xa({toolNb:la.T_WATER,size:30,alpha:50,isAA:!1,minSpacing:.5,spacing:.02,pressureSize:!1,pressureAlpha:!0,tip:xa.TIP_ROUND_AA,brushMode:xa.BRUSH_MODE_WATER,paintMode:xa.PAINT_MODE_FLOW,alphaScale:.125,resat:.3,bleed:.6}),
f[la.T_BLUR]=new xa({toolNb:la.T_BLUR,size:20,alpha:255,isAA:!1,minSpacing:.5,spacing:.05,pressureSize:!1,pressureAlpha:!0,tip:xa.TIP_ROUND_PIXEL,brushMode:xa.BRUSH_MODE_BLUR,paintMode:xa.PAINT_MODE_FLOW,alphaScale:.125}),f[la.T_SMUDGE]=new xa({toolNb:la.T_SMUDGE,size:20,alpha:128,isAA:!1,minSpacing:.5,spacing:.01,pressureSize:!1,pressureAlpha:!0,tip:xa.TIP_ROUND_AIRBRUSH,brushMode:xa.BRUSH_MODE_SMUDGE,paintMode:xa.PAINT_MODE_FLOW,alphaScale:.125,resat:0,bleed:1}),f[la.T_BLENDER]=new xa({toolNb:la.T_BLENDER,
size:20,alpha:60,isAA:!1,minSpacing:.5,spacing:.1,pressureSize:!1,pressureAlpha:!0,tip:xa.TIP_ROUND_AIRBRUSH,brushMode:xa.BRUSH_MODE_OIL,paintMode:xa.PAINT_MODE_FLOW,alphaScale:.125,resat:0,bleed:.07}),f),B=new lh,O,T,L,ja,V,ha,Z,va={CPFullScreen:{action:function(){n.setFullScreen(!H)},isSupported:function(){return"disable"!==a.fullScreenMode&&"force"!==a.fullScreenMode&&!1!==a.allowFullScreen},modifies:{gui:!0}},CPZoomIn:{action:function(){q.zoomIn()},modifies:{gui:!0}},CPZoomOut:{action:function(){q.zoomOut()},
modifies:{gui:!0}},CPZoom100:{action:function(){q.zoom100()},modifies:{gui:!0}},CPResetZoomAndRotation:{action:function(){q.resetZoomAndRotation();let M=t.getPaletteManager().palettes.misc.flipButton,z=t.getMainMenu().getElement().querySelector('[data-action="CPViewHFlip"]');M&&M.classList.remove("flipped");z&&z.classList.remove("selected")},modifies:{gui:!0}},CPViewHFlip:{action:function(){let M=q.toggleViewFlip(),z=t.getPaletteManager().palettes.misc.flipButton,K=t.getMainMenu().getElement().querySelector('[data-action="CPViewHFlip"]');
z&&(M?z.classList.add("flipped"):z.classList.remove("flipped"));K&&(M?K.classList.add("selected"):K.classList.remove("selected"))},modifies:{gui:!0}},CPUndo:{action:function(){n.artwork.undo()},modifies:{document:!0},allowed:"isUndoAllowed"},CPRedo:{action:function(){n.artwork.redo()},modifies:{document:!0},allowed:"isRedoAllowed"},CPClearHistory:{action:function(){confirm(U("You're about to clear the current Undo/Redo history.\nThis operation cannot be undone, are you sure you want to do that?"))&&
n.artwork.clearHistory()},modifies:{document:!0}},CPPencil:new d(la.T_PENCIL),CPPen:new d(la.T_PEN),CPEraser:new d(la.T_ERASER),CPSoftEraser:new d(la.T_SOFTERASER),CPAirbrush:new d(la.T_AIRBRUSH),CPDodge:new d(la.T_DODGE),CPBurn:new d(la.T_BURN),CPWater:new d(la.T_WATER),CPBlur:new d(la.T_BLUR),CPSmudge:new d(la.T_SMUDGE),CPBlender:new d(la.T_BLENDER),CPFloodFill:new b(la.M_FLOODFILL),CPGradientFill:new b(la.M_GRADIENTFILL),CPRectSelection:new b(la.M_RECT_SELECTION),CPMoveTool:new b(la.M_MOVE_TOOL),
CPRotateCanvas:new b(la.M_ROTATE_CANVAS),CPPanCanvas:new b(la.M_PAN_CANVAS),CPColorPicker:new b(la.M_COLOR_PICKER),CPTransform:{action:function(){let M=n.artwork.getActiveLayer();null==n.artwork.transformAffineBegin()?n.showLayerNotification(M,U("Whoops! All of the selected pixels are transparent!"),"layer"):g(la.M_TRANSFORM)},modifies:{mode:!0},allowed:function(){let M=n.artwork.getActiveLayer();if(M.visible)if(0==M.alpha)n.showLayerNotification(M,U("Whoops! This layer's opacity is currently 0%"),
"opacity");else{if(null!=n.artwork.transformAffineBegin())return 0!=M.getEffectiveAlpha();n.showLayerNotification(M,U("Whoops! All of the selected pixels are transparent!"),"layer")}else n.showLayerNotification(M,U("Whoops! This layer is currently hidden"),"layer")}},CPTransformAccept:{action:function(){x==la.M_TRANSFORM&&(n.artwork.transformAffineFinish(),g(F))},modifies:{mode:!0}},CPTransformReject:{action:function(){x==la.M_TRANSFORM&&(n.artwork.transformAffineAbort(),g(F))},modifies:{document:!0,
mode:!0}},CPFreeHand:{action:function(){P[C].strokeMode=xa.STROKE_MODE_FREEHAND;p()},modifies:{tool:!0}},CPLine:{action:function(){P[C].strokeMode=xa.STROKE_MODE_LINE;p()},modifies:{tool:!0}},CPBezier:{action:function(){P[C].strokeMode=xa.STROKE_MODE_BEZIER;p()},modifies:{tool:!0}},CPAbout:{action:function(){(new ah(m)).show()},modifies:{}},CPShortcuts:{action:function(){(new bh(m)).show()},modifies:{}},CPTabletSupport:{action:function(){(new eh(m)).show()},modifies:{}},CPLayerDuplicate:{action:function(){n.artwork.duplicateLayer()},
modifies:{document:!0}},CPLayerMergeDown:{action:function(){n.artwork.mergeDown()},modifies:{document:!0},allowed:"isMergeDownAllowed"},CPGroupMerge:{action:function(){n.artwork.mergeGroup()},modifies:{document:!0},allowed:"isMergeGroupAllowed"},CPLayerMergeAll:{action:function(){n.artwork.mergeAllLayers()},modifies:{document:!0},allowed:"isMergeAllLayersAllowed"},CPCreateMergedLayer:{action:function(){n.artwork.mergeAllLayers(!0)},modifies:{document:!0},allowed:"isMergeAllLayersAllowed"},CPExpandLayerGroup:{action:function(M){n.artwork.expandLayerGroup(M.group,
M.expand)},modifies:{document:!0}},CPFill:{action:function(){n.artwork.fill(4278190080|n.getCurColor().getRgb())},modifies:{document:!0},requiresDrawable:!0},CPClear:{action:function(){n.artwork.clear()},modifies:{document:!0},requiresDrawable:!0},CPClearWithTexture:{action:function(){n.artwork.clear(!1)},modifies:{document:!0},requiresDrawable:!0},CPSelectAll:{action:function(){n.artwork.rectangleSelection(n.artwork.getBounds());q.repaintAll()},modifies:{document:!0}},CPDeselectAll:{action:function(){n.artwork.rectangleSelection(new Ca(0,
0,0,0));q.repaintAll()},modifies:{document:!0}},CPHFlip:{action:function(){n.artwork.hFlip()},modifies:{document:!0},requiresDrawable:!0},CPVFlip:{action:function(){n.artwork.vFlip()},modifies:{document:!0},requiresDrawable:!0},CPMNoise:{action:function(){n.artwork.monochromaticNoise()},modifies:{document:!0},requiresDrawable:!0},CPCNoise:{action:function(){n.artwork.colorNoise()},modifies:{document:!0},allowed:"isColorNoiseAllowed"},CPFXBoxBlur:{action:function(){O||=new dh(m,n);O.show()},modifies:{document:!0},
requiresDrawable:!0},CPFXMosaic:{action:function(){L||=new jh(m,n);L.show()},modifies:{gui:!0}},CPColorHalftone:{action:function(){ja||=new hh(m,n);ja.show()},allowed:"isNotEditingMask",modifies:{gui:!0}},CPMonoHalftone:{action:function(){V||=new ih(m,n);V.show()},modifies:{gui:!0}},CPChromaticAberration:{action:function(){ha||=new gh(m,n);ha.show()},allowed:"isNotEditingMask",modifies:{gui:!0}},CPEdgeExpand:{action:function(){Z||=new kh(m,n);Z.show()},allowed:"isNotEditingMaskAndDrawable",modifies:{gui:!0}},
CPFXInvert:{action:function(){n.artwork.invert()},modifies:{document:!0},requiresDrawable:!0},CPBrightnessToOpacity:{action:function(){n.artwork.brightnessToOpacity()},modifies:{document:!0},allowed:"isNotEditingMaskAndDrawable"},CPCut:{action:function(){n.artwork.cutSelection()},modifies:{document:!0},requiresDrawable:!0,allowed:"isCutSelectionAllowed"},CPCopy:{action:function(){n.artwork.copySelection()},modifies:{document:!0},requiresDrawable:!0,allowed:"isCopySelectionAllowed"},CPCopyMerged:{action:function(){n.artwork.copySelectionMerged()},
modifies:{document:!0},allowed:"isCopySelectionMergedAllowed"},CPPaste:{action:function(){n.artwork.pasteClipboard()},modifies:{document:!0},allowed:"isPasteClipboardAllowed"},CPToggleGrid:{action:function(M){q.showGrid(M.selected)},modifies:{gui:!0}},CPGridOptions:{action:function(){T||=new fh(m,q);T.show()},modifies:{gui:!0}},CPLinearInterpolation:{action:function(M){q.setInterpolation(M.selected)},modifies:{gui:!0}},CPResetCanvasRotation:{action:function(){q.resetRotation()},modifies:{gui:!0}},
CPAddLayer:{action:function(){n.artwork.addLayer("layer")},modifies:{document:!0}},CPAddGroup:{action:function(){n.artwork.addLayer("group")},modifies:{document:!0}},CPAddLayerMask:{action:function(){n.artwork.addLayerMask()},modifies:{document:!0},allowed:"isAddLayerMaskAllowed"},CPApplyLayerMask:{action:function(){n.artwork.applyLayerMask(!0)},modifies:{document:!0},allowed:"isApplyLayerMaskAllowed"},CPRemoveLayerMask:{action:function(){n.artwork.removeLayerMask()},modifies:{document:!0},allowed:"isRemoveLayerMaskAllowed"},
CPRemoveLayer:{action:function(){n.artwork.removeLayer()||alert(U("Sorry, you can't remove the last remaining layer in the drawing."))},modifies:{document:!0},allowed:"isRemoveLayerAllowed"},CPCreateClippingMask:{action:function(){n.artwork.createClippingMask()},modifies:{document:!0},allowed:"isCreateClippingMaskAllowed"},CPReleaseClippingMask:{action:function(){n.artwork.releaseClippingMask()},modifies:{document:!0},allowed:"isReleaseClippingMaskAllowed"},CPRelocateLayer:{action:function(M){n.artwork.relocateLayer(M.layer,
M.toGroup,M.toIndex)},modifies:{document:!0}},CPSetActiveLayer:{action:function(M){M.mask&&M.layer.mask&&!M.layer.maskVisible&&n.artwork.setLayerMaskVisible(M.layer,!0);n.artwork.setActiveLayer(M.layer,M.mask);n.artwork.performIdleTasks()},modifies:{document:!0}},CPToggleMaskView:{action:function(){let M=n.artwork.toggleMaskView();M&&n.emitEvent("maskViewOpened",[M])},modifies:{gui:!0}},CPSetMaskVisible:{action:function(M){n.artwork.setLayerMaskVisible(M.layer,M.visible)},modifies:{layerProp:!0}},
CPSetLayerVisibility:{action:function(M){n.artwork.setLayerVisibility(M.layer,M.visible)},modifies:{layerProp:!0}},CPSetLayerName:{action:function(M){n.artwork.setLayerName(M.layer,M.name)},modifies:{layerProp:!0}},CPSetLayerBlendMode:{action:function(M){n.artwork.setLayerBlendMode(M.blendMode)},modifies:{layerProp:!0}},CPSetLayerAlpha:{action:function(M){n.artwork.setLayerAlpha(M.alpha)},modifies:{layerProp:!0}},CPSetLayerLockAlpha:{action:function(M){n.artwork.setLayerLockAlpha(M.lock)},modifies:{layerProp:!0}},
CPPalColor:new c("color"),CPPalBrush:new c("brush"),CPPalLayers:new c("layers"),CPPalStroke:new c("stroke"),CPPalSwatches:new c("swatches"),CPPalTool:new c("tool"),CPPalMisc:new c("misc"),CPPalTextures:new c("textures"),CPTogglePalettes:{action:function(){t.togglePalettes()},modifies:{gui:!0}},CPArrangePalettes:{action:function(){t.arrangePalettes()},modifies:{gui:!0}},CPToggleSetSmallScreenMode:{action:function(){n.setSmallScreenMode(!G);t.arrangePalettes()},modifies:{gui:!0}},CPExportAsPNG:{action:function(){k({saveUrl:a.saveUrl||
!1})},isSupported:function(){return!1!==a.allowDownload},modifies:{document:!0}},CPExportAsZIP:{action:function(){k({zip:!0,saveUrl:a.saveUrl||!1})},isSupported:function(){return!1!==a.allowDownload},modifies:{document:!0}},CPSaveDB:{action:function(){k({savedb:!0})},isSupported:function(){return!1!==a.allowDownload},modifies:{document:!0}},CPSaveDBFromMenu:{action:function(){k({savedb:!0,savedbFromMenu:!0})},isSupported:function(){return!1!==a.allowDownload},modifies:{document:!0}},CPSend:{action:function(){!function(){if(n.isActionSupported("CPContinue")||
confirm(U("Are you sure you want to send your drawing to the server and finish drawing now?"))){var M=new Cd({artwork:n.getArtwork(),rotation:q.getRotation90(),swatches:t.getSwatches(),url:a.saveUrl,post_max_size:a.post_max_size}),z=new ie(n,m,M);M.on("savingComplete",function(){n.artwork.setHasUnsavedChanges(!1);!n.isActionSupported("CPContinue")&&n.isActionSupported("CPPost")&&n.actionPerformed({action:"CPPost"})});M.on("savingFailure",function(){alert(U("Sorry, your drawing could not be saved, Please see the error message."))});
z.on("shown",function(){M.save()});z.show()}}()},isSupported:function(){return!!a.saveUrl},modifies:{document:!0}},CPPost:{action:function(){if("function"==typeof handleExit)return handleExit();window.location=a.postUrl},isSupported:function(){return!(!a.postUrl&&"function"!=typeof handleExit)},modifies:{document:!0}},CPContinue:{action:function(){},isSupported:function(){return!!a.allowMultipleSends}},CPExit:{action:function(){window.location=a.exitUrl},isSupported:function(){return!!a.exitUrl},
modifies:{}}};switch(c.prototype.action=function(M){t.showPalette(this.palName,M.selected)},c.prototype.modifies={gui:!0},d.prototype.action=function(){e(this.toolNum)},d.prototype.modifies={mode:!0,tool:!0},d.prototype.requiresDrawable=!0,b.prototype.action=function(){g(this.modeNum)},b.prototype.modifies={mode:!0},this.callToolListeners=function(){p()},this.getArtwork=function(){return this.artwork},this.setCanvas=function(M){q=M},this.setTransformInterpolation=function(M){this.artwork.setTransformInterpolation(M)},
this.setCurColor=function(M){switch(A){case la.COLOR_MODE_RGB:u.isEqual(M)||(u.copyFrom(M),this.artwork.setForegroundColor(M.getRgb()),this.emitEvent("colorChange",[M]));break;case la.COLOR_MODE_GREYSCALE:if(M=M.getValue(),v!=M){let z=jb.greyToRGB(M);this.artwork.setForegroundColor(z);v=M;this.emitEvent("colorChange",[new jb(z)])}}},this.getCurColor=function(){switch(A){case la.COLOR_MODE_RGB:return u.clone();case la.COLOR_MODE_GREYSCALE:return new jb(jb.greyToRGB(v))}},this.setCurGradient=function(M){w=
M.slice(0);this.emitEvent("gradientChange",[w])},this.getCurGradient=function(){return w.slice(0)},this.setBrushSize=function(M){P[C].size=Math.max(1,Math.min(200,M));p()},this.getBrushSize=function(){return P[C].size},this.setAlpha=function(M){P[C].alpha=M;p()},this.getAlpha=function(){return P[C].alpha},this.getCurMode=function(){return x},this.zoomOnCenter=function(M,z=!1){q.zoomOnCenter(M,z)},this.getZoom=function(){return q.getZoom()},this.getRotationDegrees=function(){return q.getRotationDegrees()},
this.setRotationDegrees=function(M){q.setRotationDegrees(M)},this.setGrowFillArea=function(M){q.setGrowFillArea(M)},this.setFoodFillAlpha=function(M){q.setFoodFillAlpha(M)},this.setFloodFillReferAllLayers=function(M){q.setFloodFillReferAllLayers(M)},this.setModalShown=function(M){q.setModalShown(M)},this.isPanOrRotateMode=function(){return q.isPanOrRotateMode()},this.getCurTool=function(){return C},this.getBrushInfo=function(){return P[C]},this.isActionSupported=function(M){if(va[M]){let z=typeof va[M].isSupported;
return"function"==z?va[M].isSupported():"undefined"==z||va[M].isSupported}return!1},this.isActionAllowed=function(M){M=va[M];return!!M&&("function"==typeof M.allowed?M.allowed():"string"==typeof M.allowed?this.artwork[M.allowed]():!M.requiresDrawable||this.artwork.isActiveLayerDrawable())},this.showLayerNotification=function(M,z,K){this.emitEvent("layerNotification",[M,z,K])},this.actionPerformed=function(M){if(null!=this.artwork&&null!=q){var z=va[M.action];if(z)if(x==la.M_TRANSFORM&&(z.modifies.document||
z.modifies.mode)&&-1==["CPTransformAccept","CPTransformReject"].indexOf(M.action))if("CPUndo"==M.action)va.CPTransformReject.action();else{if("CPTransform"!=M.action){let K=new he(m,this);K.on("accept",()=>{this.actionPerformed(M);K.hide()});K.on("reject",()=>{this.actionPerformed(M);K.hide()});K.show()}}else z.action(M)}},this.setSmallScreenMode=function(M){G!==M&&(G=M,m.classList.toggle("chickenpaint-small-screen",G),n.emitEvent("smallScreen",[G]))},this.getSmallScreenMode=function(){return G},
this.fullScreenModeOptions=function(){return a.fullScreenMode},this.setFullScreen=function(M){H!==M&&(H=M,document.body.classList.toggle("chickenpaint-full-screen",H),m.classList.toggle("chickenpaint-full-screen",H),M=document.querySelectorAll('head meta[name="viewport"]').length,H&&0===M?(M=document.createElement("meta"),M.name="viewport",M.content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,,user-scalable=no",document.head.appendChild(M),setTimeout(()=>n.emitEvent("fullScreen",
[H]),200)):n.emitEvent("fullScreen",[H]))},this.isFullScreen=function(){return H},this.setToolbarStyle=function(M){B.set("toolbarStyle",M);B.save()},this.getToolbarStyle=function(){return B.get("toolbarStyle")},this.getResourcesRoot=function(){return a.resourcesRoot},m&&(m.className+=" chickenpaint chickenpaint-lang-"+Me),a.resourcesRoot=a.resourcesRoot||"chickenpaint/",this.setSmallScreenMode(!!("number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&(window.screen.width<=820||window.screen.height<=
820))),a.fullScreenMode){case "force":this.setFullScreen(!0);break;case "auto":this.setFullScreen(G)}B.on("toolbarStyle",M=>this.emitEvent("toolbarStyleChange",[M]));let ia=a.loadImageUrl||a.loadChibiFileUrl,sa=!1;"true"===localStorage.getItem("has_chibi_autosave_flag")&&((sa=confirm(ia?U("Unsaved data was detected.\nInterrupt image loading and restore it?"):U("Unsaved data was detected. Would you like to restore it?")))||Je());Mg().then(M=>{if(sa&&M&&M.bytes)pf(M.bytes).then(z=>{if(this.artwork=
z,M.swatches){let K=URL.createObjectURL(M.swatches);z=Object.assign({},a);z.loadSwatchesUrl=K;z.loadImageUrl=null;z.loadChibiFileUrl=null;z=new Bd(z);z.on("loadingComplete",ca=>{l(ca.swatches,a.rotation);URL.revokeObjectURL(K);a.onLoaded&&a.onLoaded(this)});z.load()}else l([],a.rotation),a.onLoaded&&a.onLoaded(this)});else if(ia){let z=new Bd(a);new Pg(m,z,a.resourcesRoot);z.on("loadingComplete",function(K){n.artwork=K.layers||K.flat;l(K.swatches,a.rotation);a.onLoaded&&a.onLoaded(this)});z.load()}else a.artwork?
this.artwork=a.artwork:(this.artwork=new ec(a.canvasWidth||800,a.canvasHeight||600),this.artwork.addBackgroundLayer(),this.artwork.addDefaultLayer()),l(),a.onLoaded&&a.onLoaded(this)})}var Yc,Pc="u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:"u">typeof global?global:{};xa.STROKE_MODE_FREEHAND=0;xa.STROKE_MODE_LINE=1;xa.STROKE_MODE_BEZIER=2;xa.TIP_ROUND_PIXEL=0;xa.TIP_ROUND_AA=1;xa.TIP_ROUND_AIRBRUSH=2;xa.TIP_SQUARE_PIXEL=3;xa.TIP_SQUARE_AA=4;xa.BRUSH_MODE_PAINT=0;xa.BRUSH_MODE_ERASE=
1;xa.BRUSH_MODE_DODGE=2;xa.BRUSH_MODE_BURN=3;xa.BRUSH_MODE_WATER=4;xa.BRUSH_MODE_BLUR=5;xa.BRUSH_MODE_SMUDGE=6;xa.BRUSH_MODE_OIL=7;xa.PAINT_MODE_OPACITY=0;xa.PAINT_MODE_FLOW=1;xa.DEFAULTS={isAA:!1,minSpacing:0,spacing:0,pressureSize:!0,pressureAlpha:!1,pressureScattering:!1,alphaScale:1,tip:xa.TIP_ROUND_PIXEL,brushMode:xa.BRUSH_MODE_PAINT,paintMode:xa.PAINT_MODE_OPACITY,strokeMode:xa.STROKE_MODE_FREEHAND,resat:1,bleed:0,texture:1,size:0,curSize:0,alpha:0,curAlpha:0,scattering:0,curScattering:0,squeeze:0,
curSqueeze:0,angle:Math.PI,curAngle:0,smoothing:0};xa.prototype.applyPressure=function(a,c){let d=this.pressureSize?Math.max(.6,this.size*a):Math.max(.6,this.size);c||!this._lastSize?(this.curSize=d,this._lastSize=d):(this.curSize=this._lastSize+.3*(d-this._lastSize),this._lastSize=this.curSize);this.curAlpha=this.pressureAlpha?Math.floor(this.alpha*Math.min(a,1)):this.alpha;this.curSqueeze=this.squeeze;this.curAngle=this.angle;this.curScattering=this.scattering*this.curSize*(this.pressureScattering?
a:1)};xa.prototype.clone=function(){return new xa(this)};Ca.prototype.makeEmpty=function(){this.bottom=this.right=this.top=this.left=0};Ca.prototype.union=function(a){this.isEmpty()?this.set(a):a.isEmpty()||(this.left=Math.min(this.left,a.left),this.top=Math.min(this.top,a.top),this.right=Math.max(this.right,a.right),this.bottom=Math.max(this.bottom,a.bottom))};Ca.prototype.getUnion=function(a){var c=this.clone();return c.union(a),c};Ca.prototype.getIntersection=function(a,c=!1){let d=Math.max(this.left,
a.left),b=Math.max(this.top,a.top),h=Math.min(this.right,a.right);a=Math.min(this.bottom,a.bottom);return c&&(d>=h||b>=a)?null:new Ca(d,b,h,a)};Ca.prototype.clipTo=function(a){return this.isEmpty()||(a.isEmpty()?this.makeEmpty():(this.left=Math.min(Math.max(this.left,a.left),a.right),this.top=Math.min(Math.max(this.top,a.top),a.bottom),this.right=Math.max(Math.min(this.right,a.right),a.left),this.bottom=Math.max(Math.min(this.bottom,a.bottom),a.top))),this};Ca.prototype.containsPoint=function(a){return!(a.x<
this.left||a.y<this.top||a.x>=this.right||a.y>=this.bottom)};Ca.prototype.isInside=function(a){return this.left>=a.left&&this.top>=a.top&&this.right<=a.right&&this.bottom<=a.bottom};Ca.prototype.clipSourceDest=function(a,c){c.right=c.left+a.getWidth();c.bottom=c.top+a.getHeight();this.isEmpty()||c.left>=this.right||c.top>=this.bottom||c.right<=this.left||c.bottom<=this.top?(a.makeEmpty(),c.makeEmpty()):(c.right>this.right&&(a.right-=c.right-this.right,c.right=this.right),c.bottom>this.bottom&&(a.bottom-=
c.bottom-this.bottom,c.bottom=this.bottom),c.left<this.left&&(a.left+=this.left-c.left,c.left=this.left),c.top<this.top&&(a.top+=this.top-c.top,c.top=this.top))};Ca.prototype.getWidth=function(){return this.right-this.left};Ca.prototype.getHeight=function(){return this.bottom-this.top};Ca.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Ca.prototype.isEmpty=function(){return this.right<=this.left||this.bottom<=this.top};Ca.prototype.set=function(a){this.left=a.left;this.top=a.top;
this.right=a.right;this.bottom=a.bottom};Ca.prototype.clone=function(){return new Ca(this.left,this.top,this.right,this.bottom)};Ca.prototype.translate=function(a,c){return this.left+=a,this.right+=a,this.top+=c,this.bottom+=c,this};Ca.prototype.getTranslated=function(a,c){var d=this.clone();return d.translate(a,c),d};Ca.prototype.moveTo=function(a,c){this.translate(a-this.left,c-this.top)};Ca.prototype.equals=function(a){return this.left==a.left&&this.right==a.right&&this.top==a.top&&this.bottom==
a.bottom};Ca.prototype.grow=function(a,c){this.left-=a;this.right+=a;this.top-=c;this.bottom+=c};Ca.prototype.toString=function(){return"("+this.left+","+this.top+","+this.right+","+this.bottom+")"};Ca.prototype.toPoints=function(){return[{x:this.left,y:this.top},{x:this.right,y:this.top},{x:this.right,y:this.bottom},{x:this.left,y:this.bottom}]};Ca.prototype.roundNearest=function(){return this.left=Math.round(this.left),this.top=Math.round(this.top),this.right=Math.round(this.right),this.bottom=
Math.round(this.bottom),this};Ca.prototype.roundContain=function(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this};Ca.createBoundingBox=function(a){if(0===a.length)return new Ca(0,0,0,0);let c=new Ca(a[0].x,a[0].y,a[0].x,a[0].y);for(let d=1;d<a.length;d++)c.left=Math.min(c.left,a[d].x),c.top=Math.min(c.top,a[d].y),c.right=Math.max(c.right,a[d].x),c.bottom=Math.max(c.bottom,a[d].y);return c};Ca.prototype.subtract=
function(a){return Ca.subtract(this,a)};Ca.subtract=function(a,c){a instanceof Ca&&(a=[a]);c instanceof Ca&&(c=[c]);a=a.slice(0);for(let b=0;b<c.length;b++){let h=c[b],p=a.length;for(let g=0;g<p;g++){var d=a[g];if(!d)continue;let e=d.getIntersection(h);if(!e.isEmpty()){let k=[];if(d.top<h.top&&k.push(new Ca(d.left,d.top,d.right,e.top)),d.bottom>h.bottom&&k.push(new Ca(d.left,e.bottom,d.right,d.bottom)),d.left<h.left&&k.push(new Ca(d.left,e.top,e.left,e.bottom)),d.right>h.right&&k.push(new Ca(e.right,
e.top,d.right,e.bottom)),(k=k.filter(l=>!l.isEmpty())).length>0)for(a[g]=k[0],d=1;d<k.length;d++)a.push(k[d]);else a[g]=null}}}return a.filter(b=>null!=b)};Ca.union=function(a){if(a instanceof Ca)a=[a];else{a=a.slice(0);for(let d=0;d<a.length;d++){let b=a[d],h=a.length;if(b)for(let p=d+1;p<h;p++){var c=a[p];if(c&&!b.getIntersection(c).isEmpty()){c=Ca.subtract(c,b);a[p]=c[0];for(let g=1;g<c.length;g++)a.push(c[g])}}}}return a.filter(d=>d&&!d.isEmpty())};"object"==typeof window&&(window.cpRectGarbage=
new Ca(1.5,2.5,3.5,4.5));Uc.prototype.getBounds=function(){return new Ca(0,0,this.width,this.height)};Uc.prototype.isInside=function(a,c){return a>=0&&c>=0&&a<this.width&&c<this.height};I.prototype=Object.create(Uc.prototype);I.prototype.constructor=I;I.BYTES_PER_PIXEL=4;I.RED_BYTE_OFFSET=0;I.GREEN_BYTE_OFFSET=1;I.BLUE_BYTE_OFFSET=2;I.ALPHA_BYTE_OFFSET=3;I.prototype.clone=function(){return this.cloneRect(this.getBounds())};I.prototype.cloneRect=function(a){var c=new I(a.getWidth(),a.getHeight());
return c.copyBitmapRect(this,0,0,a),c};I.prototype.getPixel=function(a,c){a=Math.max(0,Math.min(this.width-1,a));c=Math.max(0,Math.min(this.height-1,c));a=this.offsetOfPixel(a,c);return this.data[a+I.ALPHA_BYTE_OFFSET]<<24|this.data[a+I.RED_BYTE_OFFSET]<<16|this.data[a+I.GREEN_BYTE_OFFSET]<<8|this.data[a+I.BLUE_BYTE_OFFSET]};I.prototype.setPixel=function(a,c,d){a=Math.max(0,Math.min(this.width-1,a));c=Math.max(0,Math.min(this.height-1,c));a=this.offsetOfPixel(a,c);this.data[a+I.ALPHA_BYTE_OFFSET]=
d>>24&255;this.data[a+I.RED_BYTE_OFFSET]=d>>16&255;this.data[a+I.GREEN_BYTE_OFFSET]=d>>8&255;this.data[a+I.BLUE_BYTE_OFFSET]=255&d};I.prototype.copyRectXOR=function(a,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),b=new Uint8Array(d*c.getHeight()*I.BYTES_PER_PIXEL),h=0,p=this.offsetOfPixel(c.left,c.top),g=a.offsetOfPixel(c.left,c.top),e=(this.width-d)*I.BYTES_PER_PIXEL,k=(a.width-d)*I.BYTES_PER_PIXEL;d*=I.BYTES_PER_PIXEL;for(var l=c.top;l<c.bottom;l++,p+=e,g+=k)for(var f=0;f<d;f++,h++,p++,g++)b[h]=
this.data[p]^a.data[g];return b};I.prototype.setRectXOR=function(a,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),b=c.getHeight();c=this.offsetOfPixel(c.left,c.top);var h=0,p=(this.width-d)*I.BYTES_PER_PIXEL;d*=I.BYTES_PER_PIXEL;for(var g=0;g<b;g++){for(var e=0;e<d;e++)this.data[c++]^=a[h++];c+=p}};I.prototype.copyBitmapRect=function(a,c,d,b){var h=new Ca(c,d,0,0);b=b.clone();this.getBounds().clipSourceDest(b,h);c=0|h.getWidth();d=0|h.getHeight();if(0==h.left&&0==h.top&&c==this.width&&d==this.height&&
c==a.width&&d==a.height)this.copyPixelsFrom(a);else{h=this.offsetOfPixel(h.left,h.top);var p=(this.width-c)*I.BYTES_PER_PIXEL;b=a.offsetOfPixel(b.left,b.top);for(var g=(a.width-c)*I.BYTES_PER_PIXEL,e=0;e<d;e++,b+=g,h+=p)for(var k=0;k<c;k++,b+=I.BYTES_PER_PIXEL,h+=I.BYTES_PER_PIXEL)this.data[h]=a.data[b],this.data[h+1]=a.data[b+1],this.data[h+2]=a.data[b+2],this.data[h+3]=a.data[b+3]}};I.prototype.copyAlphaFrom=function(a,c){var d=0|(c=this.getBounds().clipTo(c)).getWidth(),b=0|c.getHeight();c=this.offsetOfPixel(c.left,
c.top)+I.ALPHA_BYTE_OFFSET|0;for(var h=(this.width-d)*I.BYTES_PER_PIXEL|0,p=0;p<b;p++,c+=h)for(var g=0;g<d;g++,c+=I.BYTES_PER_PIXEL)this.data[c]=a.data[c]};I.prototype.setToSize=function(a){(a.width!=this.width||a.height!=this.height)&&(this.width=a.width,this.height=a.height,this.imageData=te(this.width,this.height),this.data=this.imageData.data)};I.prototype.copyPixelsFrom=function(a){if(this.setToSize(a),"set"in this.data)this.data.set(a.data);else for(var c=0;c<this.data.length;c++)this.data[c]=
a.data[c]};I.prototype.copyPixelsFromGreyscale=function(a){var c,d=0,b=a.width*a.height;this.setToSize(a);for(c=0;c<b;c++,d+=I.BYTES_PER_PIXEL)this.data[d+I.RED_BYTE_OFFSET]=a.data[c],this.data[d+I.GREEN_BYTE_OFFSET]=a.data[c],this.data[d+I.BLUE_BYTE_OFFSET]=a.data[c],this.data[d+I.ALPHA_BYTE_OFFSET]=255};I.prototype.copyScaledNearestNeighbor=function(a){for(var c,d=0,b=a.width/this.width,h=a.height/this.height,p=0,g=0;p<this.height;p++,g+=h){c=a.offsetOfPixel(0,Math.round(g));for(var e=0,k=0;e<this.width;e++,
d+=I.BYTES_PER_PIXEL,k+=b){var l=c+Math.round(k)*I.BYTES_PER_PIXEL;this.data[d]=a.data[l];this.data[d+1]=a.data[l+1];this.data[d+2]=a.data[l+2];this.data[d+I.ALPHA_BYTE_OFFSET]=a.data[l+I.ALPHA_BYTE_OFFSET]}}};I.prototype.createThumbnailFrom=function(a){let c=Math.min(Math.floor(a.width/this.width),3);if(c<2)return void this.copyScaledNearestNeighbor(a);let d=new Uint16Array(5*this.width);var b=a.width*I.BYTES_PER_PIXEL,h=Math.floor(a.width/this.width)*I.BYTES_PER_PIXEL;let p=Math.floor(a.width/this.width/
c)*I.BYTES_PER_PIXEL,g=h-p*c;var e=Math.floor(a.height/this.height/c);h=e*b-h*this.width;b*=Math.floor(a.height/this.height)-e*c;let k=e=0;for(let n=0;n<this.height;n++,e+=b){let q;d.fill(0);for(var l=0;l<c;l++,e+=h){q=0;for(var f=0;f<this.width;f++,q+=5,e+=g)for(var m=0;m<c;m++,e+=p){let t=a.data[e+I.ALPHA_BYTE_OFFSET],u=t/255;d[q]+=a.data[e]*u;d[q+1]+=a.data[e+1]*u;d[q+2]+=a.data[e+2]*u;d[q+I.ALPHA_BYTE_OFFSET]+=t;d[q+4]=Math.max(d[q+4],t)}}q=0;for(l=0;l<this.width;l++,q+=5,k+=I.BYTES_PER_PIXEL)f=
d[q+4],0==f?this.data[k+I.ALPHA_BYTE_OFFSET]=0:(m=f/d[q+I.ALPHA_BYTE_OFFSET],this.data[k]=d[q]*m,this.data[k+1]=d[q+1]*m,this.data[k+2]=d[q+2]*m,this.data[k+I.ALPHA_BYTE_OFFSET]=f)}};I.prototype.floodFillWithBorder=function(a,c,d,b=2,h=255,p=null){if(this.isInside(a,c)){var g=this.width,e=this.height,k=this.data,l=p?p.data:k,f=I.BYTES_PER_PIXEL;p=d>>16&255;var m=d>>8&255;d&=255;var n=new Uint8Array(g*e),q=[{x:a,y:c}];a=(c*g+a)*f;var t=l[a+I.RED_BYTE_OFFSET],u=l[a+I.GREEN_BYTE_OFFSET],v=l[a+I.BLUE_BYTE_OFFSET],
A=l[a+I.ALPHA_BYTE_OFFSET];a=(x,F)=>{if(x<0||F<0||x>=g||F>=e||n[F*g+x])return!1;x=(F*g+x)*f;return l[x+I.RED_BYTE_OFFSET]===t&&l[x+I.GREEN_BYTE_OFFSET]===u&&l[x+I.BLUE_BYTE_OFFSET]===v&&l[x+I.ALPHA_BYTE_OFFSET]===A};for(c=(x,F,w,G,H,P)=>{x=(F*g+x)*f;k[x+I.RED_BYTE_OFFSET]=w;k[x+I.GREEN_BYTE_OFFSET]=G;k[x+I.BLUE_BYTE_OFFSET]=H;k[x+I.ALPHA_BYTE_OFFSET]=P};q.length;){let {x,y:F}=q.pop();a(x,F)&&(n[F*g+x]=1,c(x,F,p,m,d,h),a(x,F-1)&&q.push({x,y:F-1}),a(x+1,F)&&q.push({x:x+1,y:F}),a(x,F+1)&&q.push({x,y:F+
1}),a(x-1,F)&&q.push({x:x-1,y:F}))}q=new Uint8ClampedArray(k);for(a=0;a<e;a++)for(c=0;c<g;c++)if(n[a*g+c])for(let x=-b;x<=b;x++)for(let F=-b;F<=b;F++){var C=c+F;let w=a+x;C<0||w<0||C>=g||w>=e||n[w*g+C]||(C=(w*g+C)*f,q[C+I.RED_BYTE_OFFSET]=p,q[C+I.GREEN_BYTE_OFFSET]=m,q[C+I.BLUE_BYTE_OFFSET]=d,q[C+I.ALPHA_BYTE_OFFSET]=h)}k.set(q)}};I.prototype.copyPixelColumnToArray=function(a,c,d,b){var h=(this.width-1)*I.BYTES_PER_PIXEL,p=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++){for(var g=0;g<I.BYTES_PER_PIXEL;g++)b[p++]=
this.data[a++];a+=h}};I.prototype.copyArrayToPixelColumn=function(a,c,d,b){var h=(this.width-1)*I.BYTES_PER_PIXEL,p=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++){for(var g=0;g<I.BYTES_PER_PIXEL;g++)this.data[a++]=b[p++];a+=h}};I.prototype.boxBlur=function(a,c,d){let b=(a=this.getBounds().clipTo(a)).getWidth(),h=b*I.BYTES_PER_PIXEL,p=a.getHeight();var g=Math.max(b,p);let e=new Uint8Array(g*I.BYTES_PER_PIXEL);g=new Uint8Array(g*I.BYTES_PER_PIXEL);for(let f=a.top;f<a.bottom;f++){var k=this.offsetOfPixel(a.left,
f);for(var l=0;l<h;l++)e[l]=this.data[k++];!function(m,n){for(var q=0,t=0;t<n;t++){for(var u=m[q+I.ALPHA_BYTE_OFFSET],v=0;v<3;v++,q++)m[q]=Math.round(m[q]*u/255);q++}}(e,b);df(e,g,b,c);k=this.offsetOfPixel(a.left,f);for(l=0;l<h;l++)this.data[k++]=g[l]}for(c=a.left;c<a.right;c++)this.copyPixelColumnToArray(c,a.top,p,e),df(e,g,p,d),function(f,m){for(var n=0,q=0;q<m;q++){var t=f[n+I.ALPHA_BYTE_OFFSET];if(0!=t){t=255/t;for(var u=0;u<3;u++,n++)f[n]=Math.min(Math.round(f[n]*t),255);n++}else n+=I.BYTES_PER_PIXEL}}(g,
p),this.copyArrayToPixelColumn(c,a.top,p,g)};I.prototype.mosaic=function(a,c){a=this.getBounds().clipTo(a);c=Math.max(1,0|c);let d=I.BYTES_PER_PIXEL,b=this.width,h=this.data;for(let n=a.top;n<a.bottom;n+=c){let q=Math.min(n+c,a.bottom);for(let t=a.left;t<a.right;t+=c){let u=Math.min(t+c,a.right);var p=0,g=0,e=0,k=0,l=0;for(var f=n;f<q;f++){var m=(f*b+t)*d;for(let v=t;v<u;v++)p+=h[m],g+=h[m+1],e+=h[m+2],k+=h[m+3],l++,m+=d}p=p/l|0;g=g/l|0;e=e/l|0;k=k/l|0;for(l=n;l<q;l++)for(f=(l*b+t)*d,m=t;m<u;m++)h[f]=
p,h[f+1]=g,h[f+2]=e,h[f+3]=k,f+=d}}};I.prototype.chromaticAberration=function(a,c,d){c=Math.max(-64,Math.min(64,0|c));d=Math.max(-64,Math.min(64,0|d));a=this.getBounds().clipTo(a);let b=this.width,h=this.height,p=I.BYTES_PER_PIXEL,g=new Uint8ClampedArray(this.data),e=new Uint8ClampedArray(this.data.length);e.set(g);for(let l=a.top;l<a.bottom;l++)for(let f=a.left;f<a.right;f++){let m=(l*b+f)*p,n=g[m+I.ALPHA_BYTE_OFFSET]/255;if(0!==n){var k=(Math.min(h-1,Math.max(0,l+d))*b+Math.min(b-1,Math.max(0,f+
c)))*p;e[k+I.BLUE_BYTE_OFFSET]=Math.round(g[m+I.BLUE_BYTE_OFFSET]*n+e[k+I.BLUE_BYTE_OFFSET]*(1-n));k=(Math.min(h-1,Math.max(0,l-d))*b+Math.min(b-1,Math.max(0,f-c)))*p;e[k+I.RED_BYTE_OFFSET]=Math.round(g[m+I.RED_BYTE_OFFSET]*n+e[k+I.RED_BYTE_OFFSET]*(1-n))}}this.data.set(e)};I.prototype.colorHalftone=function(a,c,d=1){c=Math.max(2,0|c);this.getBounds().clipTo(a);let b=this.width,h=this.height,p=I.BYTES_PER_PIXEL,g=new Uint8ClampedArray(this.data);a=new Uint8ClampedArray(this.data.length);let e=.5*
b,k=.5*h;for(var l=0;l<a.length;l+=4)a[l]=a[l+1]=a[l+2]=255,a[l+3]=255;d*=c;c*=.5;var f=Math.ceil(Math.sqrt(b*b+h*h));l=(f-b)*.5;f=(f-h)*.5;for(var m of[{idx:0,r:0,g:255,b:255,angle:15*Math.PI/180},{idx:1,r:255,g:0,b:255,angle:75*Math.PI/180},{idx:2,r:255,g:255,b:0,angle:30*Math.PI/180}]){let x=Math.cos(m.angle),F=Math.sin(m.angle);for(let w=-f;w<h+f;w+=d)for(let G=-l;G<b+l;G+=d){var n=G+.5*d-e,q=w+.5*d-k,t=n*x-q*F+e;n=n*F+q*x+k;q=Math.round(t);var u=Math.round(n);if(!(q<0||u<0||q>=b||u>=h||(q=(u*
b+q)*p,u=g[q+3]/255,u<=0||(q=[1-(g[q]/255*u+(1-u)),1-(g[q+1]/255*u+(1-u)),1-(g[q+2]/255*u+(1-u))][m.idx],q<=0)))){q=.6+(c-.6)*Math.pow(q,.85);u=m.r;var v=m.g,A=m.b;let H=q*q;for(let P=-q;P<=q;P++)for(let B=-q;B<=q;B++){if(B*B+P*P>H)continue;var C=Math.round(t+B);let O=Math.round(n+P);C<0||O<0||C>=b||O>=h||(C=(O*b+C)*p,a[C]=a[C]*u>>8,a[C+1]=a[C+1]*v>>8,a[C+2]=a[C+2]*A>>8,a[C+3]=255)}!0}}}for(m=0;m<a.length;m+=4)255===a[m]&&255===a[m+1]&&255===a[m+2]&&(a[m+3]=0);this.data.set(a)};I.prototype.edge=function(a,
c,d,b){c=Math.max(1,0|c);a=this.getBounds().clipTo(a);var h=d>>16&255,p=d>>8&255;let g=255&d,e=this.width;var k=this.height;let l=I.BYTES_PER_PIXEL;d=new Uint8ClampedArray(this.data);let f=new Uint8ClampedArray(this.data.length);k=new Int32Array(e*k);for(var m=a.top;m<a.bottom;m++)for(var n=a.left;n<a.right;n++)k[m*e+n]=d[(m*e+n)*l+3]>0?0:1E9;c*=10;for(m=a.top;m<a.bottom;m++)for(n=a.left;n<a.right;n++){var q=m*e+n,t=k[q];n>a.left&&(t=Math.min(t,k[q-1]+10));m>a.top&&(t=Math.min(t,k[q-e]+10));n>a.left&&
m>a.top&&(t=Math.min(t,k[q-e-1]+14));n<a.right-1&&m>a.top&&(t=Math.min(t,k[q-e+1]+14));k[q]=t}for(m=a.bottom-1;m>=a.top;m--)for(n=a.right-1;n>=a.left;n--)q=m*e+n,t=k[q],n<a.right-1&&(t=Math.min(t,k[q+1]+10)),m<a.bottom-1&&(t=Math.min(t,k[q+e]+10)),n<a.right-1&&m<a.bottom-1&&(t=Math.min(t,k[q+e+1]+14)),n>a.left&&m<a.bottom-1&&(t=Math.min(t,k[q+e-1]+14)),k[q]=t;for(m=a.top;m<a.bottom;m++)for(n=a.left;n<a.right;n++){t=m*e+n;q=k[t];if(q>c)continue;t*=l;let u=1;q>c-10&&(u=(c-q)/10,u*=u);f[t]=h;f[t+1]=
p;f[t+2]=g;f[t+3]=255*u}if(!b)for(a=0;a<f.length;a+=4)b=d[a+3]/255,0!==b&&(h=f[a+3]/255,p=b+h*(1-b),f[a]=(d[a]*b+f[a]*h*(1-b))/p,f[a+1]=(d[a+1]*b+f[a+1]*h*(1-b))/p,f[a+2]=(d[a+2]*b+f[a+2]*h*(1-b))/p,f[a+3]=255*p);this.data.set(f)};I.prototype.monoHalftone=function(a,c,d=0,b=1){c=Math.max(2,0|c);this.getBounds().clipTo(a);a=this.width;let h=this.height,p=I.BYTES_PER_PIXEL,g=new Uint8ClampedArray(this.data),e=new Uint8ClampedArray(this.data.length);for(var k=0;k<e.length;k+=4)e[k]=e[k+1]=e[k+2]=0,e[k+
3]=0;k=d>>16&255;let l=d>>8&255;d&=255;let f=.5*a,m=.5*h;var n=45*Math.PI/180;let q=Math.cos(n);n=Math.sin(n);b*=c;c*=.5;var t=Math.ceil(Math.sqrt(a*a+h*h));let u=(t-a)*.5;t=(t-h)*.5;for(let w=-t;w<h+t;w+=b)for(let G=-u;G<a+u;G+=b){var v=G+.5*b-f,A=w+.5*b-m,C=v*q-A*n+f;v=v*n+A*q+m;A=0|C;var x=0|v;if(!(A<0||x<0||A>=a||x>=h||(A=(x*a+A)*p,x=g[A+3]/255,A=1-((.2126*g[A]+.7152*g[A+1]+.0722*g[A+2])/255*x+(1-x)),A<=0))){A=.5+(c-.5)*Math.pow(A,.9);x=A*A;for(let H=-A;H<=A;H++)for(let P=-A;P<=A;P++){if(P*P+
H*H>x)continue;var F=C+P|0;let B=v+H|0;F<0||B<0||F>=a||B>=h||(F=(B*a+F)*p,e[F]=k,e[F+1]=l,e[F+2]=d,e[F+3]=255)}!0}}this.data.set(e)};I.prototype.offsetOfPixel=function(a,c){return(c*this.width+a)*4|0};I.prototype.getMemorySize=function(){return this.data.length};I.prototype.getImageData=function(){return this.imageData};I.prototype.setImageData=function(a){this.width=a.width;this.height=a.height;this.imageData=a;this.data=a.data};I.prototype.clearAll=function(a){if(0==a&&"fill"in this.data)this.data.fill(0);
else{var c=a>>24&255,d=a>>16&255,b=a>>8&255;a&=255;for(var h=0;h<this.width*this.height*I.BYTES_PER_PIXEL;)this.data[h++]=d,this.data[h++]=b,this.data[h++]=a,this.data[h++]=c}};I.prototype.clearRect=function(a,c){a=this.getBounds().clipTo(a);var d=c>>24&255,b=c>>16&255,h=c>>8&255;c&=255;for(var p=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,g=this.offsetOfPixel(a.left,a.top),e=a.top;e<a.bottom;e++,g+=p)for(var k=a.left;k<a.right;k++)this.data[g++]=b,this.data[g++]=h,this.data[g++]=c,this.data[g++]=
d};I.prototype.copyRegionHFlip=function(a,c){a=this.getBounds().clipTo(a);for(var d=a.top;d<a.bottom;d++)for(var b=this.offsetOfPixel(a.left,d),h=c.offsetOfPixel(a.right-1,d),p=a.left;p<a.right;p++,h-=2*I.BYTES_PER_PIXEL)for(var g=0;g<I.BYTES_PER_PIXEL;g++)this.data[b++]=c.data[h++]};I.prototype.copyRegionVFlip=function(a,c){for(var d=(a=this.getBounds().clipTo(a)).getWidth()*I.BYTES_PER_PIXEL,b=a.top;b<a.bottom;b++)for(var h=this.offsetOfPixel(a.left,b),p=c.offsetOfPixel(a.left,a.bottom-1-(b-a.top)),
g=0;g<d;g++)this.data[h++]=c.data[p++]};I.prototype.fillWithNoise=function(a,c=0){a=this.getBounds().clipTo(a);let d=c>>16&255,b=c>>8&255;c&=255;for(var h=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,p=this.offsetOfPixel(a.left,a.top),g=a.top;g<a.bottom;g++,p+=h)for(var e=a.left;e<a.right;e++,p+=I.BYTES_PER_PIXEL){let k=1-(256*Math.random()|0)/255;this.data[p+I.RED_BYTE_OFFSET]=255-(255-d)*k|0;this.data[p+I.GREEN_BYTE_OFFSET]=255-(255-b)*k|0;this.data[p+I.BLUE_BYTE_OFFSET]=255-(255-c)*k|0;this.data[p+
I.ALPHA_BYTE_OFFSET]=255}};I.prototype.gradientHorzReplace=function(a,c,d,b){var h={r:b[0]>>16&255,g:b[0]>>8&255,b:255&b[0],a:b[0]>>24&255};b={r:b[1]>>16&255,g:b[1]>>8&255,b:255&b[1],a:b[1]>>24&255};var p=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,g=0|this.offsetOfPixel(a.left,a.top),e=a.bottom-a.top|0;if(d<c){var k=d;d=c;c=k;k=h;h=b;b=k}var l=d-c|0;k=(b.r-h.r)/l;var f=(b.g-h.g)/l,m=(b.b-h.b)/l;l=(b.a-h.a)/l;for(var n=Math.max(a.left-c,0),q=0;q<e;q++,g+=p){for(var t=a.left,u=0|Math.min(c,a.right);t<
u;t++,g+=I.BYTES_PER_PIXEL)this.data[g+I.RED_BYTE_OFFSET]=h.r,this.data[g+I.GREEN_BYTE_OFFSET]=h.g,this.data[g+I.BLUE_BYTE_OFFSET]=h.b,this.data[g+I.ALPHA_BYTE_OFFSET]=h.a;var v=h.r+k*n,A=h.g+f*n,C=h.b+m*n,x=h.a+l*n;for(u=0|Math.min(d,a.right);t<u;t++,g+=I.BYTES_PER_PIXEL)this.data[g+I.RED_BYTE_OFFSET]=v,this.data[g+I.GREEN_BYTE_OFFSET]=A,this.data[g+I.BLUE_BYTE_OFFSET]=C,this.data[g+I.ALPHA_BYTE_OFFSET]=x,v+=k,A+=f,C+=m,x+=l;for(;t<a.right;t++,g+=I.BYTES_PER_PIXEL)this.data[g+I.RED_BYTE_OFFSET]=
b.r,this.data[g+I.GREEN_BYTE_OFFSET]=b.g,this.data[g+I.BLUE_BYTE_OFFSET]=b.b,this.data[g+I.ALPHA_BYTE_OFFSET]=b.a}};I.prototype.gradientVertReplace=function(a,c,d,b){var h={r:b[0]>>16&255,g:b[0]>>8&255,b:255&b[0],a:b[0]>>24&255};b={r:b[1]>>16&255,g:b[1]>>8&255,b:255&b[1],a:b[1]>>24&255};let p=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,g=0|this.offsetOfPixel(a.left,a.top),e=a.right-a.left|0;if(d<c){var k=d;d=c;c=k;k=h;h=b;b=k}k=a.top;for(var l=0|Math.min(a.bottom,c);k<l;k++,g+=p)for(var f=0;f<e;f++,
g+=I.BYTES_PER_PIXEL)this.data[g+I.RED_BYTE_OFFSET]=h.r,this.data[g+I.GREEN_BYTE_OFFSET]=h.g,this.data[g+I.BLUE_BYTE_OFFSET]=h.b,this.data[g+I.ALPHA_BYTE_OFFSET]=h.a;var m=d-c|0;l=(b.r-h.r)/m;f=(b.g-h.g)/m;var n=(b.b-h.b)/m;m=(b.a-h.a)/m;var q=Math.max(k-c,0);c=h.r+l*q;var t=h.g+f*q,u=h.b+n*q;h=h.a+m*q;for(d=0|Math.min(a.bottom,d);k<d;k++,g+=p){for(q=0;q<e;q++,g+=I.BYTES_PER_PIXEL)this.data[g+I.RED_BYTE_OFFSET]=c,this.data[g+I.GREEN_BYTE_OFFSET]=t,this.data[g+I.BLUE_BYTE_OFFSET]=u,this.data[g+I.ALPHA_BYTE_OFFSET]=
h;c+=l;t+=f;u+=n;h+=m}for(;k<a.bottom;k++,g+=p)for(d=0;d<e;d++,g+=I.BYTES_PER_PIXEL)this.data[g+I.RED_BYTE_OFFSET]=b.r,this.data[g+I.GREEN_BYTE_OFFSET]=b.g,this.data[g+I.BLUE_BYTE_OFFSET]=b.b,this.data[g+I.ALPHA_BYTE_OFFSET]=b.a};I.prototype.gradientReplace=function(a,c,d,b,h,p){var g=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,e=0|this.offsetOfPixel(a.left,a.top),k=a.right-a.left|0,l=p[0]>>16&255,f=p[0]>>8&255,m=255&p[0],n=p[0]>>24&255,q=p[1]>>16&255,t=p[1]>>8&255,u=255&p[1];p=p[1]>>24&255;var v=
h-d+(b-c)*(b-c)/(h-d);b=b-c+(h-d)*(h-d)/(b-c);h=1/b;for(var A=a.top;A<a.bottom;A++,e+=g)for(var C=(a.left-c)/b+(A-d)/v,x=0;x<k;x++,e+=I.BYTES_PER_PIXEL){var F=Math.min(Math.max(C,0),1),w=1-F;this.data[e+I.RED_BYTE_OFFSET]=l*w+q*F;this.data[e+I.GREEN_BYTE_OFFSET]=f*w+t*F;this.data[e+I.BLUE_BYTE_OFFSET]=m*w+u*F;this.data[e+I.ALPHA_BYTE_OFFSET]=n*w+p*F;C+=h}};I.prototype.gradientAlpha=function(a,c,d,b,h,p){var g=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,e=0|this.offsetOfPixel(a.left,a.top),k=a.right-
a.left|0,l=p[0]>>16&255,f=p[0]>>8&255,m=255&p[0],n=p[0]>>24&255,q=p[1]>>16&255,t=p[1]>>8&255,u=255&p[1];p=p[1]>>24&255;var v=h-d+(b-c)*(b-c)/(h-d);b=b-c+(h-d)*(h-d)/(b-c);h=1/b;for(var A=a.top;A<a.bottom;A++,e+=g)for(var C=(a.left-c)/b+(A-d)/v,x=0;x<k;x++,e+=I.BYTES_PER_PIXEL){var F=Math.min(Math.max(C,0),1),w=1-F,G=l*w+q*F,H=f*w+t*F,P=m*w+u*F;w=n*w+p*F;F=this.data[e+I.ALPHA_BYTE_OFFSET];F=w+F-w*F/255|0;if(F>0){w=255*w/F|0;var B=255-w;this.data[e+I.RED_BYTE_OFFSET]=(G*w+this.data[e+I.RED_BYTE_OFFSET]*
B)/255|0;this.data[e+I.GREEN_BYTE_OFFSET]=(H*w+this.data[e+I.GREEN_BYTE_OFFSET]*B)/255|0;this.data[e+I.BLUE_BYTE_OFFSET]=(P*w+this.data[e+I.BLUE_BYTE_OFFSET]*B)/255|0;this.data[e+I.ALPHA_BYTE_OFFSET]=F}C+=h}};I.prototype.gradient=function(a,c,d,b,h,p,g){a=this.getBounds().clipTo(a);(c!=b||d!=h)&&(g||p[0]>>>24==255&&p[1]>>>24==255?c==b?this.gradientVertReplace(a,d,h,p):d==h?this.gradientHorzReplace(a,c,b,p):this.gradientReplace(a,c,d,b,h,p):this.gradientAlpha(a,c,d,b,h,p))};I.prototype.fillWithColorNoise=
function(a){a=this.getBounds().clipTo(a);for(var c,d=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,b=this.offsetOfPixel(a.left,a.top),h=a.top;h<a.bottom;h++,b+=d)for(var p=a.left;p<a.right;p++,b+=I.BYTES_PER_PIXEL)c=16777216*Math.random()|0,this.data[b+I.RED_BYTE_OFFSET]=c>>16&255,this.data[b+I.GREEN_BYTE_OFFSET]=c>>8&255,this.data[b+I.BLUE_BYTE_OFFSET]=255&c,this.data[b+I.ALPHA_BYTE_OFFSET]=255};I.prototype.invert=function(a){a=this.getBounds().clipTo(a);for(var c=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,
d=this.offsetOfPixel(a.left,a.top),b=a.top;b<a.bottom;b++,d+=c)for(var h=a.left;h<a.right;h++,d+=I.BYTES_PER_PIXEL)this.data[d+I.RED_BYTE_OFFSET]^=255,this.data[d+I.GREEN_BYTE_OFFSET]^=255,this.data[d+I.BLUE_BYTE_OFFSET]^=255};I.prototype.brightnessToOpacity=function(a){a=this.getBounds().clipTo(a);let c=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top);for(let h=a.top;h<a.bottom;h++,d+=c)for(let p=a.left;p<a.right;p++,d+=I.BYTES_PER_PIXEL){var b=void 0;b=(this.data[d+
I.RED_BYTE_OFFSET]+this.data[d+I.GREEN_BYTE_OFFSET]+this.data[d+I.BLUE_BYTE_OFFSET])/3;let g=this.data[d+I.ALPHA_BYTE_OFFSET]/255;b=b>250?0:Math.round((1-b/250)*255);this.data[d+I.ALPHA_BYTE_OFFSET]=Math.round(b*g);b>0&&(this.data[d+I.RED_BYTE_OFFSET]=0,this.data[d+I.GREEN_BYTE_OFFSET]=0,this.data[d+I.BLUE_BYTE_OFFSET]=0)}};I.prototype.getNonTransparentBounds=function(a){var c,d,b=a.clone();var h=(this.width-b.getWidth())*I.BYTES_PER_PIXEL;a=this.offsetOfPixel(b.left,b.top)+I.ALPHA_BYTE_OFFSET;for(d=
b.top;d<b.bottom;d++,a+=h){var p=0;for(c=b.left;c<b.right;c++,a+=I.BYTES_PER_PIXEL)p|=this.data[a];if(0!=p)break}if(b.top=d,b.top==b.bottom)return b;a=this.offsetOfPixel(b.right-1,b.bottom-1)+I.ALPHA_BYTE_OFFSET;for(d=b.bottom-1;d>=b.top;d--,a-=h){p=0;for(c=b.right-1;c>=b.left;c--,a-=I.BYTES_PER_PIXEL)p|=this.data[a];if(0!=p)break}b.bottom=d+1;h=I.BYTES_PER_PIXEL*this.width;for(c=b.left;c<b.right;c++){a=this.offsetOfPixel(c,b.top)+I.ALPHA_BYTE_OFFSET;p=0;for(d=b.top;d<b.bottom;d++,a+=h)p|=this.data[a];
if(0!=p)break}b.left=c;for(c=b.right-1;c>=b.left;c--){a=this.offsetOfPixel(c,b.top)+I.ALPHA_BYTE_OFFSET;p=0;for(d=b.top;d<b.bottom;d++,a+=h)p|=this.data[a];if(0!=p)break}return b.right=c+1,b};I.prototype.getAsCanvas=function(a){var c=Vc(this.imageData.width,this.imageData.height);return c.getContext("2d").putImageData(this.imageData,0,0),ef(c,a||0)};I.prototype.getAsPNG=function(a){var c;return"string"==typeof(c=this.getAsCanvas(a).toDataURL("image/png"))&&!!c.match(/^data:image\/png;base64,/i)&&
window.atob(c.substring(22))};I.prototype.getAsPNGBuffer=function(a){return this.getAsCanvas(a).toBuffer("image/png")};I.prototype.hasAlphaInRect=function(a){a=this.getBounds().clipTo(a);for(var c=(this.width-a.getWidth())*I.BYTES_PER_PIXEL,d=this.offsetOfPixel(a.left,a.top)+I.ALPHA_BYTE_OFFSET,b=a.top;b<a.bottom;b++,d+=c){for(var h=255,p=a.left;p<a.right;p++,d+=I.BYTES_PER_PIXEL)h&=this.data[d];if(255!=h)return!0}return!1};I.prototype.hasAlpha=function(){return this.hasAlphaInRect(this.getBounds())};
I.createFromImage=function(a){var c=Vc(a.width,a.height).getContext("2d");return c.globalCompositeOperation="copy",c.drawImage(a,0,0),new I(c.getImageData(0,0,a.width,a.height))};I.prototype.equals=function(a){if(this.width!=a.width||this.height!=a.height)return!1;for(let c=0;c<this.data.length;c+=I.BYTES_PER_PIXEL)if(!(0==this.data[c+I.ALPHA_BYTE_OFFSET]&&0==a.data[c+I.ALPHA_BYTE_OFFSET]||this.data[c]==a.data[c]&&this.data[c+1]==a.data[c+1]&&this.data[c+2]==a.data[c+2]&&this.data[c+3]==a.data[c+
3]))return!1;return!0};$a.prototype=Object.create(db.prototype);$a.prototype.constructor=$a;$a.prototype.getLinearizedLayerList=function(a,c=[]){for(let d of(c=c||[],this.layers))d instanceof $a&&(d.expanded||!a)&&d.getLinearizedLayerList(a,c),c.push(d);return c};$a.prototype.clearLayers=function(){this.layers=[]};$a.prototype.addLayer=function(a){a.parent=this;this.layers.push(a)};$a.prototype.insertLayer=function(a,c){c.parent=this;this.layers.splice(a,0,c)};$a.prototype.removeLayer=function(a){a=
this.layers.indexOf(a);a>-1&&this.layers.splice(a,1)};$a.prototype.removeLayerAtIndex=function(a){var c=this.layers[a];return c&&this.layers.splice(a,1),c};$a.prototype.setLayerAtIndex=function(a,c){var d=this.layers[a];return c.parent=this,this.layers[a]=c,d};$a.prototype.setExpanded=function(a){this.expanded=a};$a.prototype.getExpanded=function(){return this.expanded};$a.prototype.indexOf=function(a){return this.layers.indexOf(a)};$a.prototype.getMemoryUsed=function(){return this.layers.map(a=>
a.getMemoryUsed()).reduce(qg,0)};$a.prototype.clone=function(){var a=new $a(this.name,this.blendMode);return db.prototype.copyFrom.call(a,this),a.expanded=this.expanded,a.layers=this.layers.map(c=>c.clone()),a.layers.forEach(c=>c.parent=a),a};$a.prototype.getNonTransparentBounds=function(a){var c=new Ca(0,0,0,0);return this.layers.forEach(d=>c.union(d.getNonTransparentBounds(a))),c};Pa.prototype=Object.create(Uc.prototype);Pa.prototype.constructor=Pa;Pa.prototype.createBitmap=function(a,c,d){switch(this.bitDepth=
d,d){case 32:this.data=new Uint32Array(a*c);break;case 16:this.data=new Uint16Array(a*c);break;default:this.data=new Uint8Array(a*c)}};Pa.prototype.clone=function(){var a=new Pa(this.width,this.height,this.bitDepth);return a.copyPixelsFrom(this),a};Pa.prototype.cloneRect=function(a){var c=new Pa(a.getWidth(),a.getHeight(),this.bitDepth);return c.copyBitmapRect(this,0,0,a),c};Pa.prototype.getPixel=function(a,c){return a=Math.max(0,Math.min(this.width-1,a)),c=Math.max(0,Math.min(this.height-1,c)),this.data[this.offsetOfPixel(a,
c)]};Pa.prototype.setPixel=function(a,c,d){a=Math.max(0,Math.min(this.width-1,a));c=Math.max(0,Math.min(this.height-1,c));a=this.offsetOfPixel(a,c);this.data[a]=d};Pa.prototype.clearAll=function(a){this.data.fill(a)};Pa.prototype.clearRect=function(a,c){if((a=this.getBounds().clipTo(a)).equals(this.getBounds()))this.clearAll(c);else{let d=this.width,b=a.right-a.left,h=this.offsetOfPixel(a.left,a.top);for(let p=a.top;p<a.bottom;p++,h+=d)this.data.fill(c,h,h+b)}};Pa.prototype.copyScaledNearestNeighbor=
function(a){for(var c,d=0,b=a.width/this.width,h=a.height/this.height,p=0,g=0;p<this.height;p++,g+=h){c=a.offsetOfPixel(0,Math.round(g));for(var e=0,k=0;e<this.width;e++,d++,k+=b)this.data[d]=a.data[c+Math.round(k)]}};Pa.prototype.floodFillWithBorder=function(a,c,d,b=2,h=255){if(this.isInside(a,c)){d&=255;var p=this.width,g=this.height,e=this.data,k=new Uint8Array(p*g),l=e[c*p+a];h/=255;for(a=[{x:a,y:c}];a.length;){var f=void 0;let {x:n,y:q}=a.pop();n<0||q<0||n>=p||q>=g||(c=q*p+n,k[c]||Math.abs(e[c]-
l)>10||(k[c]=1,f=Math.round(e[c]*(1-h)+d*h),e[c]=f,a.push({x:n+1,y:q}),a.push({x:n-1,y:q}),a.push({x:n,y:q+1}),a.push({x:n,y:q-1})))}if(b>0){f=new Uint8ClampedArray(e);l=new Uint8ClampedArray(f);for(a=0;a<g;a++)for(c=0;c<p;c++)if(k[a*p+c])for(let n=-b;n<=b;n++)for(let q=-b;q<=b;q++){var m=c+q;let t=a+n;m<0||t<0||m>=p||t>=g||(m=t*p+m,k[m]||(l[m]=Math.round(f[m]*(1-h)+d*h)))}e.set(l)}}};Pa.prototype.createThumbnailFrom=function(a){let c=Math.min(Math.floor(a.width/this.width),3);if(c<2)return void this.copyScaledNearestNeighbor(a);
let d=new Uint16Array(this.width);var b=a.width,h=Math.floor(a.width/this.width);let p=Math.floor(a.width/this.width/c),g=h-p*c;var e=Math.floor(a.height/this.height/c);h=e*b-h*this.width;b*=Math.floor(a.height/this.height)-e*c;let k=e=0;for(let f=0;f<this.height;f++,e+=b){let m;d.fill(0);for(var l=0;l<c;l++,e+=h){m=0;for(let n=0;n<this.width;n++,m++,e+=g)for(let q=0;q<c;q++,e+=p)d[m]+=a.data[e]}m=0;for(l=0;l<this.width;l++,m++,k++)this.data[k]=d[m]/(c*c)}};Pa.prototype.mirrorHorizontally=function(){let a=
this.width,c=this.height,d=new Uint8Array(a*c),b=0,h=a;for(let p=0;p<c;p++,h+=a+a)for(let g=0;g<a;g++)d[b++]=this.data[--h];this.data=d};Pa.prototype.applyLUT=function(a){for(var c=0;c<this.data.length;c++)this.data[c]=a.table[this.data[c]]};Pa.prototype.getAsCanvas=function(a){var c=this.getImageData(0,0,this.width,this.height),d=Vc(this.width,this.height);return d.getContext("2d").putImageData(c,0,0),ef(d,a||0)};Pa.prototype.getImageData=function(a,c,d,b){let h=te(d,b);a=this.offsetOfPixel(a,c);
c=0;let p=this.width-d;for(let g=0;g<b;g++,a+=p)for(let e=0;e<d;e++,a++)h.data[c++]=this.data[a],h.data[c++]=this.data[a],h.data[c++]=this.data[a],h.data[c++]=255;return h};Pa.prototype.pasteImageData=function(a,c,d){let b=0;c=this.offsetOfPixel(c,d);d=this.width-a.width;for(let h=0;h<a.height;h++,c+=d)for(let p=0;p<a.width;p++,b+=4,c++)this.data[c]=a.data[b];return a};Pa.prototype.copyPixelsFrom=function(a){a.width!=this.width||a.height!=this.height||a.bitDepth!=this.bitDepth?(this.data=a.data.slice(0),
this.width=a.width,this.height=a.height,this.bitDepth=a.bitDepth):this.data.set(a.data)};Pa.prototype.copyRectXOR=function(a,c){for(var d=(c=this.getBounds().clipTo(c)).getWidth(),b=new Uint8Array(d*c.getHeight()),h=0,p=this.offsetOfPixel(c.left,c.top),g=a.offsetOfPixel(c.left,c.top),e=this.width-d,k=a.width-d,l=c.top;l<c.bottom;l++,p+=e,g+=k)for(var f=0;f<d;f++,h++,p++,g++)b[h]=this.data[p]^a.data[g];return b};Pa.prototype.setRectXOR=function(a,c){var d=(c=this.getBounds().clipTo(c)).getWidth(),
b=c.getHeight();c=this.offsetOfPixel(c.left,c.top);for(var h=0,p=this.width-d,g=0;g<b;g++){for(var e=0;e<d;e++)this.data[c++]^=a[h++];c+=p}};Pa.prototype.copyBitmapRect=function(a,c,d,b){var h=new Ca(c,d,0,0);b=b.clone();this.getBounds().clipSourceDest(b,h);c=0|h.getWidth();d=0|h.getHeight();if(0==h.left&&0==h.top&&c==this.width&&d==this.height&&c==a.width&&d==a.height)this.copyPixelsFrom(a);else{h=this.offsetOfPixel(h.left,h.top);var p=this.width-c;b=a.offsetOfPixel(b.left,b.top);for(var g=a.width-
c,e=0;e<d;e++,b+=g,h+=p)for(var k=0;k<c;k++,b++,h++)this.data[h]=a.data[b]}};Pa.prototype.copyRegionHFlip=function(a,c){a=this.getBounds().clipTo(a);for(var d=a.top;d<a.bottom;d++)for(var b=this.offsetOfPixel(a.left,d),h=c.offsetOfPixel(a.right-1,d),p=a.left;p<a.right;p++,h-=2)this.data[b++]=c.data[h++]};Pa.prototype.copyRegionVFlip=function(a,c){for(var d=(a=this.getBounds().clipTo(a)).getWidth(),b=a.top;b<a.bottom;b++)for(var h=this.offsetOfPixel(a.left,b),p=c.offsetOfPixel(a.left,a.bottom-1-(b-
a.top)),g=0;g<d;g++)this.data[h++]=c.data[p++]};Pa.prototype.copyPixelColumnToArray=function(a,c,d,b){var h=this.width,p=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++)b[p]=this.data[a],a+=h,p++};Pa.prototype.copyArrayToPixelColumn=function(a,c,d,b){var h=this.width,p=0;a=this.offsetOfPixel(a,c);for(c=0;c<d;c++)this.data[a]=b[p],a+=h,p++};Pa.prototype.boxBlur=function(a,c,d){let b=(a=this.getBounds().clipTo(a)).getWidth(),h=a.getHeight();var p=Math.max(b,h);let g=new this.data.constructor(p);p=new this.data.constructor(p);
for(let l=a.top;l<a.bottom;l++){var e=this.offsetOfPixel(a.left,l);for(var k=0;k<b;k++)g[k]=this.data[e++];ff(g,p,b,c);e=this.offsetOfPixel(a.left,l);for(k=0;k<b;k++)this.data[e++]=p[k]}for(c=a.left;c<a.right;c++)this.copyPixelColumnToArray(c,a.top,h,g),ff(g,p,h,d),this.copyArrayToPixelColumn(c,a.top,h,p)};Pa.prototype.offsetOfPixel=function(a,c){return c*this.width+a};Pa.prototype.mosaic=function(a,c){a=this.getBounds().clipTo(a);c=Math.max(1,0|c);let d=this.width,b=this.data;for(let k=a.top;k<a.bottom;k+=
c){let l=Math.min(k+c,a.bottom);for(let f=a.left;f<a.right;f+=c){let m=Math.min(f+c,a.right);var h=0,p=0;for(var g=k;g<l;g++){var e=g*d+f;for(let n=f;n<m;n++)h+=b[e++],p++}h=h/p|0;for(p=k;p<l;p++)for(g=p*d+f,e=f;e<m;e++)b[g++]=h}}};Pa.prototype.monoHalftone=function(a,c,d,b=1){c=Math.max(2,0|c);this.getBounds().clipTo(a);a=this.width;d=this.height;Pa.BYTES_PER_PIXEL;let h=new Uint8ClampedArray(this.data),p=new Uint8ClampedArray(this.data.length);for(var g=0;g<p.length;g++)p[g]=255;g=.5*a;let e=.5*
d;var k=45*Math.PI/180;let l=Math.cos(k);k=Math.sin(k);b*=c;c*=.5;var f=Math.ceil(Math.sqrt(a*a+d*d));let m=(f-a)*.5;f=(f-d)*.5;for(let v=-f;v<d+f;v+=b)for(let A=-m;A<a+m;A+=b){var n=A+.5*b-g,q=v+.5*b-e,t=n*l-q*k+g;n=n*k+q*l+e;q=0|t;var u=0|n;if(!(q<0||u<0||q>=a||u>=d||(q=1-h[u*a+q]/255,q<=0))){q=.5+(c-.5)*Math.pow(q,.9);u=q*q;for(let C=-q;C<=q;C++)for(let x=-q;x<=q;x++){if(x*x+C*C>u)continue;let F=t+x|0,w=n+C|0;F<0||w<0||F>=a||w>=d||(p[w*a+F]=0)}!0}}this.data.set(p)};Pa.prototype.fillWithNoise=function(a){a=
this.getBounds().clipTo(a);for(var c=this.width-a.getWidth(),d=this.offsetOfPixel(a.left,a.top),b=a.top;b<a.bottom;b++,d+=c)for(var h=a.left;h<a.right;h++,d++)this.data[d]=256*Math.random()|0};Pa.prototype.invert=function(a){a=this.getBounds().clipTo(a);for(var c=this.width-a.getWidth(),d=this.offsetOfPixel(a.left,a.top),b=a.top;b<a.bottom;b++,d+=c)for(var h=a.left;h<a.right;h++,d++)this.data[d]=~this.data[d]};Pa.prototype.getValueBounds=function(a,c){var d,b,h=a.clone();var p=this.width-h.getWidth();
a=this.offsetOfPixel(h.left,h.top);for(b=h.top;b<h.bottom;b++,a+=p){var g=!1;for(d=h.left;d<h.right;d++,a++)if(this.data[a]!=c){g=!0;break}if(g)break}if(h.top=b,h.top==h.bottom)return h;a=this.offsetOfPixel(h.right-1,h.bottom-1);for(b=h.bottom-1;b>=h.top;b--,a-=p){g=!1;for(d=h.right-1;d>=h.left;d--,a--)if(this.data[a]!=c){g=!0;break}if(g)break}h.bottom=b+1;p=this.width;for(d=h.left;d<h.right;d++){a=this.offsetOfPixel(d,h.top);g=!1;for(b=h.top;b<h.bottom;b++,a+=p)if(this.data[a]!=c){g=!0;break}if(g)break}h.left=
d;for(d=h.right-1;d>=h.left;d--){a=this.offsetOfPixel(d,h.top);g=!1;for(b=h.top;b<h.bottom;b++,a+=p)if(this.data[a]!=c){g=!0;break}if(g)break}return h.right=d+1,h};Pa.prototype.gradientHorzReplace=function(a,c,d,b){var h=255&b[0];b=255&b[1];var p=this.width-a.getWidth(),g=0|this.offsetOfPixel(a.left,a.top),e=a.bottom-a.top|0;if(d<c){var k=d;d=c;c=k;k=h;h=b;b=k}k=(b-h)/(d-c|0);for(var l=Math.max(a.left-c,0),f=0;f<e;f++,g+=p){for(var m=a.left,n=0|Math.min(c,a.right);m<n;m++,g++)this.data[g]=h;var q=
h+k*l;for(n=0|Math.min(d,a.right);m<n;m++,g++)this.data[g]=q,q+=k;for(;m<a.right;m++,g++)this.data[g]=b}};Pa.prototype.gradientVertReplace=function(a,c,d,b){var h=255&b[0];b=255&b[1];let p=this.width-a.getWidth(),g=0|this.offsetOfPixel(a.left,a.top),e=a.right-a.left|0;if(d<c){var k=d;d=c;c=k;k=h;h=b;b=k}k=a.top;for(var l=0|Math.min(a.bottom,c);k<l;k++,g+=p)for(let f=0;f<e;f++,g++)this.data[g]=h;l=(b-h)/(d-c|0);c=h+l*Math.max(k-c,0);for(d=0|Math.min(a.bottom,d);k<d;k++,g+=p){for(h=0;h<e;h++,g++)this.data[g]=
c;c+=l}for(;k<a.bottom;k++,g+=p)for(d=0;d<e;d++,g++)this.data[g]=b};Pa.prototype.gradientReplace=function(a,c,d,b,h,p){var g=this.width-a.getWidth(),e=0|this.offsetOfPixel(a.left,a.top),k=a.right-a.left|0,l=255&p[0];p=255&p[1];var f=h-d+(b-c)*(b-c)/(h-d);b=b-c+(h-d)*(h-d)/(b-c);h=1/b;for(var m=a.top;m<a.bottom;m++,e+=g)for(var n=(a.left-c)/b+(m-d)/f,q=0;q<k;q++,e++){var t=Math.min(Math.max(n,0),1);this.data[e]=l*(1-t)+p*t;n+=h}};Pa.prototype.gradientAlpha=function(a,c,d,b,h,p){var g=this.width-a.getWidth(),
e=0|this.offsetOfPixel(a.left,a.top),k=a.right-a.left|0,l=255&p[0],f=p[0]>>24&255,m=255&p[1];p=p[1]>>24&255;var n=h-d+(b-c)*(b-c)/(h-d);b=b-c+(h-d)*(h-d)/(b-c);h=1/b;for(var q=a.top;q<a.bottom;q++,e+=g)for(var t=(a.left-c)/b+(q-d)/n,u=0;u<k;u++,e++){var v=Math.min(Math.max(t,0),1),A=1-v,C=f*A+p*v;this.data[e]=((l*A+m*v)*C+this.data[e]*(255-C))/255|0;t+=h}};Pa.prototype.gradient=function(a,c,d,b,h,p,g){a=this.getBounds().clipTo(a);(c!=b||d!=h)&&(g||p[0]>>>24==255&&p[1]>>>24==255?c==b?this.gradientVertReplace(a,
d,h,p):d==h?this.gradientHorzReplace(a,c,b,p):this.gradientReplace(a,c,d,b,h,p):this.gradientAlpha(a,c,d,b,h,p))};Pa.prototype.equals=function(a){if(this.width!=a.width||this.height!=a.height)return!1;for(let c=0;c<this.data.length;c++)if(this.data[c]!=a.data[c])return!1;return!0};let Ab=Array(256),Bb=Array(256);Q.multiplyOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<
h;e++,b+=4){let k=c.data[b+3],l;k&&(l=a.data[b],a.data[b]=l-((255^c.data[b])*l*k/65025|0),l=a.data[b+1],a.data[b+1]=l-((255^c.data[b+1])*l*k/65025|0),l=a.data[b+2],a.data[b+2]=l-((255^c.data[b+2])*l*k/65025|0))}};Q.multiplyOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f;l&&(f=a.data[b],a.data[b]=f-((255^c.data[b])*f*l/65025|
0),f=a.data[b+1],a.data[b+1]=f-((255^c.data[b+1])*f*l/65025|0),f=a.data[b+2],a.data[b+2]=f-((255^c.data[b+2])*f*l/65025|0))}};Q.multiplyOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];a.data[b]=(g*q+f*t+(g*f*n/
255|0))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(g*q+f*t+(g*f*n/255|0))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(g*q+f*t+(g*f*n/255|0))/m|0;a.data[b+3]=m}}};Q.multiplyOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|
0;e=c.data[b];m=a.data[b];a.data[b]=(e*t+m*u+(e*m*q/255|0))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(e*t+m*u+(e*m*q/255|0))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(e*t+m*u+(e*m*q/255|0))/n|0;a.data[b+3]=n}}};Q.multiplyOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*
h.data[b]/255|0,n;m&&(n=a.data[e],a.data[e]=n-((255^c.data[e])*n*m/65025|0),n=a.data[e+1],a.data[e+1]=n-((255^c.data[e+1])*n*m/65025|0),n=a.data[e+2],a.data[e+2]=n-((255^c.data[e+2])*n*m/65025|0))}};Q.multiplyOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/
25500|0,q;n&&(q=a.data[k],a.data[k]=q-((255^c.data[k])*q*n/65025|0),q=a.data[k+1],a.data[k+1]=q-((255^c.data[k+1])*q*n/65025|0),q=a.data[k+2],a.data[k+2]=q-((255^c.data[k+2])*q*n/65025|0))}};Q.multiplyOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,
q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(l*v+q*A+(l*q*u/255|0))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(l*v+q*A+(l*q*u/255|0))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(l*v+q*A+(l*q*u/255|0))/t|0;a.data[e+3]=t}}};Q.multiplyOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,
b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(f*A+t*C+(f*t*v/255|0))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(f*A+t*C+(f*t*v/255|0))/u|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(f*A+t*C+(f*t*v/255|0))/u|0;a.data[k+3]=u}}};Q.multiply2OntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=
0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l;k&&(l=a.data[b],a.data[b]=l-Math.ceil((255^c.data[b])*l*k/65025),l=a.data[b+1],a.data[b+1]=l-Math.ceil((255^c.data[b+1])*l*k/65025),l=a.data[b+2],a.data[b+2]=l-Math.ceil((255^c.data[b+2])*l*k/65025))}};Q.multiply2OntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=
0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f;l&&(f=a.data[b],a.data[b]=f-Math.ceil((255^c.data[b])*f*l/65025),f=a.data[b+1],a.data[b+1]=f-Math.ceil((255^c.data[b+1])*f*l/65025),f=a.data[b+2],a.data[b+2]=f-Math.ceil((255^c.data[b+2])*f*l/65025))}};Q.multiply2OntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,
f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];a.data[b]=(g*q+f*t+(g*f*n/255|0))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(g*q+f*t+(g*f*n/255|0))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(g*q+f*t+(g*f*n/255|0))/m|0;a.data[b+3]=m}}};Q.multiply2OntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=
0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=(e*t+m*u+(e*m*q/255|0))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(e*t+m*u+(e*m*q/255|0))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(e*t+m*u+(e*m*q/255|0))/n|0;a.data[b+3]=n}}};Q.multiply2OntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,
b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n;m&&(n=a.data[e],a.data[e]=n-Math.ceil((255^c.data[e])*n*m/65025),n=a.data[e+1],a.data[e+1]=n-Math.ceil((255^c.data[e+1])*n*m/65025),n=a.data[e+2],a.data[e+2]=n-Math.ceil((255^c.data[e+2])*n*m/65025))}};Q.multiply2OntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,
b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q;n&&(q=a.data[k],a.data[k]=q-Math.ceil((255^c.data[k])*q*n/65025),q=a.data[k+1],a.data[k+1]=q-Math.ceil((255^c.data[k+1])*q*n/65025),q=a.data[k+2],a.data[k+2]=q-Math.ceil((255^c.data[k+2])*q*n/65025))}};Q.multiply2OntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,
b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(l*v+q*A+(l*q*u/255|0))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(l*v+q*A+(l*q*u/255|0))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(l*v+q*A+(l*q*u/255|0))/t|0;a.data[e+3]=t}}};Q.multiply2OntoTransparentFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(f*A+t*C+(f*t*v/255|0))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(f*A+t*C+(f*t*v/255|0))/u|0;f=c.data[k+2];
t=a.data[k+2];a.data[k+2]=(f*A+t*C+(f*t*v/255|0))/u|0;a.data[k+3]=u}}};Q.normalOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l;if(k)if(255==k)a.data[b]=c.data[b],a.data[b+1]=c.data[b+1],a.data[b+2]=c.data[b+2];else{let f=255-k;l=c.data[b];a.data[b]=(l*k+a.data[b]*f)/255|0;l=c.data[b+1];a.data[b+1]=(l*k+a.data[b+1]*f)/255|0;l=c.data[b+2];
a.data[b+2]=(l*k+a.data[b+2]*f)/255|0}}};Q.normalOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f;if(l){let m=255-l;f=c.data[b];a.data[b]=(f*l+a.data[b]*m)/255|0;f=c.data[b+1];a.data[b+1]=(f*l+a.data[b+1]*m)/255|0;f=c.data[b+2];a.data[b+2]=(f*l+a.data[b+2]*m)/255|0}}};Q.normalOntoTransparentFusionWithOpaqueLayer=function(a,
c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l;if(g){let f=g+(l=a.data[b+3])-(g*l/255|0)|0;g=255*g/f|0;let m=255-g;a.data[b]=(c.data[b]*g+a.data[b]*m)/255|0;a.data[b+1]=(c.data[b+1]*g+a.data[b+1]*m)/255|0;a.data[b+2]=(c.data[b+2]*g+a.data[b+2]*m)/255|0;a.data[b+3]=f}}};Q.normalOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),
g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f;if(e){let m=e+(f=a.data[b+3])-(e*f/255|0)|0;e=255*e/m|0;let n=255-e;a.data[b]=(c.data[b]*e+a.data[b]*n)/255|0;a.data[b+1]=(c.data[b+1]*e+a.data[b+1]*n)/255|0;a.data[b+2]=(c.data[b+2]*e+a.data[b+2]*n)/255|0;a.data[b+3]=m}}};Q.normalOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,
b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n;if(m)if(255==m)a.data[e]=c.data[e],a.data[e+1]=c.data[e+1],a.data[e+2]=c.data[e+2];else{let q=255-m;n=c.data[e];a.data[e]=(n*m+a.data[e]*q)/255|0;n=c.data[e+1];a.data[e+1]=(n*m+a.data[e+1]*q)/255|0;n=c.data[e+2];a.data[e+2]=(n*m+a.data[e+2]*q)/255|0}}};Q.normalOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|
b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q;if(n){let t=255-n;q=c.data[k];a.data[k]=(q*n+a.data[k]*t)/255|0;q=c.data[k+1];a.data[k+1]=(q*n+a.data[k+1]*t)/255|0;q=c.data[k+2];a.data[k+2]=(q*n+a.data[k+2]*t)/255|0}}};Q.normalOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-
p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n;if(l){let q=l+(n=a.data[e+3])-(l*n/255|0)|0;l=255*l/q|0;let t=255-l;a.data[e]=(c.data[e]*l+a.data[e]*t)/255|0;a.data[e+1]=(c.data[e+1]*l+a.data[e+1]*t)/255|0;a.data[e+2]=(c.data[e+2]*l+a.data[e+2]*t)/255|0;a.data[e+3]=q}}};Q.normalOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),
g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q;if(f){let t=f+(q=a.data[k+3])-(f*q/255|0)|0;f=255*f/t|0;let u=255-f;a.data[k]=(c.data[k]*f+a.data[k]*u)/255|0;a.data[k+1]=(c.data[k+1]*f+a.data[k+1]*u)/255|0;a.data[k+2]=(c.data[k+2]*f+a.data[k+2]*u)/255|0;a.data[k+3]=t}}};Q.addOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=
0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3];k&&(a.data[b]=a.data[b]+k*c.data[b]/255|0,a.data[b+1]=a.data[b+1]+k*c.data[b+1]/255|0,a.data[b+2]=a.data[b+2]+k*c.data[b+2]/255|0)}};Q.addOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+
3]*d/100|0;l&&(a.data[b]=a.data[b]+l*c.data[b]/255|0,a.data[b+1]=a.data[b+1]+l*c.data[b+1]/255|0,a.data[b+2]=a.data[b+2]+l*c.data[b+2]/255|0)}};Q.addOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l;if(k){let f=k+(l=a.data[b+3])-(k*l/255|0)|0;a.data[b]=(l*a.data[b]+k*c.data[b])/f|0;a.data[b+1]=(l*a.data[b+1]+k*c.data[b+1])/f|0;a.data[b+
2]=(l*a.data[b+2]+k*c.data[b+2])/f|0;a.data[b+3]=f}}};Q.addOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f;if(l){let m=l+(f=a.data[b+3])-(l*f/255|0)|0;a.data[b]=(f*a.data[b]+l*c.data[b])/m|0;a.data[b+1]=(f*a.data[b+1]+l*c.data[b+1])/m|0;a.data[b+2]=(f*a.data[b+2]+l*c.data[b+2])/m|0;a.data[b+3]=m}}};Q.addOntoOpaqueFusionWithOpaqueLayerMasked=
function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0;m&&(a.data[e]=a.data[e]+m*c.data[e]/255|0,a.data[e+1]=a.data[e+1]+m*c.data[e+1]/255|0,a.data[e+2]=a.data[e+2]+m*c.data[e+2]/255|0)}};Q.addOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-
g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0;n&&(a.data[k]=a.data[k]+n*c.data[k]/255|0,a.data[k+1]=a.data[k+1]+n*c.data[k+1]/255|0,a.data[k+2]=a.data[k+2]+n*c.data[k+2]/255|0)}};Q.addOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,
b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n;if(m){let q=m+(n=a.data[e+3])-(m*n/255|0)|0;a.data[e]=(n*a.data[e]+m*c.data[e])/q|0;a.data[e+1]=(n*a.data[e+1]+m*c.data[e+1])/q|0;a.data[e+2]=(n*a.data[e+2]+m*c.data[e+2])/q|0;a.data[e+3]=q}}};Q.addOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,
b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q;if(n){let t=n+(q=a.data[k+3])-(n*q/255|0)|0;a.data[k]=(q*a.data[k]+n*c.data[k])/t|0;a.data[k+1]=(q*a.data[k+1]+n*c.data[k+1])/t|0;a.data[k+2]=(q*a.data[k+2]+n*c.data[k+2])/t|0;a.data[k+3]=t}}};Q.subtractOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=
c.data[b+3];k&&(a.data[b]=a.data[b]+k*c.data[b]/255-k|0,a.data[b+1]=a.data[b+1]+k*c.data[b+1]/255-k|0,a.data[b+2]=a.data[b+2]+k*c.data[b+2]/255-k|0)}};Q.subtractOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0;l&&(a.data[b]=a.data[b]+l*c.data[b]/255-l|0,a.data[b+1]=a.data[b+1]+l*c.data[b+1]/255-l|0,a.data[b+2]=a.data[b+2]+l*c.data[b+
2]/255-l|0)}};Q.subtractOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l;if(k){let f=k+(l=a.data[b+3])-(k*l/255|0)|0,m=k*l;a.data[b]=(l*a.data[b]+k*c.data[b]-m)/f|0;a.data[b+1]=(l*a.data[b+1]+k*c.data[b+1]-m)/f|0;a.data[b+2]=(l*a.data[b+2]+k*c.data[b+2]-m)/f|0;a.data[b+3]=f}}};Q.subtractOntoTransparentFusionWithTransparentLayer=function(a,
c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f;if(l){let m=l+(f=a.data[b+3])-(l*f/255|0)|0,n=l*f;a.data[b]=(f*a.data[b]+l*c.data[b]-n)/m|0;a.data[b+1]=(f*a.data[b+1]+l*c.data[b+1]-n)/m|0;a.data[b+2]=(f*a.data[b+2]+l*c.data[b+2]-n)/m|0;a.data[b+3]=m}}};Q.subtractOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*
4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0;m&&(a.data[e]=a.data[e]+m*c.data[e]/255-m|0,a.data[e+1]=a.data[e+1]+m*c.data[e+1]/255-m|0,a.data[e+2]=a.data[e+2]+m*c.data[e+2]/255-m|0)}};Q.subtractOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|
h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0;n&&(a.data[k]=a.data[k]+n*c.data[k]/255-n|0,a.data[k+1]=a.data[k+1]+n*c.data[k+1]/255-n|0,a.data[k+2]=a.data[k+2]+n*c.data[k+2]/255-n|0)}};Q.subtractOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=
g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n;if(m){let q=m+(n=a.data[e+3])-(m*n/255|0)|0,t=m*n;a.data[e]=(n*a.data[e]+m*c.data[e]-t)/q|0;a.data[e+1]=(n*a.data[e+1]+m*c.data[e+1]-t)/q|0;a.data[e+2]=(n*a.data[e+2]+m*c.data[e+2]-t)/q|0;a.data[e+3]=q}}};Q.subtractOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=
0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q;if(n){let t=n+(q=a.data[k+3])-(n*q/255|0)|0,u=n*q;a.data[k]=(q*a.data[k]+n*c.data[k]-u)/t|0;a.data[k+1]=(q*a.data[k+1]+n*c.data[k+1]-u)/t|0;a.data[k+2]=(q*a.data[k+2]+n*c.data[k+2]-u)/t|0;a.data[k+3]=t}}};Q.screenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=
c.data[b+3],l;if(k){let f=255^k;l=a.data[b];a.data[b]=255^((255^l)*f+(255^c.data[b])*(255^l)*k/255)/255;l=a.data[b+1];a.data[b+1]=255^((255^l)*f+(255^c.data[b+1])*(255^l)*k/255)/255;l=a.data[b+2];a.data[b+2]=255^((255^l)*f+(255^c.data[b+2])*(255^l)*k/255)/255}}};Q.screenOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f;if(l){let m=
255^l;f=a.data[b];a.data[b]=255^((255^f)*m+(255^c.data[b])*(255^f)*l/255)/255;f=a.data[b+1];a.data[b+1]=255^((255^f)*m+(255^c.data[b+1])*(255^f)*l/255)/255;f=a.data[b+2];a.data[b+2]=255^((255^f)*m+(255^c.data[b+2])*(255^f)*l/255)/255}}};Q.screenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*
l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];a.data[b]=255^((255^g)*q+(255^f)*t+(255^g)*(255^f)*n/255)/m;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=255^((255^g)*q+(255^f)*t+(255^g)*(255^f)*n/255)/m;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=255^((255^g)*q+(255^f)*t+(255^g)*(255^f)*n/255)/m;a.data[b+3]=m}}};Q.screenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=
0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=255^((255^e)*t+(255^m)*u+(255^e)*(255^m)*q/255)/n;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=255^((255^e)*t+(255^m)*u+(255^e)*(255^m)*q/255)/n;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=255^((255^e)*t+(255^m)*u+(255^e)*(255^m)*q/255)/n;a.data[b+3]=n}}};Q.screenOntoOpaqueFusionWithOpaqueLayerMasked=function(a,
c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n;if(m){let q=255^m;n=a.data[e];a.data[e]=255^((255^n)*q+(255^c.data[e])*(255^n)*m/255)/255;n=a.data[e+1];a.data[e+1]=255^((255^n)*q+(255^c.data[e+1])*(255^n)*m/255)/255;n=a.data[e+2];a.data[e+2]=255^((255^n)*q+(255^c.data[e+2])*(255^n)*m/255)/255}}};Q.screenOntoOpaqueFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q;if(n){let t=255^n;q=a.data[k];a.data[k]=255^((255^q)*t+(255^c.data[k])*(255^q)*n/255)/255;q=a.data[k+1];a.data[k+1]=255^((255^q)*t+(255^c.data[k+1])*(255^q)*n/255)/255;q=a.data[k+2];a.data[k+2]=255^((255^q)*t+(255^c.data[k+2])*(255^q)*n/255)/
255}}};Q.screenOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=255^((255^l)*v+(255^q)*A+(255^l)*(255^q)*u/255)/t;l=c.data[e+
1];q=a.data[e+1];a.data[e+1]=255^((255^l)*v+(255^q)*A+(255^l)*(255^q)*u/255)/t;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=255^((255^l)*v+(255^q)*A+(255^l)*(255^q)*u/255)/t;a.data[e+3]=t}}};Q.screenOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,
t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=255^((255^f)*A+(255^t)*C+(255^f)*(255^t)*v/255)/u;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=255^((255^f)*A+(255^t)*C+(255^f)*(255^t)*v/255)/u;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=255^((255^f)*A+(255^t)*C+(255^f)*(255^t)*v/255)/u;a.data[k+3]=u}}};Q.lightenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,
b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];a.data[b]=f>=l?f:(f*m+l*k)/255|0;l=c.data[b+1];f=a.data[b+1];a.data[b+1]=f>=l?f:(f*m+l*k)/255|0;l=c.data[b+2];f=a.data[b+2];a.data[b+2]=f>=l?f:(f*m+l*k)/255|0}}};Q.lightenOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+
3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=m>=f?m:(m*n+f*l)/255|0;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=m>=f?m:(m*n+f*l)/255|0;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=m>=f?m:(m*n+f*l)/255|0}}};Q.lightenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=l*(255^
g)/m|0,q=255^n,t=g*(255^l)/m|0,u=255^t;g=c.data[b];f=a.data[b];a.data[b]=(f>=g?g*t+f*u:f*n+g*q)/255|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(f>=g?g*t+f*u:f*n+g*q)/255|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(f>=g?g*t+f*u:f*n+g*q)/255|0;a.data[b+3]=m}}};Q.lightenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;
if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=f*(255^e)/n|0,t=255^q,u=e*(255^f)/n|0,v=255^u;e=c.data[b];m=a.data[b];a.data[b]=(m>=e?e*u+m*v:m*q+e*t)/255|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(m>=e?e*u+m*v:m*q+e*t)/255|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(m>=e?e*u+m*v:m*q+e*t)/255|0;a.data[b+3]=n}}};Q.lightenOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,
b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=q>=n?q:(q*t+n*m)/255|0;n=c.data[e+1];q=a.data[e+1];a.data[e+1]=q>=n?q:(q*t+n*m)/255|0;n=c.data[e+2];q=a.data[e+2];a.data[e+2]=q>=n?q:(q*t+n*m)/255|0}}};Q.lightenOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,
b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=t>=q?t:(t*u+q*n)/255|0;q=c.data[k+1];t=a.data[k+1];a.data[k+1]=t>=q?t:(t*u+q*n)/255|0;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=t>=q?t:(t*u+q*n)/255|0}}};Q.lightenOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,
b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=n*(255^l)/t|0,v=255^u,A=l*(255^n)/t|0,C=255^A;l=c.data[e];q=a.data[e];a.data[e]=(q>=l?l*A+q*C:q*u+l*v)/255|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(q>=l?l*A+q*C:q*u+l*v)/255|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(q>=l?l*A+q*C:q*u+l*v)/255|0;a.data[e+3]=t}}};Q.lightenOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=
0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=q*(255^f)/u|0,A=255^v,C=f*(255^q)/u|0,x=255^C;f=c.data[k];t=a.data[k];a.data[k]=(t>=f?f*C+t*x:t*v+f*A)/255|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(t>=f?f*C+t*x:t*v+f*A)/255|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=
(t>=f?f*C+t*x:t*v+f*A)/255|0;a.data[k+3]=u}}};Q.darkenOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];a.data[b]=f>=l?(f*m+l*k)/255|0:f;l=c.data[b+1];f=a.data[b+1];a.data[b+1]=f>=l?(f*m+l*k)/255|0:f;l=c.data[b+2];f=a.data[b+2];a.data[b+2]=f>=l?(f*m+l*k)/255|0:f}}};Q.darkenOntoOpaqueFusionWithTransparentLayer=
function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=m>=f?(m*n+f*l)/255|0:m;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=m>=f?(m*n+f*l)/255|0:m;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=m>=f?(m*n+f*l)/255|0:m}}};Q.darkenOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-
h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*(255^l)/m|0,q=255^n,t=l*(255^g)/m|0,u=255^t;g=c.data[b];f=a.data[b];a.data[b]=(f>=g?f*t+g*u:g*n+f*q)/255|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(f>=g?f*t+g*u:g*n+f*q)/255|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(f>=g?f*t+g*u:g*n+f*q)/255|0;a.data[b+3]=m}}};Q.darkenOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=
0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*(255^f)/n|0,t=255^q,u=f*(255^e)/n|0,v=255^u;e=c.data[b];m=a.data[b];a.data[b]=(m>=e?m*u+e*v:e*q+m*t)/255|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(m>=e?m*u+e*v:e*q+m*t)/255|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(m>=e?m*u+e*v:e*q+m*t)/255|0;a.data[b+3]=n}}};Q.darkenOntoOpaqueFusionWithOpaqueLayerMasked=
function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=q>=n?(q*t+n*m)/255|0:q;n=c.data[e+1];q=a.data[e+1];a.data[e+1]=q>=n?(q*t+n*m)/255|0:q;n=c.data[e+2];q=a.data[e+2];a.data[e+2]=q>=n?(q*t+n*m)/255|0:q}}};Q.darkenOntoOpaqueFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=t>=q?(t*u+q*n)/255|0:t;q=c.data[k+1];t=a.data[k+1];a.data[k+1]=t>=q?(t*u+q*n)/255|0:t;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=t>=q?(t*u+q*n)/255|0:t}}};Q.darkenOntoTransparentFusionWithOpaqueLayerMasked=
function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*(255^n)/t|0,v=255^u,A=n*(255^l)/t|0,C=255^A;l=c.data[e];q=a.data[e];a.data[e]=(q>=l?q*A+l*C:l*u+q*v)/255|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(q>=l?q*A+l*C:l*u+q*v)/255|0;l=c.data[e+2];q=
a.data[e+2];a.data[e+2]=(q>=l?q*A+l*C:l*u+q*v)/255|0;a.data[e+3]=t}}};Q.darkenOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*(255^q)/u|0,A=255^v,C=q*(255^f)/u|0,x=255^C;f=c.data[k];t=a.data[k];
a.data[k]=(t>=f?t*C+f*x:f*v+t*A)/255|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(t>=f?t*C+f*x:f*v+t*A)/255|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(t>=f?t*C+f*x:f*v+t*A)/255|0;a.data[k+3]=u}}};Q.dodgeOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];a.data[b]=(f*m+k*(255==l?255:Math.min(255,255*
f/(255^l)|0)))/255|0;l=c.data[b+1];f=a.data[b+1];a.data[b+1]=(f*m+k*(255==l?255:Math.min(255,255*f/(255^l)|0)))/255|0;l=c.data[b+2];f=a.data[b+2];a.data[b+2]=(f*m+k*(255==l?255:Math.min(255,255*f/(255^l)|0)))/255|0}}};Q.dodgeOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=
(m*n+l*(255==f?255:Math.min(255,255*m/(255^f)|0)))/255|0;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=(m*n+l*(255==f?255:Math.min(255,255*m/(255^f)|0)))/255|0;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=(m*n+l*(255==f?255:Math.min(255,255*m/(255^f)|0)))/255|0}}};Q.dodgeOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=
a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];a.data[b]=(g*q+f*t+n*(255==g?255:Math.min(255,255*f/(255^g)|0)))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(g*q+f*t+n*(255==g?255:Math.min(255,255*f/(255^g)|0)))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(g*q+f*t+n*(255==g?255:Math.min(255,255*f/(255^g)|0)))/m|0;a.data[b+3]=m}}};Q.dodgeOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*
4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=(e*t+m*u+q*(255==e?255:Math.min(255,255*m/(255^e)|0)))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(e*t+m*u+q*(255==e?255:Math.min(255,255*m/(255^e)|0)))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(e*t+m*u+q*(255==e?255:Math.min(255,255*m/(255^e)|0)))/
n|0;a.data[b+3]=n}}};Q.dodgeOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=(q*t+m*(255==n?255:Math.min(255,255*q/(255^n)|0)))/255|0;n=c.data[e+1];q=a.data[e+1];a.data[e+1]=(q*t+m*(255==n?255:Math.min(255,
255*q/(255^n)|0)))/255|0;n=c.data[e+2];q=a.data[e+2];a.data[e+2]=(q*t+m*(255==n?255:Math.min(255,255*q/(255^n)|0)))/255|0}}};Q.dodgeOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=(t*u+n*(255==
q?255:Math.min(255,255*t/(255^q)|0)))/255|0;q=c.data[k+1];t=a.data[k+1];a.data[k+1]=(t*u+n*(255==q?255:Math.min(255,255*t/(255^q)|0)))/255|0;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=(t*u+n*(255==q?255:Math.min(255,255*t/(255^q)|0)))/255|0}}};Q.dodgeOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=
4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(l*v+q*A+u*(255==l?255:Math.min(255,255*q/(255^l)|0)))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(l*v+q*A+u*(255==l?255:Math.min(255,255*q/(255^l)|0)))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(l*v+q*A+u*(255==l?255:Math.min(255,255*q/(255^l)|0)))/t|0;a.data[e+3]=t}}};Q.dodgeOntoTransparentFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(f*A+t*C+v*(255==f?255:Math.min(255,255*t/(255^f)|0)))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(f*A+t*C+v*
(255==f?255:Math.min(255,255*t/(255^f)|0)))/u|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(f*A+t*C+v*(255==f?255:Math.min(255,255*t/(255^f)|0)))/u|0;a.data[k+3]=u}}};Q.burnOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];a.data[b]=(f*m+k*(0==l?0:255^Math.min(255,255*(255^f)/l)))/255|0;l=c.data[b+
1];f=a.data[b+1];a.data[b+1]=(f*m+k*(0==l?0:255^Math.min(255,255*(255^f)/l)))/255|0;l=c.data[b+2];f=a.data[b+2];a.data[b+2]=(f*m+k*(0==l?0:255^Math.min(255,255*(255^f)/l)))/255|0}}};Q.burnOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=(m*n+l*(0==f?0:255^Math.min(255,255*
(255^m)/f)))/255|0;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=(m*n+l*(0==f?0:255^Math.min(255,255*(255^m)/f)))/255|0;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=(m*n+l*(0==f?0:255^Math.min(255,255*(255^m)/f)))/255|0}}};Q.burnOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*
(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];a.data[b]=(g*q+f*t+n*(0==g?0:255^Math.min(255,255*(255^f)/g)))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(g*q+f*t+n*(0==g?0:255^Math.min(255,255*(255^f)/g)))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(g*q+f*t+n*(0==g?0:255^Math.min(255,255*(255^f)/g)))/m|0;a.data[b+3]=m}}};Q.burnOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=
0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=(e*t+m*u+q*(0==e?0:255^Math.min(255,255*(255^m)/e)))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(e*t+m*u+q*(0==e?0:255^Math.min(255,255*(255^m)/e)))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(e*t+m*u+q*(0==e?0:255^Math.min(255,255*(255^m)/e)))/n|0;a.data[b+3]=n}}};Q.burnOntoOpaqueFusionWithOpaqueLayerMasked=
function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=(q*t+m*(0==n?0:255^Math.min(255,255*(255^q)/n)))/255|0;n=c.data[e+1];q=a.data[e+1];a.data[e+1]=(q*t+m*(0==n?0:255^Math.min(255,255*(255^q)/n)))/255|0;n=c.data[e+2];q=a.data[e+2];a.data[e+2]=(q*
t+m*(0==n?0:255^Math.min(255,255*(255^q)/n)))/255|0}}};Q.burnOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=(t*u+n*(0==q?0:255^Math.min(255,255*(255^t)/q)))/255|0;q=c.data[k+1];t=a.data[k+1];a.data[k+
1]=(t*u+n*(0==q?0:255^Math.min(255,255*(255^t)/q)))/255|0;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=(t*u+n*(0==q?0:255^Math.min(255,255*(255^t)/q)))/255|0}}};Q.burnOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/
255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(l*v+q*A+u*(0==l?0:255^Math.min(255,255*(255^q)/l)))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(l*v+q*A+u*(0==l?0:255^Math.min(255,255*(255^q)/l)))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(l*v+q*A+u*(0==l?0:255^Math.min(255,255*(255^q)/l)))/t|0;a.data[e+3]=t}}};Q.burnOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,
b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(f*A+t*C+v*(0==f?0:255^Math.min(255,255*(255^t)/f)))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(f*A+t*C+v*(0==f?0:255^Math.min(255,255*(255^t)/f)))/u|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(f*A+t*C+v*(0==f?0:255^
Math.min(255,255*(255^t)/f)))/u|0;a.data[k+3]=u}}};Q.overlayOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];a.data[b]=(m*f+(f<=127?2*k*l*f/255:k*(2*(255^l)*(255^f)/255^255)))/255|0;l=c.data[b+1];f=a.data[b+1];a.data[b+1]=(m*f+(f<=127?2*k*l*f/255:k*(2*(255^l)*(255^f)/255^255)))/255|0;l=c.data[b+
2];f=a.data[b+2];a.data[b+2]=(m*f+(f<=127?2*k*l*f/255:k*(2*(255^l)*(255^f)/255^255)))/255|0}}};Q.overlayOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=(n*m+(m<=127?2*l*f*m/255:l*(2*(255^f)*(255^m)/255^255)))/255|0;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=(n*m+(m<=127?2*
l*f*m/255:l*(2*(255^f)*(255^m)/255^255)))/255|0;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=(n*m+(m<=127?2*l*f*m/255:l*(2*(255^f)*(255^m)/255^255)))/255|0}}};Q.overlayOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];
a.data[b]=(q*g+t*f+(f<=127?2*n*g*f/255:n*(2*(255^g)*(255^f)/255^255)))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(q*g+t*f+(f<=127?2*n*g*f/255:n*(2*(255^g)*(255^f)/255^255)))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(q*g+t*f+(f<=127?2*n*g*f/255:n*(2*(255^g)*(255^f)/255^255)))/m|0;a.data[b+3]=m}}};Q.overlayOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<
p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=(t*e+u*m+(m<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(t*e+u*m+(m<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(t*e+u*m+(m<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/n|0;a.data[b+3]=n}}};Q.overlayOntoOpaqueFusionWithOpaqueLayerMasked=
function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=(t*q+(q<=127?2*m*n*q/255:m*(2*(255^n)*(255^q)/255^255)))/255|0;n=c.data[e+1];q=a.data[e+1];a.data[e+1]=(t*q+(q<=127?2*m*n*q/255:m*(2*(255^n)*(255^q)/255^255)))/255|0;n=c.data[e+2];q=a.data[e+2];
a.data[e+2]=(t*q+(q<=127?2*m*n*q/255:m*(2*(255^n)*(255^q)/255^255)))/255|0}}};Q.overlayOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=(u*t+(t<=127?2*n*q*t/255:n*(2*(255^q)*(255^t)/255^255)))/255|
0;q=c.data[k+1];t=a.data[k+1];a.data[k+1]=(u*t+(t<=127?2*n*q*t/255:n*(2*(255^q)*(255^t)/255^255)))/255|0;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=(u*t+(t<=127?2*n*q*t/255:n*(2*(255^q)*(255^t)/255^255)))/255|0}}};Q.overlayOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/
255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+A*q+(q<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+A*q+(q<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+A*q+(q<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/t|0;a.data[e+3]=t}}};Q.overlayOntoTransparentFusionWithTransparentLayerMasked=function(a,c,
d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(A*f+C*t+(t<=127?2*v*f*t/255:v*(2*(255^f)*(255^t)/255^255)))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(A*f+C*t+(t<=127?2*
v*f*t/255:v*(2*(255^f)*(255^t)/255^255)))/u|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(A*f+C*t+(t<=127?2*v*f*t/255:v*(2*(255^f)*(255^t)/255^255)))/u|0;a.data[k+3]=u}}};Q.hardLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];a.data[b]=(m*f+(l<=127?2*k*l*f/255:k*(2*(255^l)*(255^f)/255^255)))/
255|0;l=c.data[b+1];f=a.data[b+1];a.data[b+1]=(m*f+(l<=127?2*k*l*f/255:k*(2*(255^l)*(255^f)/255^255)))/255|0;l=c.data[b+2];f=a.data[b+2];a.data[b+2]=(m*f+(l<=127?2*k*l*f/255:k*(2*(255^l)*(255^f)/255^255)))/255|0}}};Q.hardLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=
(n*m+(f<=127?2*l*f*m/255:l*(2*(255^f)*(255^m)/255^255)))/255|0;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=(n*m+(f<=127?2*l*f*m/255:l*(2*(255^f)*(255^m)/255^255)))/255|0;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=(n*m+(f<=127?2*l*f*m/255:l*(2*(255^f)*(255^m)/255^255)))/255|0}}};Q.hardLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,
f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];a.data[b]=(q*g+t*f+(g<=127?2*n*g*f/255:n*(2*(255^g)*(255^f)/255^255)))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(q*g+t*f+(g<=127?2*n*g*f/255:n*(2*(255^g)*(255^f)/255^255)))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(q*g+t*f+(g<=127?2*n*g*f/255:n*(2*(255^g)*(255^f)/255^255)))/m|0;a.data[b+3]=m}}};Q.hardLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),
p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=(t*e+u*m+(e<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(t*e+u*m+(e<=127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(t*e+u*m+(e<=
127?2*q*e*m/255:q*(2*(255^e)*(255^m)/255^255)))/n|0;a.data[b+3]=n}}};Q.hardLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=(t*q+(n<=127?2*m*n*q/255:m*(2*(255^n)*(255^q)/255^255)))/255|0;n=c.data[e+
1];q=a.data[e+1];a.data[e+1]=(t*q+(n<=127?2*m*n*q/255:m*(2*(255^n)*(255^q)/255^255)))/255|0;n=c.data[e+2];q=a.data[e+2];a.data[e+2]=(t*q+(n<=127?2*m*n*q/255:m*(2*(255^n)*(255^q)/255^255)))/255|0}}};Q.hardLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/
25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=(u*t+(q<=127?2*n*q*t/255:n*(2*(255^q)*(255^t)/255^255)))/255|0;q=c.data[k+1];t=a.data[k+1];a.data[k+1]=(u*t+(q<=127?2*n*q*t/255:n*(2*(255^q)*(255^t)/255^255)))/255|0;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=(u*t+(q<=127?2*n*q*t/255:n*(2*(255^q)*(255^t)/255^255)))/255|0}}};Q.hardLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),
k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+A*q+(l<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+A*q+(l<=127?2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+A*q+(l<=127?
2*u*l*q/255:u*(2*(255^l)*(255^q)/255^255)))/t|0;a.data[e+3]=t}}};Q.hardLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];
a.data[k]=(A*f+C*t+(f<=127?2*v*f*t/255:v*(2*(255^f)*(255^t)/255^255)))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(A*f+C*t+(f<=127?2*v*f*t/255:v*(2*(255^f)*(255^t)/255^255)))/u|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(A*f+C*t+(f<=127?2*v*f*t/255:v*(2*(255^f)*(255^t)/255^255)))/u|0;a.data[k+3]=u}}};Q.softLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=
4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];a.data[b]=(m*f+k*(l<=127?((2*l-255)*Ab[f]/255|0)+f:((2*l-255)*Bb[f]/255|0)+f))/255|0;l=c.data[b+1];f=a.data[b+1];a.data[b+1]=(m*f+k*(l<=127?((2*l-255)*Ab[f]/255|0)+f:((2*l-255)*Bb[f]/255|0)+f))/255|0;l=c.data[b+2];f=a.data[b+2];a.data[b+2]=(m*f+k*(l<=127?((2*l-255)*Ab[f]/255|0)+f:((2*l-255)*Bb[f]/255|0)+f))/255|0}}};Q.softLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-
p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=(n*m+l*(f<=127?((2*f-255)*Ab[m]/255|0)+m:((2*f-255)*Bb[m]/255|0)+m))/255|0;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=(n*m+l*(f<=127?((2*f-255)*Ab[m]/255|0)+m:((2*f-255)*Bb[m]/255|0)+m))/255|0;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=(n*m+l*(f<=127?((2*f-255)*Ab[m]/255|0)+m:((2*f-255)*Bb[m]/255|0)+m))/255|0}}};Q.softLightOntoTransparentFusionWithOpaqueLayer=
function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];a.data[b]=(q*g+t*f+(g<=127?n*(((2*g-255)*Ab[f]/255|0)+f):n*(((2*g-255)*Bb[f]/255|0)+f)))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(q*g+t*f+(g<=127?n*(((2*g-255)*Ab[f]/255|0)+f):n*(((2*g-255)*Bb[f]/
255|0)+f)))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(q*g+t*f+(g<=127?n*(((2*g-255)*Ab[f]/255|0)+f):n*(((2*g-255)*Bb[f]/255|0)+f)))/m|0;a.data[b+3]=m}}};Q.softLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];
m=a.data[b];a.data[b]=(t*e+u*m+(e<=127?q*(((2*e-255)*Ab[m]/255|0)+m):q*(((2*e-255)*Bb[m]/255|0)+m)))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(t*e+u*m+(e<=127?q*(((2*e-255)*Ab[m]/255|0)+m):q*(((2*e-255)*Bb[m]/255|0)+m)))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(t*e+u*m+(e<=127?q*(((2*e-255)*Ab[m]/255|0)+m):q*(((2*e-255)*Bb[m]/255|0)+m)))/n|0;a.data[b+3]=n}}};Q.softLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,
b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=(t*q+m*(n<=127?((2*n-255)*Ab[q]/255|0)+q:((2*n-255)*Bb[q]/255|0)+q))/255|0;n=c.data[e+1];q=a.data[e+1];a.data[e+1]=(t*q+m*(n<=127?((2*n-255)*Ab[q]/255|0)+q:((2*n-255)*Bb[q]/255|0)+q))/255|0;n=c.data[e+2];q=a.data[e+2];a.data[e+2]=(t*q+m*(n<=127?((2*n-255)*Ab[q]/255|0)+q:((2*n-255)*Bb[q]/255|0)+q))/
255|0}}};Q.softLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=(u*t+n*(q<=127?((2*q-255)*Ab[t]/255|0)+t:((2*q-255)*Bb[t]/255|0)+t))/255|0;q=c.data[k+1];t=a.data[k+1];a.data[k+1]=(u*t+n*(q<=
127?((2*q-255)*Ab[t]/255|0)+t:((2*q-255)*Bb[t]/255|0)+t))/255|0;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=(u*t+n*(q<=127?((2*q-255)*Ab[t]/255|0)+t:((2*q-255)*Bb[t]/255|0)+t))/255|0}}};Q.softLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=
l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+A*q+(l<=127?u*(((2*l-255)*Ab[q]/255|0)+q):u*(((2*l-255)*Bb[q]/255|0)+q)))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+A*q+(l<=127?u*(((2*l-255)*Ab[q]/255|0)+q):u*(((2*l-255)*Bb[q]/255|0)+q)))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+A*q+(l<=127?u*(((2*l-255)*Ab[q]/255|0)+q):u*(((2*l-255)*Bb[q]/255|0)+q)))/t|0;a.data[e+3]=t}}};Q.softLightOntoTransparentFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(A*f+C*t+(f<=127?v*(((2*f-255)*Ab[t]/255|0)+t):v*(((2*f-255)*Bb[t]/255|0)+t)))/u|0;f=c.data[k+1];t=a.data[k+1];
a.data[k+1]=(A*f+C*t+(f<=127?v*(((2*f-255)*Ab[t]/255|0)+t):v*(((2*f-255)*Bb[t]/255|0)+t)))/u|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(A*f+C*t+(f<=127?v*(((2*f-255)*Ab[t]/255|0)+t):v*(((2*f-255)*Bb[t]/255|0)+t)))/u|0;a.data[k+3]=u}}};Q.vividLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];
a.data[b]=(m*f+(l<=127?k*(0==l?0:255-Math.min(255,(255-f)*255/(2*l)|0)):k*(255==l?255:Math.min(255,255*f/(2*(255-l))|0))))/255|0;l=c.data[b+1];f=a.data[b+1];a.data[b+1]=(m*f+(l<=127?k*(0==l?0:255-Math.min(255,(255-f)*255/(2*l)|0)):k*(255==l?255:Math.min(255,255*f/(2*(255-l))|0))))/255|0;l=c.data[b+2];f=a.data[b+2];a.data[b+2]=(m*f+(l<=127?k*(0==l?0:255-Math.min(255,(255-f)*255/(2*l)|0)):k*(255==l?255:Math.min(255,255*f/(2*(255-l))|0))))/255|0}}};Q.vividLightOntoOpaqueFusionWithTransparentLayer=function(a,
c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=(n*m+(f<=127?l*(0==f?0:255-Math.min(255,(255-m)*255/(2*f)|0)):l*(255==f?255:Math.min(255,255*m/(2*(255-f))|0))))/255|0;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=(n*m+(f<=127?l*(0==f?0:255-Math.min(255,(255-m)*255/(2*f)|0)):l*(255==f?255:Math.min(255,255*m/(2*(255-f))|0))))/
255|0;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=(n*m+(f<=127?l*(0==f?0:255-Math.min(255,(255-m)*255/(2*f)|0)):l*(255==f?255:Math.min(255,255*m/(2*(255-f))|0))))/255|0}}};Q.vividLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];
f=a.data[b];a.data[b]=(q*g+t*f+(g<=127?n*(0==g?0:255-Math.min(255,(255-f)*255/(2*g)|0)):n*(255==g?255:Math.min(255,255*f/(2*(255-g))|0))))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(q*g+t*f+(g<=127?n*(0==g?0:255-Math.min(255,(255-f)*255/(2*g)|0)):n*(255==g?255:Math.min(255,255*f/(2*(255-g))|0))))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(q*g+t*f+(g<=127?n*(0==g?0:255-Math.min(255,(255-f)*255/(2*g)|0)):n*(255==g?255:Math.min(255,255*f/(2*(255-g))|0))))/m|0;a.data[b+3]=m}}};Q.vividLightOntoTransparentFusionWithTransparentLayer=
function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=(t*e+u*m+(e<=127?q*(0==e?0:255-Math.min(255,(255-m)*255/(2*e)|0)):q*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(t*e+u*m+(e<=127?q*(0==
e?0:255-Math.min(255,(255-m)*255/(2*e)|0)):q*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(t*e+u*m+(e<=127?q*(0==e?0:255-Math.min(255,(255-m)*255/(2*e)|0)):q*(255==e?255:Math.min(255,255*m/(2*(255-e))|0))))/n|0;a.data[b+3]=n}}};Q.vividLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,
e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=(t*q+(n<=127?m*(0==n?0:255-Math.min(255,(255-q)*255/(2*n)|0)):m*(255==n?255:Math.min(255,255*q/(2*(255-n))|0))))/255|0;n=c.data[e+1];q=a.data[e+1];a.data[e+1]=(t*q+(n<=127?m*(0==n?0:255-Math.min(255,(255-q)*255/(2*n)|0)):m*(255==n?255:Math.min(255,255*q/(2*(255-n))|0))))/255|0;n=c.data[e+2];q=a.data[e+2];a.data[e+2]=(t*q+(n<=127?m*(0==n?0:255-Math.min(255,(255-q)*255/(2*
n)|0)):m*(255==n?255:Math.min(255,255*q/(2*(255-n))|0))))/255|0}}};Q.vividLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=(u*t+(q<=127?n*(0==q?0:255-Math.min(255,(255-t)*255/(2*q)|0)):n*(255==
q?255:Math.min(255,255*t/(2*(255-q))|0))))/255|0;q=c.data[k+1];t=a.data[k+1];a.data[k+1]=(u*t+(q<=127?n*(0==q?0:255-Math.min(255,(255-t)*255/(2*q)|0)):n*(255==q?255:Math.min(255,255*t/(2*(255-q))|0))))/255|0;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=(u*t+(q<=127?n*(0==q?0:255-Math.min(255,(255-t)*255/(2*q)|0)):n*(255==q?255:Math.min(255,255*t/(2*(255-q))|0))))/255|0}}};Q.vividLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,
e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+A*q+(l<=127?u*(0==l?0:255-Math.min(255,(255-q)*255/(2*l)|0)):u*(255==l?255:Math.min(255,255*q/(2*(255-l))|0))))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+A*q+(l<=127?u*(0==l?0:255-
Math.min(255,(255-q)*255/(2*l)|0)):u*(255==l?255:Math.min(255,255*q/(2*(255-l))|0))))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+A*q+(l<=127?u*(0==l?0:255-Math.min(255,(255-q)*255/(2*l)|0)):u*(255==l?255:Math.min(255,255*q/(2*(255-l))|0))))/t|0;a.data[e+3]=t}}};Q.vividLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<
p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(A*f+C*t+(f<=127?v*(0==f?0:255-Math.min(255,(255-t)*255/(2*f)|0)):v*(255==f?255:Math.min(255,255*t/(2*(255-f))|0))))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(A*f+C*t+(f<=127?v*(0==f?0:255-Math.min(255,(255-t)*255/(2*f)|0)):v*(255==f?255:Math.min(255,255*t/(2*(255-f))|0))))/u|0;f=
c.data[k+2];t=a.data[k+2];a.data[k+2]=(A*f+C*t+(f<=127?v*(0==f?0:255-Math.min(255,(255-t)*255/(2*f)|0)):v*(255==f?255:Math.min(255,255*t/(2*(255-f))|0))))/u|0;a.data[k+3]=u}}};Q.linearLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l;if(k){let f=255^k;l=a.data[b];a.data[b]=(f*l+k*Math.min(255,Math.max(0,l+2*c.data[b]-255)))/255|0;l=
a.data[b+1];a.data[b+1]=(f*l+k*Math.min(255,Math.max(0,l+2*c.data[b+1]-255)))/255|0;l=a.data[b+2];a.data[b+2]=(f*l+k*Math.min(255,Math.max(0,l+2*c.data[b+2]-255)))/255|0}}};Q.linearLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f;if(l){let m=255^l;f=a.data[b];a.data[b]=(m*f+l*Math.min(255,Math.max(0,f+2*c.data[b]-255)))/
255|0;f=a.data[b+1];a.data[b+1]=(m*f+l*Math.min(255,Math.max(0,f+2*c.data[b+1]-255)))/255|0;f=a.data[b+2];a.data[b+2]=(m*f+l*Math.min(255,Math.max(0,f+2*c.data[b+2]-255)))/255|0}}};Q.linearLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*
l/255|0;g=c.data[b];f=a.data[b];a.data[b]=(q*g+t*f+n*Math.min(255,Math.max(0,f+2*g-255)))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(q*g+t*f+n*Math.min(255,Math.max(0,f+2*g-255)))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(q*g+t*f+n*Math.min(255,Math.max(0,f+2*g-255)))/m|0;a.data[b+3]=m}}};Q.linearLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,
b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=(t*e+u*m+q*Math.min(255,Math.max(0,m+2*e-255)))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(t*e+u*m+q*Math.min(255,Math.max(0,m+2*e-255)))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(t*e+u*m+q*Math.min(255,Math.max(0,m+2*e-255)))/n|0;a.data[b+3]=n}}};Q.linearLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();
let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n;if(m){let q=255^m;n=a.data[e];a.data[e]=(q*n+m*Math.min(255,Math.max(0,n+2*c.data[e]-255)))/255|0;n=a.data[e+1];a.data[e+1]=(q*n+m*Math.min(255,Math.max(0,n+2*c.data[e+1]-255)))/255|0;n=a.data[e+2];a.data[e+2]=(q*n+m*Math.min(255,Math.max(0,n+2*c.data[e+2]-255)))/255|0}}};Q.linearLightOntoOpaqueFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0,q;if(n){let t=255^n;q=a.data[k];a.data[k]=(t*q+n*Math.min(255,Math.max(0,q+2*c.data[k]-255)))/255|0;q=a.data[k+1];a.data[k+1]=(t*q+n*Math.min(255,Math.max(0,q+2*c.data[k+1]-255)))/255|0;q=a.data[k+2];a.data[k+2]=(t*q+n*Math.min(255,Math.max(0,q+
2*c.data[k+2]-255)))/255|0}}};Q.linearLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+A*q+u*Math.min(255,Math.max(0,
q+2*l-255)))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+A*q+u*Math.min(255,Math.max(0,q+2*l-255)))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+A*q+u*Math.min(255,Math.max(0,q+2*l-255)))/t|0;a.data[e+3]=t}}};Q.linearLightOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=
c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(A*f+C*t+v*Math.min(255,Math.max(0,t+2*f-255)))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(A*f+C*t+v*Math.min(255,Math.max(0,t+2*f-255)))/u|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(A*f+C*t+v*Math.min(255,Math.max(0,t+2*f-255)))/u|0;a.data[k+3]=u}}};Q.pinLightOntoOpaqueFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=
0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;if(k){let m=255^k;l=c.data[b];f=a.data[b];a.data[b]=(m*f+k*(f>=2*l?2*l:f<=2*l-255?2*l-255:f))/255|0;l=c.data[b+1];f=a.data[b+1];a.data[b+1]=(m*f+k*(f>=2*l?2*l:f<=2*l-255?2*l-255:f))/255|0;l=c.data[b+2];f=a.data[b+2];a.data[b+2]=(m*f+k*(f>=2*l?2*l:f<=2*l-255?2*l-255:f))/255|0}}};Q.pinLightOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),
p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;if(l){let n=255^l;f=c.data[b];m=a.data[b];a.data[b]=(n*m+l*(m>=2*f?2*f:m<=2*f-255?2*f-255:m))/255|0;f=c.data[b+1];m=a.data[b+1];a.data[b+1]=(n*m+l*(m>=2*f?2*f:m<=2*f-255?2*f-255:m))/255|0;f=c.data[b+2];m=a.data[b+2];a.data[b+2]=(n*m+l*(m>=2*f?2*f:m<=2*f-255?2*f-255:m))/255|0}}};Q.pinLightOntoTransparentFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();
let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<d;e++,b+=p)for(let k=0;k<h;k++,b+=4){var g=c.data[b+3];let l,f;if(g){let m=g+(l=a.data[b+3])-(g*l/255|0)|0,n=g*l/255|0,q=g*(255^l)/255|0,t=(255^g)*l/255|0;g=c.data[b];f=a.data[b];a.data[b]=(q*g+t*f+n*(f>=2*g?2*g:f<=2*g-255?2*g-255:f))/m|0;g=c.data[b+1];f=a.data[b+1];a.data[b+1]=(q*g+t*f+n*(f>=2*g?2*g:f<=2*g-255?2*g-255:f))/m|0;g=c.data[b+2];f=a.data[b+2];a.data[b+2]=(q*g+t*f+n*(f>=2*g?2*g:f<=2*g-255?2*g-255:f))/
m|0;a.data[b+3]=m}}};Q.pinLightOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let k=0;k<h;k++,b+=g)for(let l=0;l<p;l++,b+=4){var e=c.data[b+3]*d/100|0;let f,m;if(e){let n=e+(f=a.data[b+3])-(e*f/255|0)|0,q=e*f/255|0,t=e*(255^f)/255|0,u=(255^e)*f/255|0;e=c.data[b];m=a.data[b];a.data[b]=(t*e+u*m+q*(m>=2*e?2*e:m<=2*e-255?2*e-255:m))/n|0;e=c.data[b+1];m=a.data[b+1];a.data[b+1]=(t*e+u*m+q*(m>=2*e?
2*e:m<=2*e-255?2*e-255:m))/n|0;e=c.data[b+2];m=a.data[b+2];a.data[b+2]=(t*e+u*m+q*(m>=2*e?2*e:m<=2*e-255?2*e-255:m))/n|0;a.data[b+3]=n}}};Q.pinLightOntoOpaqueFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0,n,q;if(m){let t=255^m;n=c.data[e];q=a.data[e];a.data[e]=(t*q+m*
(q>=2*n?2*n:q<=2*n-255?2*n-255:q))/255|0;n=c.data[e+1];q=a.data[e+1];a.data[e+1]=(t*q+m*(q>=2*n?2*n:q<=2*n-255?2*n-255:q))/255|0;n=c.data[e+2];q=a.data[e+2];a.data[e+2]=(t*q+m*(q>=2*n?2*n:q<=2*n-255?2*n-255:q))/255|0}}};Q.pinLightOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+
3]*h.data[b]*d/25500|0,q,t;if(n){let u=255^n;q=c.data[k];t=a.data[k];a.data[k]=(u*t+n*(t>=2*q?2*q:t<=2*q-255?2*q-255:t))/255|0;q=c.data[k+1];t=a.data[k+1];a.data[k+1]=(u*t+n*(t>=2*q?2*q:t<=2*q-255?2*q-255:t))/255|0;q=c.data[k+2];t=a.data[k+2];a.data[k+2]=(u*t+n*(t>=2*q?2*q:t<=2*q-255?2*q-255:t))/255|0}}};Q.pinLightOntoTransparentFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,
b.top);for(let f=0;f<d;f++,e+=g,b+=k)for(let m=0;m<p;m++,e+=4,b++){var l=c.data[e+3]*h.data[b]/255|0;let n,q;if(l){let t=l+(n=a.data[e+3])-(l*n/255|0)|0,u=l*n/255|0,v=l*(255^n)/255|0,A=(255^l)*n/255|0;l=c.data[e];q=a.data[e];a.data[e]=(v*l+A*q+u*(q>=2*l?2*l:q<=2*l-255?2*l-255:q))/t|0;l=c.data[e+1];q=a.data[e+1];a.data[e+1]=(v*l+A*q+u*(q>=2*l?2*l:q<=2*l-255?2*l-255:q))/t|0;l=c.data[e+2];q=a.data[e+2];a.data[e+2]=(v*l+A*q+u*(q>=2*l?2*l:q<=2*l-255?2*l-255:q))/t|0;a.data[e+3]=t}}};Q.pinLightOntoTransparentFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let m=0;m<p;m++,k+=e,b+=l)for(let n=0;n<g;n++,k+=4,b++){var f=c.data[k+3]*h.data[b]*d/25500|0;let q,t;if(f){let u=f+(q=a.data[k+3])-(f*q/255|0)|0,v=f*q/255|0,A=f*(255^q)/255|0,C=(255^f)*q/255|0;f=c.data[k];t=a.data[k];a.data[k]=(A*f+C*t+v*(t>=2*f?2*f:t<=2*f-255?2*f-255:t))/u|0;f=c.data[k+1];t=a.data[k+1];a.data[k+1]=(A*f+C*t+v*(t>=2*f?2*
f:t<=2*f-255?2*f-255:t))/u|0;f=c.data[k+2];t=a.data[k+2];a.data[k+2]=(A*f+C*t+v*(t>=2*f?2*f:t<=2*f-255?2*f-255:t))/u|0;a.data[k+3]=u}}};Q.passthroughOntoOpaqueFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3],f=d/100,m=1-f,n=l*f+255*m;a.data[b]=(c.data[b]*l*f+255*a.data[b]*m)/n|0;a.data[b+1]=(c.data[b+1]*l*f+255*a.data[b+1]*m)/n|0;a.data[b+2]=(c.data[b+
2]*l*f+255*a.data[b+2]*m)/n|0;a.data[b+3]=n}};Q.passthroughOntoOpaqueFusionWithOpaqueLayer=Q.passthroughOntoOpaqueFusionWithTransparentLayer;Q.passthroughOntoTransparentFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3],f=a.data[b+3],m=d/100,n=1-m,q=l*m+f*n;a.data[b]=(c.data[b]*l*m+a.data[b]*f*n)/q|0;a.data[b+1]=(c.data[b+1]*l*m+a.data[b+1]*f*n)/
q|0;a.data[b+2]=(c.data[b+2]*l*m+a.data[b+2]*f*n)/q|0;a.data[b+3]=q}};Q.passthroughOntoTransparentFusionWithOpaqueLayer=Q.passthroughOntoTransparentFusionWithTransparentLayer;Q.passthroughOntoOpaqueFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3],q=h.data[b]*d/25500,t=1-q,u=n*q+255*
t;a.data[k]=(c.data[k]*n*q+255*a.data[k]*t)/u|0;a.data[k+1]=(c.data[k+1]*n*q+255*a.data[k+1]*t)/u|0;a.data[k+2]=(c.data[k+2]*n*q+255*a.data[k+2]*t)/u|0;a.data[k+3]=u}};Q.passthroughOntoOpaqueFusionWithOpaqueLayerMasked=Q.passthroughOntoOpaqueFusionWithTransparentLayerMasked;Q.passthroughOntoTransparentFusionWithTransparentLayerMasked=function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=
0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3],q=a.data[k+3],t=h.data[b]*d/25500,u=1-t,v=n*t+q*u;a.data[k]=(c.data[k]*n*t+a.data[k]*q*u)/v|0;a.data[k+1]=(c.data[k+1]*n*t+a.data[k+1]*q*u)/v|0;a.data[k+2]=(c.data[k+2]*n*t+a.data[k+2]*q*u)/v|0;a.data[k+3]=v}};Q.passthroughOntoTransparentFusionWithOpaqueLayerMasked=Q.passthroughOntoTransparentFusionWithTransparentLayerMasked;Q.replaceOntoFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-
p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0;a.data[b]=c.data[b];a.data[b+1]=c.data[b+1];a.data[b+2]=c.data[b+2];a.data[b+3]=l}};Q.replaceOntoFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3];a.data[b]=c.data[b];a.data[b+1]=c.data[b+1];a.data[b+2]=c.data[b+2];a.data[b+3]=k}};Q.replaceOntoFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++){let n=c.data[k+3]*h.data[b]*d/25500|0;a.data[k]=c.data[k];a.data[k+1]=c.data[k+1];a.data[k+2]=c.data[k+2];a.data[k+3]=n}};Q.replaceOntoFusionWithOpaqueLayerMasked=function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-
p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++){let m=c.data[e+3]*h.data[b]/255|0;a.data[e]=c.data[e];a.data[e+1]=c.data[e+1];a.data[e+2]=c.data[e+2];a.data[e+3]=m}};Q.replaceAlphaOntoFusionWithTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4)a.data[b+3]=c.data[b+3]*d/100|0};Q.replaceAlphaOntoFusionWithTransparentLayerMasked=
function(a,c,d,b,h){let p=0|b.getHeight(),g=0|b.getWidth(),e=(c.width-g)*4|0,k=0|c.offsetOfPixel(b.left,b.top),l=h.width-g|0;b=0|h.offsetOfPixel(b.left,b.top);for(let f=0;f<p;f++,k+=e,b+=l)for(let m=0;m<g;m++,k+=4,b++)a.data[k+3]=c.data[k+3]*h.data[b]*d/25500|0};Q.replaceAlphaOntoFusionWithOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4)a.data[b+3]=c.data[b+3]};Q.replaceAlphaOntoFusionWithOpaqueLayerMasked=
function(a,c,d,b,h){d=0|b.getHeight();let p=0|b.getWidth(),g=(c.width-p)*4|0,e=0|c.offsetOfPixel(b.left,b.top),k=h.width-p|0;b=0|h.offsetOfPixel(b.left,b.top);for(let l=0;l<d;l++,e+=g,b+=k)for(let f=0;f<p;f++,e+=4,b++)a.data[e+3]=c.data[e+3]*h.data[b]/255|0};Q.upgradeMultiplyOfOpaqueLayer=function(a,c,d,b){d=0|b.getHeight();let h=0|b.getWidth(),p=(c.width-h)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let g=0;g<d;g++,b+=p)for(let e=0;e<h;e++,b+=4){let k=c.data[b+3],l,f;k&&(l=c.data[b],f=a.data[b],c.data[b]=
l+Math.ceil((255-l)*f*k%65025/(f*k)),l=c.data[b+1],f=a.data[b+1],c.data[b+1]=l+Math.ceil((255-l)*f*k%65025/(f*k)),l=c.data[b+2],f=a.data[b+2],c.data[b+2]=l+Math.ceil((255-l)*f*k%65025/(f*k)))}};Q.upgradeMultiplyOfTransparentLayer=function(a,c,d,b){let h=0|b.getHeight(),p=0|b.getWidth(),g=(c.width-p)*4|0;b=0|c.offsetOfPixel(b.left,b.top);for(let e=0;e<h;e++,b+=g)for(let k=0;k<p;k++,b+=4){let l=c.data[b+3]*d/100|0,f,m;l&&(f=c.data[b],m=a.data[b],c.data[b]=f+Math.ceil((255-f)*m*l%65025/(m*l)),f=c.data[b+
1],m=a.data[b+1],c.data[b+1]=f+Math.ceil((255-f)*m*l%65025/(m*l)),f=c.data[b+2],m=a.data[b+2],c.data[b+2]=f+Math.ceil((255-f)*m*l%65025/(m*l)))}};Q._normalFuseImageOntoImageAtPosition=function(a,c,d,b,h,p){d=0|b.getHeight();let g=0|b.getWidth(),e=(c.width-g)*4|0;b=0|c.offsetOfPixel(b.left,b.top);let k=(a.width-g)*4|0;h=0|a.offsetOfPixel(h,p);for(p=0;p<d;p++,b+=e,h+=k)for(let f=0;f<g;f++,b+=4,h+=4){var l=c.data[b+3];let m;if(l){let n=l+(m=a.data[h+3])-(l*m/255|0)|0;l=255*l/n|0;let q=255-l;a.data[h]=
(c.data[b]*l+a.data[h]*q)/255|0;a.data[h+1]=(c.data[b+1]*l+a.data[h+1]*q)/255|0;a.data[h+2]=(c.data[b+2]*l+a.data[h+2]*q)/255|0;a.data[h+3]=n}}};Q.LM_NORMAL=0;Q.LM_MULTIPLY=1;Q.LM_ADD=2;Q.LM_SCREEN=3;Q.LM_LIGHTEN=4;Q.LM_DARKEN=5;Q.LM_SUBTRACT=6;Q.LM_DODGE=7;Q.LM_BURN=8;Q.LM_OVERLAY=9;Q.LM_HARDLIGHT=10;Q.LM_SOFTLIGHT=11;Q.LM_VIVIDLIGHT=12;Q.LM_LINEARLIGHT=13;Q.LM_PINLIGHT=14;Q.LM_PASSTHROUGH=15;Q.LM_MULTIPLY2=16;Q.LM_FIRST=0;Q.LM_LAST=16;Q.LM_LAST_CHIBIPAINT=Q.LM_PINLIGHT;Q.BLEND_MODE_CODENAMES="normal multiply add screen lighten darken subtract dodge burn overlay hardLight softLight vividLight linearLight pinLight passthrough multiply2".split(" ");
Q.BLEND_MODE_DISPLAY_NAMES="Normal;Multiply;Add;Screen;Lighten;Darken;Subtract;Dodge;Burn;Overlay;Hard Light;Soft Light;Vivid Light;Linear Light;Pin Light;Passthrough;Multiply".split(";");for(let a=0;a<256;a++){let c=a/255;Ab[a]=(c-c*c)*255|0}for(let a=0;a<256;a++){let c=a/255;Bb[a]=(Math.sqrt(c)-c)*255|0}db.prototype.copyFrom=function(a){this.name=a.name;this.blendMode=a.blendMode;this.useLegacyMultiply=a.useLegacyMultiply;this.alpha=a.alpha;this.visible=a.visible;this.parent=a.parent;this.lockAlpha=
a.lockAlpha;a.mask?this.mask?this.mask.copyPixelsFrom(a.mask):this.mask=a.mask.clone():this.mask=null;this.maskLinked=a.maskLinked;this.maskVisible=a.maskVisible;a.maskThumbnail?this.maskThumbnail?this.maskThumbnail.copyPixelsFrom(a.maskThumbnail):this.maskThumbnail=a.maskThumbnail.clone():this.maskThumbnail=null};db.prototype.setMask=function(a){(this.mask=a)||(this.maskThumbnail=null)};db.prototype.setAlpha=function(a){this.alpha=a};db.prototype.getAlpha=function(){return this.alpha};db.prototype.getEffectiveAlpha=
function(){return this.visible?this.alpha:0};db.prototype.getEffectiveMask=function(){return this.maskVisible?this.mask:null};db.prototype.setName=function(a){this.name=a};db.prototype.getName=function(){return this.name};db.prototype.setBlendMode=function(a){this.blendMode=a;a===Q.LM_MULTIPLY?this.useLegacyMultiply=!0:a===Q.LM_MULTIPLY2&&(this.useLegacyMultiply=!1)};db.prototype.getBlendMode=function(){return this.blendMode};db.prototype.getLockAlpha=function(){return this.lockAlpha};db.prototype.setLockAlpha=
function(a){this.lockAlpha=a};db.prototype.setVisible=function(a){this.visible=a};db.prototype.getVisible=function(){return this.visible};db.prototype.isVisible=db.prototype.getVisible;db.prototype.setMaskLinked=function(a){this.maskLinked=a};db.prototype.getMaskLinked=function(){return this.maskLinked};db.prototype.setMaskVisible=function(a){this.maskVisible=a};db.prototype.getMaskVisible=function(){return this.maskVisible};db.prototype.getMemoryUsed=function(){return 0};db.prototype.getDepth=function(){return null==
this.parent?0:this.parent.getDepth()+1};db.prototype.ancestorsAreVisible=function(){return null==this.parent||this.parent.visible&&this.parent.ancestorsAreVisible()};db.prototype.hasAncestor=function(a){return this.parent==a||this.parent&&this.parent.hasAncestor(a)};db.prototype.clone=function(){throw"Pure virtual CPLayer.clone() call";};db.prototype.getNonTransparentBounds=function(a){return new Ca(0,0,0,0)};db.prototype.rebuildMaskThumbnail=function(){if(this.mask){if(!this.maskThumbnail){var a=
Math.ceil(Math.max(this.mask.width/db.LAYER_THUMBNAIL_WIDTH,this.mask.height/db.LAYER_THUMBNAIL_HEIGHT));this.maskThumbnail=new Pa(Math.floor(this.mask.width/a),Math.floor(this.mask.height/a),8)}this.maskThumbnail.createThumbnailFrom(this.mask)}else this.maskThumbnail=null};db.prototype.getMaskThumbnail=function(){return!this.maskThumbnail&&this.mask&&this.rebuildMaskThumbnail(),this.maskThumbnail};db.LAYER_THUMBNAIL_WIDTH=80;db.LAYER_THUMBNAIL_HEIGHT=50;Fa.prototype=Object.create(db.prototype);Fa.prototype.constructor=
Fa;Fa.createFromImage=function(a,c){c=new Fa(0,0,c);return c.image=a,c};Fa.prototype.clone=function(){var a=new Fa(0,0,this.name);return a.copyFrom(this),a};Fa.prototype.copyFrom=function(a){db.prototype.copyFrom.call(this,a);this.clip=a.clip;this.image?this.image.copyPixelsFrom(a.image):this.image=a.image.clone()};Fa.prototype.hasAlpha=function(){return 100!=this.alpha||this.image.hasAlpha()};Fa.prototype.hasAlphaInRect=function(a){return 100!=this.alpha||this.image.hasAlphaInRect(a)};Fa.prototype.copyImageFrom=
function(a){this.image.copyPixelsFrom(a)};Fa.prototype.getClippingBase=function(){if(this.clip&&this.parent)for(var a=this.parent.indexOf(this)-1;a>=0;a--)if(this.parent.layers[a]instanceof Fa){if(!this.parent.layers[a].clip)return this.parent.layers[a]}else break;return null};Fa.prototype.getClip=function(){return this.clip};Fa.prototype.setClip=function(a){this.clip=a};Fa.prototype.getNonTransparentBounds=function(a){return this.image.getNonTransparentBounds(a)};Fa.prototype.getBounds=function(){return new Ca(0,
0,this.image.width,this.image.height)};Fa.prototype.getMemoryUsed=function(){return this.image?this.image.getMemorySize():0};Fa.prototype.rebuildImageThumbnail=function(){if(!this.imageThumbnail){var a=Math.ceil(Math.max(this.image.width/db.LAYER_THUMBNAIL_WIDTH,this.image.height/db.LAYER_THUMBNAIL_HEIGHT));this.imageThumbnail=new I(Math.floor(this.image.width/a),Math.floor(this.image.height/a))}this.imageThumbnail.createThumbnailFrom(this.image)};Fa.prototype.getImageThumbnail=function(){return this.imageThumbnail||
this.rebuildImageThumbnail(),this.imageThumbnail};Q.blendFunctionNameForParameters=function(a,c,d,b){d=Q.BLEND_MODE_CODENAMES[d]+"Onto";return a?d+="TransparentFusion":d+="OpaqueFusion",100==c?d+="WithOpaqueLayer":d+="WithTransparentLayer",b&&(d+="Masked"),d};Q.fuseImageOntoImage=function(a,c,d,b,h,p,g){b<=0||(c=Q.blendFunctionNameForParameters(c,b,h,null!=g),p=a.getBounds().clipTo(p),this[c](a,d,b,p,g))};Q.normalFuseImageOntoImageAtPosition=function(a,c,d,b,h){h=h.clone();d=new Ca(d,b,0,0);a.getBounds().clipSourceDest(h,
d);this._normalFuseImageOntoImageAtPosition(a,c,100,h,d.left,d.top)};Q.multiplyAlphaBy=function(a,c){if(c<100)if(0==c)a.clearAll(0);else{a=a.data;for(var d=3;d<a.length;d+=4)a[d]=Math.round(a[d]*c/100)}};Q.multiplyAlphaByMask=function(a,c,d){c/=25500;for(var b=I.ALPHA_BYTE_OFFSET,h=0;b<a.data.length;b+=I.BYTES_PER_PIXEL,h++)a.data[b]=Math.round(a.data[b]*d.data[h]*c)};Q.copyAndMultiplyAlphaBy=function(a,c,d,b){if(100==d)a.copyBitmapRect(c,b.left,b.top,b);else if(0==d)a.clearRect(b,0);else for(a=c.data,
c=0;c<a.length;c+=4)a[c]=a[c],a[c+1]=a[c+1],a[c+2]=a[c+2],a[c+3]=Math.round(a[c+3]*d/100)};zd.prototype.addChildren=function(a){null!=a&&(Array.isArray(a)?(a.forEach(c=>c.parent=this),this.layers=this.layers.concat(a)):(a.parent=this,this.layers.push(a)))};var Ib={};!function(a){function c(){}function d(g,e){for(var k=g.length;k--;)if(g[k].listener===e)return k;return-1}function b(g){return function(){return this[g].apply(this,arguments)}}var h=c.prototype,p=a.EventEmitter;h.getListeners=function(g){var e,
k,l=this._getEvents();if(g instanceof RegExp)for(k in e={},l)l.hasOwnProperty(k)&&g.test(k)&&(e[k]=l[k]);else e=l[g]||(l[g]=[]);return e};h.flattenListeners=function(g){var e,k=[];for(e=0;e<g.length;e+=1)k.push(g[e].listener);return k};h.getListenersAsObject=function(g){var e,k=this.getListeners(g);return k instanceof Array&&((e={})[g]=k),e||k};h.addListener=function(g,e){if(!function n(m){return"function"==typeof m||m instanceof RegExp||!!m&&"object"==typeof m&&n(m.listener)}(e))throw TypeError("listener must be a function");
var k;g=this.getListenersAsObject(g);var l="object"==typeof e;for(k in g)g.hasOwnProperty(k)&&-1===d(g[k],e)&&g[k].push(l?e:{listener:e,once:!1});return this};h.on=b("addListener");h.addOnceListener=function(g,e){return this.addListener(g,{listener:e,once:!0})};h.once=b("addOnceListener");h.defineEvent=function(g){return this.getListeners(g),this};h.defineEvents=function(g){for(var e=0;e<g.length;e+=1)this.defineEvent(g[e]);return this};h.removeListener=function(g,e){var k,l;g=this.getListenersAsObject(g);
for(l in g)g.hasOwnProperty(l)&&-1!==(k=d(g[l],e))&&g[l].splice(k,1);return this};h.off=b("removeListener");h.addListeners=function(g,e){return this.manipulateListeners(!1,g,e)};h.removeListeners=function(g,e){return this.manipulateListeners(!0,g,e)};h.manipulateListeners=function(g,e,k){var l,f,m=g?this.removeListener:this.addListener;g=g?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(l=k.length;l--;)m.call(this,e,k[l]);else for(l in e)e.hasOwnProperty(l)&&
(f=e[l])&&("function"==typeof f?m.call(this,l,f):g.call(this,l,f));return this};h.removeEvent=function(g){var e,k=typeof g,l=this._getEvents();if("string"===k)delete l[g];else if(g instanceof RegExp)for(e in l)l.hasOwnProperty(e)&&g.test(e)&&delete l[e];else delete this._events;return this};h.removeAllListeners=b("removeEvent");h.emitEvent=function(g,e){var k,l,f,m=this.getListenersAsObject(g);for(f in m)if(m.hasOwnProperty(f)){var n=0;for(k=m[f].slice(0);n<k.length;n++)!0===(l=k[n]).once&&this.removeListener(g,
l.listener),l.listener.apply(this,e||[])===this._getOnceReturnValue()&&this.removeListener(g,l.listener)}return this};h.trigger=b("emitEvent");h.emit=function(g){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(g,e)};h.setOnceReturnValue=function(g){return this._onceReturnValue=g,this};h._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue};h._getEvents=function(){return this._events||(this._events={})};c.noConflict=function(){return a.EventEmitter=
p,c};"function"==typeof define&&define.amd?define(function(){return c}):Ib?Ib=c:a.EventEmitter=c}("u">typeof window?window:Ib||{});class tg extends Ja(Ib){close(){this.layer=this.buffer=null;this.emitEvent("changeLayer")}setLayer(a){this.layer=a;this.invalidRect=a.getBounds();this.emitEvent("changeLayer")}isOpen(){return null!=this.layer}invalidateRect(a){this.invalidRect.union(a)}getImageData(){this.prepareMask();if(!this.invalidRect.isEmpty()&&this.layer&&this.layer.mask){var a=this.buffer,c=this.layer.mask,
d=this.invalidRect,b=d.top*c.width+d.left,h=b*I.BYTES_PER_PIXEL,p=d.getWidth();d=d.getHeight();var g=c.width-p,e=g*I.BYTES_PER_PIXEL;for(let k=0;k<d;k++,b+=g,h+=e)for(let l=0;l<p;l++,b++,h+=I.BYTES_PER_PIXEL)a.data[h+I.RED_BYTE_OFFSET]=c.data[b],a.data[h+I.GREEN_BYTE_OFFSET]=c.data[b],a.data[h+I.BLUE_BYTE_OFFSET]=c.data[b],a.data[h+I.ALPHA_BYTE_OFFSET]=255;!0;this.invalidRect.makeEmpty()}return this.buffer}constructor(a,c){super();this.layer=a;this.buffer=a.mask.getImageData(0,0,a.mask.width,a.mask.height);
this.invalidRect=new Ca(0,0,0,0);this.prepareMask=c}}class Yb{merge(a){return!1}noChange(){return!1}getMemoryUsed(a,c){return 0}compact(){}}jb.prototype.getRgb=function(){return this.rgb};jb.prototype.getSaturation=function(){return this.saturation};jb.prototype.getHue=function(){return this.hue};jb.prototype.getValue=function(){return this.value};jb.prototype.setRgbComponents=function(a,c,d){this.setRgb(a<<16|c<<8|d)};jb.prototype.setRgb=function(a){this.rgb=a;var c=a>>16&255,d=a>>8&255;a&=255;this.value=
Math.max(c,Math.max(d,a));var b=Math.min(c,Math.min(d,a));if(0==this.value?this.saturation=0:this.saturation=~~((this.value-b)/this.value*255),0==this.saturation)this.hue=0;else{var h=(this.value-c)/(this.value-b),p=(this.value-d)/(this.value-b);b=(this.value-a)/(this.value-b);var g=0;this.value==c&&(g=b-p);this.value==d&&(g=2+h-b);this.value==a&&(g=4+p-h);(g*=60)<0&&(g+=360);this.hue=~~g}};jb.prototype.setHsv=function(a,c,d){this.hue=a;this.saturation=c;this.value=d;this.rgb=Ld(this)};jb.prototype.setHue=
function(a){this.hue=a;this.rgb=Ld(this)};jb.prototype.setSaturation=function(a){this.saturation=a;this.rgb=Ld(this)};jb.prototype.setValue=function(a){this.value=a;this.rgb=Ld(this)};jb.prototype.setGreyscale=function(a){this.rgb=jb.greyToRGB(a);this.saturation=this.hue=0;this.value=a};jb.prototype.clone=function(){var a=new jb(0);return a.copyFrom(this),a};jb.prototype.copyFrom=function(a){this.rgb=a.rgb;this.hue=a.hue;this.saturation=a.saturation;this.value=a.value};jb.prototype.isEqual=function(a){return this.rgb==
a.rgb&&this.hue==a.hue&&this.saturation==a.saturation&&this.value==a.value};jb.greyToRGB=function(a){return a|a<<8|a<<16};qb.prototype.setToIdentity=function(){this.m=[1,0,0,1,0,0]};qb.prototype.multiply=function(a){var c=this.m[1]*a.m[0]+this.m[3]*a.m[1],d=this.m[0]*a.m[2]+this.m[2]*a.m[3],b=this.m[1]*a.m[2]+this.m[3]*a.m[3],h=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],p=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=this.m[0]*a.m[0]+this.m[2]*a.m[1];this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=
h;this.m[5]=p};qb.prototype.preMultiply=function(a){var c=a.m[1]*this.m[0]+a.m[3]*this.m[1],d=a.m[0]*this.m[2]+a.m[2]*this.m[3],b=a.m[1]*this.m[2]+a.m[3]*this.m[3],h=a.m[0]*this.m[4]+a.m[2]*this.m[5]+a.m[4],p=a.m[1]*this.m[4]+a.m[3]*this.m[5]+a.m[5];this.m[0]=a.m[0]*this.m[0]+a.m[2]*this.m[1];this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=h;this.m[5]=p};qb.prototype.invert=function(){var a=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),c=-this.m[1]*a,d=-this.m[2]*a,b=this.m[0]*a,h=a*(this.m[2]*this.m[5]-
this.m[3]*this.m[4]),p=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=this.m[3]*a;this.m[1]=c;this.m[2]=d;this.m[3]=b;this.m[4]=h;this.m[5]=p};qb.prototype.getInverted=function(){var a=new qb;return a.m[0]=this.m[0],a.m[1]=this.m[1],a.m[2]=this.m[2],a.m[3]=this.m[3],a.m[4]=this.m[4],a.m[5]=this.m[5],a.invert(),a};qb.prototype.rotate=function(a){var c=Math.cos(a);a=Math.sin(a);var d=this.m[1]*c+this.m[3]*a,b=-(this.m[0]*a)+this.m[2]*c,h=-(this.m[1]*a)+this.m[3]*c;this.m[0]=this.m[0]*c+this.m[2]*
a;this.m[1]=d;this.m[2]=b;this.m[3]=h};qb.prototype.rotateAroundPoint=function(a,c,d){this.translate(c,d);this.rotate(a);this.translate(-c,-d)};qb.prototype.translate=function(a,c){this.m[4]+=this.m[0]*a+this.m[2]*c;this.m[5]+=this.m[1]*a+this.m[3]*c};qb.prototype.scale=function(a,c){this.m[0]*=a;this.m[1]*=a;this.m[2]*=c;this.m[3]*=c};qb.prototype.scaleAroundPoint=function(a,c,d,b){this.translate(d,b);this.scale(a,c);this.translate(-d,-b)};qb.prototype.shear=function(a,c){var d=this.m[1]+this.m[3]*
c,b=this.m[2]+this.m[0]*a;a=this.m[3]+this.m[1]*a;this.m[0]+=this.m[2]*c;this.m[1]=d;this.m[2]=b;this.m[3]=a};qb.prototype.getTransformedPoint=function(a){return{x:a.x*this.m[0]+a.y*this.m[2]+this.m[4],y:a.x*this.m[1]+a.y*this.m[3]+this.m[5]}};qb.prototype.transformPoints=function(a){for(var c=0;c<a.length;c++)a[c]=this.getTransformedPoint(a[c])};qb.prototype.getTranslateX=function(){return this.m[4]};qb.prototype.getTranslateY=function(){return this.m[5]};qb.prototype.clone=function(){var a=new qb;
return a.m[0]=this.m[0],a.m[1]=this.m[1],a.m[2]=this.m[2],a.m[3]=this.m[3],a.m[4]=this.m[4],a.m[5]=this.m[5],a};qb.prototype.getDeterminant=function(){return this.m[0]*this.m[3]-this.m[1]*this.m[2]};qb.prototype.decompose=function(){var a=this.getDeterminant(),c=Math.sqrt(this.m[0]*this.m[0]+this.m[1]*this.m[1]);return{translate:{x:this.m[4],y:this.m[5]},rotate:Math.sign(this.m[1])*Math.acos(this.m[0]/c),scale:{x:c,y:a/c},shear:{x:Math.atan((this.m[0]*this.m[2]+this.m[1]*this.m[3])/(c*c)),y:0}}};
qb.prototype.toString=function(){return"["+this.m[0].toFixed(2)+" "+this.m[2].toFixed(2)+" "+this.m[4].toFixed(2)+"]\n["+this.m[1].toFixed(2)+" "+this.m[3].toFixed(2)+" "+this.m[5].toFixed(2)+"]\n[0.00 0.00 1.00]"};Math.sign=Math.sign||function(a){return 0==(a*=1)||isNaN(a)?a:a>0?1:-1};tc.prototype.toInt=function(){return Math.max(0,Math.min(255,Math.round(255*this.r)))<<16|Math.max(0,Math.min(255,Math.round(255*this.g)))<<8|Math.max(0,Math.min(255,Math.round(255*this.b)))};tc.prototype.mixWith=function(a,
c){this.r=this.r*(1-c)+a.r*c;this.g=this.g*(1-c)+a.g*c;this.b=this.b*(1-c)+a.b*c};tc.prototype.clone=function(){return new tc(this.r,this.g,this.b)};tc.createFromInt=function(a){return new tc((a>>>16&255)/255,(a>>>8&255)/255,(255&a)/255)};class gd{calcAlphaScale(a){return a<=230?.5:.5+(a-230)/25*(180/255-.5)}paintDab(a,c,d,b,h,p,g){p.alpha=Math.round(250/254*(p.alpha-1)+5);a=2===b.toolNb?this.calcAlphaScale(p.alpha):b.alphaScale;a=Math.max(1,Math.ceil(p.alpha*a));switch(b.paintMode){case xa.PAINT_MODE_FLOW:this._paintFlow(h,
c,p.brush,p.width,a);break;case xa.PAINT_MODE_OPACITY:this._paintOpacity(h,c,p.brush,p.width,a)}}mergeOntoImage(a,c,d){let b=this._strokeBuffer.data;var h=this._strokedRegion;c=c.data;let p=a.data,g=d>>16&255,e=d>>8&255;d&=255;let k=0|h.getWidth(),l=0|h.getHeight(),f=this._strokeBuffer.offsetOfPixel(h.left,h.top);h=a.offsetOfPixel(h.left,h.top);let m=this._strokeBuffer.width-k|0;a=(a.width-k)*I.BYTES_PER_PIXEL|0;for(let q=0;q<l;q++,f+=m,h+=a)for(let t=0;t<k;t++,f++,h+=I.BYTES_PER_PIXEL){var n=b[f]/
255+.5|0;if(n>0){let u=n+c[h+I.ALPHA_BYTE_OFFSET]*(255-n)/255|0;n=255*n/u|0;let v=255-n;p[h]=(g*n+c[h]*v)/255&255;p[h+1]=(e*n+c[h+1]*v)/255&255;p[h+2]=(d*n+c[h+2]*v)/255&255;p[h+3]=u}}}mergeOntoMask(a,c,d){let b=this._strokeBuffer.data;var h=this._strokedRegion;c=c.data;let p=a.data,g=0|h.getWidth(),e=0|h.getHeight(),k=a.offsetOfPixel(h.left,h.top);h=this._strokeBuffer.offsetOfPixel(h.left,h.top);let l=this._strokeBuffer.width-g|0;a=a.width-g|0;for(let f=0;f<e;f++,h+=l,k+=a)for(let m=0;m<g;m++,h++,
k++){let n=b[h]/255|0;n>0&&(p[k]=(d*n+c[k]*(255-n))/255)}}_paintFlow(a,c,d,b,h){let p=this._strokeBuffer.data;a=a.left+a.top*b;let g=this._strokeBuffer.offsetOfPixel(c.left,c.top),e=c.getHeight(),k=c.getWidth();b-=k;let l=this._strokeBuffer.width-k;this._strokedRegion.union(c);for(c=0;c<e;c++,a+=b,g+=l)for(let f=0;f<k;f++,a++,g++){let m=d[a]*h;0!=m&&(p[g]=Math.min(65025,p[g]+(255-p[g]/255)*m/255))}}_paintOpacity(a,c,d,b,h){let p=this._strokeBuffer.data;a=a.left+a.top*b;let g=this._strokeBuffer.offsetOfPixel(c.left,
c.top),e=c.getWidth();b-=e;let k=this._strokeBuffer.width-e;h=Math.min(255,h);this._strokedRegion.union(c);for(let l=c.top;l<c.bottom;l++,a+=b,g+=k)for(let f=0;f<e;f++,a++,g++)p[g]=Math.max(d[a]*h,p[g])}beginStroke(){}endStroke(){}constructor(a,c){this._strokeBuffer=a;this._strokedRegion=c;this.wantsOutputAsInput=!0}}class ug extends gd{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;let b=this._strokedRegion;c=c.data;let h=a.data;for(let p=b.top;p<b.bottom;p++){let g=a.offsetOfPixel(b.left,p)+I.ALPHA_BYTE_OFFSET,
e=this._strokeBuffer.offsetOfPixel(b.left,p);for(let k=b.left;k<b.right;k++,g+=I.BYTES_PER_PIXEL){let l=d[e++]/255|0;l>0&&(h[g]=c[g]*(255-l)/255)}}}}class vg extends gd{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let h=b.getWidth(),p=b.getHeight(),g=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=(a.width-h)*I.BYTES_PER_PIXEL,k=this._strokeBuffer.width-h;c=c.data;a=a.data;for(let f=0;f<p;f++,b+=k,g+=e)for(let m=0;m<h;m++,b++,g+=I.BYTES_PER_PIXEL){var l=
d[b]/255|0;l>0&&0!=c[g+I.ALPHA_BYTE_OFFSET]&&(l=(l+255)/255,a[g+I.RED_BYTE_OFFSET]=c[g+I.RED_BYTE_OFFSET]*l,a[g+I.GREEN_BYTE_OFFSET]=c[g+I.GREEN_BYTE_OFFSET]*l,a[g+I.BLUE_BYTE_OFFSET]=c[g+I.BLUE_BYTE_OFFSET]*l)}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let h=b.getWidth(),p=b.getHeight(),g=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=a.width-h,k=this._strokeBuffer.width-h;c=c.data;a=a.data;for(let l=0;l<p;l++,b+=k,g+=e)for(let f=
0;f<h;f++,b++,g++){let m=d[b]/255|0;m>0&&(a[g]=Math.min((m+255)/255*c[g],255))}}}class wg extends gd{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let h=b.getWidth(),p=b.getHeight(),g=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=(a.width-h)*I.BYTES_PER_PIXEL,k=this._strokeBuffer.width-h;c=c.data;a=a.data;for(let l=0;l<p;l++,b+=k,g+=e)for(let f=0;f<h;f++,b++,g+=I.BYTES_PER_PIXEL){let m=d[b]/255|0;m>0&&0!=c[g+I.ALPHA_BYTE_OFFSET]&&
(a[g+I.RED_BYTE_OFFSET]=c[g+I.RED_BYTE_OFFSET]-(260-c[g+I.RED_BYTE_OFFSET])*m/255|0,a[g+I.GREEN_BYTE_OFFSET]=c[g+I.GREEN_BYTE_OFFSET]-(260-c[g+I.GREEN_BYTE_OFFSET])*m/255|0,a[g+I.BLUE_BYTE_OFFSET]=c[g+I.BLUE_BYTE_OFFSET]-(260-c[g+I.BLUE_BYTE_OFFSET])*m/255|0)}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;let h=b.getWidth(),p=b.getHeight(),g=a.offsetOfPixel(b.left,b.top);b=this._strokeBuffer.offsetOfPixel(b.left,b.top);let e=a.width-h,k=this._strokeBuffer.width-h;c=c.data;
a=a.data;for(let l=0;l<p;l++,b+=k,g+=e)for(let f=0;f<h;f++,b++,g++){let m=d[b]/255|0;m>0&&(a[g]=Math.max(c[g]-(260-c[g])*m/255,0))}}}class xg extends gd{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;let b=this._strokedRegion,h=c.data;a=a.data;var p=b.getWidth();let g=c.width*I.BYTES_PER_PIXEL,e=c.offsetOfPixel(b.left,b.top),k=this._strokeBuffer.offsetOfPixel(b.left,b.top),l=(c.width-p)*I.BYTES_PER_PIXEL;p=this._strokeBuffer.width-p;let f,m,n,q,t=function(v){f+=h[v+I.RED_BYTE_OFFSET];m+=h[v+I.GREEN_BYTE_OFFSET];
n+=h[v+I.BLUE_BYTE_OFFSET];q+=h[v+I.ALPHA_BYTE_OFFSET]};for(let v=b.top;v<b.bottom;v++,e+=l,k+=p)for(let A=b.left;A<b.right;A++,e+=I.BYTES_PER_PIXEL,k++){var u=d[k]/255|0;if(u>0){u=64+-63*u/255|0;let C=u+4;f=u*h[e+I.RED_BYTE_OFFSET];m=u*h[e+I.GREEN_BYTE_OFFSET];n=u*h[e+I.BLUE_BYTE_OFFSET];q=u*h[e+I.ALPHA_BYTE_OFFSET];t(v>0?e-g:e);t(v<c.height-1?e+g:e);t(A>0?e-I.BYTES_PER_PIXEL:e);t(A<c.width-1?e+I.BYTES_PER_PIXEL:e);q/=C;f/=C;m/=C;n/=C;a[e+I.RED_BYTE_OFFSET]=0|f;a[e+I.GREEN_BYTE_OFFSET]=0|m;a[e+I.BLUE_BYTE_OFFSET]=
0|n;a[e+I.ALPHA_BYTE_OFFSET]=0|q}}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;let b=this._strokedRegion,h=c.data;a=a.data;var p=b.getWidth();let g=c.width,e=c.offsetOfPixel(b.left,b.top),k=this._strokeBuffer.offsetOfPixel(b.left,b.top),l=c.width-p;p=this._strokeBuffer.width-p;for(let n=b.top;n<b.bottom;n++,e+=l,k+=p)for(let q=b.left;q<b.right;q++,e++,k++){var f=d[k]/255|0;if(f>0){var m=64+-63*f/255|0;f=m+4;m=m*h[e]+h[n>0?e-g:e]+h[n<c.height-1?e+g:e]+h[q>0?e-1:e]+h[q<c.width-1?e+1:e];a[e]=m/f|
0}}}}class Se extends gd{mergeOntoImage(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;c=c.data;let h=a.data,p=this._strokeBuffer.offsetOfPixel(b.left,b.top),g=a.offsetOfPixel(b.left,b.top),e=0|b.getWidth();b=0|b.getHeight();let k=this._strokeBuffer.width-e|0;a=(a.width-e)*I.BYTES_PER_PIXEL|0;for(let m=0;m<b;m++,p+=k,g+=a)for(let n=0;n<e;n++,p++,g+=I.BYTES_PER_PIXEL){let q=d[p];var l=q>>>24;if(l>0){var f=c[g+I.ALPHA_BYTE_OFFSET];f=l+f-l*f/255|0;l=255*l/f|0;let t=255-l;h[g]=((q>>16&255)*
l+c[g]*t)/255|0;h[g+1]=((q>>8&255)*l+c[g+1]*t)/255|0;h[g+2]=((255&q)*l+c[g+2]*t)/255|0;h[g+3]=f}}}mergeOntoMask(a,c,d){d=this._strokeBuffer.data;var b=this._strokedRegion;c=c.data;let h=a.data,p=this._strokeBuffer.offsetOfPixel(b.left,b.top),g=a.offsetOfPixel(b.left,b.top),e=0|b.getWidth();b=0|b.getHeight();let k=this._strokeBuffer.width-e|0;a=a.width-e|0;for(let l=0;l<b;l++,p+=k,g+=a)for(let f=0;f<e;f++,p++,g++){let m=d[p],n=m>>8;n>0&&(h[g]=((255&m)*n+c[g]*(255-n))/255|0)}}}let Sf=2/6;class Ad extends Se{static _sampleGrey(a,
c,d,b,h){c|=0;d|=0;let p=[{x:c,y:d}];for(let g=.25;g<1.001;g+=.25)Array.prototype.push.apply(p,[{x:~~(c+g*b),y:d},{x:~~(c-g*b),y:d},{x:c,y:~~(d+g*h)},{x:c,y:~~(d-g*h)},{x:~~(c+.7*g*b),y:~~(d+.7*g*h)},{x:~~(c+.7*g*b),y:~~(d-.7*g*h)},{x:~~(c-.7*g*b),y:~~(d+.7*g*h)},{x:~~(c-.7*g*b),y:~~(d-.7*g*h)}]);return gf(p.map(g=>a.getPixel(g.x,g.y)))}static _sampleRGB(a,c,d,b,h,p){let g=a.width,e=a.height,k=a.data,l=0,f=0,m=0,n=0;a=(q,t)=>{q=~~q;t=~~t;q>=0&&t>=0&&q<g&&t<e&&(t=(t*g+q)*4,k[t+3]>0&&(l+=k[t],f+=k[t+
1],m+=k[t+2],n++))};a(c,d);for(let q=.25;q<1.001;q+=.25){let t=q*b,u=q*h,v=.7*t,A=.7*u;a(c+t,d);a(c-t,d);a(c,d+u);a(c,d-u);a(c+v,d+A);a(c+v,d-A);a(c-v,d+A);a(c-v,d-A)}return 0===n?p:tc.createFromInt(-16777216|(l/n|0)<<16|(f/n|0)<<8|m/n|0)}_paintToColorStrokeBuffer(a,c,d,b,h,p){let g=this._strokeBuffer.data,e=c.getWidth(),k=c.getHeight(),l=this._strokeBuffer.width-e,f=b-e;a=a.left+a.top*b;b=this._strokeBuffer.offsetOfPixel(c.left,c.top);this._strokedRegion.union(c);for(c=0;c<k;c++,a+=f,b+=l)for(let q=
0;q<e;q++,a++,b++){var m=d[a]*h/255|0;if(m>0){let t=g[b];var n=t>>>24;n=m+n-m*n/255|0;m=255-(255*m/n|0);g[b]=n<<24|(p>>16&255)+((t>>16&255)*m-(p>>16&255)*m)/255<<16|(p>>8&255)+((t>>8&255)*m-(p>>8&255)*m)/255<<8|(255&p)+((255&t)*m-(255&p)*m)/255}}}_paintToGreyscaleStrokeBuffer(a,c,d,b,h,p){let g=this._strokeBuffer.data;this._strokedRegion.union(c);for(let l=c.top,f=a.top;l<c.bottom;l++,f++){let m=a.left+f*b,n=this._strokeBuffer.offsetOfPixel(c.left,l);for(let q=c.left;q<c.right;q++,m++,n++){var e=
d[m]*h/255|0;if(e<=0)continue;let t=g[n];var k=t>>8;k=e+k-e*k/255|0;k>0&&(e=255-(255*e/k|0),g[n]=k<<8|p+((255&t)*e-p*e)/255)}}}beginStroke(){this._previousSamples=null}paintDab(a,c,d,b,h,p,g){a=this.isTransparentCanvas?.3:1;p.alpha=247/254*(p.alpha-1)+8;p.alpha*=a;var e,k;a=Math.max(1,p.alpha/4);var l=(c.left+c.right)/2,f=(c.top+c.bottom)/2,m=Math.max(1,Math.min(64,c.getWidth()*Sf)),n=Math.max(1,Math.min(64,c.getHeight()*Sf));if(d instanceof Pa){null==this._previousSamples&&(this._previousSamples=
Array(50),this._previousSamples.fill(Ad._sampleGrey(d,l,f,m,n)));var q=gf(this._previousSamples);var t=q;g=t=q=t*(1-(e=b.resat*b.resat))+(255&g)*e;d=Ad._sampleGrey(d,l,f,m,n);q=g*(1-(k=b.bleed))+d*k;this._previousSamples.push(q);this._previousSamples.shift();this._paintToGreyscaleStrokeBuffer(h,c,p.brush,p.width,a,Math.round(t))}else{null==this._previousSamples&&(this._previousSamples=Array(50),k=tc.createFromInt(g),this._previousSamples.fill(Ad._sampleRGB(d,l,f,m,n,k)));k=this._previousSamples;e=
new tc(0,0,0);for(t=0;t<k.length;t++)q=k[t],e.r+=q.r,e.g+=q.g,e.b+=q.b;k=(e.r/=k.length,e.g/=k.length,e.b/=k.length,e);k.mixWith(tc.createFromInt(g),b.resat*b.resat);e=k.toInt();g=tc.createFromInt(g);d=Ad._sampleRGB(d,l,f,m,n,g);this.isTransparentCanvas=g===d;k.mixWith(d,b.bleed);this._previousSamples.push(k);this._previousSamples.shift();this._paintToColorStrokeBuffer(h,c,p.brush,p.width,a,e)}}constructor(a,c){super(a,c);this.wantsOutputAsInput=!0}}class zg extends Se{_accumulatePaintFromMask(a,
c,d,b){let h=this._brushBuffer.data,p=a.data,g=d.getWidth(),e=d.getHeight();c=c.left+c.top*this._brushBuffer.width;d=a.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-g;a=a.width-g;if(!(b<=0))for(let f=0;f<e;f++,c+=k,d+=a)for(let m=0;m<g;m++,c++,d++){let n=p[d],q=h[c];var l=q>>8;l=b+l-b*l/255|0;let t=255-(255*b/l|0);h[c]=l<<8|n+((255&q)*t-n*t)/255}}_resaturateBrushWithGrey(a,c,d){if(!(c<=0)){var b=this._brushBuffer.data,h=a.getWidth(),p=a.getHeight();a=a.left+a.top*this._brushBuffer.width;
var g=this._brushBuffer.width-h;for(let k=0;k<p;k++,a+=g)for(let l=0;l<h;l++,a++){let f=b[a];var e=f>>8;e=c+e-c*e/255|0;let m=255-(255*c/e|0);b[a]=e<<8|d+((255&f)*m-d*m)/255}}}_paintToGreyscaleStrokeBuffer(a,c,d,b,h){let p=this._strokeBuffer.data,g=this._brushBuffer.data,e=a.data;this._strokedRegion.union(d);for(let l=d.top,f=c.top;l<d.bottom;l++,f++){let m=this._brushBuffer.offsetOfPixel(c.left,f),n=this._strokeBuffer.offsetOfPixel(d.left,l),q=a.offsetOfPixel(d.left,l);for(let t=d.left;t<d.right;t++,
m++,q++,n++){let u=g[m];var k=(u>>8)*b[m]*h/65025|0;k>0&&(k=255-k,p[n]=65280|(255&u)+(e[q]*k-(255&u)*k)/255)}}}_accumulatePaintFromImage(a,c,d,b){let h=this._brushBuffer.data,p=a.data,g=d.getWidth(),e=d.getHeight();c=c.left+c.top*this._brushBuffer.width;d=a.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-g;a=(a.width-g)*I.BYTES_PER_PIXEL;for(let m=0;m<e;m++,c+=k,d+=a)for(let n=0;n<g;n++,c++,d+=I.BYTES_PER_PIXEL){var l=p[d+I.ALPHA_BYTE_OFFSET]*b/255|0;if(l>0){let q=h[c];var f=q>>>24;f=l+
f-l*f/255|0;l=255-(255*l/f|0);let t=p[d+I.RED_BYTE_OFFSET],u=p[d+I.GREEN_BYTE_OFFSET],v=p[d+I.BLUE_BYTE_OFFSET];h[c]=f<<24|t+((q>>16&255)*l-t*l)/255<<16|u+((q>>8&255)*l-u*l)/255<<8|v+((255&q)*l-v*l)/255}}}_resaturateBrushWithColor(a,c,d){if(!(c<=0)){var b=this._brushBuffer.data,h=a.getWidth(),p=a.getHeight();a=a.left+a.top*this._brushBuffer.width;var g=this._brushBuffer.width-h;for(let k=0;k<p;k++,a+=g)for(let l=0;l<h;l++,a++){let f=b[a];var e=f>>>24;e=c+e-c*e/255|0;let m=255-(255*c/e|0);b[a]=e<<
24|(d>>>16&255)+((f>>>16&255)*m-(d>>>16&255)*m)/255<<16|(d>>>8&255)+((f>>>8&255)*m-(d>>>8&255)*m)/255<<8|(255&d)+((255&f)*m-(255&d)*m)/255}}}_paintToColorStrokeBuffer(a,c,d,b,h){let p=this._strokeBuffer.data,g=this._brushBuffer.data,e=a.data;this._strokedRegion.union(d);for(let f=d.top,m=c.top;f<d.bottom;f++,m++){let n=this._brushBuffer.offsetOfPixel(c.left,m),q=this._strokeBuffer.offsetOfPixel(d.left,f),t=a.offsetOfPixel(d.left,f);for(let u=d.left;u<d.right;u++,n++,t+=I.BYTES_PER_PIXEL,q++){let v=
g[n];var k=(v>>>24)*b[n]*h/65025|0;if(k>0){var l=e[t+I.ALPHA_BYTE_OFFSET];l=k+l-k*l/255|0;k=255-(255*k/l|0);p[q]=l<<24|(v>>16&255)+(e[t+I.RED_BYTE_OFFSET]*k-(v>>16&255)*k)/255<<16|(v>>8&255)+(e[t+I.GREEN_BYTE_OFFSET]*k-(v>>8&255)*k)/255<<8|(255&v)+(e[t+I.BLUE_BYTE_OFFSET]*k-(255&v)*k)/255}}}}paintDab(a,c,d,b,h,p,g){a instanceof I?null==this._brushBuffer?(this._brushBuffer=new Pa(p.width,p.height,32),this._accumulatePaintFromImage(d,h,c,255)):(this._resaturateBrushWithColor(h,~~(b.resat<=0?0:Math.max(1,
b.resat*b.resat*255)),16777215&g),this._paintToColorStrokeBuffer(a,h,c,p.brush,p.alpha),this._accumulatePaintFromImage(d,h,c,~~(255*b.bleed))):null==this._brushBuffer?(this._brushBuffer=new Pa(p.width,p.height,16),this._accumulatePaintFromMask(d,h,c,255)):(this._resaturateBrushWithGrey(h,~~(b.resat<=0?0:Math.max(1,b.resat*b.resat*255)),255&g),this._paintToGreyscaleStrokeBuffer(a,h,c,p.brush,p.alpha),this._accumulatePaintFromMask(d,h,c,~~(255*b.bleed)))}endStroke(){this._brushBuffer=null}constructor(a,
c){super(a,c);this.wantsOutputAsInput=!0;this.isTransparentCanvas=!1}}class yg extends Se{_sampleFromMask(a,c,d,b){let h=this._brushBuffer.data,p=c.getWidth(),g=c.getHeight(),e=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let k=this._brushBuffer.width-p,l=a.width-p,f=255-b;if(255!=b){for(let m=0;m<g;m++,e+=k,d+=l)for(let n=0;n<p;n++,e++,d++){let q=a.data[d],t=h[e],u=(q*f+(255&t)*b)/255,v=(255*f+(t>>8)*b)/255<<8|u;v==t&&(q>u?v++:q<u&&v--);h[e]=v}hf(this._brushBuffer,
c)}}_paintToMask(a,c,d,b){let h=c.getWidth(),p=c.getHeight();c=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let g=this._brushBuffer.width-h,e=a.width-h;a=a.data;let k=this._brushBuffer.data;for(let l=0;l<p;l++,d+=e,c+=g)for(let f=0;f<h;f++,c++,d++){let m=k[c],n=255&m;((m>>8)*b[c]/255|0)>0&&(a[d]=n)}}_sampleFromImage(a,c,d,b){let h=this._brushBuffer.data,p=c.getWidth(),g=c.getHeight(),e=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let k=
this._brushBuffer.width-p,l=(a.width-p)*I.BYTES_PER_PIXEL,f=255-b;if(255!=b){for(let n=0;n<g;n++,e+=k,d+=l)for(let q=0;q<p;q++,e++,d+=I.BYTES_PER_PIXEL){let t=a.data[d+I.RED_BYTE_OFFSET],u=a.data[d+I.GREEN_BYTE_OFFSET],v=a.data[d+I.BLUE_BYTE_OFFSET];var m=h[e];let A=(a.data[d+I.ALPHA_BYTE_OFFSET]*f+(m>>24&255)*b)/255<<24&4278190080|(t*f+(m>>16&255)*b)/255<<16&16711680|(u*f+(m>>8&255)*b)/255<<8&65280|(v*f+(255&m)*b)/255&255;if(A==m){m=(16711680&A)>>16;let C=(65280&A)>>8,x=255&A;t>m?A+=65536:t<m&&(A-=
65536);u>C?A+=256:u<C&&(A-=256);v>x?A+=1:v<x&&--A}h[e]=A}hf(this._brushBuffer,c)}}_paintToImage(a,c,d,b){let h=c.getWidth(),p=c.getHeight();c=this._brushBuffer.offsetOfPixel(c.left,c.top);d=a.offsetOfPixel(d.left,d.top);let g=this._brushBuffer.width-h,e=(a.width-h)*I.BYTES_PER_PIXEL;a=a.data;let k=this._brushBuffer.data;for(let l=0;l<p;l++,d+=e,c+=g)for(let f=0;f<h;f++,c++,d+=I.BYTES_PER_PIXEL){let m=k[c];((m>>>24)*b[c]/255|0)>0&&(a[d+I.RED_BYTE_OFFSET]=m>>16&255,a[d+I.GREEN_BYTE_OFFSET]=m>>8&255,
a[d+I.BLUE_BYTE_OFFSET]=255&m,a[d+I.ALPHA_BYTE_OFFSET]=m>>24&255)}}paintDab(a,c,d,b,h,p,g){a instanceof I?null==this._brushBuffer?(this._brushBuffer=new Pa(p.width,p.height,32),this._sampleFromImage(d,h,c,0)):(this._sampleFromImage(d,h,c,p.alpha),this._paintToImage(a,h,c,p.brush)):null==this._brushBuffer?(this._brushBuffer=new Pa(p.width,p.height,16),this._sampleFromMask(d,h,c,0)):(this._sampleFromMask(d,h,c,p.alpha),this._paintToMask(a,h,c,p.brush))}mergeOntoImage(a,c,d){}mergeOntoMask(a,c,d){}beginStroke(){this._brushBuffer=
null}endStroke(){this._brushBuffer=null}constructor(a,c){super(a,c);this._brushBuffer=null;this.noMergePhase=this.wantsOutputAsInput=!0}}ec.prototype=Object.create(Ja(Ib).prototype);ec.prototype.constructor=ec;ec.prototype.getBounds=function(){return new Ca(0,0,this.width,this.height)};ec.prototype.isPointWithin=function(a,c){return a>=0&&c>=0&&a<this.width&&c<this.height};ec.EDITING_MODE_IMAGE=0;ec.EDITING_MODE_MASK=1;gb.prototype.readChar=function(){return this.pos<this.end?String.fromCharCode(this.data[this.pos++]):
(this.eof=!0,-1)};gb.prototype.readByte=function(){return this.pos<this.end?this.data[this.pos++]:(this.eof=!0,-1)};gb.prototype.readU8=gb.prototype.readByte;gb.prototype.readS8=function(){var a;return 128&(a=this.readByte())?4294967040|a:a};gb.prototype.unreadChar=function(a){this.pos--};gb.prototype.peekChar=function(){return this.pos<this.end?String.fromCharCode(this.data[this.pos]):(this.eof=!0,-1)};gb.prototype.readString=function(a){var c,d=Array(a);for(c=0;c<a;c++)d[c]=this.readChar();return d.join("")};
gb.prototype.readS16=function(){var a;return 32768&(a=this.readByte()<<8|this.readByte())?4294901760|a:a};gb.prototype.readU16BE=function(){return this.readByte()<<8|this.readByte()};gb.prototype.readU16LE=function(){var a=this.readByte();return this.readByte()<<8|a};gb.prototype.readU32BE=function(){return(this.readByte()<<24|this.readByte()<<16|this.readByte()<<8|this.readByte())>>>0};gb.prototype.readU32LE=function(){var a=this.readByte(),c=this.readByte(),d=this.readByte();return(this.readByte()<<
24|d<<16|c<<8|a)>>>0};gb.prototype.readBytes=function(a){var c=this.data.subarray(this.pos,this.pos+a);return this.pos+=a,this.pos>this.end&&(this.eof=!0),c};gb.prototype.skip=function(a){this.pos+=a;this.pos>this.end&&(this.eof=!0)};gb.prototype.seek=function(a){this.pos=a};gb.prototype.writeBytes=function(a){for(var c=0;c<a.length;c++)this.data[this.pos++]=a[c]};gb.prototype.writeByte=function(a){this.data[this.pos++]=a};gb.prototype.writeU8=gb.prototype.writeByte;gb.prototype.writeU16LE=function(a){this.data[this.pos++]=
a;this.data[this.pos++]=a>>8};gb.prototype.writeU16BE=function(a){this.data[this.pos++]=a>>8;this.data[this.pos++]=a};gb.prototype.writeU32BE=function(a){this.data[this.pos++]=a>>24;this.data[this.pos++]=a>>16;this.data[this.pos++]=a>>8;this.data[this.pos++]=a};gb.prototype.writeU32LE=function(a){this.data[this.pos++]=a;this.data[this.pos++]=a>>8;this.data[this.pos++]=a>>16;this.data[this.pos++]=a>>24};gb.prototype.writeDoubleBE=function(a){a=new Uint8Array((new Float64Array([a])).buffer);for(var c=
a.length-1;c>=0;c--)this.writeByte(a[c])};gb.prototype.writeFloatBE=function(a){a=new Uint8Array((new Float32Array([a])).buffer);for(var c=a.length-1;c>=0;c--)this.writeByte(a[c])};gb.prototype.writeString=function(a){for(var c=0;c<a.length;c++)this.data[this.pos++]=a.charCodeAt(c)};gb.prototype.writeUnsignedIntBE=function(a,c){switch(void 0===c&&(c=this.measureUnsignedInt(a)),c){case 5:this.writeU8(Math.floor(a/4294967296));case 4:this.writeU8(a>>24);case 3:this.writeU8(a>>16);case 2:this.writeU8(a>>
8);case 1:this.writeU8(a);break;default:throw"Bad UINT size "+c;}};gb.prototype.measureUnsignedInt=function(a){return a<256?1:a<65536?2:a<16777216?3:a<4294967296?4:5};gb.prototype.getAsDataArray=function(){if(this.pos<this.data.byteLength)return this.data.subarray(0,this.pos);if(this.pos==this.data.byteLength)return this.data;throw"ArrayDataStream's pos lies beyond end of buffer";};gb.prototype.EOF=-1;var Tf={},mh=function(a,c,d,b,h){a=new Worker(Tf[c]||(Tf[c]=URL.createObjectURL(new Blob([a+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],
{type:"text/javascript"}))));return a.onmessage=function(p){var g=p.data;(p=g.$e$)?(g=Error(p[0]),g.code=p[1],g.stack=p[2],h(g,null)):h(null,g)},a.postMessage(d,b),a},Fb=Uint8Array,cc=Uint16Array,Gd=Int32Array,qd=new Fb([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rd=new Fb([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Hd=new Fb([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Uf=function(a,c){for(var d=new cc(31),b=0;b<31;++b)d[b]=c+=1<<a[b-1];
a=new Gd(d[30]);for(b=1;b<30;++b)for(c=d[b];c<d[b+1];++c)a[c]=c-d[b]<<5|b;return{b:d,r:a}},Vf=Uf(qd,2),Te=Vf.b,je=Vf.r;Te[28]=258;je[258]=28;for(var Wf=Uf(rd,0),Xf=Wf.b,Ue=Wf.r,Id=new cc(32768),Cb=0;Cb<32768;++Cb){var cd=(43690&Cb)>>1|(21845&Cb)<<1;cd=(61680&(cd=(52428&cd)>>2|(13107&cd)<<2))>>4|(3855&cd)<<4;Id[Cb]=((65280&cd)>>8|(255&cd)<<8)>>1}var rc=function(a,c,d){for(var b=a.length,h=0,p=new cc(c);h<b;++h)a[h]&&++p[a[h]-1];var g=new cc(c);for(h=1;h<c;++h)g[h]=g[h-1]+p[h-1]<<1;if(d)for(d=new cc(1<<
c),p=15-c,h=0;h<b;++h){if(a[h]){var e=h<<4|a[h],k=c-a[h],l=g[a[h]-1]++<<k;for(k=l|(1<<k)-1;l<=k;++l)d[Id[l]>>p]=e}}else for(h=0,d=new cc(b);h<b;++h)a[h]&&(d[h]=Id[g[a[h]-1]++]>>15-a[h]);return d},Gc=new Fb(288);for(Cb=0;Cb<144;++Cb)Gc[Cb]=8;for(Cb=144;Cb<256;++Cb)Gc[Cb]=9;for(Cb=256;Cb<280;++Cb)Gc[Cb]=7;for(Cb=280;Cb<288;++Cb)Gc[Cb]=8;var sd=new Fb(32);for(Cb=0;Cb<32;++Cb)sd[Cb]=5;var Yf=rc(Gc,9,0),Zf=rc(Gc,9,1),$f=rc(sd,5,0),ag=rc(sd,5,1),ke=function(a){for(var c=a[0],d=1;d<a.length;++d)a[d]>c&&
(c=a[d]);return c},sc=function(a,c,d){var b=c/8|0;return(a[b]|a[b+1]<<8)>>(7&c)&d},le=function(a,c){var d=c/8|0;return(a[d]|a[d+1]<<8|a[d+2]<<16)>>(7&c)},Jd=function(a){return(a+7)/8|0},dd=function(a,c,d){return(null==c||c<0)&&(c=0),(null==d||d>a.length)&&(d=a.length),new Fb(a.subarray(c,d))},bg=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099",
"filename too long","stream finishing","invalid zip data"],$b=function(a,c,d){c=Error(c||bg[a]);if(c.code=a,Error.captureStackTrace&&Error.captureStackTrace(c,$b),!d)throw c;return c},Nd=function(a,c,d,b){var h=a.length,p=b?b.length:0;if(!h||c.f&&!c.l)return d||new Fb(0);var g=!d,e=g||2!=c.i,k=c.i;g&&(d=new Fb(3*h));var l=function(P){var B=d.length;P>B&&(P=new Fb(Math.max(2*B,P)),P.set(d),d=P)},f=c.f||0,m=c.p||0,n=c.b||0,q=c.l,t=c.d,u=c.m,v=c.n,A=8*h;do{if(!q){f=sc(a,m,1);var C=sc(a,m+1,3);if(m+=
3,C)if(1==C)q=Zf,t=ag,u=9,v=5;else if(2==C){u=sc(a,m,31)+257;t=sc(a,m+10,15)+4;q=u+sc(a,m+5,31)+1;m+=14;v=new Fb(q);var x=new Fb(19);for(C=0;C<t;++C)x[Hd[C]]=sc(a,m+3*C,7);m+=3*t;C=ke(x);t=(1<<C)-1;var F=rc(x,C,1);for(C=0;C<q;)if(x=F[sc(a,m,t)],m+=15&x,x>>=4,x<16)v[C++]=x;else{var w=0,G=0;for(16==x?(G=3+sc(a,m,3),m+=2,w=v[C-1]):17==x?(G=3+sc(a,m,7),m+=3):18==x&&(G=11+sc(a,m,127),m+=7);G--;)v[C++]=w}q=v.subarray(0,u);C=v.subarray(u);u=ke(q);v=ke(C);q=rc(q,u,1);t=rc(C,v,1)}else $b(1);else{x=Jd(m)+4;
m=a[x-4]|a[x-3]<<8;C=x+m;if(C>h){k&&$b(0);break}e&&l(n+m);d.set(a.subarray(x,C),n);c.b=n+=m;c.p=m=8*C;c.f=f;continue}if(m>A){k&&$b(0);break}}e&&l(n+131072);x=(1<<u)-1;F=(1<<v)-1;for(G=m;;G=m){w=q[le(a,m)&x];C=w>>4;if((m+=15&w)>A){k&&$b(0);break}if(w||$b(2),C<256)d[n++]=C;else if(256==C){G=m;q=null;break}else{w=C-254;if(C>264){C-=257;var H=qd[C];w=sc(a,m,(1<<H)-1)+Te[C];m+=H}C=t[le(a,m)&F];H=C>>4;C||$b(3);m+=15&C;C=Xf[H];H>3&&(H=rd[H],C+=le(a,m)&(1<<H)-1,m+=H);if(m>A){k&&$b(0);break}e&&l(n+131072);
w=n+w;if(n<C)for(G=p-C,H=Math.min(C,w),G+n<0&&$b(3);n<H;++n)d[n]=b[G+n];for(;n<w;++n)d[n]=d[n-C]}}c.l=q;c.p=G;c.b=n;c.f=f;q&&(f=1,c.m=u,c.d=t,c.n=v)}while(!f);return n!=d.length&&g?dd(d,0,n):d.subarray(0,n)},Ac=function(a,c,d){d<<=7&c;c=c/8|0;a[c]|=d;a[c+1]|=d>>8},td=function(a,c,d){d<<=7&c;c=c/8|0;a[c]|=d;a[c+1]|=d>>8;a[c+2]|=d>>16},ne=function(a,c){for(var d=[],b=0;b<a.length;++b)a[b]&&d.push({s:b,f:a[b]});var h=d.length;a=d.slice();if(!h)return{t:Ve,l:0};if(1==h)return c=new Fb(d[0].s+1),c[d[0].s]=
1,{t:c,l:1};d.sort(function(f,m){return f.f-m.f});d.push({s:-1,f:25001});b=d[0];var p=d[1],g=0,e=1,k=2;for(d[0]={s:-1,f:b.f+p.f,l:b,r:p};e!=h-1;)b=d[d[g].f<d[k].f?g++:k++],p=d[g!=e&&d[g].f<d[k].f?g++:k++],d[e++]={s:-1,f:b.f+p.f,l:b,r:p};p=a[0].s;for(b=1;b<h;++b)a[b].s>p&&(p=a[b].s);var l=new cc(p+1);e=me(d[e-1],l,0);if(e>c){d=b=0;p=e-c;g=1<<p;for(a.sort(function(f,m){return l[m.s]-l[f.s]||f.f-m.f});b<h;++b)if(k=a[b].s,l[k]>c)d+=g-(1<<e-l[k]),l[k]=c;else break;for(d>>=p;d>0;)h=a[b].s,l[h]<c?d-=1<<
c-l[h]++-1:++b;for(;b>=0&&d;--b)h=a[b].s,l[h]==c&&(--l[h],++d);e=c}return{t:new Fb(l),l:e}},me=function(a,c,d){return-1==a.s?Math.max(me(a.l,c,d+1),me(a.r,c,d+1)):c[a.s]=d},We=function(a){for(var c=a.length;c&&!a[--c];);for(var d=new cc(++c),b=0,h=a[0],p=1,g=function(k){d[b++]=k},e=1;e<=c;++e)if(a[e]==h&&e!=c)++p;else{if(!h&&p>2){for(;p>138;p-=138)g(32754);p>2&&(g(p>10?p-11<<5|28690:p-3<<5|12305),p=0)}else if(p>3){g(h);for(--p;p>6;p-=6)g(8304);p>2&&(g(p-3<<5|8208),p=0)}for(;p--;)g(h);p=1;h=a[e]}return{c:d.subarray(0,
b),n:c}},ud=function(a,c){for(var d=0,b=0;b<c.length;++b)d+=a[b]*c[b];return d},Xe=function(a,c,d){var b=d.length;c=Jd(c+2);a[c]=255&b;a[c+1]=b>>8;a[c+2]=255^a[c];a[c+3]=255^a[c+1];for(var h=0;h<b;++h)a[c+h+4]=d[h];return(c+4+b)*8},Ye=function(a,c,d,b,h,p,g,e,k,l,f){Ac(c,f++,d);++h[256];d=ne(h,15);var m=d.t,n=d.l;d=ne(p,15);var q=d.t;var t=d.l;d=We(m);var u=d.c,v=d.n;d=We(q);for(var A=d.c,C=d.n,x=new cc(19),F=0;F<u.length;++F)++x[31&u[F]];for(F=0;F<A.length;++F)++x[31&A[F]];F=ne(x,7);d=F.t;F=F.l;
for(var w=19;w>4&&!d[Hd[w-1]];--w);var G=l+5<<3,H=ud(h,Gc)+ud(p,sd)+g;h=ud(h,m)+ud(p,q)+g+14+3*w+ud(x,d)+2*x[16]+3*x[17]+7*x[18];if(k>=0&&G<=H&&G<=h)return Xe(c,f,a.subarray(k,k+l));if(Ac(c,f,1+(h<H)),f+=2,h<H){a=rc(m,n,0);k=m;l=rc(q,t,0);m=rc(d,F,0);Ac(c,f,v-257);Ac(c,f+5,C-1);Ac(c,f+10,w-4);f+=14;for(F=0;F<w;++F)Ac(c,f+3*F,d[Hd[F]]);f+=3*w;v=[u,A];for(A=0;A<2;++A)for(C=v[A],F=0;F<C.length;++F)u=31&C[F],Ac(c,f,m[u]),f+=d[u],u>15&&(Ac(c,f,C[F]>>5&127),f+=C[F]>>12)}else a=Yf,k=Gc,l=$f,q=sd;for(F=0;F<
e;++F)d=b[F],d>255?(u=d>>18&31,td(c,f,a[u+257]),f+=k[u+257],u>7&&(Ac(c,f,d>>23&31),f+=qd[u]),u=31&d,td(c,f,l[u]),f+=q[u],u>3&&(td(c,f,d>>5&8191),f+=rd[u])):(td(c,f,a[d]),f+=k[d]);return td(c,f,a[256]),f+k[256]},cg=new Gd([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ve=new Fb(0),dg=function(a,c,d,b,h,p){var g=p.z||a.length,e=new Fb(b+g+5*(1+Math.ceil(g/7E3))+h),k=e.subarray(b,e.length-h),l=p.l,f=7&(p.r||0);if(c){f&&(k[0]=p.r>>3);var m=cg[c-1];c=m>>13;m&=8191;var n=(1<<d)-1,
q=p.p||new cc(32768),t=p.h||new cc(n+1),u=Math.ceil(d/3),v=2*u,A=function(ca){return(a[ca]^a[ca+1]<<u^a[ca+2]<<v)&n},C=new Gd(25E3),x=new cc(288),F=new cc(32),w=0,G=0;d=p.i||0;for(var H=0,P=p.w||0,B=0;d+2<g;++d){var O=A(d),T=32767&d,L=t[O];if(q[T]=L,t[O]=T,P<=d){var ja=g-d;if((w>7E3||H>24576)&&(ja>423||!l)){f=Ye(a,k,0,C,x,F,G,H,B,d-B,f);H=w=G=0;B=d;for(var V=0;V<286;++V)x[V]=0;for(V=0;V<30;++V)F[V]=0}var ha=2,Z=0,va=m,ia=T-L&32767;if(ja>2&&O==A(d-ia)){O=Math.min(c,ja)-1;var sa=Math.min(32767,d);for(ja=
Math.min(258,ja);ia<=sa&&--va&&T!=L;){if(a[d+ha]==a[d+ha-ia]){for(V=0;V<ja&&a[d+V]==a[d+V-ia];++V);if(V>ha){if(ha=V,Z=ia,V>O)break;T=Math.min(ia,V-2);var M=0;for(V=0;V<T;++V){var z=d-ia+V&32767,K=z-q[z]&32767;K>M&&(M=K,L=z)}}}L=q[T=L];ia+=T-L&32767}}Z?(C[H++]=268435456|je[ha]<<18|Ue[Z],P=31&je[ha],Z=31&Ue[Z],G+=qd[P]+rd[Z],++x[257+P],++F[Z],P=d+ha,++w):(C[H++]=a[d],++x[a[d]])}}for(d=Math.max(d,P);d<g;++d)C[H++]=a[d],++x[a[d]];f=Ye(a,k,l,C,x,F,G,H,B,d-B,f);l||(p.r=7&f|k[f/8|0]<<3,f-=7,p.h=t,p.p=q,
p.i=d,p.w=P)}else{for(d=p.w||0;d<g+l;d+=65535)c=d+65535,c>=g&&(k[f/8|0]=l,c=g),f=Xe(k,f+1,a.subarray(d,c));p.i=g}return dd(e,0,b+Jd(f)+h)};(function(){for(var a=new Int32Array(256),c=0;c<256;++c){for(var d=c,b=9;--b;)d=(1&d&&-306674912)^d>>>1;a[c]=d}return a})();var xe=function(){var a=1,c=0;return{p:function(d){for(var b=a,h=c,p=0|d.length,g=0;g!=p;){for(var e=Math.min(g+2655,p);g<e;++g)h+=b+=d[g];b=(65535&b)+15*(b>>16);h=(65535&h)+15*(h>>16)}a=b;c=h},d:function(){return a%=65521,c%=65521,(255&a)<<
24|(65280&a)<<8|(255&c)<<8|c>>8}}},we=function(a,c,d,b,h){if(!h&&(h={l:1},c.dictionary)){var p=c.dictionary.subarray(-32768),g=new Fb(p.length+a.length);g.set(p);g.set(a,p.length);a=g;h.w=p.length}return dg(a,null==c.level?6:c.level,null==c.mem?h.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(a.length)))):20:12+c.mem,d,b,h)},eg=function(a,c,d){var b=a();a=a.toString();a=a.slice(a.indexOf("[")+1,a.lastIndexOf("]")).replace(/\s+/g,"").split(",");for(var h=0;h<b.length;++h){var p=b[h],g=a[h];if("function"==
typeof p){c+=";"+g+"=";var e=p.toString();if(p.prototype)if(-1!=e.indexOf("[native code]"))p=e.indexOf(" ",8)+1,c+=e.slice(p,e.indexOf("(",p));else for(var k in c+=e,p.prototype)c+=";"+g+".prototype."+k+"="+p.prototype[k].toString();else c+=e}else d[g]=p}return c},oe=[],nh=function(a,c,d,b){if(!oe[d]){for(var h="",p={},g=a.length-1,e=0;e<g;++e)h=eg(a[e],h,p);oe[d]={c:eg(a[g],h,p),e:p}}h={};p=oe[d].e;a={};for(var k in h)a[k]=h[k];for(k in p)a[k]=p[k];c=oe[d].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+
c.toString()+"}";k=[];for(var l in a)a[l].buffer&&k.push((a[l]=new a[l].constructor(a[l])).buffer);return mh(c,d,a,k,b)},Eg=function(){return[Fb,cc,Gd,qd,rd,Hd,Te,Xf,Zf,ag,Id,bg,rc,ke,sc,le,Jd,dd,$b,Nd,Bg,Pd,rf]},Ng=function(){return[Fb,cc,Gd,qd,rd,Hd,je,Ue,Yf,Gc,$f,sd,Id,cg,Ve,rc,Ac,td,ne,me,We,ud,Xe,Ye,Jd,dd,dg,we,Ag,Pd]},Og=function(){return[lf,ye,xe]},Fg=function(){return[nf]},Pd=function(a){return postMessage(a,[a.buffer])},rf=function(a){return a&&{out:a.size&&new Fb(a.size),dictionary:a.dictionary}},
qf=function(a,c,d,b,h,p){var g=nh(d,b,h,function(e,k){g.terminate();p(e,k)});return g.postMessage([a,c],c.consume?[a.buffer]:[]),function(){g.terminate()}},ye=function(a,c,d){for(;d;++c)a[c]=d,d>>>=8},lf=function(a,c){var d=c.level;if(a[0]=120,a[1]=(0==d?0:d<6?1:9==d?3:2)<<6|(c.dictionary&&32),a[1]|=31-(a[0]<<8|a[1])%31,c.dictionary)d=xe(),d.p(c.dictionary),ye(a,2,d.d())},nf=function(a,c){return((15&a[0])!=8||a[0]>>4>7||(a[0]<<8|a[1])%31)&&$b(6,"invalid zlib data"),(a[1]>>5&1)==+!c&&$b(6,"invalid zlib data: "+
(32&a[1]?"need":"unexpected")+" dictionary"),(a[1]>>3&4)+2};(function(){function a(c,d){"function"==typeof c&&(d=c,c={});this.ondata=d;c=c&&c.dictionary&&c.dictionary.subarray(-32768);this.s={i:0,b:c?c.length:0};this.o=new Fb(32768);this.p=new Fb(0);c&&this.o.set(c)}return a.prototype.e=function(c){if(this.ondata||$b(5),this.d&&$b(4),this.p.length){if(c.length){var d=new Fb(this.p.length+c.length);d.set(this.p);d.set(c,this.p.length);this.p=d}}else this.p=c},a.prototype.c=function(c){this.s.i=+(this.d=
c||!1);c=this.s.b;var d=Nd(this.p,this.s,this.o);this.ondata(dd(d,c,this.s.b),this.d);this.o=dd(d,this.s.b-32768);this.s.b=this.o.length;this.p=dd(this.p,this.s.p/8|0);this.s.p&=7},a.prototype.push=function(c,d){this.e(c);this.c(d)},a})();var oh="u">typeof TextDecoder&&new TextDecoder;try{oh.decode(Ve,{stream:!0})}catch(a){}"function"==typeof queueMicrotask&&queueMicrotask;ze.FIXED_HEADER_LENGTH=16;Od.HEADER_LENGTH=8;class fg{readFixedHeader(a){this.payloadOffset=a.readU32BE();this.blendMode=a.readU32BE();
this.alpha=a.readU32BE();let c=a.readU32BE();this.visible=(1&c)!=0;this.clip=(2&c)!=0;this.hasMask=(4&c)!=0;this.maskLinked=(8&c)!=0;this.maskVisible=(16&c)!=0;this.expanded=(32&c)!=0;this.lockAlpha=(64&c)!=0;this.blendMode===Q.LM_MULTIPLY&&(128&c)!=0&&(this.blendMode=Q.LM_MULTIPLY2);this.nameLength=a.readU32BE()}getFixedHeaderLen(){return 20}getVariableHeaderLen(){return this.nameLength}readVariableSizeHeader(a){a=a.readString(this.nameLength);let c=new Uint8Array(a.length);for(let d=0;d<a.length;d++)c[d]=
255&a.charCodeAt(d);try{this.name=(new TextDecoder("utf-8")).decode(c)}catch(d){this.name=a}}decode(a){for(var c;;){if(this.skipBytes>0){if(this.skipBytes>=a.length)return this.skipBytes-=a.length,null;a=a.subarray(this.skipBytes);this.skipBytes=0}switch(this.state){case 0:if(a.length<this.getFixedHeaderLen())break;c=new gb(a);this.readFixedHeader(c);a=a.subarray(c.pos);this.state=1;continue;case 1:if(a.length<this.getVariableHeaderLen())break;c=new gb(a);this.readVariableSizeHeader(c);this.layer=
this.createLayer();this.hasMask&&(this.layer.setMask(new Pa(this.width,this.height,8)),this.maskDecoder=new ph(this.layer.mask));this.layer instanceof Fa&&(this.colorDecoder=new qh(this.layer.image));this.skipBytes=this.payloadOffset-this.getFixedHeaderLen();this.colorDecoder?this.state=3:this.maskDecoder?this.state=4:this.state=5;continue;case 3:if(a=this.colorDecoder.decode(a),this.colorDecoder.done){this.maskDecoder?this.state=4:this.state=5;continue}break;case 4:if(a=this.maskDecoder.decode(a),
this.maskDecoder.done){this.state=5;continue}break;case 5:c=this.payloadOffset;this.colorDecoder&&(c+=this.colorDecoder.bytesTotal);this.maskDecoder&&(c+=this.maskDecoder.bytesTotal);this.state=6;this.skipBytes=this.chunkHeader.chunkSize-c;continue;case 6:this.done=!0}break}return a}constructor(a,c,d){this.chunkHeader=a;this.width=c;this.height=d;this.nameLength=this.skipBytes=this.payloadOffset=this.state=0;this.done=!1;this.maskDecoder=this.colorDecoder=null}}class Cg extends fg{createLayer(){let a=
new Fa(this.width,this.height,this.name);return a.setBlendMode(this.blendMode),a.setAlpha(this.alpha),a.setVisible(this.visible),a.setClip(this.clip),a.setMaskLinked(this.maskLinked),a.setMaskVisible(this.maskVisible),a.setLockAlpha(this.lockAlpha),a}}class Dg extends fg{readFixedHeader(a){super.readFixedHeader.call(this,a);this.childLayers=a.readU32BE()}getFixedHeaderLen(){return super.getFixedHeaderLen.call(this)+4}createLayer(){let a=new $a(this.name,this.blendMode);return a.setAlpha(this.alpha),
a.setVisible(this.visible),a.setExpanded(this.expanded),a.setMaskLinked(this.maskLinked),a.setMaskVisible(this.maskVisible),a}constructor(a,c,d){super(a,c,d);this.childLayers=0}}class qh{decode(a){if(null==a)return null;var c=this.bytesRead%I.BYTES_PER_PIXEL,d=this.bytesRead-c;let b=0,h=[I.ALPHA_BYTE_OFFSET,I.RED_BYTE_OFFSET,I.GREEN_BYTE_OFFSET,I.BLUE_BYTE_OFFSET];for(;c<I.BYTES_PER_PIXEL&&b<a.length;c++)this.output[d+h[c]]=a[b],b++;this.bytesRead+=b;var p=0|Math.min(a.length-b,this.bytesTotal-this.bytesRead);
c=p/I.BYTES_PER_PIXEL|0;p%=I.BYTES_PER_PIXEL;for(d=0;d<c;d++)this.output[this.bytesRead+I.ALPHA_BYTE_OFFSET]=a[b],this.output[this.bytesRead+I.RED_BYTE_OFFSET]=a[b+1],this.output[this.bytesRead+I.GREEN_BYTE_OFFSET]=a[b+2],this.output[this.bytesRead+I.BLUE_BYTE_OFFSET]=a[b+3],this.bytesRead+=I.BYTES_PER_PIXEL,b+=I.BYTES_PER_PIXEL;c=0;for(d=this.bytesRead;c<p;c++)this.output[d+h[c]]=a[b],b++;return(this.bytesRead+=p,this.bytesRead>=this.bytesTotal&&(this.done=!0),b<a.length)?a.subarray(b):null}constructor(a){this.bytesRead=
0;this.bytesTotal=a.width*a.height*I.BYTES_PER_PIXEL;this.output=a.data;this.done=!1}}class ph{decode(a){if(null==a)return null;let c=0|Math.min(a.length,this.bytesTotal-this.bytesRead),d=this.bytesRead,b;for(b=0;b<c;b++,d++)this.output[d]=a[b];return(this.bytesRead=d,this.bytesRead>=this.bytesTotal&&(this.done=!0),b<a.length)?a.subarray(b):null}constructor(a){this.bytesRead=0;this.bytesTotal=a.width*a.height;this.output=a.data;this.done=!1}}let Be=()=>new Promise(a=>setTimeout(a,0));hd.prototype.read=
function(a){if(null==a)return null;var c=new gb(new Uint8Array(a)),d=[];if(1!=c.readU16BE())return null;a=c.readU16BE();for(var b=0;b<a;b++)if(0==c.readU16BE()){var h=255*c.readU16BE()/65535,p=255*c.readU16BE()/65535,g=255*c.readU16BE()/65535;c.readU16BE();d.push(h<<16|p<<8|g)}return d};hd.prototype.write=function(a){var c=new gb(new Uint8Array(4+10*a.length));c.writeU16BE(1);c.writeU16BE(a.length);for(var d=0;d<a.length;d++){var b=a[d];c.writeU16BE(0);c.writeU16BE((b>>16&255)*257);c.writeU16BE((b>>
8&255)*257);c.writeU16BE((255&b)*257);c.writeU16BE(0)}return c.getAsDataArray()};Bd.prototype=Object.create(Ja(Ib).prototype);Bd.prototype.constructor=Bd;var Ud={};"use strict";"use strict";var gg=function(){function a(g,e,k){var l=new XMLHttpRequest;l.open("GET",g);l.responseType="blob";l.onload=function(){p(l.response,e,k)};l.onerror=function(){console.error("could not download file")};l.send()}function c(g){var e=new XMLHttpRequest;e.open("HEAD",g,!1);try{e.send()}catch(k){}return 200<=e.status&&
299>=e.status}function d(g){try{g.dispatchEvent(new MouseEvent("click"))}catch(k){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null);g.dispatchEvent(e)}}var b="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof Pc&&Pc.global===Pc?Pc:void 0,h=b.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),p=b.saveAs||
("object"!=typeof window||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!h?function(g,e,k){var l=b.URL||b.webkitURL,f=document.createElement("a");f.download=e=e||g.name||"download";f.rel="noopener";"string"==typeof g?(f.href=g,f.origin===location.origin?d(f):c(f.href)?a(g,e,k):d(f,f.target="_blank")):(f.href=l.createObjectURL(g),setTimeout(function(){l.revokeObjectURL(f.href)},4E4),setTimeout(function(){d(f)},0))}:"msSaveOrOpenBlob"in navigator?function(g,e,k){if(e=e||g.name||
"download","string"!=typeof g){var l;navigator.msSaveOrOpenBlob((void 0===(l=k)?l={autoBom:!1}:"object"!=typeof l&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(g.type)?new Blob(["\ufeff",g],{type:g.type}):g),e)}else if(c(g))a(g,e,k);else{var f=document.createElement("a");f.href=g;f.target="_blank";setTimeout(function(){d(f)})}}:function(g,e,k,l){if((l=l||open("","_blank"))&&
(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof g)return a(g,e,k);e="application/octet-stream"===g.type;k=/constructor/i.test(b.HTMLElement)||b.safari;var f=/CriOS\/[\d]+/.test(navigator.userAgent);if((f||e&&k||h)&&"u">typeof FileReader){var m=new FileReader;m.onloadend=function(){var t=m.result;t=f?t:t.replace(/^data:[^;]*;/,"data:attachment/file;");l?l.location.href=t:location=t;l=null};m.readAsDataURL(g)}else{var n=b.URL||b.webkitURL,q=n.createObjectURL(g);l?l.location=
q:location.href=q;l=null;setTimeout(function(){n.revokeObjectURL(q)},4E4)}});Ud=b.saveAs=p.saveAs=p};"function"==typeof define&&define.amd?define([],gg):gg();var Hf={};var yf=function(a){for(var c,d=a.length,b=d%3,h=[],p=0,g=d-b;p<g;p+=16383){for(var e=h,k=e.push,l,f=a,m=p+16383>g?g:p+16383,n=[],q=p;q<m;q+=3)l=(f[q]<<16&16711680)+(f[q+1]<<8&65280)+(255&f[q+2]),n.push(Bc[l>>18&63]+Bc[l>>12&63]+Bc[l>>6&63]+Bc[63&l]);l=n.join("");k.call(e,l)}return 1===b?h.push(Bc[(c=a[d-1])>>2]+Bc[c<<4&63]+"=="):2===
b&&h.push(Bc[(c=(a[d-2]<<8)+a[d-1])>>10]+Bc[c>>4&63]+Bc[c<<2&63]+"="),h.join("")};for(var Bc=[],pc=[],Ig="u">typeof Uint8Array?Uint8Array:Array,vd=0;vd<64;++vd)Bc[vd]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[vd],pc["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(vd)]=vd;pc[45]=62;pc[95]=63;var pe=function(a,c,d,b,h){var p=8*h-b-1;var g=(1<<p)-1,e=g>>1,k=-7;h=d?h-1:0;var l=d?-1:1,f=a[c+h];h+=l;d=f&(1<<-k)-1;f>>=-k;for(k+=p;k>0;d=256*d+a[c+h],
h+=l,k-=8);p=d&(1<<-k)-1;d>>=-k;for(k+=b;k>0;p=256*p+a[c+h],h+=l,k-=8);if(0===d)d=1-e;else{if(d===g)return p?NaN:1/0*(f?-1:1);p+=Math.pow(2,b);d-=e}return(f?-1:1)*p*Math.pow(2,d-b)};var Cf=function(a,c,d,b,h,p){var g,e,k,l=8*p-h-1,f=(1<<l)-1,m=f>>1,n=5.960464477539062E-8*(23===h);p=b?0:p-1;b=b?1:-1;var q=+(c<0||0===c&&1/c<0);for(isNaN(c=Math.abs(c))||c===1/0?(e=+!!isNaN(c),g=f):(g=Math.floor(Math.log(c)/Math.LN2),c*(k=Math.pow(2,-g))<1&&(g--,k*=2),g+m>=1?c+=n/k:c+=n*Math.pow(2,1-m),c*k>=2&&(g++,k/=
2),g+m>=f?(e=0,g=f):g+m>=1?(e=(c*k-1)*Math.pow(2,h),g+=m):(e=c*Math.pow(2,m-1)*Math.pow(2,h),g=0));h>=8;a[d+p]=255&e,p+=b,e/=256,h-=8);g=g<<h|e;for(l+=h;l>0;a[d+p]=255&g,p+=b,g/=256,l-=8);a[d+p-b]|=128*q};var hg="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;oa.TYPED_ARRAY_SUPPORT=function(){try{var a=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(a,c),42===a.foo()}catch(d){return!1}}();
!oa.TYPED_ARRAY_SUPPORT&&"u">typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");Object.defineProperty(oa.prototype,"parent",{enumerable:!0,get:function(){if(oa.isBuffer(this))return this.buffer}});Object.defineProperty(oa.prototype,"offset",{enumerable:!0,get:function(){if(oa.isBuffer(this))return this.byteOffset}});oa.poolSize=8192;oa.from=
function(a,c,d){return sf(a,c,d)};Object.setPrototypeOf(oa.prototype,Uint8Array.prototype);Object.setPrototypeOf(oa,Uint8Array);oa.alloc=function(a,c,d){return(vf(a),a<=0)?Cc(a):void 0!==c?"string"==typeof d?Cc(a).fill(c,d):Cc(a).fill(c):Cc(a)};oa.allocUnsafe=function(a){return Ce(a)};oa.allocUnsafeSlow=function(a){return Ce(a)};oa.isBuffer=function(a){return null!=a&&!0===a._isBuffer&&a!==oa.prototype};oa.compare=function(a,c){if(zc(a,Uint8Array)&&(a=oa.from(a,a.offset,a.byteLength)),zc(c,Uint8Array)&&
(c=oa.from(c,c.offset,c.byteLength)),!oa.isBuffer(a)||!oa.isBuffer(c))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===c)return 0;for(var d=a.length,b=c.length,h=0,p=Math.min(d,b);h<p;++h)if(a[h]!==c[h]){d=a[h];b=c[h];break}return d<b?-1:+(b<d)};oa.isEncoding=function(a){switch(String(a).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};oa.concat=function(a,c){if(!Array.isArray(a))throw TypeError('"list" argument must be an Array of Buffers');if(0===a.length)return oa.alloc(0);if(void 0===c)for(c=d=0;d<a.length;++d)c+=a[d].length;var d;c=oa.allocUnsafe(c);var b=0;for(d=0;d<a.length;++d){var h=a[d];if(zc(h,Uint8Array))b+h.length>c.length?oa.from(h).copy(c,b):Uint8Array.prototype.set.call(c,h,b);else if(oa.isBuffer(h))h.copy(c,b);else throw TypeError('"list" argument must be an Array of Buffers');b+=h.length}return c};
oa.byteLength=tf;oa.prototype._isBuffer=!0;oa.prototype.swap16=function(){var a=this.length;if(a%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<a;c+=2)Xc(this,c,c+1);return this};oa.prototype.swap32=function(){var a=this.length;if(a%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<a;c+=4)Xc(this,c,c+3),Xc(this,c+1,c+2);return this};oa.prototype.swap64=function(){var a=this.length;if(a%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");
for(var c=0;c<a;c+=8)Xc(this,c,c+7),Xc(this,c+1,c+6),Xc(this,c+2,c+5),Xc(this,c+3,c+4);return this};oa.prototype.toString=function(){var a=this.length;return 0===a?"":0==arguments.length?xf(this,0,a):Gg.apply(this,arguments)};oa.prototype.toLocaleString=oa.prototype.toString;oa.prototype.equals=function(a){if(!oa.isBuffer(a))throw TypeError("Argument must be a Buffer");return this===a||0===oa.compare(this,a)};oa.prototype.inspect=function(){var a="";return a=this.toString("hex",0,50).replace(/(.{2})/g,
"$1 ").trim(),this.length>50&&(a+=" ... "),"<Buffer "+a+">"};hg&&(oa.prototype[hg]=oa.prototype.inspect);oa.prototype.compare=function(a,c,d,b,h){if(zc(a,Uint8Array)&&(a=oa.from(a,a.offset,a.byteLength)),!oa.isBuffer(a))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(void 0===c&&(c=0),void 0===d&&(d=a?a.length:0),void 0===b&&(b=0),void 0===h&&(h=this.length),c<0||d>a.length||b<0||h>this.length)throw RangeError("out of range index");if(b>=
h&&c>=d)return 0;if(b>=h)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,b>>>=0,h>>>=0,this===a)return 0;var p=h-b,g=d-c,e=Math.min(p,g);b=this.slice(b,h);a=a.slice(c,d);for(c=0;c<e;++c)if(b[c]!==a[c]){p=b[c];g=a[c];break}return p<g?-1:+(g<p)};oa.prototype.includes=function(a,c,d){return-1!==this.indexOf(a,c,d)};oa.prototype.indexOf=function(a,c,d){return zf(this,a,c,d,!0)};oa.prototype.lastIndexOf=function(a,c,d){return zf(this,a,c,d,!1)};oa.prototype.write=function(a,c,d,b){if(void 0===c)b="utf8",d=
this.length,c=0;else if(void 0===d&&"string"==typeof c)b=c,d=this.length,c=0;else if(isFinite(c))c>>>=0,isFinite(d)?(d>>>=0,void 0===b&&(b="utf8")):(b=d,d=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var h,p,g,e,k,l,f,m,n=this.length-c;if((void 0===d||d>n)&&(d=n),a.length>0&&(d<0||c<0)||c>this.length)throw RangeError("Attempt to write outside buffer bounds");b||="utf8";for(n=!1;;)switch(b){case "hex":return function(q,t,u,v){u=Number(u)||0;var A=
q.length-u;v?(v=Number(v))>A&&(v=A):v=A;A=t.length;v>A/2&&(v=A/2);for(A=0;A<v;++A){var C,x=parseInt(t.substr(2*A,2),16);if((C=x)!=C)break;q[u+A]=x}return A}(this,a,c,d);case "utf8":case "utf-8":return h=c,p=d,Qd(Fe(a,this.length-h),this,h,p);case "ascii":case "latin1":case "binary":return g=c,e=d,Qd(function(q){for(var t=[],u=0;u<q.length;++u)t.push(255&q.charCodeAt(u));return t}(a),this,g,e);case "base64":return k=c,l=d,Qd(wf(a),this,k,l);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return f=
c,m=d,Qd(function(q,t){for(var u,v,A=[],C=0;C<q.length&&!((t-=2)<0);++C)v=(u=q.charCodeAt(C))>>8,A.push(u%256),A.push(v);return A}(a,this.length-f),this,f,m);default:if(n)throw TypeError("Unknown encoding: "+b);b=(""+b).toLowerCase();n=!0}};oa.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};oa.prototype.slice=function(a,c){var d=this.length;a=~~a;c=void 0===c?d:~~c;a<0?(a+=d)<0&&(a=0):a>d&&(a=d);c<0?(c+=d)<0&&(c=0):c>d&&(c=d);c<a&&(c=a);a=this.subarray(a,
c);return Object.setPrototypeOf(a,oa.prototype),a};oa.prototype.readUintLE=oa.prototype.readUIntLE=function(a,c,d){a>>>=0;c>>>=0;d||Rb(a,c,this.length);d=this[a];for(var b=1,h=0;++h<c&&(b*=256);)d+=this[a+h]*b;return d};oa.prototype.readUintBE=oa.prototype.readUIntBE=function(a,c,d){a>>>=0;c>>>=0;d||Rb(a,c,this.length);d=this[a+--c];for(var b=1;c>0&&(b*=256);)d+=this[a+--c]*b;return d};oa.prototype.readUint8=oa.prototype.readUInt8=function(a,c){return a>>>=0,c||Rb(a,1,this.length),this[a]};oa.prototype.readUint16LE=
oa.prototype.readUInt16LE=function(a,c){return a>>>=0,c||Rb(a,2,this.length),this[a]|this[a+1]<<8};oa.prototype.readUint16BE=oa.prototype.readUInt16BE=function(a,c){return a>>>=0,c||Rb(a,2,this.length),this[a]<<8|this[a+1]};oa.prototype.readUint32LE=oa.prototype.readUInt32LE=function(a,c){return a>>>=0,c||Rb(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]};oa.prototype.readUint32BE=oa.prototype.readUInt32BE=function(a,c){return a>>>=0,c||Rb(a,4,this.length),16777216*this[a]+
(this[a+1]<<16|this[a+2]<<8|this[a+3])};oa.prototype.readIntLE=function(a,c,d){a>>>=0;c>>>=0;d||Rb(a,c,this.length);d=this[a];for(var b=1,h=0;++h<c&&(b*=256);)d+=this[a+h]*b;return d>=b*128&&(d-=Math.pow(2,8*c)),d};oa.prototype.readIntBE=function(a,c,d){a>>>=0;c>>>=0;d||Rb(a,c,this.length);d=c;for(var b=1,h=this[a+--d];d>0&&(b*=256);)h+=this[a+--d]*b;return h>=b*128&&(h-=Math.pow(2,8*c)),h};oa.prototype.readInt8=function(a,c){return(a>>>=0,c||Rb(a,1,this.length),128&this[a])?-(255-this[a]+1):this[a]};
oa.prototype.readInt16LE=function(a,c){a>>>=0;c||Rb(a,2,this.length);a=this[a]|this[a+1]<<8;return 32768&a?4294901760|a:a};oa.prototype.readInt16BE=function(a,c){a>>>=0;c||Rb(a,2,this.length);a=this[a+1]|this[a]<<8;return 32768&a?4294901760|a:a};oa.prototype.readInt32LE=function(a,c){return a>>>=0,c||Rb(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24};oa.prototype.readInt32BE=function(a,c){return a>>>=0,c||Rb(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]};oa.prototype.readFloatLE=
function(a,c){return a>>>=0,c||Rb(a,4,this.length),pe(this,a,!0,23,4)};oa.prototype.readFloatBE=function(a,c){return a>>>=0,c||Rb(a,4,this.length),pe(this,a,!1,23,4)};oa.prototype.readDoubleLE=function(a,c){return a>>>=0,c||Rb(a,8,this.length),pe(this,a,!0,52,8)};oa.prototype.readDoubleBE=function(a,c){return a>>>=0,c||Rb(a,8,this.length),pe(this,a,!1,52,8)};oa.prototype.writeUintLE=oa.prototype.writeUIntLE=function(a,c,d,b){(a*=1,c>>>=0,d>>>=0,b)||ic(this,a,c,d,Math.pow(2,8*d)-1,0);b=1;var h=0;for(this[c]=
255&a;++h<d&&(b*=256);)this[c+h]=a/b&255;return c+d};oa.prototype.writeUintBE=oa.prototype.writeUIntBE=function(a,c,d,b){(a*=1,c>>>=0,d>>>=0,b)||ic(this,a,c,d,Math.pow(2,8*d)-1,0);b=d-1;var h=1;for(this[c+b]=255&a;--b>=0&&(h*=256);)this[c+b]=a/h&255;return c+d};oa.prototype.writeUint8=oa.prototype.writeUInt8=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,1,255,0),this[c]=255&a,c+1};oa.prototype.writeUint16LE=oa.prototype.writeUInt16LE=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,2,65535,0),
this[c]=255&a,this[c+1]=a>>>8,c+2};oa.prototype.writeUint16BE=oa.prototype.writeUInt16BE=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,2,65535,0),this[c]=a>>>8,this[c+1]=255&a,c+2};oa.prototype.writeUint32LE=oa.prototype.writeUInt32LE=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,4,4294967295,0),this[c+3]=a>>>24,this[c+2]=a>>>16,this[c+1]=a>>>8,this[c]=255&a,c+4};oa.prototype.writeUint32BE=oa.prototype.writeUInt32BE=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,4,4294967295,0),this[c]=
a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=255&a,c+4};oa.prototype.writeIntLE=function(a,c,d,b){(a*=1,c>>>=0,b)||(b=Math.pow(2,8*d-1),ic(this,a,c,d,b-1,-b));b=0;var h=1,p=0;for(this[c]=255&a;++b<d&&(h*=256);)a<0&&0===p&&0!==this[c+b-1]&&(p=1),this[c+b]=(a/h|0)-p&255;return c+d};oa.prototype.writeIntBE=function(a,c,d,b){(a*=1,c>>>=0,b)||(b=Math.pow(2,8*d-1),ic(this,a,c,d,b-1,-b));b=d-1;var h=1,p=0;for(this[c+b]=255&a;--b>=0&&(h*=256);)a<0&&0===p&&0!==this[c+b+1]&&(p=1),this[c+b]=(a/h|0)-p&255;
return c+d};oa.prototype.writeInt8=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,1,127,-128),a<0&&(a=255+a+1),this[c]=255&a,c+1};oa.prototype.writeInt16LE=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,2,32767,-32768),this[c]=255&a,this[c+1]=a>>>8,c+2};oa.prototype.writeInt16BE=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,2,32767,-32768),this[c]=a>>>8,this[c+1]=255&a,c+2};oa.prototype.writeInt32LE=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,4,2147483647,-2147483648),this[c]=255&
a,this[c+1]=a>>>8,this[c+2]=a>>>16,this[c+3]=a>>>24,c+4};oa.prototype.writeInt32BE=function(a,c,d){return a*=1,c>>>=0,d||ic(this,a,c,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[c]=a>>>24,this[c+1]=a>>>16,this[c+2]=a>>>8,this[c+3]=255&a,c+4};oa.prototype.writeFloatLE=function(a,c,d){return Bf(this,a,c,!0,d)};oa.prototype.writeFloatBE=function(a,c,d){return Bf(this,a,c,!1,d)};oa.prototype.writeDoubleLE=function(a,c,d){return Df(this,a,c,!0,d)};oa.prototype.writeDoubleBE=function(a,c,d){return Df(this,
a,c,!1,d)};oa.prototype.copy=function(a,c,d,b){if(!oa.isBuffer(a))throw TypeError("argument should be a Buffer");if(d||=0,b||0===b||(b=this.length),c>=a.length&&(c=a.length),c||=0,b>0&&b<d&&(b=d),b===d||0===a.length||0===this.length)return 0;if(c<0)throw RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw RangeError("Index out of range");if(b<0)throw RangeError("sourceEnd out of bounds");b>this.length&&(b=this.length);a.length-c<b-d&&(b=a.length-c+d);var h=b-d;return this===a&&"function"==
typeof Uint8Array.prototype.copyWithin?this.copyWithin(c,d,b):Uint8Array.prototype.set.call(a,this.subarray(d,b),c),h};oa.prototype.fill=function(a,c,d,b){if("string"==typeof a){if("string"==typeof c?(b=c,c=0,d=this.length):"string"==typeof d&&(b=d,d=this.length),void 0!==b&&"string"!=typeof b)throw TypeError("encoding must be a string");if("string"==typeof b&&!oa.isEncoding(b))throw TypeError("Unknown encoding: "+b);if(1===a.length){var h=a.charCodeAt(0);("utf8"===b&&h<128||"latin1"===b)&&(a=h)}}else"number"==
typeof a?a&=255:"boolean"==typeof a&&(a=Number(a));if(c<0||this.length<c||this.length<d)throw RangeError("Out of range index");if(d<=c)return this;if(c>>>=0,d=void 0===d?this.length:d>>>0,a||=0,"number"==typeof a)for(b=c;b<d;++b)this[b]=a;else{h=oa.isBuffer(a)?a:oa.from(a,b);var p=h.length;if(0===p)throw TypeError('The value "'+a+'" is invalid for argument "value"');for(b=0;b<d-c;++b)this[b+c]=h[b%p]}return this};var Jg=/[^+/0-9A-Za-z-_]/g,Hg=function(){for(var a=Array(256),c=0;c<16;++c)for(var d=
16*c,b=0;b<16;++b)a[d+b]="0123456789abcdef"[c]+"0123456789abcdef"[b];return a}(),ig={},Jb=ig={};try{var Kc="function"==typeof setTimeout?setTimeout:Ge}catch(a){Kc=Ge}try{var Lc="function"==typeof clearTimeout?clearTimeout:He}catch(a){Lc=He}var Dc=[],id=!1,Rd=-1;Jb.nextTick=function(a){var c=Array(arguments.length-1);if(arguments.length>1)for(var d=1;d<arguments.length;d++)c[d-1]=arguments[d];Dc.push(new Gf(a,c));1!==Dc.length||id||Ef(Ff)};Gf.prototype.run=function(){this.fun.apply(null,this.array)};
Jb.title="browser";Jb.browser=!0;Jb.env={};Jb.argv=[];Jb.version="";Jb.versions={};Jb.on=Ec;Jb.addListener=Ec;Jb.once=Ec;Jb.off=Ec;Jb.removeListener=Ec;Jb.removeAllListeners=Ec;Jb.emit=Ec;Jb.prependListener=Ec;Jb.prependOnceListener=Ec;Jb.listeners=function(a){return[]};Jb.binding=function(a){throw Error("process.binding is not supported");};Jb.cwd=function(){return"/"};Jb.chdir=function(a){throw Error("process.chdir is not supported");};Jb.umask=function(){return 0};Hf=function h(c,d,b){function p(k,
l){if(!d[k]){if(!c[k]){if(g)return g(k,!0);l=Error("Cannot find module '"+k+"'");throw l.code="MODULE_NOT_FOUND",l;}l=d[k]={exports:{}};c[k][0].call(l.exports,function(f){return p(c[k][1][f]||f)},l,l.exports,h,c,d,b)}return d[k].exports}for(var g=void 0,e=0;e<b.length;e++)p(b[e]);return p}({1:[function(c,d,b){var h=c("./utils"),p=c("./support");b.encode=function(g){for(var e,k,l,f,m,n,q=[],t=0,u=g.length,v,A="string"!==h.getTypeOf(g);t<g.length;)v=u-t,l=A?(e=g[t++],k=t<u?g[t++]:0,t<u?g[t++]:0):(e=
g.charCodeAt(t++),k=t<u?g.charCodeAt(t++):0,t<u?g.charCodeAt(t++):0),f=e>>2,m=(3&e)<<4|k>>4,n=1<v?(15&k)<<2|l>>6:64,l=2<v?63&l:64,q.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l));return q.join("")};b.decode=function(g){var e,k,l,f=
0,m=0;if(g.substr(0,5)==="data:")throw Error("Invalid base64 input, it looks like a data url.");var n;var q=3*(g=g.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(g.charAt(g.length-1)==="="&&q--,g.charAt(g.length-2)==="="&&q--,q%1!=0)throw Error("Invalid base64 input, bad content length.");for(n=p.uint8array?new Uint8Array(0|q):Array(0|q);f<g.length;){q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(g.charAt(f++))<<2|(e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(g.charAt(f++)))>>
4;e=(15&e)<<4|(k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(g.charAt(f++)))>>2;var t=(3&k)<<6|(l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(g.charAt(f++)));n[m++]=q;64!==k&&(n[m++]=e);64!==l&&(n[m++]=t)}return n}},{"./support":30,"./utils":32}],2:[function(c,d,b){function h(l,f,m,n,q){this.compressedSize=l;this.uncompressedSize=f;this.crc32=m;this.compression=n;this.compressedContent=q}var p=c("./external"),g=c("./stream/DataWorker"),
e=c("./stream/Crc32Probe"),k=c("./stream/DataLengthProbe");h.prototype={getContentWorker:function(){var l=(new g(p.Promise.resolve(this.compressedContent))).pipe(this.compression.uncompressWorker()).pipe(new k("data_length")),f=this;return l.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw Error("Bug : uncompressed data size mismatch");}),l},getCompressedWorker:function(){return(new g(p.Promise.resolve(this.compressedContent))).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",
this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};h.createWorkerFrom=function(l,f,m){return l.pipe(new e).pipe(new k("uncompressedSize")).pipe(f.compressWorker(m)).pipe(new k("compressedSize")).withStreamInfo("compression",f)};d.exports=h},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(c,d,b){var h=c("./stream/GenericWorker");b.STORE={magic:"\x00\x00",compressWorker:function(){return new h("STORE compression")},
uncompressWorker:function(){return new h("STORE decompression")}};b.DEFLATE=c("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(c,d,b){var h=c("./utils"),p=function(){for(var g,e=[],k=0;k<256;k++){g=k;for(var l=0;l<8;l++)g=1&g?3988292384^g>>>1:g>>>1;e[k]=g}return e}();d.exports=function(g,e){return void 0!==g&&g.length?"string"!==h.getTypeOf(g)?function(k,l,f){f=0+f;k^=-1;for(var m=0;m<f;m++)k=k>>>8^p[255&(k^l[m])];return-1^k}(0|e,g,g.length):function(k,l,f){f=0+f;k^=-1;for(var m=
0;m<f;m++)k=k>>>8^p[255&(k^l.charCodeAt(m))];return-1^k}(0|e,g,g.length):0}},{"./utils":32}],5:[function(c,d,b){b.base64=!1;b.binary=!1;b.dir=!1;b.createFolders=!0;b.date=null;b.compression=null;b.compressionOptions=null;b.comment=null;b.unixPermissions=null;b.dosPermissions=null},{}],6:[function(c,d,b){d.exports={Promise:"u">typeof Promise?Promise:c("lie")}},{lie:37}],7:[function(c,d,b){function h(l,f){e.call(this,"FlateWorker/"+l);this._pako=null;this._pakoAction=l;this._pakoOptions=f;this.meta=
{}}d="u">typeof Uint8Array&&"u">typeof Uint16Array&&"u">typeof Uint32Array;var p=c("pako"),g=c("./utils"),e=c("./stream/GenericWorker"),k=d?"uint8array":"array";b.magic="\b\x00";g.inherits(h,e);h.prototype.processChunk=function(l){this.meta=l.meta;null===this._pako&&this._createPako();this._pako.push(g.transformTo(k,l.data),!1)};h.prototype.flush=function(){e.prototype.flush.call(this);null===this._pako&&this._createPako();this._pako.push([],!0)};h.prototype.cleanUp=function(){e.prototype.cleanUp.call(this);
this._pako=null};h.prototype._createPako=function(){this._pako=new p[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var l=this;this._pako.onData=function(f){l.push({data:f,meta:l.meta})}};b.compressWorker=function(l){return new h("Deflate",l)};b.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(c,d,b){function h(n,q){var t,u="";for(t=0;t<q;t++)u+=String.fromCharCode(255&n),n>>>=8;return u}function p(n,q,t,u,v,A){var C,
x,F=n.file,w=n.compression,G=A!==l.utf8encode,H=e.transformTo("string",A(F.name)),P=e.transformTo("string",l.utf8encode(F.name)),B=F.comment;A=e.transformTo("string",A(B));var O=e.transformTo("string",l.utf8encode(B)),T=P.length!==F.name.length,L=O.length!==B.length,ja=B="",V="",ha=F.dir,Z=F.date,va=0,ia=0,sa=0;q&&!t||(va=n.crc32,ia=n.compressedSize,sa=n.uncompressedSize);n=0;q&&(n|=8);!G&&(T||L)&&(n|=2048);G=q=0;ha&&(q|=16);"UNIX"===v?(G=798,q|=(C=F.unixPermissions,x=C,C||(x=ha?16893:33204),(65535&
x)<<16)):(G=20,q|=63&(F.dosPermissions||0));v=(Z.getUTCHours()<<6|Z.getUTCMinutes())<<5|Z.getUTCSeconds()/2;C=(Z.getUTCFullYear()-1980<<4|Z.getUTCMonth()+1)<<5|Z.getUTCDate();T&&(ja=h(1,1)+h(f(H),4)+P,B+="up"+h(ja.length,2)+ja);L&&(V=h(1,1)+h(f(A),4)+O,B+="uc"+h(V.length,2)+V);P="";return P+="\n\x00",P+=h(n,2),P+=w.magic,P+=h(v,2),P+=h(C,2),P+=h(va,4),P+=h(ia,4),P+=h(sa,4),P+=h(H.length,2),P+=h(B.length,2),{fileRecord:m.LOCAL_FILE_HEADER+P+H+B,dirRecord:m.CENTRAL_FILE_HEADER+h(G,2)+P+h(A.length,2)+
"\x00\x00\x00\x00"+h(q,4)+h(u,4)+H+B+A}}function g(n,q,t,u){k.call(this,"ZipFileWorker");this.bytesWritten=0;this.zipComment=q;this.zipPlatform=t;this.encodeFileName=u;this.streamFiles=n;this.accumulate=!1;this.contentBuffer=[];this.dirRecords=[];this.entriesCount=this.currentSourceOffset=0;this.currentFile=null;this._sources=[]}var e=c("../utils"),k=c("../stream/GenericWorker"),l=c("../utf8"),f=c("../crc32"),m=c("../signature");e.inherits(g,k);g.prototype.push=function(n){var q=n.meta.percent||0,
t=this.entriesCount,u=this._sources.length;this.accumulate?this.contentBuffer.push(n):(this.bytesWritten+=n.data.length,k.prototype.push.call(this,{data:n.data,meta:{currentFile:this.currentFile,percent:t?(q+100*(t-u-1))/t:100}}))};g.prototype.openedSource=function(n){this.currentSourceOffset=this.bytesWritten;this.currentFile=n.file.name;var q=this.streamFiles&&!n.file.dir;q?(n=p(n,q,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName),this.push({data:n.fileRecord,meta:{percent:0}})):
this.accumulate=!0};g.prototype.closedSource=function(n){this.accumulate=!1;var q=this.streamFiles&&!n.file.dir,t=p(n,q,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),q)this.push({data:m.DATA_DESCRIPTOR+h(n.crc32,4)+h(n.compressedSize,4)+h(n.uncompressedSize,4),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null};g.prototype.flush=
function(){for(var n,q,t,u,v=this.bytesWritten,A=0;A<this.dirRecords.length;A++)this.push({data:this.dirRecords[A],meta:{percent:100}});A=this.bytesWritten-v;var C=(n=this.dirRecords.length,q=this.zipComment,t=this.encodeFileName,u=e.transformTo("string",t(q)),m.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+h(n,2)+h(n,2)+h(A,4)+h(v,4)+h(u.length,2)+u);this.push({data:C,meta:{percent:100}})};g.prototype.prepareNextSource=function(){this.previous=this._sources.shift();this.openedSource(this.previous.streamInfo);
this.isPaused?this.previous.pause():this.previous.resume()};g.prototype.registerPrevious=function(n){this._sources.push(n);var q=this;return n.on("data",function(t){q.processChunk(t)}),n.on("end",function(){q.closedSource(q.previous.streamInfo);q._sources.length?q.prepareNextSource():q.end()}),n.on("error",function(t){q.error(t)}),this};g.prototype.resume=function(){return!!k.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||
this.generatedError?void 0:(this.end(),!0))};g.prototype.error=function(n){var q=this._sources;if(!k.prototype.error.call(this,n))return!1;for(var t=0;t<q.length;t++)try{q[t].error(n)}catch(u){}return!0};g.prototype.lock=function(){k.prototype.lock.call(this);for(var n=this._sources,q=0;q<n.length;q++)n[q].lock()};d.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(c,d,b){var h=c("../compressions"),p=c("./ZipFileWorker");b.generateWorker=
function(g,e,k){var l=new p(e.streamFiles,k,e.platform,e.encodeFileName),f=0;try{g.forEach(function(m,n){f++;var q=n.options.compression||e.compression,t=h[q];if(!t)throw Error(q+" is not a valid compression method !");q=n.dir;var u=n.date;n._compressWorker(t,n.options.compressionOptions||e.compressionOptions||{}).withStreamInfo("file",{name:m,dir:q,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(l)}),l.entriesCount=f}catch(m){l.error(m)}return l}},
{"../compressions":3,"./ZipFileWorker":8}],10:[function(c,d,b){function h(){if(!(this instanceof h))return new h;if(arguments.length)throw Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null);this.comment=null;this.root="";this.clone=function(){var p=new h,g;for(g in this)"function"!=typeof this[g]&&(p[g]=this[g]);return p}}(h.prototype=c("./object")).loadAsync=c("./load");h.support=c("./support");h.defaults=c("./defaults");
h.version="3.10.1";h.loadAsync=function(p,g){return(new h).loadAsync(p,g)};h.external=c("./external");d.exports=h},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(c,d,b){var h=c("./utils"),p=c("./external"),g=c("./utf8"),e=c("./zipEntries"),k=c("./stream/Crc32Probe"),l=c("./nodejsUtils");d.exports=function(f,m){var n=this;return m=h.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:g.utf8decode}),l.isNode&&l.isStream(f)?
p.Promise.reject(Error("JSZip can't accept a stream when loading a zip file.")):h.prepareContent("the loaded zip file",f,!0,m.optimizedBinaryString,m.base64).then(function(q){var t=new e(m);return t.load(q),t}).then(function(q){var t=[p.Promise.resolve(q)];q=q.files;if(m.checkCRC32)for(var u=0;u<q.length;u++)t.push(function(v){return new p.Promise(function(A,C){var x=v.decompressed.getContentWorker().pipe(new k);x.on("error",function(F){C(F)}).on("end",function(){x.streamInfo.crc32!==v.decompressed.crc32?
C(Error("Corrupted zip : CRC32 mismatch")):A()}).resume()})}(q[u]));return p.Promise.all(t)}).then(function(q){q=q.shift();for(var t=q.files,u=0;u<t.length;u++){var v=t[u],A=v.fileNameStr,C=h.resolve(v.fileNameStr);n.file(C,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:m.createFolders});v.dir||(n.file(C).unsafeOriginalName=A)}return q.zipComment.length&&
(n.comment=q.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(c,d,b){function h(g,e){p.call(this,"Nodejs stream input adapter for "+g);this._upstreamEnded=!1;this._bindStream(e)}b=c("../utils");var p=c("../stream/GenericWorker");b.inherits(h,p);h.prototype._bindStream=function(g){var e=this;(this._stream=g).pause();g.on("data",function(k){e.push({data:k,meta:{percent:0}})}).on("error",function(k){e.isPaused?this.generatedError=
k:e.error(k)}).on("end",function(){e.isPaused?e._upstreamEnded=!0:e.end()})};h.prototype.pause=function(){return!!p.prototype.pause.call(this)&&(this._stream.pause(),!0)};h.prototype.resume=function(){return!!p.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)};d.exports=h},{"../stream/GenericWorker":28,"../utils":32}],13:[function(c,d,b){function h(g,e,k){p.call(this,e);this._helper=g;var l=this;g.on("data",function(f,m){l.push(f)||l._helper.pause();k&&k(m)}).on("error",
function(f){l.emit("error",f)}).on("end",function(){l.push(null)})}var p=c("readable-stream").Readable;c("../utils").inherits(h,p);h.prototype._read=function(){this._helper.resume()};d.exports=h},{"../utils":32,"readable-stream":16}],14:[function(c,d,b){d.exports={isNode:!0,newBufferFrom:function(h,p){if(oa.from&&oa.from!==Uint8Array.from)return oa.from(h,p);if("number"==typeof h)throw Error('The "data" argument must not be a number');return new oa(h,p)},allocBuffer:function(h){if(oa.alloc)return oa.alloc(h);
h=new oa(h);return h.fill(0),h},isBuffer:function(h){return oa.isBuffer(h)},isStream:function(h){return h&&"function"==typeof h.on&&"function"==typeof h.pause&&"function"==typeof h.resume}}},{}],15:[function(c,d,b){function h(A,C,x){var F=g.getTypeOf(C),w=g.extend(x||{},l);w.date=w.date||new Date;null!==w.compression&&(w.compression=w.compression.toUpperCase());"string"==typeof w.unixPermissions&&(w.unixPermissions=parseInt(w.unixPermissions,8));w.unixPermissions&&16384&w.unixPermissions&&(w.dir=
!0);w.dosPermissions&&16&w.dosPermissions&&(w.dir=!0);w.dir&&(A=u(A));var G;if(G=w.createFolders){var H=A;"/"===H.slice(-1)&&(H=H.substring(0,H.length-1));G=H.lastIndexOf("/");G=H=0<G?H.substring(0,G):""}G&&v.call(this,H,!0);F="string"===F&&!1===w.binary&&!1===w.base64;x&&void 0!==x.binary||(w.binary=!F);(C instanceof f&&0===C.uncompressedSize||w.dir||!C||0===C.length)&&(w.base64=!1,w.binary=!0,C="",w.compression="STORE");C=C instanceof f||C instanceof e?C:q.isNode&&q.isStream(C)?new t(A,C):g.prepareContent(A,
C,w.binary,w.optimizedBinaryString,w.base64);w=new m(A,C,w);this.files[A]=w}var p=c("./utf8"),g=c("./utils"),e=c("./stream/GenericWorker"),k=c("./stream/StreamHelper"),l=c("./defaults"),f=c("./compressedObject"),m=c("./zipObject"),n=c("./generate"),q=c("./nodejsUtils"),t=c("./nodejs/NodejsStreamInputAdapter"),u=function(A){return"/"!==A.slice(-1)&&(A+="/"),A},v=function(A,C){return C=void 0!==C?C:l.createFolders,A=u(A),this.files[A]||h.call(this,A,null,{dir:!0,createFolders:C}),this.files[A]};d.exports=
{load:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");},forEach:function(A){var C,x;for(C in this.files){var F=this.files[C];(x=C.slice(this.root.length,C.length))&&C.slice(0,this.root.length)===this.root&&A(x,F)}},filter:function(A){var C=[];return this.forEach(function(x,F){A(x,F)&&C.push(F)}),C},file:function(A,C,x){if(1!=arguments.length)return A=this.root+A,h.call(this,A,C,x),this;if("[object RegExp]"===Object.prototype.toString.call(A)){var F=
A;return this.filter(function(G,H){return!H.dir&&F.test(G)})}var w=this.files[this.root+A];return w&&!w.dir?w:null},folder:function(A){if(!A)return this;if("[object RegExp]"===Object.prototype.toString.call(A))return this.filter(function(F,w){return w.dir&&A.test(F)});var C=v.call(this,this.root+A),x=this.clone();return x.root=C.name,x},remove:function(A){A=this.root+A;var C=this.files[A];if(C||("/"!==A.slice(-1)&&(A+="/"),C=this.files[A]),C&&!C.dir)delete this.files[A];else{C=this.filter(function(F,
w){return w.name.slice(0,A.length)===A});for(var x=0;x<C.length;x++)delete this.files[C[x].name]}return this},generate:function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");},generateInternalStream:function(A){var C={};try{if((C=g.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:p.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),
"binarystring"===C.type&&(C.type="string"),!C.type)throw Error("No output type specified.");g.checkSupport(C.type);"darwin"!==C.platform&&"freebsd"!==C.platform&&"linux"!==C.platform&&"sunos"!==C.platform||(C.platform="UNIX");"win32"===C.platform&&(C.platform="DOS");var x=n.generateWorker(this,C,C.comment||this.comment||"")}catch(F){(x=new e("error")).error(F)}return new k(x,C.type||"string",C.mimeType)},generateAsync:function(A,C){return this.generateInternalStream(A).accumulate(C)},generateNodeStream:function(A,
C){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(C)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(c,d,b){d.exports=c("stream")},{stream:void 0}],17:[function(c,d,b){function h(g){p.call(this,g);for(var e=0;e<this.data.length;e++)g[e]&=255}var p=c("./DataReader");c("../utils").inherits(h,
p);h.prototype.byteAt=function(g){return this.data[this.zero+g]};h.prototype.lastIndexOfSignature=function(g){var e=g.charCodeAt(0),k=g.charCodeAt(1),l=g.charCodeAt(2);g=g.charCodeAt(3);for(var f=this.length-4;0<=f;--f)if(this.data[f]===e&&this.data[f+1]===k&&this.data[f+2]===l&&this.data[f+3]===g)return f-this.zero;return-1};h.prototype.readAndCheckSignature=function(g){var e=g.charCodeAt(0),k=g.charCodeAt(1),l=g.charCodeAt(2);g=g.charCodeAt(3);var f=this.readData(4);return e===f[0]&&k===f[1]&&l===
f[2]&&g===f[3]};h.prototype.readData=function(g){if(this.checkOffset(g),0===g)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,e};d.exports=h},{"../utils":32,"./DataReader":18}],18:[function(c,d,b){function h(g){this.data=g;this.length=g.length;this.zero=this.index=0}var p=c("../utils");h.prototype={checkOffset:function(g){this.checkIndex(this.index+g)},checkIndex:function(g){if(this.length<this.zero+g||g<0)throw Error("End of data reached (data length = "+
this.length+", asked index = "+g+"). Corrupted zip ?");},setIndex:function(g){this.checkIndex(g);this.index=g},skip:function(g){this.setIndex(this.index+g)},byteAt:function(){},readInt:function(g){var e,k=0;this.checkOffset(g);for(e=this.index+g-1;e>=this.index;e--)k=(k<<8)+this.byteAt(e);return this.index+=g,k},readString:function(g){return p.transformTo("string",this.readData(g))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var g=
this.readInt(4);return new Date(Date.UTC(1980+(g>>25&127),(g>>21&15)-1,g>>16&31,g>>11&31,g>>5&63,(31&g)<<1))}};d.exports=h},{"../utils":32}],19:[function(c,d,b){function h(g){p.call(this,g)}var p=c("./Uint8ArrayReader");c("../utils").inherits(h,p);h.prototype.readData=function(g){this.checkOffset(g);var e=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,e};d.exports=h},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(c,d,b){function h(g){p.call(this,g)}var p=
c("./DataReader");c("../utils").inherits(h,p);h.prototype.byteAt=function(g){return this.data.charCodeAt(this.zero+g)};h.prototype.lastIndexOfSignature=function(g){return this.data.lastIndexOf(g)-this.zero};h.prototype.readAndCheckSignature=function(g){return g===this.readData(4)};h.prototype.readData=function(g){this.checkOffset(g);var e=this.data.slice(this.zero+this.index,this.zero+this.index+g);return this.index+=g,e};d.exports=h},{"../utils":32,"./DataReader":18}],21:[function(c,d,b){function h(g){p.call(this,
g)}var p=c("./ArrayReader");c("../utils").inherits(h,p);h.prototype.readData=function(g){if(this.checkOffset(g),0===g)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+g);return this.index+=g,e};d.exports=h},{"../utils":32,"./ArrayReader":17}],22:[function(c,d,b){var h=c("../utils"),p=c("../support"),g=c("./ArrayReader"),e=c("./StringReader"),k=c("./NodeBufferReader"),l=c("./Uint8ArrayReader");d.exports=function(f){var m=h.getTypeOf(f);return h.checkSupport(m),
"string"!==m||p.uint8array?"nodebuffer"===m?new k(f):p.uint8array?new l(h.transformTo("uint8array",f)):new g(h.transformTo("array",f)):new e(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(c,d,b){b.LOCAL_FILE_HEADER="PK\u0003\u0004";b.CENTRAL_FILE_HEADER="PK\u0001\u0002";b.CENTRAL_DIRECTORY_END="PK\u0005\u0006";b.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\u0006\u0007";b.ZIP64_CENTRAL_DIRECTORY_END="PK\u0006\u0006";
b.DATA_DESCRIPTOR="PK\u0007\b"},{}],24:[function(c,d,b){function h(e){p.call(this,"ConvertWorker to "+e);this.destType=e}var p=c("./GenericWorker"),g=c("../utils");g.inherits(h,p);h.prototype.processChunk=function(e){this.push({data:g.transformTo(this.destType,e.data),meta:e.meta})};d.exports=h},{"../utils":32,"./GenericWorker":28}],25:[function(c,d,b){function h(){p.call(this,"Crc32Probe");this.withStreamInfo("crc32",0)}var p=c("./GenericWorker"),g=c("../crc32");c("../utils").inherits(h,p);h.prototype.processChunk=
function(e){this.streamInfo.crc32=g(e.data,this.streamInfo.crc32||0);this.push(e)};d.exports=h},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(c,d,b){function h(g){p.call(this,"DataLengthProbe for "+g);this.propName=g;this.withStreamInfo(g,0)}b=c("../utils");var p=c("./GenericWorker");b.inherits(h,p);h.prototype.processChunk=function(g){g&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+g.data.length);p.prototype.processChunk.call(this,g)};d.exports=h},{"../utils":32,
"./GenericWorker":28}],27:[function(c,d,b){function h(e){g.call(this,"DataWorker");var k=this;this.dataIsReady=!1;this.max=this.index=0;this.data=null;this.type="";this._tickScheduled=!1;e.then(function(l){k.dataIsReady=!0;k.data=l;k.max=l&&l.length||0;k.type=p.getTypeOf(l);k.isPaused||k._tickAndRepeat()},function(l){k.error(l)})}var p=c("../utils"),g=c("./GenericWorker");p.inherits(h,g);h.prototype.cleanUp=function(){g.prototype.cleanUp.call(this);this.data=null};h.prototype.resume=function(){return!!g.prototype.resume.call(this)&&
(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,p.delay(this._tickAndRepeat,[],this)),!0)};h.prototype._tickAndRepeat=function(){this._tickScheduled=!1;this.isPaused||this.isFinished||(this._tick(),this.isFinished||(p.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))};h.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,k=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case "string":e=this.data.substring(this.index,
k);break;case "uint8array":e=this.data.subarray(this.index,k);break;case "array":case "nodebuffer":e=this.data.slice(this.index,k)}return this.index=k,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})};d.exports=h},{"../utils":32,"./GenericWorker":28}],28:[function(c,d,b){function h(p){this.name=p||"default";this.streamInfo={};this.generatedError=null;this.extraStreamInfo={};this.isPaused=!0;this.isLocked=this.isFinished=!1;this._listeners={data:[],end:[],error:[]};this.previous=
null}h.prototype={push:function(p){this.emit("data",p)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(p){this.emit("error",p)}return!0},error:function(p){return!this.isFinished&&(this.isPaused?this.generatedError=p:(this.isFinished=!0,this.emit("error",p),this.previous&&this.previous.error(p),this.cleanUp()),!0)},on:function(p,g){return this._listeners[p].push(g),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=
null;this._listeners=[]},emit:function(p,g){if(this._listeners[p])for(var e=0;e<this._listeners[p].length;e++)this._listeners[p][e].call(this,g)},pipe:function(p){return p.registerPrevious(this)},registerPrevious:function(p){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.streamInfo=p.streamInfo;this.mergeStreamInfo();this.previous=p;var g=this;return p.on("data",function(e){g.processChunk(e)}),p.on("end",function(){g.end()}),p.on("error",function(e){g.error(e)}),
this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var p=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),p=!0),this.previous&&this.previous.resume(),!p},flush:function(){},processChunk:function(p){this.push(p)},withStreamInfo:function(p,g){return this.extraStreamInfo[p]=g,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var p in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,
p)&&(this.streamInfo[p]=this.extraStreamInfo[p])},lock:function(){if(this.isLocked)throw Error("The stream '"+this+"' has already been used.");this.isLocked=!0;this.previous&&this.previous.lock()},toString:function(){var p="Worker "+this.name;return this.previous?this.previous+" -> "+p:p}};d.exports=h},{}],29:[function(c,d,b){function h(m,n,q){var t=n;switch(n){case "blob":case "arraybuffer":t="uint8array";break;case "base64":t="string"}try{this._internalType=t,this._outputType=n,this._mimeType=q,
p.checkSupport(t),this._worker=m.pipe(new g(t)),m.lock()}catch(u){this._worker=new e("error"),this._worker.error(u)}}var p=c("../utils"),g=c("./ConvertWorker"),e=c("./GenericWorker"),k=c("../base64");b=c("../support");var l=c("../external"),f=null;if(b.nodestream)try{f=c("../nodejs/NodejsStreamOutputAdapter")}catch(m){}h.prototype={accumulate:function(m){var n;return n=this,new l.Promise(function(q,t){var u=[],v=n._internalType,A=n._outputType,C=n._mimeType;n.on("data",function(x,F){u.push(x);m&&
m(F)}).on("error",function(x){u=[];t(x)}).on("end",function(){try{var x=function(F,w,G){switch(F){case "blob":return p.newBlob(p.transformTo("arraybuffer",w),G);case "base64":return k.encode(w);default:return p.transformTo(F,w)}}(A,function(F,w){var G,H=0,P=0;for(G=0;G<w.length;G++)P+=w[G].length;switch(F){case "string":return w.join("");case "array":return Array.prototype.concat.apply([],w);case "uint8array":F=new Uint8Array(P);for(G=0;G<w.length;G++)F.set(w[G],H),H+=w[G].length;return F;case "nodebuffer":return oa.concat(w);
default:throw Error("concat : unsupported type '"+F+"'");}}(v,u),C);q(x)}catch(F){t(F)}u=[]}).resume()})},on:function(m,n){var q=this;return"data"===m?this._worker.on(m,function(t){n.call(q,t.data,t.meta)}):this._worker.on(m,function(){p.delay(n,arguments,q)}),this},resume:function(){return p.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(p.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw Error(this._outputType+
" is not supported by this method");return new f(this,{objectMode:"nodebuffer"!==this._outputType},m)}};d.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(c,d,b){if(b.base64=!0,b.array=!0,b.string=!0,b.arraybuffer="u">typeof ArrayBuffer&&"u">typeof Uint8Array,b.nodebuffer=!0,b.uint8array="u">typeof Uint8Array,"u"<typeof ArrayBuffer)b.blob=!1;else{d=new ArrayBuffer(0);try{b.blob=
0===(new Blob([d],{type:"application/zip"})).size}catch(p){try{var h=new (self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);h.append(d);b.blob=0===h.getBlob("application/zip").size}catch(g){b.blob=!1}}}try{b.nodestream=!!c("readable-stream").Readable}catch(p){b.nodestream=!1}},{"readable-stream":16}],31:[function(c,d,b){function h(){l.call(this,"utf-8 decode");this.leftOver=null}function p(){l.call(this,"utf-8 encode")}var g=c("./utils"),e=c("./support"),k=c("./nodejsUtils"),
l=c("./stream/GenericWorker"),f=Array(256);for(c=0;c<256;c++)f[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;f[254]=f[254]=1;b.utf8encode=function(m){if(e.nodebuffer)m=k.newBufferFrom(m,"utf-8");else{var n,q,t,u,v=m.length,A=0;for(t=0;t<v;t++)55296==(64512&(n=m.charCodeAt(t)))&&t+1<v&&56320==(64512&(q=m.charCodeAt(t+1)))&&(n=65536+(n-55296<<10)+(q-56320),t++),A+=n<128?1:n<2048?2:n<65536?3:4;var C=e.uint8array?new Uint8Array(A):Array(A);for(t=u=0;u<A;t++)55296==(64512&(n=m.charCodeAt(t)))&&t+1<
v&&56320==(64512&(q=m.charCodeAt(t+1)))&&(n=65536+(n-55296<<10)+(q-56320),t++),n<128?C[u++]=n:(n<2048?C[u++]=192|n>>>6:(n<65536?C[u++]=224|n>>>12:(C[u++]=240|n>>>18,C[u++]=128|n>>>12&63),C[u++]=128|n>>>6&63),C[u++]=128|63&n);m=C}return m};b.utf8decode=function(m){if(e.nodebuffer)var n=g.transformTo("nodebuffer",m).toString("utf-8");else{n=g.transformTo(e.uint8array?"uint8array":"array",m);var q,t,u,v=n.length,A=Array(2*v);for(q=m=0;q<v;)if((t=n[q++])<128)A[m++]=t;else if(4<(u=f[t]))A[m++]=65533,q+=
u-1;else{for(t&=2===u?31:3===u?15:7;1<u&&q<v;)t=t<<6|63&n[q++],u--;1<u?A[m++]=65533:t<65536?A[m++]=t:(t-=65536,A[m++]=55296|t>>10&1023,A[m++]=56320|1023&t)}n=(A.length!==m&&(A.subarray?A=A.subarray(0,m):A.length=m),g.applyFromCharCode(A))}return n};g.inherits(h,l);h.prototype.processChunk=function(m){var n=g.transformTo(e.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(e.uint8array){var q=n;(n=new Uint8Array(q.length+this.leftOver.length)).set(this.leftOver,0);n.set(q,
this.leftOver.length)}else n=this.leftOver.concat(n);this.leftOver=null}q=n;var t=void 0,u;(t=t||q.length)>q.length&&(t=q.length);for(u=t-1;0<=u&&128==(192&q[u]);)u--;q=u<0||0===u?t:u+f[q[u]]>t?u:t;t=n;q!==n.length&&(e.uint8array?(t=n.subarray(0,q),this.leftOver=n.subarray(q,n.length)):(t=n.slice(0,q),this.leftOver=n.slice(q,n.length)));this.push({data:b.utf8decode(t),meta:m.meta})};h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:b.utf8decode(this.leftOver),meta:{}}),
this.leftOver=null)};b.Utf8DecodeWorker=h;g.inherits(p,l);p.prototype.processChunk=function(m){this.push({data:b.utf8encode(m.data),meta:m.meta})};b.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(c,d,b){function h(v){return v}function p(v,A){for(var C=0;C<v.length;++C)A[C]=255&v.charCodeAt(C);return A}function g(v){var A=65536,C=b.getTypeOf(v),x=!0;if("uint8array"===C?x=t.applyCanBeUsed.uint8array:"nodebuffer"===C&&(x=t.applyCanBeUsed.nodebuffer),
x)for(;1<A;)try{return t.stringifyByChunk(v,C,A)}catch(F){A=Math.floor(A/2)}return t.stringifyByChar(v)}function e(v,A){for(var C=0;C<v.length;C++)A[C]=v[C];return A}var k=c("./support"),l=c("./base64"),f=c("./nodejsUtils"),m=c("./external");c("setimmediate");b.newBlob=function(v,A){b.checkSupport("blob");try{return new Blob([v],{type:A})}catch(x){try{var C=new (self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return C.append(v),C.getBlob(A)}catch(F){throw Error("Bug : can't construct the Blob.");
}}};try{var n=k.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(v){n=!1}c=n;try{var q=k.nodebuffer&&1===String.fromCharCode.apply(null,f.allocBuffer(1)).length}catch(v){q=!1}var t={stringifyByChunk:function(v,A,C){var x=[],F=0,w=v.length;if(w<=C)return String.fromCharCode.apply(null,v);for(;F<w;)"array"===A||"nodebuffer"===A?x.push(String.fromCharCode.apply(null,v.slice(F,Math.min(F+C,w)))):x.push(String.fromCharCode.apply(null,v.subarray(F,Math.min(F+C,w)))),F+=C;return x.join("")},
stringifyByChar:function(v){for(var A="",C=0;C<v.length;C++)A+=String.fromCharCode(v[C]);return A},applyCanBeUsed:{uint8array:c,nodebuffer:q}};b.applyFromCharCode=g;var u={};u.string={string:h,array:function(v){return p(v,Array(v.length))},arraybuffer:function(v){return u.string.uint8array(v).buffer},uint8array:function(v){return p(v,new Uint8Array(v.length))},nodebuffer:function(v){return p(v,f.allocBuffer(v.length))}};u.array={string:g,array:h,arraybuffer:function(v){return(new Uint8Array(v)).buffer},
uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return f.newBufferFrom(v)}};u.arraybuffer={string:function(v){return g(new Uint8Array(v))},array:function(v){return e(new Uint8Array(v),Array(v.byteLength))},arraybuffer:h,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return f.newBufferFrom(new Uint8Array(v))}};u.uint8array={string:g,array:function(v){return e(v,Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:h,nodebuffer:function(v){return f.newBufferFrom(v)}};
u.nodebuffer={string:g,array:function(v){return e(v,Array(v.length))},arraybuffer:function(v){return u.nodebuffer.uint8array(v).buffer},uint8array:function(v){return e(v,new Uint8Array(v.length))},nodebuffer:h};b.transformTo=function(v,A){return(A=A||"",v)?(b.checkSupport(v),u[b.getTypeOf(A)][v](A)):A};b.resolve=function(v){v=v.split("/");for(var A=[],C=0;C<v.length;C++){var x=v[C];"."===x||""===x&&0!==C&&C!==v.length-1||(".."===x?A.pop():A.push(x))}return A.join("/")};b.getTypeOf=function(v){return"string"==
typeof v?"string":"[object Array]"===Object.prototype.toString.call(v)?"array":k.nodebuffer&&f.isBuffer(v)?"nodebuffer":k.uint8array&&v instanceof Uint8Array?"uint8array":k.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0};b.checkSupport=function(v){if(!k[v.toLowerCase()])throw Error(v+" is not supported by this platform");};b.MAX_VALUE_16BITS=65535;b.MAX_VALUE_32BITS=-1;b.pretty=function(v){var A,C,x="";for(C=0;C<(v||"").length;C++)x+="\\x"+((A=v.charCodeAt(C))<16?"0":"")+A.toString(16).toUpperCase();
return x};b.delay=function(v,A,C){setImmediate(function(){v.apply(C||null,A||[])})};b.inherits=function(v,A){function C(){}C.prototype=A.prototype;v.prototype=new C};b.extend=function(){var v,A,C={};for(v=0;v<arguments.length;v++)for(A in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],A)&&void 0===C[A]&&(C[A]=arguments[v][A]);return C};b.prepareContent=function(v,A,C,x,F){return m.Promise.resolve(A).then(function(w){return k.blob&&(w instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w)))&&
"u">typeof FileReader?new m.Promise(function(G,H){var P=new FileReader;P.onload=function(B){G(B.target.result)};P.onerror=function(B){H(B.target.error)};P.readAsArrayBuffer(w)}):w}).then(function(w){var G,H=b.getTypeOf(w);return H?("arraybuffer"===H?w=b.transformTo("uint8array",w):"string"===H&&(F?w=l.decode(w):C&&!0!==x&&(w=p(G=w,k.uint8array?new Uint8Array(G.length):Array(G.length)))),w):m.Promise.reject(Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},
{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(c,d,b){function h(f){this.files=[];this.loadOptions=f}var p=c("./reader/readerFor"),g=c("./utils"),e=c("./signature"),k=c("./zipEntry"),l=c("./support");h.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var m=this.reader.readString(4);throw Error("Corrupted zip or bug: unexpected signature ("+g.pretty(m)+", expected "+g.pretty(f)+")");}},isSignature:function(f,
m){var n=this.reader.index;this.reader.setIndex(f);f=this.reader.readString(4)===m;return this.reader.setIndex(n),f},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength);
f=g.transformTo(l.uint8array?"uint8array":"array",f);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.reader.skip(4);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData=
{};for(var f,m,n,q=this.zip64EndOfCentralSize-44;0<q;)f=this.reader.readInt(2),m=this.reader.readInt(4),n=this.reader.readData(m),this.zip64ExtensibleData[f]={id:f,length:m,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var f;for(f=0;f<
this.files.length;f++){var m=this.files[f];this.reader.setIndex(m.localHeaderOffset);this.checkSignature(e.LOCAL_FILE_HEADER);m.readLocalPart(this.reader);m.handleUTF8();m.processAttributes()}},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(e.CENTRAL_FILE_HEADER);)(f=new k({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&
0===this.files.length)throw Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length);},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(e.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,e.LOCAL_FILE_HEADER)?Error("Corrupted zip: can't find end of central directory"):Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);
var m=f;if(this.checkSignature(e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===g.MAX_VALUE_16BITS||this.diskWithCentralDirStart===g.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===g.MAX_VALUE_16BITS||this.centralDirRecords===g.MAX_VALUE_16BITS||this.centralDirSize===g.MAX_VALUE_32BITS||this.centralDirOffset===g.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw Error("Corrupted zip: can't find the ZIP64 end of central directory locator");
if(this.reader.setIndex(f),this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(e.ZIP64_CENTRAL_DIRECTORY_END);
this.readBlockZip64EndOfCentral()}f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);f=m-f;if(0<f)this.isSignature(m,e.CENTRAL_FILE_HEADER)||(this.reader.zero=f);else if(f<0)throw Error("Corrupted zip: missing "+Math.abs(f)+" bytes.");},prepareReader:function(f){this.reader=p(f)},load:function(f){this.prepareReader(f);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};d.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,
"./utils":32,"./zipEntry":34}],34:[function(c,d,b){function h(n,q){this.options=n;this.loadOptions=q}var p=c("./reader/readerFor"),g=c("./utils"),e=c("./compressedObject"),k=c("./crc32"),l=c("./utf8"),f=c("./compressions"),m=c("./support");h.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(n){var q;if(n.skip(22),this.fileNameLength=n.readInt(2),q=n.readInt(2),this.fileName=n.readData(this.fileNameLength),n.skip(q),
-1===this.compressedSize||-1===this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");a:{q=this.compressionMethod;for(t in f)if(Object.prototype.hasOwnProperty.call(f,t)&&f[t].magic===q){var t=f[t];break a}t=null}if(null===t)throw Error("Corrupted zip : compression "+g.pretty(this.compressionMethod)+" unknown (inner file : "+g.transformTo("string",this.fileName)+")");this.decompressed=
new e(this.compressedSize,this.uncompressedSize,this.crc32,t,n.readData(this.compressedSize))},readCentralPart:function(n){this.versionMadeBy=n.readInt(2);n.skip(2);this.bitFlag=n.readInt(2);this.compressionMethod=n.readString(2);this.date=n.readDate();this.crc32=n.readInt(4);this.compressedSize=n.readInt(4);this.uncompressedSize=n.readInt(4);var q=n.readInt(2);if(this.extraFieldsLength=n.readInt(2),this.fileCommentLength=n.readInt(2),this.diskNumberStart=n.readInt(2),this.internalFileAttributes=
n.readInt(2),this.externalFileAttributes=n.readInt(4),this.localHeaderOffset=n.readInt(4),this.isEncrypted())throw Error("Encrypted zip are not supported");n.skip(q);this.readExtraFields(n);this.parseZIP64ExtraField(n);this.fileComment=n.readData(this.fileCommentLength)},processAttributes:function(){this.dosPermissions=this.unixPermissions=null;var n=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes);0==n&&(this.dosPermissions=63&this.externalFileAttributes);3==n&&(this.unixPermissions=
this.externalFileAttributes>>16&65535);this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var n=p(this.extraFields[1].value);this.uncompressedSize===g.MAX_VALUE_32BITS&&(this.uncompressedSize=n.readInt(8));this.compressedSize===g.MAX_VALUE_32BITS&&(this.compressedSize=n.readInt(8));this.localHeaderOffset===g.MAX_VALUE_32BITS&&(this.localHeaderOffset=n.readInt(8));this.diskNumberStart===g.MAX_VALUE_32BITS&&(this.diskNumberStart=n.readInt(4))}},
readExtraFields:function(n){var q=n.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});n.index+4<q;){var t=n.readInt(2);var u=n.readInt(2);var v=n.readData(u);this.extraFields[t]={id:t,length:u,value:v}}n.setIndex(q)},handleUTF8:function(){var n=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var q=this.findExtraFieldUnicodePath();null!==q?this.fileNameStr=q:(q=g.transformTo(n,
this.fileName),this.fileNameStr=this.loadOptions.decodeFileName(q));q=this.findExtraFieldUnicodeComment();null!==q?this.fileCommentStr=q:(n=g.transformTo(n,this.fileComment),this.fileCommentStr=this.loadOptions.decodeFileName(n))}},findExtraFieldUnicodePath:function(){var n=this.extraFields[28789];if(n){var q=p(n.value);return 1!==q.readInt(1)||k(this.fileName)!==q.readInt(4)?null:l.utf8decode(q.readData(n.length-5))}return null},findExtraFieldUnicodeComment:function(){var n=this.extraFields[25461];
if(n){var q=p(n.value);return 1!==q.readInt(1)||k(this.fileComment)!==q.readInt(4)?null:l.utf8decode(q.readData(n.length-5))}return null}};d.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(c,d,b){function h(m,n,q){this.name=m;this.dir=q.dir;this.date=q.date;this.comment=q.comment;this.unixPermissions=q.unixPermissions;this.dosPermissions=q.dosPermissions;this._data=n;this._dataBinary=q.binary;this.options=
{compression:q.compression,compressionOptions:q.compressionOptions}}var p=c("./stream/StreamHelper"),g=c("./stream/DataWorker"),e=c("./utf8"),k=c("./compressedObject"),l=c("./stream/GenericWorker");h.prototype={internalStream:function(m){var n=null,q="string";try{if(!m)throw Error("No output type specified.");var t="string"===(q=m.toLowerCase())||"text"===q;"binarystring"!==q&&"text"!==q||(q="string");n=this._decompressWorker();var u=!this._dataBinary;u&&!t&&(n=n.pipe(new e.Utf8EncodeWorker));!u&&
t&&(n=n.pipe(new e.Utf8DecodeWorker))}catch(v){(n=new l("error")).error(v)}return new p(n,q,"")},async:function(m,n){return this.internalStream(m).accumulate(n)},nodeStream:function(m,n){return this.internalStream(m||"nodebuffer").toNodejsStream(n)},_compressWorker:function(m,n){if(this._data instanceof k&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var q=this._decompressWorker();return this._dataBinary||(q=q.pipe(new e.Utf8EncodeWorker)),k.createWorkerFrom(q,m,
n)},_decompressWorker:function(){return this._data instanceof k?this._data.getContentWorker():this._data instanceof l?this._data:new g(this._data)}};c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"];b=function(){throw Error("This method has been removed in JSZip 3.0, please check the upgrade guide.");};for(var f=0;f<c.length;f++)h.prototype[c[f]]=b;d.exports=h},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],
36:[function(c,d,b){(function(h){function p(){var q;g=!0;for(var t=n.length;t;){var u=n;n=[];for(q=-1;++q<t;)u[q]();t=n.length}g=!1}var g,e=h.MutationObserver||h.WebKitMutationObserver;if(e){var k=0;e=new e(p);var l=h.document.createTextNode("");e.observe(l,{characterData:!0});var f=function(){l.data=k=++k%2}}else if(h.setImmediate||void 0===h.MessageChannel)f="document"in h&&"onreadystatechange"in h.document.createElement("script")?function(){var q=h.document.createElement("script");q.onreadystatechange=
function(){p();q.onreadystatechange=null;q.parentNode.removeChild(q);q=null};h.document.documentElement.appendChild(q)}:function(){setTimeout(p,0)};else{var m=new h.MessageChannel;m.port1.onmessage=p;f=function(){m.port2.postMessage(0)}}var n=[];d.exports=function(q){1!==n.push(q)||g||f()}}).call(this,void 0!==Pc?Pc:"u">typeof self?self:"u">typeof window?window:{})},{}],37:[function(c,d,b){function h(){}function p(v){if("function"!=typeof v)throw TypeError("resolver must be a function");this.state=
u;this.queue=[];this.outcome=void 0;v!==h&&l(this,v)}function g(v,A,C){this.promise=v;"function"==typeof A&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled);"function"==typeof C&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function e(v,A,C){m(function(){try{var x=A(C)}catch(F){return n.reject(v,F)}x===v?n.reject(v,TypeError("Cannot resolve promise with itself")):n.resolve(v,x)})}function k(v){var A=v&&v.then;if(v&&("object"==typeof v||"function"==typeof v)&&"function"==
typeof A)return function(){A.apply(v,arguments)}}function l(v,A){function C(G){F||(F=!0,n.reject(v,G))}function x(G){F||(F=!0,n.resolve(v,G))}var F=!1,w=f(function(){A(x,C)});"error"===w.status&&C(w.value)}function f(v,A){var C={};try{C.value=v(A),C.status="success"}catch(x){C.status="error",C.value=x}return C}var m=c("immediate"),n={},q=["REJECTED"],t=["FULFILLED"],u=["PENDING"];(d.exports=p).prototype.finally=function(v){if("function"!=typeof v)return this;var A=this.constructor;return this.then(function(C){return A.resolve(v()).then(function(){return C})},
function(C){return A.resolve(v()).then(function(){throw C;})})};p.prototype.catch=function(v){return this.then(null,v)};p.prototype.then=function(v,A){if("function"!=typeof v&&this.state===t||"function"!=typeof A&&this.state===q)return this;var C=new this.constructor(h);return this.state!==u?e(C,this.state===t?v:A,this.outcome):this.queue.push(new g(C,v,A)),C};g.prototype.callFulfilled=function(v){n.resolve(this.promise,v)};g.prototype.otherCallFulfilled=function(v){e(this.promise,this.onFulfilled,
v)};g.prototype.callRejected=function(v){n.reject(this.promise,v)};g.prototype.otherCallRejected=function(v){e(this.promise,this.onRejected,v)};n.resolve=function(v,A){var C=f(k,A);if("error"===C.status)return n.reject(v,C.value);if(C=C.value)l(v,C);else{v.state=t;v.outcome=A;C=-1;for(var x=v.queue.length;++C<x;)v.queue[C].callFulfilled(A)}return v};n.reject=function(v,A){v.state=q;v.outcome=A;for(var C=-1,x=v.queue.length;++C<x;)v.queue[C].callRejected(A);return v};p.resolve=function(v){return v instanceof
this?v:n.resolve(new this(h),v)};p.reject=function(v){var A=new this(h);return n.reject(A,v)};p.all=function(v){var A=this;if("[object Array]"!==Object.prototype.toString.call(v))return this.reject(TypeError("must be an array"));var C=v.length,x=!1;if(!C)return this.resolve([]);for(var F=Array(C),w=0,G=-1,H=new this(h);++G<C;)!function(P,B){A.resolve(P).then(function(O){F[B]=O;++w!==C||x||(x=!0,n.resolve(H,F))},function(O){x||(x=!0,n.reject(H,O))})}(v[G],G);return H};p.race=function(v){if("[object Array]"!==
Object.prototype.toString.call(v))return this.reject(TypeError("must be an array"));var A=v.length,C=!1;if(!A)return this.resolve([]);for(var x=-1,F=new this(h);++x<A;){var w=v[x];this.resolve(w).then(function(G){C||(C=!0,n.resolve(F,G))},function(G){C||(C=!0,n.reject(F,G))})}return F}},{immediate:36}],38:[function(c,d,b){b={};(0,c("./lib/utils/common").assign)(b,c("./lib/deflate"),c("./lib/inflate"),c("./lib/zlib/constants"));d.exports=b},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,
"./lib/zlib/constants":44}],39:[function(c,d,b){function h(n){if(!(this instanceof h))return new h(n);this.options=e.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},n||{});var q;n=this.options;n.raw&&0<n.windowBits?n.windowBits=-n.windowBits:n.gzip&&0<n.windowBits&&n.windowBits<16&&(n.windowBits+=16);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new f;this.strm.avail_out=0;var t=g.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,
n.strategy);if(0!==t)throw Error(l[t]);if(n.header&&g.deflateSetHeader(this.strm,n.header),n.dictionary){if(q="string"==typeof n.dictionary?k.string2buf(n.dictionary):"[object ArrayBuffer]"===m.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,0!==(t=g.deflateSetDictionary(this.strm,q)))throw Error(l[t]);this._dict_set=!0}}function p(n,q){q=new h(q);if(q.push(n,!0),q.err)throw q.msg||l[q.err];return q.result}var g=c("./zlib/deflate"),e=c("./utils/common"),k=c("./utils/strings"),l=c("./zlib/messages"),
f=c("./zlib/zstream"),m=Object.prototype.toString;h.prototype.push=function(n,q){var t,u=this.strm,v=this.options.chunkSize;if(this.ended)return!1;q=q===~~q?q:4*(!0===q);"string"==typeof n?u.input=k.string2buf(n):"[object ArrayBuffer]"===m.call(n)?u.input=new Uint8Array(n):u.input=n;u.next_in=0;u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new e.Buf8(v),u.next_out=0,u.avail_out=v),1!==(t=g.deflate(u,q))&&0!==t)return this.onEnd(t),this.ended=!0,!1;0!==u.avail_out&&(0!==u.avail_in||4!==
q&&2!==q)||("string"===this.options.to?this.onData(k.buf2binstring(e.shrinkBuf(u.output,u.next_out))):this.onData(e.shrinkBuf(u.output,u.next_out)))}while((0<u.avail_in||0===u.avail_out)&&1!==t);return 4===q?(t=g.deflateEnd(this.strm),this.onEnd(t),this.ended=!0,0===t):2!==q||(this.onEnd(0),u.avail_out=0,!0)};h.prototype.onData=function(n){this.chunks.push(n)};h.prototype.onEnd=function(n){0===n&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks));
this.chunks=[];this.err=n;this.msg=this.strm.msg};b.Deflate=h;b.deflate=p;b.deflateRaw=function(n,q){return(q=q||{}).raw=!0,p(n,q)};b.gzip=function(n,q){return(q=q||{}).gzip=!0,p(n,q)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(c,d,b){function h(t){if(!(this instanceof h))return new h(t);var u=this.options=e.assign({chunkSize:16384,windowBits:0,to:""},t||{});u.raw&&0<=u.windowBits&&u.windowBits<16&&(u.windowBits=-u.windowBits,
0===u.windowBits&&(u.windowBits=-15));!(0<=u.windowBits&&u.windowBits<16)||t&&t.windowBits||(u.windowBits+=32);15<u.windowBits&&u.windowBits<48&&0==(15&u.windowBits)&&(u.windowBits|=15);this.err=0;this.msg="";this.ended=!1;this.chunks=[];this.strm=new m;this.strm.avail_out=0;t=g.inflateInit2(this.strm,u.windowBits);if(t!==l.Z_OK)throw Error(f[t]);this.header=new n;g.inflateGetHeader(this.strm,this.header)}function p(t,u){u=new h(u);if(u.push(t,!0),u.err)throw u.msg||f[u.err];return u.result}var g=
c("./zlib/inflate"),e=c("./utils/common"),k=c("./utils/strings"),l=c("./zlib/constants"),f=c("./zlib/messages"),m=c("./zlib/zstream"),n=c("./zlib/gzheader"),q=Object.prototype.toString;h.prototype.push=function(t,u){var v,A,C,x,F,w=this.strm,G=this.options.chunkSize,H=this.options.dictionary,P=!1;if(this.ended)return!1;u=u===~~u?u:!0===u?l.Z_FINISH:l.Z_NO_FLUSH;"string"==typeof t?w.input=k.binstring2buf(t):"[object ArrayBuffer]"===q.call(t)?w.input=new Uint8Array(t):w.input=t;w.next_in=0;w.avail_in=
w.input.length;do{if(0===w.avail_out&&(w.output=new e.Buf8(G),w.next_out=0,w.avail_out=G),(v=g.inflate(w,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&H&&(F="string"==typeof H?k.string2buf(H):"[object ArrayBuffer]"===q.call(H)?new Uint8Array(H):H,v=g.inflateSetDictionary(this.strm,F)),v===l.Z_BUF_ERROR&&!0===P&&(v=l.Z_OK,P=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),this.ended=!0,!1;w.next_out&&(0!==w.avail_out&&v!==l.Z_STREAM_END&&(0!==w.avail_in||u!==l.Z_FINISH&&u!==l.Z_SYNC_FLUSH)||("string"===this.options.to?
(A=k.utf8border(w.output,w.next_out),C=w.next_out-A,x=k.buf2string(w.output,A),w.next_out=C,w.avail_out=G-C,C&&e.arraySet(w.output,w.output,A,C,0),this.onData(x)):this.onData(e.shrinkBuf(w.output,w.next_out))));0===w.avail_in&&0===w.avail_out&&(P=!0)}while((0<w.avail_in||0===w.avail_out)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(u=l.Z_FINISH),u===l.Z_FINISH?(v=g.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):u!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),w.avail_out=0,!0)};h.prototype.onData=
function(t){this.chunks.push(t)};h.prototype.onEnd=function(t){t===l.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=e.flattenChunks(this.chunks));this.chunks=[];this.err=t;this.msg=this.strm.msg};b.Inflate=h;b.inflate=p;b.inflateRaw=function(t,u){return(u=u||{}).raw=!0,p(t,u)};b.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(c,d,b){c="u">typeof Uint8Array&&
"u">typeof Uint16Array&&"u">typeof Int32Array;b.assign=function(g){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var k=e.shift();if(k){if("object"!=typeof k)throw TypeError(k+"must be non-object");for(var l in k)k.hasOwnProperty(l)&&(g[l]=k[l])}}return g};b.shrinkBuf=function(g,e){return g.length===e?g:g.subarray?g.subarray(0,e):(g.length=e,g)};var h={arraySet:function(g,e,k,l,f){if(e.subarray&&g.subarray)g.set(e.subarray(k,k+l),f);else for(var m=0;m<l;m++)g[f+m]=e[k+m]},flattenChunks:function(g){var e,
k;var l=k=0;for(e=g.length;l<e;l++)k+=g[l].length;var f=new Uint8Array(k);l=k=0;for(e=g.length;l<e;l++){var m=g[l];f.set(m,k);k+=m.length}return f}},p={arraySet:function(g,e,k,l,f){for(var m=0;m<l;m++)g[f+m]=e[k+m]},flattenChunks:function(g){return[].concat.apply([],g)}};b.setTyped=function(g){g?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,h)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,p))};b.setTyped(c)},{}],42:[function(c,d,b){function h(l,f){if(f<65537&&(l.subarray&&
e||!l.subarray&&g))return String.fromCharCode.apply(null,p.shrinkBuf(l,f));for(var m="",n=0;n<f;n++)m+=String.fromCharCode(l[n]);return m}var p=c("./common"),g=!0,e=!0;try{String.fromCharCode.apply(null,[0])}catch(l){g=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){e=!1}var k=new p.Buf8(256);for(c=0;c<256;c++)k[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;k[254]=k[254]=1;b.string2buf=function(l){var f,m,n,q,t=l.length,u=0;for(n=0;n<t;n++)55296==(64512&(f=l.charCodeAt(n)))&&
n+1<t&&56320==(64512&(m=l.charCodeAt(n+1)))&&(f=65536+(f-55296<<10)+(m-56320),n++),u+=f<128?1:f<2048?2:f<65536?3:4;var v=new p.Buf8(u);for(n=q=0;q<u;n++)55296==(64512&(f=l.charCodeAt(n)))&&n+1<t&&56320==(64512&(m=l.charCodeAt(n+1)))&&(f=65536+(f-55296<<10)+(m-56320),n++),f<128?v[q++]=f:(f<2048?v[q++]=192|f>>>6:(f<65536?v[q++]=224|f>>>12:(v[q++]=240|f>>>18,v[q++]=128|f>>>12&63),v[q++]=128|f>>>6&63),v[q++]=128|63&f);return v};b.buf2binstring=function(l){return h(l,l.length)};b.binstring2buf=function(l){for(var f=
new p.Buf8(l.length),m=0,n=f.length;m<n;m++)f[m]=l.charCodeAt(m);return f};b.buf2string=function(l,f){var m,n,q,t=f||l.length,u=Array(2*t);for(f=m=0;f<t;)if((n=l[f++])<128)u[m++]=n;else if(4<(q=k[n]))u[m++]=65533,f+=q-1;else{for(n&=2===q?31:3===q?15:7;1<q&&f<t;)n=n<<6|63&l[f++],q--;1<q?u[m++]=65533:n<65536?u[m++]=n:(n-=65536,u[m++]=55296|n>>10&1023,u[m++]=56320|1023&n)}return h(u,m)};b.utf8border=function(l,f){var m;(f=f||l.length)>l.length&&(f=l.length);for(m=f-1;0<=m&&128==(192&l[m]);)m--;return m<
0||0===m?f:m+k[l[m]]>f?m:f}},{"./common":41}],43:[function(c,d,b){d.exports=function(h,p,g,e){var k=65535&h;h=h>>>16&65535;for(var l;0!==g;){for(g-=l=2E3<g?2E3:g;h=h+(k=k+p[e++]|0)|0,--l;);k%=65521;h%=65521}return k|h<<16}},{}],44:[function(c,d,b){d.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,
Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(c,d,b){var h=function(){for(var p,g=[],e=0;e<256;e++){p=e;for(var k=0;k<8;k++)p=1&p?3988292384^p>>>1:p>>>1;g[e]=p}return g}();d.exports=function(p,g,e,k){e=k+e;for(p^=-1;k<e;k++)p=p>>>8^h[255&(p^g[k])];return-1^p}},{}],46:[function(c,d,b){function h(B,O){return B.msg=H[O],O}function p(B){for(var O=B.length;0<=--O;)B[O]=0}function g(B){var O=
B.state,T=O.pending;T>B.avail_out&&(T=B.avail_out);0!==T&&(x.arraySet(B.output,O.pending_buf,O.pending_out,T,B.next_out),B.next_out+=T,O.pending_out+=T,B.total_out+=T,B.avail_out-=T,O.pending-=T,0===O.pending&&(O.pending_out=0))}function e(B,O){F._tr_flush_block(B,0<=B.block_start?B.block_start:-1,B.strstart-B.block_start,O);B.block_start=B.strstart;g(B.strm)}function k(B,O){B.pending_buf[B.pending++]=O}function l(B,O){B.pending_buf[B.pending++]=O>>>8&255;B.pending_buf[B.pending++]=255&O}function f(B,
O){var T,L,ja=B.max_chain_length,V=B.strstart,ha=B.prev_length,Z=B.nice_match,va=B.strstart>B.w_size-262?B.strstart-(B.w_size-262):0,ia=B.window,sa=B.w_mask,M=B.prev,z=B.strstart+258,K=ia[V+ha-1],ca=ia[V+ha];B.prev_length>=B.good_match&&(ja>>=2);Z>B.lookahead&&(Z=B.lookahead);do if(ia[(T=O)+ha]===ca&&ia[T+ha-1]===K&&ia[T]===ia[V]&&ia[++T]===ia[V+1]){V+=2;for(T++;ia[++V]===ia[++T]&&ia[++V]===ia[++T]&&ia[++V]===ia[++T]&&ia[++V]===ia[++T]&&ia[++V]===ia[++T]&&ia[++V]===ia[++T]&&ia[++V]===ia[++T]&&ia[++V]===
ia[++T]&&V<z;);if(L=258-(z-V),V=z-258,ha<L){if(B.match_start=O,Z<=(ha=L))break;K=ia[V+ha-1];ca=ia[V+ha]}}while((O=M[O&sa])>va&&0!=--ja);return ha<=B.lookahead?ha:B.lookahead}function m(B){var O,T,L,ja,V,ha,Z,va,ia,sa=B.w_size;do{if(ja=B.window_size-B.lookahead-B.strstart,B.strstart>=sa+(sa-262)){x.arraySet(B.window,B.window,sa,sa,0);B.match_start-=sa;B.strstart-=sa;B.block_start-=sa;for(O=T=B.hash_size;L=B.head[--O],B.head[O]=sa<=L?L-sa:0,--T;);for(O=T=sa;L=B.prev[--O],B.prev[O]=sa<=L?L-sa:0,--T;);
ja+=sa}if(0===B.strm.avail_in)break;if(V=B.strm,ha=B.window,Z=B.strstart+B.lookahead,ia=void 0,(va=ja)<(ia=V.avail_in)&&(ia=va),T=0===ia?0:(V.avail_in-=ia,x.arraySet(ha,V.input,V.next_in,ia,Z),1===V.state.wrap?V.adler=w(V.adler,ha,ia,Z):2===V.state.wrap&&(V.adler=G(V.adler,ha,ia,Z)),V.next_in+=ia,V.total_in+=ia,ia),B.lookahead+=T,B.lookahead+B.insert>=3)for(O=B.strstart-B.insert,B.ins_h=B.window[O],B.ins_h=(B.ins_h<<B.hash_shift^B.window[O+1])&B.hash_mask;B.insert&&(B.ins_h=(B.ins_h<<B.hash_shift^
B.window[O+3-1])&B.hash_mask,B.prev[O&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=O,O++,B.insert--,!(B.lookahead+B.insert<3)););}while(B.lookahead<262&&0!==B.strm.avail_in)}function n(B,O){for(var T,L;;){if(B.lookahead<262){if(m(B),B.lookahead<262&&0===O)return 1;if(0===B.lookahead)break}if(T=0,B.lookahead>=3&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,T=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),0!==T&&B.strstart-T<=B.w_size-262&&(B.match_length=
f(B,T)),B.match_length>=3)if(L=F._tr_tally(B,B.strstart-B.match_start,B.match_length-3),B.lookahead-=B.match_length,B.match_length<=B.max_lazy_match&&B.lookahead>=3){for(B.match_length--;B.strstart++,B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,T=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart,0!=--B.match_length;);B.strstart++}else B.strstart+=B.match_length,B.match_length=0,B.ins_h=B.window[B.strstart],B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+
1])&B.hash_mask;else L=F._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++;if(L&&(e(B,!1),0===B.strm.avail_out))return 1}return B.insert=B.strstart<2?B.strstart:2,4===O?(e(B,!0),0===B.strm.avail_out?3:4):B.last_lit&&(e(B,!1),0===B.strm.avail_out)?1:2}function q(B,O){for(var T,L,ja;;){if(B.lookahead<262){if(m(B),B.lookahead<262&&0===O)return 1;if(0===B.lookahead)break}if(T=0,B.lookahead>=3&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,T=B.prev[B.strstart&B.w_mask]=
B.head[B.ins_h],B.head[B.ins_h]=B.strstart),B.prev_length=B.match_length,B.prev_match=B.match_start,B.match_length=2,0!==T&&B.prev_length<B.max_lazy_match&&B.strstart-T<=B.w_size-262&&(B.match_length=f(B,T),B.match_length<=5&&(1===B.strategy||3===B.match_length&&4096<B.strstart-B.match_start)&&(B.match_length=2)),B.prev_length>=3&&B.match_length<=B.prev_length){ja=B.strstart+B.lookahead-3;L=F._tr_tally(B,B.strstart-1-B.prev_match,B.prev_length-3);B.lookahead-=B.prev_length-1;for(B.prev_length-=2;++B.strstart<=
ja&&(B.ins_h=(B.ins_h<<B.hash_shift^B.window[B.strstart+3-1])&B.hash_mask,T=B.prev[B.strstart&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=B.strstart),0!=--B.prev_length;);if(B.match_available=0,B.match_length=2,B.strstart++,L&&(e(B,!1),0===B.strm.avail_out))return 1}else if(B.match_available){if(F._tr_tally(B,0,B.window[B.strstart-1])&&e(B,!1),B.strstart++,B.lookahead--,0===B.strm.avail_out)return 1}else B.match_available=1,B.strstart++,B.lookahead--}return B.match_available&&(F._tr_tally(B,0,B.window[B.strstart-
1]),B.match_available=0),B.insert=B.strstart<2?B.strstart:2,4===O?(e(B,!0),0===B.strm.avail_out?3:4):B.last_lit&&(e(B,!1),0===B.strm.avail_out)?1:2}function t(B,O,T,L,ja){this.good_length=B;this.max_lazy=O;this.nice_length=T;this.max_chain=L;this.func=ja}function u(){this.strm=null;this.status=0;this.pending_buf=null;this.wrap=this.pending=this.pending_out=this.pending_buf_size=0;this.gzhead=null;this.gzindex=0;this.method=8;this.last_flush=-1;this.w_mask=this.w_bits=this.w_size=0;this.window=null;
this.window_size=0;this.head=this.prev=null;this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0;this.dyn_ltree=new x.Buf16(1146);this.dyn_dtree=new x.Buf16(122);this.bl_tree=new x.Buf16(78);p(this.dyn_ltree);p(this.dyn_dtree);p(this.bl_tree);this.bl_desc=
this.d_desc=this.l_desc=null;this.bl_count=new x.Buf16(16);this.heap=new x.Buf16(573);p(this.heap);this.heap_max=this.heap_len=0;this.depth=new x.Buf16(573);p(this.depth);this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function v(B){var O;return B&&B.state?(B.total_in=B.total_out=0,B.data_type=2,(O=B.state).pending=0,O.pending_out=0,O.wrap<0&&(O.wrap=-O.wrap),O.status=O.wrap?42:113,B.adler=+(2!==O.wrap),O.last_flush=
0,F._tr_init(O),0):h(B,-2)}function A(B){var O,T=v(B);return 0===T&&((O=B.state).window_size=2*O.w_size,p(O.head),O.max_lazy_match=P[O.level].max_lazy,O.good_match=P[O.level].good_length,O.nice_match=P[O.level].nice_length,O.max_chain_length=P[O.level].max_chain,O.strstart=0,O.block_start=0,O.lookahead=0,O.insert=0,O.match_length=O.prev_length=2,O.match_available=0,O.ins_h=0),T}function C(B,O,T,L,ja,V){if(!B)return-2;var ha=1;if(-1===O&&(O=6),L<0?(ha=0,L=-L):15<L&&(ha=2,L-=16),ja<1||9<ja||8!==T||
L<8||15<L||O<0||9<O||V<0||4<V)return h(B,-2);8===L&&(L=9);var Z=new u;return(B.state=Z).strm=B,Z.wrap=ha,Z.gzhead=null,Z.w_bits=L,Z.w_size=1<<Z.w_bits,Z.w_mask=Z.w_size-1,Z.hash_bits=ja+7,Z.hash_size=1<<Z.hash_bits,Z.hash_mask=Z.hash_size-1,Z.hash_shift=~~((Z.hash_bits+3-1)/3),Z.window=new x.Buf8(2*Z.w_size),Z.head=new x.Buf16(Z.hash_size),Z.prev=new x.Buf16(Z.w_size),Z.lit_bufsize=1<<ja+6,Z.pending_buf_size=4*Z.lit_bufsize,Z.pending_buf=new x.Buf8(Z.pending_buf_size),Z.d_buf=+Z.lit_bufsize,Z.l_buf=
3*Z.lit_bufsize,Z.level=O,Z.strategy=V,Z.method=T,A(B)}var x=c("../utils/common"),F=c("./trees"),w=c("./adler32"),G=c("./crc32"),H=c("./messages");var P=[new t(0,0,0,0,function(B,O){var T=65535;for(65535>B.pending_buf_size-5&&(T=B.pending_buf_size-5);;){if(B.lookahead<=1){if(m(B),0===B.lookahead&&0===O)return 1;if(0===B.lookahead)break}B.strstart+=B.lookahead;B.lookahead=0;var L=B.block_start+T;if((0===B.strstart||B.strstart>=L)&&(B.lookahead=B.strstart-L,B.strstart=L,e(B,!1),0===B.strm.avail_out)||
B.strstart-B.block_start>=B.w_size-262&&(e(B,!1),0===B.strm.avail_out))return 1}return B.insert=0,4===O?(e(B,!0),0===B.strm.avail_out?3:4):(B.strstart>B.block_start&&(e(B,!1),B.strm.avail_out),1)}),new t(4,4,8,4,n),new t(4,5,16,8,n),new t(4,6,32,32,n),new t(4,4,16,16,q),new t(8,16,32,32,q),new t(8,16,128,128,q),new t(8,32,128,256,q),new t(32,128,258,1024,q),new t(32,258,258,4096,q)];b.deflateInit=function(B,O){return C(B,O,8,15,8,0)};b.deflateInit2=C;b.deflateReset=A;b.deflateResetKeep=v;b.deflateSetHeader=
function(B,O){return B&&B.state?2!==B.state.wrap?-2:(B.state.gzhead=O,0):-2};b.deflate=function(B,O){var T,L;if(!B||!B.state||5<O||O<0)return B?h(B,-2):-2;if(L=B.state,!B.output||!B.input&&0!==B.avail_in||666===L.status&&4!==O)return h(B,0===B.avail_out?-5:-2);if(L.strm=B,T=L.last_flush,L.last_flush=O,42===L.status)if(2===L.wrap)B.adler=0,k(L,31),k(L,139),k(L,8),L.gzhead?(k(L,+!!L.gzhead.text+2*!!L.gzhead.hcrc+4*!!L.gzhead.extra+8*!!L.gzhead.name+16*!!L.gzhead.comment),k(L,255&L.gzhead.time),k(L,
L.gzhead.time>>8&255),k(L,L.gzhead.time>>16&255),k(L,L.gzhead.time>>24&255),k(L,9===L.level?2:4*(2<=L.strategy||L.level<2)),k(L,255&L.gzhead.os),L.gzhead.extra&&L.gzhead.extra.length&&(k(L,255&L.gzhead.extra.length),k(L,L.gzhead.extra.length>>8&255)),L.gzhead.hcrc&&(B.adler=G(B.adler,L.pending_buf,L.pending,0)),L.gzindex=0,L.status=69):(k(L,0),k(L,0),k(L,0),k(L,0),k(L,0),k(L,9===L.level?2:4*(2<=L.strategy||L.level<2)),k(L,3),L.status=113);else{var ja=8+(L.w_bits-8<<4)<<8;ja|=(2<=L.strategy||L.level<
2?0:L.level<6?1:6===L.level?2:3)<<6;0!==L.strstart&&(ja|=32);L.status=113;l(L,ja+(31-ja%31));0!==L.strstart&&(l(L,B.adler>>>16),l(L,65535&B.adler));B.adler=1}if(69===L.status)if(L.gzhead.extra){for(ja=L.pending;L.gzindex<(65535&L.gzhead.extra.length)&&(L.pending!==L.pending_buf_size||(L.gzhead.hcrc&&L.pending>ja&&(B.adler=G(B.adler,L.pending_buf,L.pending-ja,ja)),g(B),ja=L.pending,L.pending!==L.pending_buf_size));)k(L,255&L.gzhead.extra[L.gzindex]),L.gzindex++;L.gzhead.hcrc&&L.pending>ja&&(B.adler=
G(B.adler,L.pending_buf,L.pending-ja,ja));L.gzindex===L.gzhead.extra.length&&(L.gzindex=0,L.status=73)}else L.status=73;if(73===L.status)if(L.gzhead.name){ja=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>ja&&(B.adler=G(B.adler,L.pending_buf,L.pending-ja,ja)),g(B),ja=L.pending,L.pending===L.pending_buf_size)){var V=1;break}V=L.gzindex<L.gzhead.name.length?255&L.gzhead.name.charCodeAt(L.gzindex++):0;k(L,V)}while(0!==V);L.gzhead.hcrc&&L.pending>ja&&(B.adler=G(B.adler,L.pending_buf,
L.pending-ja,ja));0===V&&(L.gzindex=0,L.status=91)}else L.status=91;if(91===L.status)if(L.gzhead.comment){ja=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>ja&&(B.adler=G(B.adler,L.pending_buf,L.pending-ja,ja)),g(B),ja=L.pending,L.pending===L.pending_buf_size)){V=1;break}V=L.gzindex<L.gzhead.comment.length?255&L.gzhead.comment.charCodeAt(L.gzindex++):0;k(L,V)}while(0!==V);L.gzhead.hcrc&&L.pending>ja&&(B.adler=G(B.adler,L.pending_buf,L.pending-ja,ja));0===V&&(L.status=103)}else L.status=
103;if(103===L.status&&(L.gzhead.hcrc?(L.pending+2>L.pending_buf_size&&g(B),L.pending+2<=L.pending_buf_size&&(k(L,255&B.adler),k(L,B.adler>>8&255),B.adler=0,L.status=113)):L.status=113),0!==L.pending){if(g(B),0===B.avail_out)return L.last_flush=-1,0}else if(0===B.avail_in&&(O<<1)-9*(4<O)<=(T<<1)-9*(4<T)&&4!==O)return h(B,-5);if(666===L.status&&0!==B.avail_in)return h(B,-5);if(0!==B.avail_in||0!==L.lookahead||0!==O&&666!==L.status){T=2===L.strategy?function(ha,Z){for(var va;;){if(0===ha.lookahead&&
(m(ha),0===ha.lookahead)){if(0===Z)return 1;break}if(ha.match_length=0,va=F._tr_tally(ha,0,ha.window[ha.strstart]),ha.lookahead--,ha.strstart++,va&&(e(ha,!1),0===ha.strm.avail_out))return 1}return ha.insert=0,4===Z?(e(ha,!0),0===ha.strm.avail_out?3:4):ha.last_lit&&(e(ha,!1),0===ha.strm.avail_out)?1:2}(L,O):3===L.strategy?function(ha,Z){for(var va,ia,sa,M,z=ha.window;;){if(ha.lookahead<=258){if(m(ha),ha.lookahead<=258&&0===Z)return 1;if(0===ha.lookahead)break}if(ha.match_length=0,ha.lookahead>=3&&
0<ha.strstart&&(ia=z[sa=ha.strstart-1])===z[++sa]&&ia===z[++sa]&&ia===z[++sa]){for(M=ha.strstart+258;ia===z[++sa]&&ia===z[++sa]&&ia===z[++sa]&&ia===z[++sa]&&ia===z[++sa]&&ia===z[++sa]&&ia===z[++sa]&&ia===z[++sa]&&sa<M;);ha.match_length=258-(M-sa);ha.match_length>ha.lookahead&&(ha.match_length=ha.lookahead)}if(ha.match_length>=3?(va=F._tr_tally(ha,1,ha.match_length-3),ha.lookahead-=ha.match_length,ha.strstart+=ha.match_length,ha.match_length=0):(va=F._tr_tally(ha,0,ha.window[ha.strstart]),ha.lookahead--,
ha.strstart++),va&&(e(ha,!1),0===ha.strm.avail_out))return 1}return ha.insert=0,4===Z?(e(ha,!0),0===ha.strm.avail_out?3:4):ha.last_lit&&(e(ha,!1),0===ha.strm.avail_out)?1:2}(L,O):P[L.level].func(L,O);if(3!==T&&4!==T||(L.status=666),1===T||3===T)return 0===B.avail_out&&(L.last_flush=-1),0;if(2===T&&(1===O?F._tr_align(L):5!==O&&(F._tr_stored_block(L,0,0,!1),3===O&&(p(L.head),0===L.lookahead&&(L.strstart=0,L.block_start=0,L.insert=0))),g(B),0===B.avail_out))return L.last_flush=-1,0}return 4!==O?0:L.wrap<=
0?1:(2===L.wrap?(k(L,255&B.adler),k(L,B.adler>>8&255),k(L,B.adler>>16&255),k(L,B.adler>>24&255),k(L,255&B.total_in),k(L,B.total_in>>8&255),k(L,B.total_in>>16&255),k(L,B.total_in>>24&255)):(l(L,B.adler>>>16),l(L,65535&B.adler)),g(B),0<L.wrap&&(L.wrap=-L.wrap),+(0===L.pending))};b.deflateEnd=function(B){var O;return B&&B.state?42!==(O=B.state.status)&&69!==O&&73!==O&&91!==O&&103!==O&&113!==O&&666!==O?h(B,-2):(B.state=null,113===O?h(B,-3):0):-2};b.deflateSetDictionary=function(B,O){var T,L,ja;var V=
O.length;if(!B||!B.state||2===(L=(T=B.state).wrap)||1===L&&42!==T.status||T.lookahead)return-2;1===L&&(B.adler=w(B.adler,O,V,0));T.wrap=0;V>=T.w_size&&(0===L&&(p(T.head),T.strstart=0,T.block_start=0,T.insert=0),ja=new x.Buf8(T.w_size),x.arraySet(ja,O,V-T.w_size,T.w_size,0),O=ja,V=T.w_size);ja=B.avail_in;var ha=B.next_in;var Z=B.input;B.avail_in=V;B.next_in=0;B.input=O;for(m(T);T.lookahead>=3;){O=T.strstart;for(V=T.lookahead-2;T.ins_h=(T.ins_h<<T.hash_shift^T.window[O+3-1])&T.hash_mask,T.prev[O&T.w_mask]=
T.head[T.ins_h],T.head[T.ins_h]=O,O++,--V;);T.strstart=O;T.lookahead=2;m(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=2,T.match_available=0,B.next_in=ha,B.input=Z,B.avail_in=ja,T.wrap=L,0};b.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(c,d,b){d.exports=function(){this.os=this.xflags=this.time=this.text=0;this.extra=null;this.extra_len=
0;this.comment=this.name="";this.hcrc=0;this.done=!1}},{}],48:[function(c,d,b){d.exports=function(h,p){var g,e,k,l;var f=h.state;var m=h.next_in;var n=h.input;var q=m+(h.avail_in-5);var t=h.next_out;var u=h.output;p=t-(p-h.avail_out);var v=t+(h.avail_out-257);var A=f.dmax;var C=f.wsize;var x=f.whave;var F=f.wnext;var w=f.window;var G=f.hold;var H=f.bits;var P=f.lencode;var B=f.distcode;var O=(1<<f.lenbits)-1;var T=(1<<f.distbits)-1;a:do for(H<15&&(G+=n[m++]<<H,H+=8,G+=n[m++]<<H,H+=8),g=P[G&O];;){if(G>>>=
e=g>>>24,H-=e,0==(e=g>>>16&255))u[t++]=65535&g;else{if(!(16&e)){if(0==(64&e)){g=P[(65535&g)+(G&(1<<e)-1)];continue}if(32&e){f.mode=12;break a}h.msg="invalid literal/length code";f.mode=30;break a}var L=65535&g;(e&=15)&&(H<e&&(G+=n[m++]<<H,H+=8),L+=G&(1<<e)-1,G>>>=e,H-=e);H<15&&(G+=n[m++]<<H,H+=8,G+=n[m++]<<H,H+=8);for(g=B[G&T];;){if(G>>>=e=g>>>24,H-=e,!(16&(e=g>>>16&255))){if(0==(64&e)){g=B[(65535&g)+(G&(1<<e)-1)];continue}h.msg="invalid distance code";f.mode=30;break a}if(k=65535&g,H<(e&=15)&&(G+=
n[m++]<<H,(H+=8)<e&&(G+=n[m++]<<H,H+=8)),A<(k+=G&(1<<e)-1)){h.msg="invalid distance too far back";f.mode=30;break a}if(G>>>=e,H-=e,(e=t-p)<k){if(x<(e=k-e)&&f.sane){h.msg="invalid distance too far back";f.mode=30;break a}if(l=w,(g=0)===F){if(g+=C-e,e<L){for(L-=e;u[t++]=w[g++],--e;);g=t-k;l=u}}else if(F<e){if(g+=C+F-e,(e-=F)<L){for(L-=e;u[t++]=w[g++],--e;);if(g=0,F<L){for(L-=e=F;u[t++]=w[g++],--e;);g=t-k;l=u}}}else if(g+=F-e,e<L){for(L-=e;u[t++]=w[g++],--e;);g=t-k;l=u}for(;2<L;)u[t++]=l[g++],u[t++]=
l[g++],u[t++]=l[g++],L-=3;L&&(u[t++]=l[g++],1<L&&(u[t++]=l[g++]))}else{for(g=t-k;u[t++]=u[g++],u[t++]=u[g++],u[t++]=u[g++],2<(L-=3););L&&(u[t++]=u[g++],1<L&&(u[t++]=u[g++]))}break}}break}while(m<q&&t<v);m-=L=H>>3;G&=(1<<(H-=L<<3))-1;h.next_in=m;h.next_out=t;h.avail_in=m<q?q-m+5:5-(m-q);h.avail_out=t<v?v-t+257:257-(t-v);f.hold=G;f.bits=H}},{}],49:[function(c,d,b){function h(x){return(x>>>24&255)+(x>>>8&65280)+((65280&x)<<8)+((255&x)<<24)}function p(){this.mode=0;this.last=!1;this.wrap=0;this.havedict=
!1;this.total=this.check=this.dmax=this.flags=0;this.head=null;this.wnext=this.whave=this.wsize=this.wbits=0;this.window=null;this.extra=this.offset=this.length=this.bits=this.hold=0;this.distcode=this.lencode=null;this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0;this.next=null;this.lens=new m.Buf16(320);this.work=new m.Buf16(288);this.distdyn=this.lendyn=null;this.was=this.back=this.sane=0}function g(x){var F;return x&&x.state?(F=x.state,x.total_in=x.total_out=F.total=0,x.msg=
"",F.wrap&&(x.adler=1&F.wrap),F.mode=1,F.last=0,F.havedict=0,F.dmax=32768,F.head=null,F.hold=0,F.bits=0,F.lencode=F.lendyn=new m.Buf32(852),F.distcode=F.distdyn=new m.Buf32(592),F.sane=1,F.back=-1,0):-2}function e(x){var F;return x&&x.state?((F=x.state).wsize=0,F.whave=0,F.wnext=0,g(x)):-2}function k(x,F){var w,G;return x&&x.state?(G=x.state,F<0?(w=0,F=-F):(w=1+(F>>4),F<48&&(F&=15)),F&&(F<8||15<F)?-2:(null!==G.window&&G.wbits!==F&&(G.window=null),G.wrap=w,G.wbits=F,e(x))):-2}function l(x,F){var w;
return x?((x.state=new p).window=null,0!==(w=k(x,F))&&(x.state=null),w):-2}function f(x,F,w,G){var H;x=x.state;return null===x.window&&(x.wsize=1<<x.wbits,x.wnext=0,x.whave=0,x.window=new m.Buf8(x.wsize)),G>=x.wsize?(m.arraySet(x.window,F,w-x.wsize,x.wsize,0),x.wnext=0,x.whave=x.wsize):(G<(H=x.wsize-x.wnext)&&(H=G),m.arraySet(x.window,F,w-G,H,x.wnext),(G-=H)?(m.arraySet(x.window,F,w-G,G,0),x.wnext=G,x.whave=x.wsize):(x.wnext+=H,x.wnext===x.wsize&&(x.wnext=0),x.whave<x.wsize&&(x.whave+=H))),0}var m=
c("../utils/common"),n=c("./adler32"),q=c("./crc32"),t=c("./inffast"),u=c("./inftrees"),v,A,C=!0;b.inflateReset=e;b.inflateReset2=k;b.inflateResetKeep=g;b.inflateInit=function(x){return l(x,15)};b.inflateInit2=l;b.inflate=function(x,F){var w,G,H,P,B,O,T,L=0,ja=new m.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!x||!x.state||!x.output||!x.input&&0!==x.avail_in)return-2;12===(w=x.state).mode&&(w.mode=13);var ha=x.next_out;var Z=x.output;var va=x.avail_out;var ia=x.next_in;var sa=x.input;
var M=x.avail_in;var z=w.hold;var K=w.bits;var ca=M;var na=va;var X=0;a:for(;;)switch(w.mode){case 1:if(0===w.wrap){w.mode=13;break}for(;K<16;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(2&w.wrap&&35615===z){ja[w.check=0]=255&z;ja[1]=z>>>8&255;w.check=q(w.check,ja,2,0);K=z=0;w.mode=2;break}if(w.flags=0,w.head&&(w.head.done=!1),!(1&w.wrap)||(((255&z)<<8)+(z>>8))%31){x.msg="incorrect header check";w.mode=30;break}if(8!=(15&z)){x.msg="unknown compression method";w.mode=30;break}if(K-=4,O=8+(15&(z>>>=
4)),0===w.wbits)w.wbits=O;else if(O>w.wbits){x.msg="invalid window size";w.mode=30;break}w.dmax=1<<O;x.adler=w.check=1;w.mode=512&z?10:12;K=z=0;break;case 2:for(;K<16;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(w.flags=z,8!=(255&w.flags)){x.msg="unknown compression method";w.mode=30;break}if(57344&w.flags){x.msg="unknown header flags set";w.mode=30;break}w.head&&(w.head.text=z>>8&1);512&w.flags&&(ja[0]=255&z,ja[1]=z>>>8&255,w.check=q(w.check,ja,2,0));K=z=0;w.mode=3;case 3:for(;K<32;){if(0===M)break a;
M--;z+=sa[ia++]<<K;K+=8}w.head&&(w.head.time=z);512&w.flags&&(ja[0]=255&z,ja[1]=z>>>8&255,ja[2]=z>>>16&255,ja[3]=z>>>24&255,w.check=q(w.check,ja,4,0));K=z=0;w.mode=4;case 4:for(;K<16;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}w.head&&(w.head.xflags=255&z,w.head.os=z>>8);512&w.flags&&(ja[0]=255&z,ja[1]=z>>>8&255,w.check=q(w.check,ja,2,0));K=z=0;w.mode=5;case 5:if(1024&w.flags){for(;K<16;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}w.length=z;w.head&&(w.head.extra_len=z);512&w.flags&&(ja[0]=255&z,ja[1]=
z>>>8&255,w.check=q(w.check,ja,2,0));K=z=0}else w.head&&(w.head.extra=null);w.mode=6;case 6:if(1024&w.flags&&(M<(G=w.length)&&(G=M),G&&(w.head&&(O=w.head.extra_len-w.length,w.head.extra||(w.head.extra=Array(w.head.extra_len)),m.arraySet(w.head.extra,sa,ia,G,O)),512&w.flags&&(w.check=q(w.check,sa,G,ia)),M-=G,ia+=G,w.length-=G),w.length))break a;w.length=0;w.mode=7;case 7:if(2048&w.flags){if(0===M)break a;for(G=0;O=sa[ia+G++],w.head&&O&&w.length<65536&&(w.head.name+=String.fromCharCode(O)),O&&G<M;);
if(512&w.flags&&(w.check=q(w.check,sa,G,ia)),M-=G,ia+=G,O)break a}else w.head&&(w.head.name=null);w.length=0;w.mode=8;case 8:if(4096&w.flags){if(0===M)break a;for(G=0;O=sa[ia+G++],w.head&&O&&w.length<65536&&(w.head.comment+=String.fromCharCode(O)),O&&G<M;);if(512&w.flags&&(w.check=q(w.check,sa,G,ia)),M-=G,ia+=G,O)break a}else w.head&&(w.head.comment=null);w.mode=9;case 9:if(512&w.flags){for(;K<16;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(z!==(65535&w.check)){x.msg="header crc mismatch";w.mode=
30;break}K=z=0}w.head&&(w.head.hcrc=w.flags>>9&1,w.head.done=!0);x.adler=w.check=0;w.mode=12;break;case 10:for(;K<32;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}x.adler=w.check=h(z);K=z=0;w.mode=11;case 11:if(0===w.havedict)return x.next_out=ha,x.avail_out=va,x.next_in=ia,x.avail_in=M,w.hold=z,w.bits=K,2;x.adler=w.check=1;w.mode=12;case 12:if(5===F||6===F)break a;case 13:if(w.last){z>>>=7&K;K-=7&K;w.mode=27;break}for(;K<3;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}switch(w.last=1&z,--K,3&(z>>>=1)){case 0:w.mode=
14;break;case 1:var ba=w;if(C){v=new m.Buf32(512);A=new m.Buf32(32);for(H=0;H<144;)ba.lens[H++]=8;for(;H<256;)ba.lens[H++]=9;for(;H<280;)ba.lens[H++]=7;for(;H<288;)ba.lens[H++]=8;u(1,ba.lens,0,288,v,0,ba.work,{bits:9});for(H=0;H<32;)ba.lens[H++]=5;u(2,ba.lens,0,32,A,0,ba.work,{bits:5});C=!1}ba.lencode=v;ba.lenbits=9;ba.distcode=A;ba.distbits=5;if(w.mode=20,6!==F)break;z>>>=2;K-=2;break a;case 2:w.mode=17;break;case 3:x.msg="invalid block type",w.mode=30}z>>>=2;K-=2;break;case 14:z>>>=7&K;for(K-=7&
K;K<32;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if((65535&z)!=(z>>>16^65535)){x.msg="invalid stored block lengths";w.mode=30;break}if(w.length=65535&z,K=z=0,w.mode=15,6===F)break a;case 15:w.mode=16;case 16:if(G=w.length){if(M<G&&(G=M),va<G&&(G=va),0===G)break a;m.arraySet(Z,sa,ia,G,ha);M-=G;ia+=G;va-=G;ha+=G;w.length-=G;break}w.mode=12;break;case 17:for(;K<14;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(w.nlen=257+(31&z),K-=5,w.ndist=1+(31&(z>>>=5)),K-=5,w.ncode=4+(15&(z>>>=5)),z>>>=4,K-=4,286<
w.nlen||30<w.ndist){x.msg="too many length or distance symbols";w.mode=30;break}w.have=0;w.mode=18;case 18:for(;w.have<w.ncode;){for(;K<3;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}w.lens[V[w.have++]]=7&z;z>>>=3;K-=3}for(;w.have<19;)w.lens[V[w.have++]]=0;if(w.lencode=w.lendyn,w.lenbits=7,T={bits:w.lenbits},X=u(0,w.lens,0,19,w.lencode,0,w.work,T),w.lenbits=T.bits,X){x.msg="invalid code lengths set";w.mode=30;break}w.have=0;w.mode=19;case 19:for(;w.have<w.nlen+w.ndist;){for(;L=w.lencode[z&(1<<w.lenbits)-
1],P=65535&L,!((H=L>>>24)<=K);){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(P<16)z>>>=H,K-=H,w.lens[w.have++]=P;else{if(16===P){for(ba=H+2;K<ba;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(z>>>=H,K-=H,0===w.have){x.msg="invalid bit length repeat";w.mode=30;break}O=w.lens[w.have-1];G=3+(3&z);z>>>=2;K-=2}else if(17===P){for(ba=H+3;K<ba;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}K-=H;O=0;G=3+(7&(z>>>=H));z>>>=3;K-=3}else{for(ba=H+7;K<ba;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}K-=H;O=0;G=11+(127&
(z>>>=H));z>>>=7;K-=7}if(w.have+G>w.nlen+w.ndist){x.msg="invalid bit length repeat";w.mode=30;break}for(;G--;)w.lens[w.have++]=O}}if(30===w.mode)break;if(0===w.lens[256]){x.msg="invalid code -- missing end-of-block";w.mode=30;break}if(w.lenbits=9,T={bits:w.lenbits},X=u(1,w.lens,0,w.nlen,w.lencode,0,w.work,T),w.lenbits=T.bits,X){x.msg="invalid literal/lengths set";w.mode=30;break}if(w.distbits=6,w.distcode=w.distdyn,T={bits:w.distbits},X=u(2,w.lens,w.nlen,w.ndist,w.distcode,0,w.work,T),w.distbits=
T.bits,X){x.msg="invalid distances set";w.mode=30;break}if(w.mode=20,6===F)break a;case 20:w.mode=21;case 21:if(6<=M&&258<=va){x.next_out=ha;x.avail_out=va;x.next_in=ia;x.avail_in=M;w.hold=z;w.bits=K;t(x,na);ha=x.next_out;Z=x.output;va=x.avail_out;ia=x.next_in;sa=x.input;M=x.avail_in;z=w.hold;K=w.bits;12===w.mode&&(w.back=-1);break}for(w.back=0;ba=(L=w.lencode[z&(1<<w.lenbits)-1])>>>16&255,P=65535&L,!((H=L>>>24)<=K);){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(ba&&0==(240&ba)){var ea=H;var ma=ba;
for(B=P;ba=(L=w.lencode[B+((z&(1<<ea+ma)-1)>>ea)])>>>16&255,P=65535&L,!(ea+(H=L>>>24)<=K);){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}z>>>=ea;K-=ea;w.back+=ea}if(z>>>=H,K-=H,w.back+=H,w.length=P,0===ba){w.mode=26;break}if(32&ba){w.back=-1;w.mode=12;break}if(64&ba){x.msg="invalid literal/length code";w.mode=30;break}w.extra=15&ba;w.mode=22;case 22:if(w.extra){for(ba=w.extra;K<ba;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}w.length+=z&(1<<w.extra)-1;z>>>=w.extra;K-=w.extra;w.back+=w.extra}w.was=w.length;
w.mode=23;case 23:for(;ba=(L=w.distcode[z&(1<<w.distbits)-1])>>>16&255,P=65535&L,!((H=L>>>24)<=K);){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(0==(240&ba)){ea=H;ma=ba;for(B=P;ba=(L=w.distcode[B+((z&(1<<ea+ma)-1)>>ea)])>>>16&255,P=65535&L,!(ea+(H=L>>>24)<=K);){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}z>>>=ea;K-=ea;w.back+=ea}if(z>>>=H,K-=H,w.back+=H,64&ba){x.msg="invalid distance code";w.mode=30;break}w.offset=P;w.extra=15&ba;w.mode=24;case 24:if(w.extra){for(ba=w.extra;K<ba;){if(0===M)break a;M--;
z+=sa[ia++]<<K;K+=8}w.offset+=z&(1<<w.extra)-1;z>>>=w.extra;K-=w.extra;w.back+=w.extra}if(w.offset>w.dmax){x.msg="invalid distance too far back";w.mode=30;break}w.mode=25;case 25:if(0===va)break a;if(G=na-va,w.offset>G){if((G=w.offset-G)>w.whave&&w.sane){x.msg="invalid distance too far back";w.mode=30;break}H=G>w.wnext?(G-=w.wnext,w.wsize-G):w.wnext-G;G>w.length&&(G=w.length);ba=w.window}else ba=Z,H=ha-w.offset,G=w.length;va<G&&(G=va);va-=G;for(w.length-=G;Z[ha++]=ba[H++],--G;);0===w.length&&(w.mode=
21);break;case 26:if(0===va)break a;Z[ha++]=w.length;va--;w.mode=21;break;case 27:if(w.wrap){for(;K<32;){if(0===M)break a;M--;z|=sa[ia++]<<K;K+=8}if(na-=va,x.total_out+=na,w.total+=na,na&&(x.adler=w.check=w.flags?q(w.check,Z,na,ha-na):n(w.check,Z,na,ha-na)),na=va,(w.flags?z:h(z))!==w.check){x.msg="incorrect data check";w.mode=30;break}K=z=0}w.mode=28;case 28:if(w.wrap&&w.flags){for(;K<32;){if(0===M)break a;M--;z+=sa[ia++]<<K;K+=8}if(z!==(0|w.total)){x.msg="incorrect length check";w.mode=30;break}K=
z=0}w.mode=29;case 29:X=1;break a;case 30:X=-3;break a;case 31:return-4;default:return-2}return x.next_out=ha,x.avail_out=va,x.next_in=ia,x.avail_in=M,w.hold=z,w.bits=K,(w.wsize||na!==x.avail_out&&w.mode<30&&(w.mode<27||4!==F))&&f(x,x.output,x.next_out,na-x.avail_out)?(w.mode=31,-4):(ca-=x.avail_in,na-=x.avail_out,x.total_in+=ca,x.total_out+=na,w.total+=na,w.wrap&&na&&(x.adler=w.check=w.flags?q(w.check,Z,na,x.next_out-na):n(w.check,Z,na,x.next_out-na)),x.data_type=w.bits+64*!!w.last+128*(12===w.mode)+
256*(20===w.mode||15===w.mode),(0==ca&&0===na||4===F)&&0===X&&(X=-5),X)};b.inflateEnd=function(x){if(!x||!x.state)return-2;var F=x.state;return F.window&&(F.window=null),x.state=null,0};b.inflateGetHeader=function(x,F){var w;return x&&x.state?0==(2&(w=x.state).wrap)?-2:((w.head=F).done=!1,0):-2};b.inflateSetDictionary=function(x,F){var w,G=F.length;return x&&x.state?0!==(w=x.state).wrap&&11!==w.mode?-2:11===w.mode&&n(1,F,G,0)!==w.check?-3:f(x,F,G,G)?(w.mode=31,-4):(w.havedict=1,0):-2};b.inflateInfo=
"pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(c,d,b){var h=c("../utils/common"),p=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],g=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],k=[16,16,16,16,17,17,18,
18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];d.exports=function(l,f,m,n,q,t,u,v){var A,C,x,F,w,G=v.bits,H,P,B,O,T,L=0,ja,V=null,ha=0,Z=new h.Buf16(16);var va=new h.Buf16(16);var ia=null,sa=0;for(H=0;H<=15;H++)Z[H]=0;for(P=0;P<n;P++)Z[f[m+P]]++;var M=G;for(B=15;1<=B&&0===Z[B];B--);if(B<M&&(M=B),0===B)return q[t++]=20971520,q[t++]=20971520,v.bits=1,0;for(G=1;G<B&&0===Z[G];G++);M<G&&(M=G);for(H=A=1;H<=15;H++)if(A<<=1,(A-=Z[H])<0)return-1;if(0<A&&(0===l||1!==B))return-1;
va[1]=0;for(H=1;H<15;H++)va[H+1]=va[H]+Z[H];for(P=0;P<n;P++)0!==f[m+P]&&(u[va[f[m+P]]++]=P);if(F=0===l?(V=ia=u,19):1===l?(V=p,ha-=257,ia=g,sa-=257,256):(V=e,ia=k,-1),H=G,va=t,T=P=ja=0,x=-1,n=(L=1<<(O=M))-1,1===l&&852<L||2===l&&592<L)return 1;for(;;){var z=H-T;var K=u[P]<F?(w=0,u[P]):u[P]>F?(w=ia[sa+u[P]],V[ha+u[P]]):(w=96,0);A=1<<H-T;for(G=C=1<<O;q[va+(ja>>T)+(C-=A)]=z<<24|w<<16|K,0!==C;);for(A=1<<H-1;ja&A;)A>>=1;if(0!==A?(ja&=A-1,ja+=A):ja=0,P++,0==--Z[H]){if(H===B)break;H=f[m+u[P]]}if(M<H&&(ja&
n)!==x){0===T&&(T=M);va+=G;for(A=1<<(O=H-T);O+T<B&&!((A-=Z[O+T])<=0);)O++,A<<=1;if(L+=1<<O,1===l&&852<L||2===l&&592<L)return 1;q[x=ja&n]=M<<24|O<<16|va-t}}return 0!==ja&&(q[va+ja]=H-T<<24|4194304),v.bits=M,0}},{"../utils/common":41}],51:[function(c,d,b){d.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(c,d,b){function h(z){for(var K=z.length;0<=--K;)z[K]=
0}function p(z,K,ca,na,X){this.static_tree=z;this.extra_bits=K;this.extra_base=ca;this.elems=na;this.max_length=X;this.has_stree=z&&z.length}function g(z,K){this.dyn_tree=z;this.max_code=0;this.stat_desc=K}function e(z){return z<256?ja[z]:ja[256+(z>>>7)]}function k(z,K){z.pending_buf[z.pending++]=255&K;z.pending_buf[z.pending++]=K>>>8&255}function l(z,K,ca){z.bi_valid>16-ca?(z.bi_buf|=K<<z.bi_valid&65535,k(z,z.bi_buf),z.bi_buf=K>>16-z.bi_valid,z.bi_valid+=ca-16):(z.bi_buf|=K<<z.bi_valid&65535,z.bi_valid+=
ca)}function f(z,K,ca){l(z,ca[2*K],ca[2*K+1])}function m(z,K){for(var ca=0;ca|=1&z,z>>>=1,ca<<=1,0<--K;);return ca>>>1}function n(z,K,ca){var na,X=Array(16),ba=0;for(na=1;na<=15;na++)X[na]=ba=ba+ca[na-1]<<1;for(ca=0;ca<=K;ca++)na=z[2*ca+1],0!==na&&(z[2*ca]=m(X[na]++,na))}function q(z){var K;for(K=0;K<286;K++)z.dyn_ltree[2*K]=0;for(K=0;K<30;K++)z.dyn_dtree[2*K]=0;for(K=0;K<19;K++)z.bl_tree[2*K]=0;z.dyn_ltree[512]=1;z.opt_len=z.static_len=0;z.last_lit=z.matches=0}function t(z){8<z.bi_valid?k(z,z.bi_buf):
0<z.bi_valid&&(z.pending_buf[z.pending++]=z.bi_buf);z.bi_buf=0;z.bi_valid=0}function u(z,K,ca,na){var X=2*K,ba=2*ca;return z[X]<z[ba]||z[X]===z[ba]&&na[K]<=na[ca]}function v(z,K,ca){for(var na=z.heap[ca],X=ca<<1;X<=z.heap_len&&(X<z.heap_len&&u(K,z.heap[X+1],z.heap[X],z.depth)&&X++,!u(K,na,z.heap[X],z.depth));)z.heap[ca]=z.heap[X],ca=X,X<<=1;z.heap[ca]=na}function A(z,K,ca){var na,X,ba,ea,ma=0;if(0!==z.last_lit)for(;na=z.pending_buf[z.d_buf+2*ma]<<8|z.pending_buf[z.d_buf+2*ma+1],X=z.pending_buf[z.l_buf+
ma],ma++,0===na?f(z,X,K):(f(z,(ba=V[X])+256+1,K),0!==(ea=H[ba])&&l(z,X-=ha[ba],ea),f(z,ba=e(--na),ca),0!==(ea=P[ba])&&l(z,na-=sa[ba],ea)),ma<z.last_lit;);f(z,256,K)}function C(z,K){var ca,na,X,ba=K.dyn_tree,ea=K.stat_desc.static_tree,ma=K.stat_desc.has_stree,Ha=K.stat_desc.elems,pa=-1;z.heap_len=0;z.heap_max=573;for(ca=0;ca<Ha;ca++)0!==ba[2*ca]?(z.heap[++z.heap_len]=pa=ca,z.depth[ca]=0):ba[2*ca+1]=0;for(;z.heap_len<2;)ba[2*(X=z.heap[++z.heap_len]=pa<2?++pa:0)]=1,z.depth[X]=0,z.opt_len--,ma&&(z.static_len-=
ea[2*X+1]);K.max_code=pa;for(ca=z.heap_len>>1;1<=ca;ca--)v(z,ba,ca);for(X=Ha;ca=z.heap[1],z.heap[1]=z.heap[z.heap_len--],v(z,ba,1),na=z.heap[1],z.heap[--z.heap_max]=ca,z.heap[--z.heap_max]=na,ba[2*X]=ba[2*ca]+ba[2*na],z.depth[X]=(z.depth[ca]>=z.depth[na]?z.depth[ca]:z.depth[na])+1,ba[2*ca+1]=ba[2*na+1]=X,z.heap[1]=X++,v(z,ba,1),2<=z.heap_len;);z.heap[--z.heap_max]=z.heap[1];var za,rb,bb,Pb,Ia;ca=K.dyn_tree;na=K.max_code;X=K.stat_desc.static_tree;ea=K.stat_desc.has_stree;ma=K.stat_desc.extra_bits;
Ha=K.stat_desc.extra_base;var ob=K.stat_desc.max_length,hb=0;for(bb=0;bb<=15;bb++)z.bl_count[bb]=0;ca[2*z.heap[z.heap_max]+1]=0;for(K=z.heap_max+1;K<573;K++)ob<(bb=ca[2*ca[2*(za=z.heap[K])+1]+1]+1)&&(bb=ob,hb++),ca[2*za+1]=bb,na<za||(z.bl_count[bb]++,Pb=0,Ha<=za&&(Pb=ma[za-Ha]),Ia=ca[2*za],z.opt_len+=Ia*(bb+Pb),ea&&(z.static_len+=Ia*(X[2*za+1]+Pb)));if(0!==hb){do{for(bb=ob-1;0===z.bl_count[bb];)bb--;z.bl_count[bb]--;z.bl_count[bb+1]+=2;z.bl_count[ob]--;hb-=2}while(0<hb);for(bb=ob;0!==bb;bb--)for(za=
z.bl_count[bb];0!==za;)na<(rb=z.heap[--K])||(ca[2*rb+1]!==bb&&(z.opt_len+=(bb-ca[2*rb+1])*ca[2*rb],ca[2*rb+1]=bb),za--)}n(ba,pa,z.bl_count)}function x(z,K,ca){var na,X=-1,ba=K[1],ea=0,ma=7,Ha=4;0===ba&&(ma=138,Ha=3);K[2*(ca+1)+1]=65535;for(na=0;na<=ca;na++){var pa=ba;ba=K[2*(na+1)+1];++ea<ma&&pa===ba||(ea<Ha?z.bl_tree[2*pa]+=ea:0!==pa?(pa!==X&&z.bl_tree[2*pa]++,z.bl_tree[32]++):ea<=10?z.bl_tree[34]++:z.bl_tree[36]++,X=pa,Ha=(ea=0)===ba?(ma=138,3):pa===ba?(ma=6,3):(ma=7,4))}}function F(z,K,ca){var na,
X,ba=-1,ea=K[1],ma=0,Ha=7,pa=4;0===ea&&(Ha=138,pa=3);for(na=0;na<=ca;na++)if(X=ea,ea=K[2*(na+1)+1],!(++ma<Ha&&X===ea)){if(ma<pa)for(;f(z,X,z.bl_tree),0!=--ma;);else 0!==X?(X!==ba&&(f(z,X,z.bl_tree),ma--),f(z,16,z.bl_tree),l(z,ma-3,2)):ma<=10?(f(z,17,z.bl_tree),l(z,ma-3,3)):(f(z,18,z.bl_tree),l(z,ma-11,7));ba=X;pa=(ma=0)===ea?(Ha=138,3):X===ea?(Ha=6,3):(Ha=7,4)}}function w(z,K,ca,na){l(z,+!!na,3);t(z);k(z,ca);k(z,~ca);G.arraySet(z.pending_buf,z.window,K,ca,z.pending);z.pending+=ca}var G=c("../utils/common"),
H=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],P=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],T=Array(576);h(T);var L=Array(60);h(L);var ja=Array(512);h(ja);var V=Array(256);h(V);var ha=Array(29);h(ha);var Z,va,ia,sa=Array(30);h(sa);var M=!1;b._tr_init=function(z){if(!M){var K,ca,na,X=Array(16);for(na=ca=0;na<28;na++)for(ha[na]=ca,K=0;K<1<<H[na];K++)V[ca++]=na;V[ca-
1]=na;for(na=ca=0;na<16;na++)for(sa[na]=ca,K=0;K<1<<P[na];K++)ja[ca++]=na;for(ca>>=7;na<30;na++)for(sa[na]=ca<<7,K=0;K<1<<P[na]-7;K++)ja[256+ca++]=na;for(K=0;K<=15;K++)X[K]=0;for(K=0;K<=143;)T[2*K+1]=8,K++,X[8]++;for(;K<=255;)T[2*K+1]=9,K++,X[9]++;for(;K<=279;)T[2*K+1]=7,K++,X[7]++;for(;K<=287;)T[2*K+1]=8,K++,X[8]++;n(T,287,X);for(K=0;K<30;K++)L[2*K+1]=5,L[2*K]=m(K,5);Z=new p(T,H,257,286,15);va=new p(L,P,0,30,15);ia=new p([],B,0,19,7);M=!0}z.l_desc=new g(z.dyn_ltree,Z);z.d_desc=new g(z.dyn_dtree,
va);z.bl_desc=new g(z.bl_tree,ia);z.bi_buf=0;z.bi_valid=0;q(z)};b._tr_stored_block=w;b._tr_flush_block=function(z,K,ca,na){var X,ba,ea=0;0<z.level?(2===z.strm.data_type&&(z.strm.data_type=function(ma){var Ha,pa=4093624447;for(Ha=0;Ha<=31;Ha++,pa>>>=1)if(1&pa&&0!==ma.dyn_ltree[2*Ha])return 0;if(0!==ma.dyn_ltree[18]||0!==ma.dyn_ltree[20]||0!==ma.dyn_ltree[26])return 1;for(Ha=32;Ha<256;Ha++)if(0!==ma.dyn_ltree[2*Ha])return 1;return 0}(z)),C(z,z.l_desc),C(z,z.d_desc),ea=function(ma){var Ha;x(ma,ma.dyn_ltree,
ma.l_desc.max_code);x(ma,ma.dyn_dtree,ma.d_desc.max_code);C(ma,ma.bl_desc);for(Ha=18;3<=Ha&&0===ma.bl_tree[2*O[Ha]+1];Ha--);return ma.opt_len+=3*(Ha+1)+5+5+4,Ha}(z),X=z.opt_len+3+7>>>3,(ba=z.static_len+3+7>>>3)<=X&&(X=ba)):X=ba=ca+5;ca+4<=X&&-1!==K?w(z,K,ca,na):4===z.strategy||ba===X?(l(z,2+ +!!na,3),A(z,T,L)):(l(z,4+ +!!na,3),function(ma,Ha,pa,za){var rb;l(ma,Ha-257,5);l(ma,pa-1,5);l(ma,za-4,4);for(rb=0;rb<za;rb++)l(ma,ma.bl_tree[2*O[rb]+1],3);F(ma,ma.dyn_ltree,Ha-1);F(ma,ma.dyn_dtree,pa-1)}(z,z.l_desc.max_code+
1,z.d_desc.max_code+1,ea+1),A(z,z.dyn_ltree,z.dyn_dtree));q(z);na&&t(z)};b._tr_tally=function(z,K,ca){return z.pending_buf[z.d_buf+2*z.last_lit]=K>>>8&255,z.pending_buf[z.d_buf+2*z.last_lit+1]=255&K,z.pending_buf[z.l_buf+z.last_lit]=255&ca,z.last_lit++,0===K?z.dyn_ltree[2*ca]++:(z.matches++,K--,z.dyn_ltree[2*(V[ca]+256+1)]++,z.dyn_dtree[2*e(K)]++),z.last_lit===z.lit_bufsize-1};b._tr_align=function(z){l(z,2,3);f(z,256,T);16===z.bi_valid?(k(z,z.bi_buf),z.bi_buf=0,z.bi_valid=0):8<=z.bi_valid&&(z.pending_buf[z.pending++]=
255&z.bi_buf,z.bi_buf>>=8,z.bi_valid-=8)}},{"../utils/common":41}],53:[function(c,d,b){d.exports=function(){this.input=null;this.total_in=this.avail_in=this.next_in=0;this.output=null;this.total_out=this.avail_out=this.next_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}},{}],54:[function(c,d,b){(function(h){!function(p,g){function e(x){delete t[x]}function k(x){if(u)setTimeout(k,0,x);else{var F=t[x];if(F){u=!0;try{var w=F.callback,G=F.args;switch(G.length){case 0:w();break;case 1:w(G[0]);
break;case 2:w(G[0],G[1]);break;case 3:w(G[0],G[1],G[2]);break;default:w.apply(g,G)}}finally{e(x),u=!1}}}}function l(x){x.source===p&&"string"==typeof x.data&&0===x.data.indexOf(n)&&k(+x.data.slice(n.length))}if(!p.setImmediate){var f,m,n,q=1,t={},u=!1,v=p.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(p);A=A&&A.setTimeout?A:p;var C="[object process]"==={}.toString.call(p.process)?function(x){ig.nextTick(function(){k(x)})}:function(){if(p.postMessage&&!p.importScripts){var x=!0,F=p.onmessage;
return p.onmessage=function(){x=!1},p.postMessage("","*"),p.onmessage=F,x}}()?(n="setImmediate$"+Math.random()+"$",p.addEventListener?p.addEventListener("message",l,!1):p.attachEvent("onmessage",l),function(x){p.postMessage(n+x,"*")}):p.MessageChannel?((m=new MessageChannel).port1.onmessage=function(x){k(x.data)},function(x){m.port2.postMessage(x)}):v&&"onreadystatechange"in v.createElement("script")?(f=v.documentElement,function(x){var F=v.createElement("script");F.onreadystatechange=function(){k(x);
F.onreadystatechange=null;f.removeChild(F);F=null};f.appendChild(F)}):function(x){setTimeout(k,0,x)};A.setImmediate=function(x){"function"!=typeof x&&(x=Function(""+x));for(var F=Array(arguments.length-1),w=0;w<F.length;w++)F[w]=arguments[w+1];return t[q]={callback:x,args:F},C(q),q++};A.clearImmediate=e}}("u"<typeof self?void 0===h?this:h:self)}).call(this,void 0!==Pc?Pc:"u">typeof self?self:"u">typeof window?window:{})},{}]},{},[10])(10);var Td={};Td=JSON.parse('{"Dodge (tool)":"Dodge","Burn (tool)":"Burn","Color (picker)":"Color","Color swatches (shorter)":"Swatches"}');
let Le={ja:JSON.parse('{"File":"\u30d5\u30a1\u30a4\u30eb","Export as png":"PNG\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9","Save the PNG image, CHI project file, and swatches file together as a ZIP package":"\u753b\u50cf\u3068\u56fa\u6709\u5f62\u5f0f\u30d5\u30a1\u30a4\u30eb\u3092ZIP\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3059","Export as zip":"ZIP\u3067\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9","Backup to browser storage":"\u30d0\u30c3\u30af\u30a2\u30c3\u30d7\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58","Saved to your browser\'s storage.":"\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3057\u307e\u3057\u305f\u3002","Save the current drawing to the browser\'s local database":"\u73fe\u5728\u306e\u753b\u50cf\u3092\u30d6\u30e9\u30a6\u30b6\u306e\u30ed\u30fc\u30ab\u30eb\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4fdd\u5b58\u3057\u307e\u3059","Post Oekaki":"\u6295\u7a3f\u3059\u308b","Finish drawing and post to the server":"\u4f5c\u753b\u3092\u7d42\u4e86\u3057\u3066\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3057\u307e\u3059","Edit":"\u7de8\u96c6","Undo":"\u53d6\u308a\u6d88\u3057","Redo":"\u3084\u308a\u76f4\u3057","Cut":"\u5207\u308a\u53d6\u308a","Copy":"\u30b3\u30d4\u30fc","Clear history":"\u5c65\u6b74\u6d88\u53bb","Copy merged":"\u7d50\u5408\u30b3\u30d4\u30fc","Paste":"\u8cbc\u308a\u4ed8\u3051","Select all":"\u3059\u3079\u3066\u9078\u629e","Deselect":"\u9078\u629e\u89e3\u9664","Transform":"\u5909\u5f62","Selection":"\u9078\u629e\u7bc4\u56f2","Constrain":"\u7e26\u6a2a\u6bd4\u3092\u7dad\u6301","Layers":"\u30ec\u30a4\u30e4\u30fc","Duplicate":"\u8907\u88fd","Merge down":"\u4e0b\u306e\u30ec\u30a4\u30e4\u30fc\u3068\u7d50\u5408","Merge group":"\u30b0\u30eb\u30fc\u30d7\u7d50\u5408","Merge all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u7d50\u5408","Create merged layer":"\u7d50\u5408\u30ec\u30a4\u30e4\u30fc\u3092\u8ffd\u52a0","Add layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u8ffd\u52a0","Delete mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u524a\u9664","Delete layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u524a\u9664","Apply mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u9069\u7528","Apply layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u9069\u7528","Disable mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u7121\u52b9\u5316","Enable mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u6709\u52b9\u5316","Clip to the layer below":"\u4e0b\u306e\u30ec\u30a4\u30e4\u30fc\u3067\u30af\u30ea\u30c3\u30d4\u30f3\u30b0","Unclip from the layer below":"\u30af\u30ea\u30c3\u30d4\u30f3\u30b0\u89e3\u9664","Effects":"\u52b9\u679c","Clear":"\u6d88\u53bb","Clear with texture":"\u30c6\u30af\u30b9\u30c1\u30e3\u3067\u6d88\u53bb","Fill":"\u5857\u308a\u6f70\u3057","Flip horizontal":"\u5de6\u53f3\u53cd\u8ee2","Flip vertical":"\u4e0a\u4e0b\u53cd\u8ee2","Invert":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Convert brightness to opacity":"\u8f1d\u5ea6\u3092\u900f\u660e\u5ea6\u306b\u5909\u63db","Box blur...":"\u307c\u304b\u3057","Box blur":"\u307c\u304b\u3057","Blur amount":"\u307c\u304b\u3057\u91cf","Iterations (1~8, larger gives smoother blur)":"\u53cd\u5fa9 (1~8,\u5927\u304d\u3044\u307b\u3069\u307c\u304b\u3057\u304c\u6ed1\u3089\u304b)","Mosaic":"\u30e2\u30b6\u30a4\u30af","Block size":"\u30d6\u30ed\u30c3\u30af\u30b5\u30a4\u30ba","Color halftone":"\u30ab\u30e9\u30fc\u30cf\u30fc\u30d5\u30c8\u30fc\u30f3","Mono halftone":"\u5358\u8272\u30cf\u30fc\u30d5\u30c8\u30fc\u30f3","Dot size":"\u30c9\u30c3\u30c8\u30b5\u30a4\u30ba","Chromatic aberration":"\u8272\u53ce\u5dee (RGB\u305a\u3089\u3057)","Offset X":"\u6a2a\u65b9\u5411 X","Offset Y":"\u7e26\u65b9\u5411 Y","Apply to all (create merged layer)":"\u5168\u4f53\u306b\u9069\u7528 (\u7d50\u5408\u30ec\u30a4\u30e4\u30fc\u3092\u8ffd\u52a0)","Edge expand":"\u7e01\u53d6\u308a","Edge expand width":"\u7e01\u306e\u5e45","Fill Inside with edge color":"\u7e01\u306e\u8272\u3067\u5185\u5074\u3092\u5857\u308a\u6f70\u3059","Monochromatic noise":"\u5358\u8272\u30ce\u30a4\u30ba","Color noise":"\u30ab\u30e9\u30fc\u30ce\u30a4\u30ba","View":"\u8868\u793a","Full-screen mode":"\u30d5\u30eb\u30b9\u30af\u30ea\u30fc\u30f3\u30e2\u30fc\u30c9","Zoom in":"\u62e1\u5927","Zoom out":"\u7e2e\u5c0f","Zoom 100%":"100%","Reset Rotation":"\u56de\u8ee2\u3092\u30ea\u30bb\u30c3\u30c8","Smooth-out zoomed canvas":"\u30ba\u30fc\u30e0\u3092\u306a\u3081\u3089\u304b\u306b\u8868\u793a\u3059\u308b","Show grid":"\u30b0\u30ea\u30c3\u30c9\u3092\u8868\u793a","Grid options...":"\u30b0\u30ea\u30c3\u30c9\u306e\u8a2d\u5b9a","Palettes":"\u30d1\u30ec\u30c3\u30c8","Rearrange":"\u521d\u671f\u5316","Toggle palettes":"\u8868\u793a\u975e\u8868\u793a\u5207\u308a\u66ff\u3048","Mobile mode":"\u30e2\u30d0\u30a4\u30eb\u30e2\u30fc\u30c9","PC mode":"PC\u30e2\u30fc\u30c9","Use old icons":"\u53e4\u3044\u30a2\u30a4\u30b3\u30f3","Show tool options":"\u30c4\u30fc\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3","Show color":"\u30ab\u30e9\u30fc","Show layers":"\u30ec\u30a4\u30e4\u30fc","Show misc":"\u64cd\u4f5c","Show stroke":"\u30b9\u30c8\u30ed\u30fc\u30af","Show swatches":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Show textures":"\u30c6\u30af\u30b9\u30c1\u30e3","Show tools":"\u30c4\u30fc\u30eb","Help":"\u30d8\u30eb\u30d7","Tablet support":"\u30bf\u30d6\u30ec\u30c3\u30c8\u30b5\u30dd\u30fc\u30c8","Shortcuts":"\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8","About":"litaChix\u306b\u3064\u3044\u3066","Removes all undo/redo information to regain memory":"\u5c65\u6b74\u3092\u30af\u30ea\u30a2\u3057\u3066\u30e1\u30e2\u30ea\u3092\u958b\u653e\u3057\u307e\u3059","Clears the selected area":"\u6d88\u53bb","Invert the image colors":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Blur effect":"\u307c\u304b\u3057\u30d5\u30a3\u30eb\u30bf","Fills the selection with noise":"\u5358\u8272\u30ce\u30a4\u30ba\u3067\u5857\u308a\u6f70\u3057","Fills the selection with colored noise":"\u30ab\u30e9\u30fc\u30ce\u30a4\u30ba\u3067\u5857\u308a\u6f70\u3057","Linear interpolation is used to give a smoothed looked to the picture when zoomed in":"\u753b\u50cf\u306e\u62e1\u5927\u6642\u306b\u88dc\u5b8c\u3057\u3066\u6ed1\u3089\u304b\u306b\u8868\u793a\u3057\u307e\u3059","Rearrange the palette windows":"\u30d1\u30ec\u30c3\u30c8\u3092\u518d\u914d\u7f6e","Hides or shows all palettes":"\u30d1\u30ec\u30c3\u30c8\u306e\u8868\u793a/\u975e\u8868\u793a","You\'re about to clear the current Undo/Redo history.\\nThis operation cannot be undone, are you sure you want to do that?":"\u30a2\u30f3\u30c9\u30a5\u30fb\u30ea\u30c9\u30a5\u306e\u5c65\u6b74\u3092\u6d88\u53bb\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u307e\u3059\u3002\\n\u3053\u306e\u64cd\u4f5c\u306f\u5143\u306b\u623b\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u305b\u3093\u3002\u672c\u5f53\u306b\u5b9f\u884c\u3057\u307e\u3059\u304b?","Misc":"\u64cd\u4f5c","Round Pixelated":"\u5186\u30d4\u30af\u30bb\u30eb","Round Hard Edge":"\u5186\u30cf\u30fc\u30c9\u30a8\u30c3\u30b8","Round Soft":"\u5186\u30bd\u30d5\u30c8","Square Pixelated":"\u89d2\u30d4\u30af\u30bb\u30eb","Square Hard Edge":"\u89d2\u30cf\u30fc\u30c9\u30a8\u30c3\u30b8","Color (picker)":"\u30ab\u30e9\u30fc","Tool options":"\u30c4\u30fc\u30eb\u30aa\u30d7\u30b7\u30e7\u30f3","Brush size":"\u30d6\u30e9\u30b7\u30b5\u30a4\u30ba","Opacity":"\u4e0d\u900f\u660e\u5ea6","Color":"\u8272\u88dc\u5145","Blend":"\u6df7\u8272","Spacing":"\u9593\u9694","Scattering":"\u6563\u4e71","Smoothing":"\u624b\u3076\u308c\u88dc\u6b63","Rotation":"\u89d2\u5ea6","Color swatches":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Color swatches (shorter)":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Remove":"\u524a\u9664","Replace with current color":"\u9078\u629e\u4e2d\u306e\u8272\u306b\u7f6e\u304d\u63db\u3048","Save swatches to your computer...":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8\u3092PC\u306b\u4fdd\u5b58","Load swatches from your computer...":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8\u3092PC\u304b\u3089\u8aad\u307f\u8fbc\u307f","Add the current brush color as a new swatch":"\u9078\u629e\u4e2d\u306e\u8272\u3092\u8ffd\u52a0","Refer all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u53c2\u7167","Blend all layers":"\u5168\u30ec\u30a4\u30e4\u30fc\u6df7\u5408","Lock transparency":"\u900f\u660e\u90e8\u5206\u3092\u4fdd\u8b77","Textures":"\u30c6\u30af\u30b9\u30c1\u30e3","Customize":"\u30ab\u30b9\u30bf\u30de\u30a4\u30ba","Inverse":"\u30cd\u30ac\u30dd\u30b8\u53cd\u8ee2","Mirror":"\u5de6\u53f3\u53cd\u8ee2","Brightness":"\u8f1d\u5ea6","Contrast":"\u30b3\u30f3\u30c8\u30e9\u30b9\u30c8","Scale":"\u62e1\u5927\u7387","Reset":"\u30ea\u30bb\u30c3\u30c8","Layer blending mode":"\u5408\u6210\u30e2\u30fc\u30c9","Normal":"\u901a\u5e38","Multiply":"\u4e57\u7b97","Add":"\u52a0\u7b97","Screen":"\u30b9\u30af\u30ea\u30fc\u30f3","Lighten":"\u6bd4\u8f03(\u660e)","Darken":"\u6bd4\u8f03(\u6697)","Subtract":"\u6e1b\u7b97","Dodge":"\u8986\u3044\u713c\u304d","Burn":"\u713c\u304d\u8fbc\u307f","Overlay":"\u30aa\u30fc\u30d0\u30fc\u30ec\u30a4","Hard Light":"\u30cf\u30fc\u30c9\u30e9\u30a4\u30c8","Soft Light":"\u30bd\u30d5\u30c8\u30e9\u30a4\u30c8","Vivid Light":"\u30d3\u30d3\u30c3\u30c9\u30e9\u30a4\u30c8","Linear Light":"\u30ea\u30cb\u30a2\u30e9\u30a4\u30c8","Pin Light":"\u30d4\u30f3\u30e9\u30a4\u30c8","Passthrough":"\u901a\u904e","Stroke":"\u30b9\u30c8\u30ed\u30fc\u30af","Free-hand":"\u30d5\u30ea\u30fc\u30cf\u30f3\u30c9","Straight line":"\u76f4\u7dda","Bezier curve":"Bz\uff08\u30d9\u30b8\u30a7\uff09\u66f2\u7dda","Tools":"\u30c4\u30fc\u30eb","Marquee":"\u9078\u629e\u7bc4\u56f2","Move tool":"\u79fb\u52d5","Flood fill":"\u30d0\u30b1\u30c4\u5857\u308a","Grow fill area":"\u9818\u57df\u62e1\u5f35","Gradient fill":"\u30b0\u30e9\u30c7\u30fc\u30b7\u30e7\u30f3","Color picker":"\u30b9\u30dd\u30a4\u30c8","Rotate canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u56de\u8ee2","Grab canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u4f4d\u7f6e","Pencil":"\u925b\u7b46","Pen":"\u30da\u30f3","Airbrush":"\u30a8\u30a2\u30d6\u30e9\u30b7","Waterpaint":"\u6c34\u5f69","Eraser":"\u6d88\u3057\u30b4\u30e0","Soft eraser":"\u8584\u6d88\u3057","Smudge":"\u6307\u5148","Blender":"\u6df7\u8272","Dodge (tool)":"\u8986\u3044\u713c\u304d","Burn (tool)":"\u713c\u304d\u8fbc\u307f","Blur":"\u307c\u304b\u3057","Grid options":"\u30b0\u30ea\u30c3\u30c9\u306e\u8a2d\u5b9a","Grid size":"\u30b0\u30ea\u30c3\u30c9\u30b5\u30a4\u30ba","Rename...":"\u540d\u524d\u3092\u5909\u66f4","Add layer":"\u65b0\u898f\u30ec\u30a4\u30e4\u30fc","Delete layer":"\u30ec\u30a4\u30e4\u30fc\u524a\u9664","Add group":"\u65b0\u898f\u30b0\u30eb\u30fc\u30d7","Delete group":"\u30b0\u30eb\u30fc\u30d7\u524a\u9664","Add mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af\u8ffd\u52a0","Gradient":"\u30b0\u30e9\u30c7\u30fc\u30b7\u30e7\u30f3\u4f5c\u6210","Zoom and Rotate":"\u30ba\u30fc\u30e0\u3068\u56de\u8ee2","Reset View":"\u8868\u793a\u3092\u521d\u671f\u5316","Transform style":"\u5909\u5f62\u30b9\u30bf\u30a4\u30eb","Apply transform":"\u5909\u5f62\u78ba\u5b9a","Complete transform":"\u5909\u5f62\u3092\u5b8c\u4e86","Undo transform":"\u53d6\u308a\u6d88\u3057","You need to finish transforming this layer before you can do that. What would you like to do with the transform?":"\u7d9a\u884c\u3059\u308b\u305f\u3081\u306b\u5909\u5f62\u3092\u5b8c\u4e86\u3057\u307e\u3059\u3002","Smooth":"\u30b9\u30e0\u30fc\u30ba","Sharp":"\u30b7\u30e3\u30fc\u30d7","Opacity: ":"\u4e0d\u900f\u660e\u5ea6:","Please enter a color in hex format":"16\u9032\u5f62\u5f0f\u3067\u8272\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff08#xxxxxx\u306e\u5f62\uff09","Cancel":"\u30ad\u30e3\u30f3\u30bb\u30eb","Ok":"OK","Okay":"OK","OK":"OK","Whoops! This layer is currently hidden":"\u975e\u8868\u793a\u30ec\u30a4\u30e4\u30fc\u3067\u3059\u3002","Whoops! This layer\'s opacity is currently 0%":"\u30ec\u30a4\u30e4\u30fc\u306e\u4e0d\u900f\u660e\u5ea6\u304c0%\u3067\u3059","Whoops! You can\'t draw on a group":"\u30b0\u30eb\u30fc\u30d7\u30d5\u30a9\u30eb\u30c0\u306b\u306f\u63cf\u3051\u307e\u305b\u3093","Whoops! All of the selected pixels are transparent!":"\u30ec\u30a4\u30e4\u30fc\u304c\u7a7a\u3067\u3059","Image":"\u753b\u50cf","Layer mask":"\u30ec\u30a4\u30e4\u30fc\u30de\u30b9\u30af","Sorry, you can\'t remove the last remaining layer in the drawing.":"\u6700\u5f8c\u306e1\u3064\u306a\u306e\u3067\u524a\u9664\u3067\u304d\u307e\u305b\u3093\u3002","Are you sure you want to send your drawing to the server and finish drawing now?":"\u753b\u50cf\u3092\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3057\u307e\u3059\u3002\u7d42\u4e86\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f","Your drawing has unsaved changes! Are you sure to want to navigate away?":"\u753b\u50cf\u306b\u672a\u4fdd\u5b58\u306e\u5909\u66f4\u304c\u3042\u308a\u307e\u3059\u3002\u7d42\u4e86\u3057\u3066\u3082\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f","Many of the menu options and painting tools have keyboard shortcuts which are written next to them or appear when you hover.":"\u5229\u7528\u53ef\u80fd\u306a\u30ad\u30fc\u30dc\u30fc\u30c9\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u306e\u3044\u304f\u3064\u304b\u306f\u30e1\u30cb\u30e5\u30fc\u306e\u6a2a\u3084\u30c4\u30fc\u30eb\u30c1\u30c3\u30d7\u306b\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\u3002","Here are some other shortcuts which are not as obvious!":"\u3053\u306e\u4e00\u89a7\u306f\u305d\u308c\u4ee5\u5916\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u3092\u307e\u3068\u3081\u305f\u3082\u306e\u3067\u3059\u3002","Right":"\u53f3","Left":"\u5de6","Middle":"\u4e2d","or":"\u307e\u305f\u306f","Double click":"\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af","Color swatches palette":"\u30ab\u30e9\u30fc\u30bb\u30c3\u30c8","Use as the drawing color":"\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u53d6\u5f97","Remove or replace a color swatch":"\u30d1\u30ec\u30c3\u30c8\u306e\u5909\u66f4\uff65\u524a\u9664","Line drawing mode":"\u76f4\u7dda\u30e2\u30fc\u30c9","Snap line to nearest 45 degrees":"45\u00b0\u5358\u4f4d\u3067\u30b9\u30ca\u30c3\u30d7","Painting tools":"\u30c4\u30fc\u30eb","Change brush opacity":"\u30d6\u30e9\u30b7\u306e\u4e0d\u900f\u660e\u5ea6","Change brush size":"\u30d6\u30e9\u30b7\u30b5\u30a4\u30ba","Brush palette":"\u30d6\u30e9\u30b7\u30d1\u30ec\u30c3\u30c8","Adjust brush sliders more precisely":"\u30d6\u30e9\u30b7\u30b9\u30e9\u30a4\u30c0\u30fc\u3092\u3088\u308a\u7d30\u304b\u304f\u8abf\u6574","Drawing canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9","Move the canvas around":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u79fb\u52d5","Rotate the canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u56de\u8ee2","Zoom":"\u30ba\u30fc\u30e0","Zoom the canvas":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u62e1\u5927\u7e2e\u5c0f","Sample the color under the cursor":"\u30ad\u30e3\u30f3\u30d0\u30b9\u306e\u8272\u3092\u30b9\u30dd\u30a4\u30c8","Flip View Horizontal":"\u8868\u793a\u306e\u5de6\u53f3\u53cd\u8ee2","Layers palette":"\u30ec\u30a4\u30e4\u30fc\u30d1\u30ec\u30c3\u30c8","Rename layer":"\u30ec\u30a4\u30e4\u30fc\u540d\u5909\u66f4","Toggle mask enable/disable":"\u30de\u30b9\u30af\u306e\u6709\u52b9/\u7121\u52b9\u5207\u308a\u66ff\u3048","Toggle mask View":"\u30de\u30b9\u30af\u306e\u8868\u793a/\u975e\u8868\u793a\u5207\u308a\u66ff\u3048","Save Oekaki":"\u4fdd\u5b58","Saving drawing...":"\u753b\u50cf\u3092\u4fdd\u5b58\u4e2d\u2026","Preparing your drawing to be saved, please wait...":"\u753b\u50cf\u3092\u4fdd\u5b58\u3059\u308b\u6e96\u5099\u3092\u3057\u3066\u3044\u307e\u3059\u3002\u3057\u3070\u3089\u304f\u304a\u5f85\u3061\u304f\u3060\u3055\u3044\u2026","Drawing saved!":"\u753b\u50cf\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\uff01","Your drawing has been saved, would you like to post it to the forum now?":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u30d5\u30a9\u30fc\u30e9\u30e0\u3078\u6295\u7a3f\u3057\u307e\u3059\u304b\uff1f","Yes, post it now":"\u306f\u3044\u3001\u6295\u7a3f\u3057\u307e\u3059","No, keep drawing":"\u307e\u3060\u63cf\u304d\u307e\u3059","No, quit and I\'ll finish it later":"\u30a2\u30d7\u30ea\u3092\u7d42\u4e86\u3057\u3066\u7d9a\u304d\u3092\u5f8c\u3067\u63cf\u304f","Your drawing has been saved, would you like to view it on the forum now?":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u30d5\u30a9\u30fc\u30e9\u30e0\u3078\u6295\u7a3f\u3057\u307e\u3059\u304b\uff1f","Yes, view the post":"\u306f\u3044\u3001\u6295\u7a3f\u3057\u307e\u3059\u3002","Your drawing has been saved, redirecting you to view your new post now...":"\u753b\u50cf\u306e\u4fdd\u5b58\u306b\u6210\u529f\u3057\u307e\u3057\u305f\u3002\u6295\u7a3f\u5148\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002","Sorry, your drawing could not be saved, Please see the error message.":"\u753b\u50cf\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30a8\u30e9\u30fc\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002","Sorry, your drawing could not be saved, please try again later.":"\u753b\u50cf\u3092\u4fdd\u5b58\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u6642\u9593\u3092\u7f6e\u3044\u3066\u518d\u5ea6\u6295\u7a3f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002","The error returned from the server was":"\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u8fd4\u3063\u3066\u6765\u305f\u30a8\u30e9\u30fc","The file size exceeds the server limit.":"\u30d5\u30a1\u30a4\u30eb\u30b5\u30a4\u30ba\u304c\u30b5\u30fc\u30d0\u30fc\u306e\u4e0a\u9650\u3092\u8d85\u3048\u3066\u3044\u307e\u3059\u3002","The total size of FormData is within the acceptable range.":"FormData\u306e\u5408\u8a08\u30b5\u30a4\u30ba\u306f\u5236\u9650\u7bc4\u56f2\u5185\u3067\u3059\u3002","Limit size":"\u4e0a\u9650\u30b5\u30a4\u30ba","Current size":"\u73fe\u5728\u306e\u30b5\u30a4\u30ba","Network response was not OK":"\u901a\u4fe1\u30a8\u30e9\u30fc","HTTP status code":"HTTP\u30b9\u30c6\u30fc\u30bf\u30b9\u30b3\u30fc\u30c9","Unsaved data was detected.\\nInterrupt image loading and restore it?":"\u672a\u4fdd\u5b58\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u3059\u3002\\n\u753b\u50cf\u306e\u8aad\u307f\u8fbc\u307f\u3092\u4e2d\u65ad\u3057\u3066\u5fa9\u5143\u3057\u307e\u3059\u304b\uff1f","Unsaved data was detected. Would you like to restore it?":"\u672a\u4fdd\u5b58\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u3059\u3002\u5fa9\u5143\u3057\u307e\u3059\u304b\uff1f"}'),
en:Td},Sd=Td,Me="en";Cd.prototype=Object.create(Ja(Ib).prototype);Cd.prototype.constructor=Cd;var zb={};zb=function(){function c(r,y){return y&&`${y}::${Ic++}`||r.uidEvent||Ic++}function d(r){let y=c(r);return r.uidEvent=y,oc[y]=oc[y]||{},oc[y]}function b(r,y,J=null){return Object.values(r).find(R=>R.callable===y&&R.delegationSelector===J)}function h(r,y,J){let R="string"==typeof y,fa=e(r);return fc.has(fa)||(fa=r),[R,R?J:y||J,fa]}function p(r,y,J,R,fa){var ra,Ba;if("string"==typeof y&&r){var [Da,
Ra,Xa]=h(y,J,R);if(y in Wc){let Sa;Sa=Ra;Ra=function(Ea){if(!Ea.relatedTarget||Ea.relatedTarget!==Ea.delegateTarget&&!Ea.delegateTarget.contains(Ea.relatedTarget))return Sa.call(this,Ea)}}R=d(r);R=R[Xa]||(R[Xa]={});var ua=b(R,Ra,Da?J:null);if(ua)return void(ua.oneOff=ua.oneOff&&fa);y=c(Ra,y.replace(xc,""));ua=Da?(ra=Ra,function Ya(Ea){let Wa=r.querySelectorAll(J);for(let {target:Ta}=Ea;Ta&&Ta!==this;Ta=Ta.parentNode)for(let Ua of Wa)if(Ua===Ta)return k(Ea,{delegateTarget:Ta}),Ya.oneOff&&qa.off(r,
Ea.type,J,ra),ra.apply(Ta,[Ea])}):(Ba=Ra,function Wa(Ya){return k(Ya,{delegateTarget:r}),Wa.oneOff&&qa.off(r,Ya.type,Ba),Ba.apply(r,[Ya])});ua.delegationSelector=Da?J:null;ua.callable=Ra;ua.oneOff=fa;ua.uidEvent=y;R[y]=ua;r.addEventListener(Xa,ua,Da)}}function g(r,y,J,R,fa){(R=b(y[J],R,fa))&&(r.removeEventListener(J,R,!!fa),delete y[J][R.uidEvent])}function e(r){return Wc[r=r.replace(kb,"")]||r}function k(r,y={}){for(let [J,R]of Object.entries(y))try{r[J]=R}catch(fa){Object.defineProperty(r,J,{configurable:!0,
get:()=>R})}return r}function l(r){if("true"===r)return!0;if("false"===r)return!1;if(r===Number(r).toString())return Number(r);if(""===r||"null"===r)return null;if("string"!=typeof r)return r;try{return JSON.parse(decodeURIComponent(r))}catch(y){return r}}function f(r){return r.replace(/[A-Z]/g,y=>`-${y.toLowerCase()}`)}function m(r){return r?(r.nodeName||"").toLowerCase():null}function n(r){return null==r?window:"[object Window]"!==r.toString()?(r=r.ownerDocument)&&r.defaultView||window:r}function q(r){return r instanceof
n(r).Element||r instanceof Element}function t(r){return r instanceof n(r).HTMLElement||r instanceof HTMLElement}function u(r){return"u">typeof ShadowRoot&&(r instanceof n(r).ShadowRoot||r instanceof ShadowRoot)}function v(r){return r.split("-")[0]}function A(){var r=navigator.userAgentData;return null!=r&&r.brands&&Array.isArray(r.brands)?r.brands.map(function(y){return y.brand+"/"+y.version}).join(" "):navigator.userAgent}function C(){return!/^((?!chrome|android).)*safari/i.test(A())}function x(r,
y,J){void 0===y&&(y=!1);void 0===J&&(J=!1);var R=r.getBoundingClientRect(),fa=1,ra=1;y&&t(r)&&(fa=r.offsetWidth>0&&wc(R.width)/r.offsetWidth||1,ra=r.offsetHeight>0&&wc(R.height)/r.offsetHeight||1);r=(q(r)?n(r):window).visualViewport;y=!C()&&J;J=(R.left+(y&&r?r.offsetLeft:0))/fa;r=(R.top+(y&&r?r.offsetTop:0))/ra;fa=R.width/fa;R=R.height/ra;return{width:fa,height:R,top:r,right:J+fa,bottom:r+R,left:J,x:J,y:r}}function F(r){var y=x(r),J=r.offsetWidth,R=r.offsetHeight;return 1>=Math.abs(y.width-J)&&(J=
y.width),1>=Math.abs(y.height-R)&&(R=y.height),{x:r.offsetLeft,y:r.offsetTop,width:J,height:R}}function w(r,y){var J=y.getRootNode&&y.getRootNode();if(r.contains(y))return!0;if(J&&u(J)){do{if(y&&r.isSameNode(y))return!0;y=y.parentNode||y.host}while(y)}return!1}function G(r){return n(r).getComputedStyle(r)}function H(r){return((q(r)?r.ownerDocument:r.document)||window.document).documentElement}function P(r){return"html"===m(r)?r:r.assignedSlot||r.parentNode||(u(r)?r.host:null)||H(r)}function B(r){return t(r)&&
"fixed"!==G(r).position?r.offsetParent:null}function O(r){for(var y=n(r),J=B(r);J&&["table","td","th"].indexOf(m(J))>=0&&"static"===G(J).position;)J=B(J);if(!J||"html"!==m(J)&&("body"!==m(J)||"static"!==G(J).position)){if(!J)a:{J=/firefox/i.test(A());if(!/Trident/i.test(A())||!t(r)||"fixed"!==G(r).position)for(r=P(r),u(r)&&(r=r.host);t(r)&&0>["html","body"].indexOf(m(r));){var R=G(r);if("none"!==R.transform||"none"!==R.perspective||"paint"===R.contain||-1!==["transform","perspective"].indexOf(R.willChange)||
J&&"filter"===R.willChange||J&&R.filter&&"none"!==R.filter){J=r;break a}r=r.parentNode}J=null}y=J||y}return y}function T(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function L(r){return Object.assign({},{top:0,right:0,bottom:0,left:0},r)}function ja(r,y){return y.reduce(function(J,R){return J[R]=r,J},{})}function V(r){return r.split("-")[1]}function ha(r){var y,J=r.popper,R=r.popperRect,fa=r.placement,ra=r.variation,Ba=r.offsets,Da=r.position,Ra=r.gpuAcceleration,Xa=r.adaptive,ua=r.roundOffsets,
Sa=r.isFixed;r=Ba.x;r=void 0===r?0:r;var Ea=Ba.y;Ea=void 0===Ea?0:Ea;Ea="function"==typeof ua?ua({x:r,y:Ea}):{x:r,y:Ea};r=Ea.x;Ea=Ea.y;var Ya=Ba.hasOwnProperty("x");Ba=Ba.hasOwnProperty("y");var Wa="left",Ta="top",Ua=window;if(Xa){var Za=O(J),Db="clientHeight",cb="clientWidth";Za===n(J)&&"static"!==G(Za=H(J)).position&&"absolute"===Da&&(Db="scrollHeight",cb="scrollWidth");("top"===fa||(fa==="left"||fa==="right")&&"end"===ra)&&(Ta="bottom",Ea-=(Sa&&Za===Ua&&Ua.visualViewport?Ua.visualViewport.height:
Za[Db])-R.height,Ea*=Ra?1:-1);fa!=="left"&&("top"!==fa&&fa!=="bottom"||"end"!==ra)||(Wa="right",r-=(Sa&&Za===Ua&&Ua.visualViewport?Ua.visualViewport.width:Za[cb])-R.width,r*=Ra?1:-1)}var Oa,sb,tb,Eb,ub,pb;R=Object.assign({position:Da},Xa&&Ed);ua=!0===ua?(Oa={x:r,y:Ea},sb=n(J),tb=Oa.x,Eb=Oa.y,{x:wc(tb*(ub=sb.devicePixelRatio||1))/ub||0,y:wc(Eb*ub)/ub||0}):{x:r,y:Ea};return r=ua.x,Ea=ua.y,Ra?Object.assign({},R,((pb={})[Ta]=Ba?"0":"",pb[Wa]=Ya?"0":"",pb.transform=1>=(Ua.devicePixelRatio||1)?"translate("+
r+"px, "+Ea+"px)":"translate3d("+r+"px, "+Ea+"px, 0)",pb)):Object.assign({},R,((y={})[Ta]=Ba?Ea+"px":"",y[Wa]=Ya?r+"px":"",y.transform="",y))}function Z(r){return r.replace(/left|right|bottom|top/g,function(y){return Yd[y]})}function va(r){return r.replace(/start|end/g,function(y){return Nc[y]})}function ia(r){r=n(r);return{scrollLeft:r.pageXOffset,scrollTop:r.pageYOffset}}function sa(r){return x(H(r)).left+ia(r).scrollLeft}function M(r){r=G(r);return/auto|scroll|overlay|hidden/.test(r.overflow+r.overflowY+
r.overflowX)}function z(r,y){void 0===y&&(y=[]);var J,R=function Ba(ra){return["html","body","#document"].indexOf(m(ra))>=0?ra.ownerDocument.body:t(ra)&&M(ra)?ra:Ba(P(ra))}(r);r=R===(null==(J=r.ownerDocument)?void 0:J.body);J=n(R);R=r?[J].concat(J.visualViewport||[],M(R)?R:[]):R;y=y.concat(R);return r?y:y.concat(z(P(R)))}function K(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function ca(r,y,J){var R,fa,ra,Ba,Da,Ra,Xa;if(y==="viewport"){y=n(r);var ua=H(r);
y=y.visualViewport;var Sa=ua.clientWidth;ua=ua.clientHeight;var Ea=R=0;y&&(Sa=y.width,ua=y.height,((fa=C())||!fa&&"fixed"===J)&&(R=y.offsetLeft,Ea=y.offsetTop));r={width:Sa,height:ua,x:R+sa(r),y:Ea};J=K(r)}else J=q(y)?((Sa=x(y,!1,"fixed"===J)).top=Sa.top+y.clientTop,Sa.left+=y.clientLeft,Sa.bottom=Sa.top+y.clientHeight,Sa.right=Sa.left+y.clientWidth,Sa.width=y.clientWidth,Sa.height=y.clientHeight,Sa.x=Sa.left,Sa.y=Sa.top,Sa):K((ua=H(r),Ea=H(ua),fa=ia(ua),ra=null==(R=ua.ownerDocument)?void 0:R.body,
Ba=Mb(Ea.scrollWidth,Ea.clientWidth,ra?ra.scrollWidth:0,ra?ra.clientWidth:0),Da=Mb(Ea.scrollHeight,Ea.clientHeight,ra?ra.scrollHeight:0,ra?ra.clientHeight:0),Ra=-fa.scrollLeft+sa(ua),Xa=-fa.scrollTop,"rtl"===G(ra||Ea).direction&&(Ra+=Mb(Ea.clientWidth,ra?ra.clientWidth:0)-Ba),{width:Ba,height:Da,x:Ra,y:Xa}));return J}function na(r){var y=r.reference,J=r.element,R=(r=r.placement)?v(r):null;r=r?V(r):null;var fa=y.x+y.width/2-J.width/2;var ra=y.y+y.height/2-J.height/2;switch(R){case "top":fa={x:fa,y:y.y-
J.height};break;case "bottom":fa={x:fa,y:y.y+y.height};break;case "right":fa={x:y.x+y.width,y:ra};break;case "left":fa={x:y.x-J.width,y:ra};break;default:fa={x:y.x,y:y.y}}R=R?T(R):null;if(null!=R)switch(ra="y"===R?"height":"width",r){case "start":fa[R]-=y[ra]/2-J[ra]/2;break;case "end":fa[R]+=y[ra]/2-J[ra]/2}return fa}function X(r,y){void 0===y&&(y={});var J,R,fa,ra,Ba,Da,Ra,Xa,ua=y;y=ua.placement;y=void 0===y?r.placement:y;var Sa=ua.strategy,Ea=void 0===Sa?r.strategy:Sa,Ya=ua.boundary,Wa=ua.rootBoundary;
Sa=ua.elementContext;Sa=void 0===Sa?"popper":Sa;var Ta=ua.altBoundary;ua=ua.padding;ua=void 0===ua?0:ua;ua=L("number"!=typeof ua?ua:ja(ua,Ob));var Ua=r.rects.popper;Ta=r.elements[void 0!==Ta&&Ta?Sa==="popper"?"reference":"popper":Sa];Ta=(J=q(Ta)?Ta:Ta.contextElement||H(r.elements.popper),R=void 0===Ya?"clippingParents":Ya,fa=void 0===Wa?"viewport":Wa,Ra=(Da=[].concat("clippingParents"===R?(ra=z(P(J)),q(Ba=["absolute","fixed"].indexOf(G(J).position)>=0&&t(J)?O(J):J)?ra.filter(function(cb){return q(cb)&&
w(cb,Ba)&&"body"!==m(cb)}):[]):[].concat(R),[fa]))[0],(Xa=Da.reduce(function(cb,Oa){Oa=ca(J,Oa,Ea);return cb.top=Mb(Oa.top,cb.top),cb.right=nc(Oa.right,cb.right),cb.bottom=nc(Oa.bottom,cb.bottom),cb.left=Mb(Oa.left,cb.left),cb},ca(J,Ra,Ea))).width=Xa.right-Xa.left,Xa.height=Xa.bottom-Xa.top,Xa.x=Xa.left,Xa.y=Xa.top,Xa);R=x(r.elements.reference);fa=na({reference:R,element:Ua,placement:y});fa=K(Object.assign({},Ua,fa));R=Sa==="popper"?fa:R;var Za={top:Ta.top-R.top+ua.top,bottom:R.bottom-Ta.bottom+ua.bottom,
left:Ta.left-R.left+ua.left,right:R.right-Ta.right+ua.right};r=r.modifiersData.offset;if(Sa==="popper"&&r){var Db=r[y];Object.keys(Za).forEach(function(cb){var Oa=["right","bottom"].indexOf(cb)>=0?1:-1,sb=["top","bottom"].indexOf(cb)>=0?"y":"x";Za[cb]+=Db[sb]*Oa})}return Za}function ba(r,y,J){return void 0===J&&(J={x:0,y:0}),{top:r.top-y.height-J.y,right:r.right-y.width+J.x,bottom:r.bottom-y.height+J.y,left:r.left-y.width-J.x}}function ea(r){return["top","right","bottom","left"].some(function(y){return r[y]>=
0})}function ma(){for(var r=arguments.length,y=Array(r),J=0;J<r;J++)y[J]=arguments[J];return!y.some(function(R){return!(R&&"function"==typeof R.getBoundingClientRect)})}function Ha(r){void 0===r&&(r={});var y=r.defaultModifiers,J=void 0===y?[]:y;r=r.defaultOptions;var R=void 0===r?E:r;return function(fa,ra,Ba){function Da(){Sa.forEach(function(Wa){return Wa()});Sa=[]}void 0===Ba&&(Ba=R);var Ra,Xa,ua={placement:"bottom",orderedModifiers:[],options:Object.assign({},E,R),modifiersData:{},elements:{reference:fa,
popper:ra},attributes:{},styles:{}},Sa=[],Ea=!1,Ya={state:ua,setOptions:function(Wa){Wa="function"==typeof Wa?Wa(ua.options):Wa;Da();ua.options=Object.assign({},R,ua.options,Wa);ua.scrollParents={reference:q(fa)?z(fa):fa.contextElement?z(fa.contextElement):[],popper:z(ra)};var Ta,Ua,Za,Db,cb;Wa=(Ta=Object.keys(cb=[].concat(J,ua.options.modifiers).reduce(function(Oa,sb){var tb=Oa[sb.name];return Oa[sb.name]=tb?Object.assign({},tb,sb,{options:Object.assign({},tb.options,sb.options),data:Object.assign({},
tb.data,sb.data)}):sb,Oa},{})).map(function(Oa){return cb[Oa]}),Ua=new Map,Za=new Set,Db=[],Ta.forEach(function(Oa){Ua.set(Oa.name,Oa)}),Ta.forEach(function(Oa){Za.has(Oa.name)||function Eb(tb){Za.add(tb.name);[].concat(tb.requires||[],tb.requiresIfExists||[]).forEach(function(ub){Za.has(ub)||(ub=Ua.get(ub))&&Eb(ub)});Db.push(tb)}(Oa)}),Vb.reduce(function(Oa,sb){return Oa.concat(Db.filter(function(tb){return tb.phase===sb}))},[]));return ua.orderedModifiers=Wa.filter(function(Oa){return Oa.enabled}),
ua.orderedModifiers.forEach(function(Oa){var sb=Oa.name,tb=Oa.options;Oa=Oa.effect;"function"==typeof Oa&&(sb=Oa({state:ua,name:sb,instance:Ya,options:void 0===tb?{}:tb}),Sa.push(sb||function(){}))}),Ya.update()},forceUpdate:function(){if(!Ea){var Wa=ua.elements,Ta=Wa.reference;Wa=Wa.popper;if(ma(Ta,Wa)){ua.rects={reference:(Ua=O(Wa),Za="fixed"===ua.options.strategy,sb=t(Ua),tb=t(Ua)&&(cb=wc((Db=Ua.getBoundingClientRect()).width)/Ua.offsetWidth||1,Oa=wc(Db.height)/Ua.offsetHeight||1,1!==cb||1!==Oa),
Eb=H(Ua),ub=x(Ta,tb,Za),pb={scrollLeft:0,scrollTop:0},dc={x:0,y:0},(sb||!sb&&!Za)&&(("body"!==m(Ua)||M(Eb))&&(pb=Ua!==n(Ua)&&t(Ua)?{scrollLeft:Ua.scrollLeft,scrollTop:Ua.scrollTop}:ia(Ua)),t(Ua)?((dc=x(Ua,!0)).x+=Ua.clientLeft,dc.y+=Ua.clientTop):Eb&&(dc.x=sa(Eb))),{x:ub.left+pb.scrollLeft-dc.x,y:ub.top+pb.scrollTop-dc.y,width:ub.width,height:ub.height}),popper:F(Wa)};ua.reset=!1;ua.placement=ua.options.placement;ua.orderedModifiers.forEach(function(Qc){return ua.modifiersData[Qc.name]=Object.assign({},
Qc.data)});var Ua,Za,Db,cb,Oa,sb,tb,Eb,ub,pb,dc;for(Ta=0;Ta<ua.orderedModifiers.length;Ta++)!0!==ua.reset?(Za=ua.orderedModifiers[Ta],Ua=Za.fn,Db=Za.options,Db=void 0===Db?{}:Db,Za=Za.name,"function"==typeof Ua&&(ua=Ua({state:ua,options:Db,name:Za,instance:Ya})||ua)):(ua.reset=!1,Ta=-1)}}},update:(Ra=function(){return new Promise(function(Wa){Ya.forceUpdate();Wa(ua)})},function(){return Xa||=new Promise(function(Wa){Promise.resolve().then(function(){Xa=void 0;Wa(Ra())})}),Xa}),destroy:function(){Da();
Ea=!0}};return ma(fa,ra)?(Ya.setOptions(Ba).then(function(Wa){!Ea&&Ba.onFirstUpdate&&Ba.onFirstUpdate(Wa)}),Ya):Ya}}let pa=new Map,za={set(r,y,J){pa.has(r)||pa.set(r,new Map);r=pa.get(r);r.has(y)||0===r.size?r.set(y,J):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`)},get:(r,y)=>pa.has(r)&&pa.get(r).get(y)||null,remove(r,y){if(pa.has(r)){var J=pa.get(r);J.delete(y);0===J.size&&pa.delete(r)}}},rb=r=>(r&&window.CSS&&window.CSS.escape&&
(r=r.replace(/#([^\s"#']+)/g,(y,J)=>`#${CSS.escape(J)}`)),r),bb=r=>!(!r||"object"!=typeof r)&&(void 0!==r.jquery&&(r=r[0]),void 0!==r.nodeType),Pb=r=>bb(r)?r.jquery?r[0]:r:"string"==typeof r&&r.length>0?document.querySelector(rb(r)):null,Ia=r=>{if(!bb(r)||0===r.getClientRects().length)return!1;let y="visible"===getComputedStyle(r).getPropertyValue("visibility"),J=r.closest("details:not([open])");return J?J!==r&&((r=r.closest("summary"))&&r.parentNode!==J||null===r)?!1:y:y},ob=r=>!r||r.nodeType!==
Node.ELEMENT_NODE||!!r.classList.contains("disabled")||(void 0!==r.disabled?r.disabled:r.hasAttribute("disabled")&&"false"!==r.getAttribute("disabled")),hb=r=>document.documentElement.attachShadow?"function"==typeof r.getRootNode?(r=r.getRootNode(),r instanceof ShadowRoot?r:null):r instanceof ShadowRoot?r:r.parentNode?hb(r.parentNode):null:null,Gb=()=>{},lb=r=>{r.offsetHeight},wb=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,uc=[],Lb=r=>{var y=()=>{let J=wb();
if(J){let R=r.NAME,fa=J.fn[R];J.fn[R]=r.jQueryInterface;J.fn[R].Constructor=r;J.fn[R].noConflict=()=>(J.fn[R]=fa,r.jQueryInterface)}};"loading"===document.readyState?(uc.length||document.addEventListener("DOMContentLoaded",()=>{for(let J of uc)J()}),uc.push(y)):y()},yb=(r,y=[],J=r)=>"function"==typeof r?r.call(...y):J,mb=(r,y,J=!0)=>{if(!J)return void yb(r);J=(ra=>{if(!ra)return 0;let {transitionDuration:Ba,transitionDelay:Da}=window.getComputedStyle(ra);ra=Number.parseFloat(Ba);let Ra=Number.parseFloat(Da);
return ra||Ra?(Ba=Ba.split(",")[0],Da=Da.split(",")[0],1E3*(Number.parseFloat(Ba)+Number.parseFloat(Da))):0})(y)+5;let R=!1,fa=({target:ra})=>{ra===y&&(R=!0,y.removeEventListener("transitionend",fa),yb(r))};y.addEventListener("transitionend",fa);setTimeout(()=>{R||y.dispatchEvent(new Event("transitionend"))},J)},nb=(r,y,J,R)=>{let fa=r.length;y=r.indexOf(y);return-1===y?!J&&R?r[fa-1]:r[0]:(y+=J?1:-1,R&&(y=(y+fa)%fa),r[Math.max(0,Math.min(y,fa-1))])},xc=/[^.]*(?=\..*)\.|.*/,kb=/\..*/,Tb=/::\d+$/,oc=
{},Ic=1,Wc={mouseenter:"mouseover",mouseleave:"mouseout"},fc=new Set("click dblclick mouseup mousedown contextmenu mousewheel DOMMouseScroll mouseover mouseout mousemove selectstart selectend keydown keypress keyup orientationchange touchstart touchmove touchend touchcancel pointerdown pointermove pointerup pointerleave pointercancel gesturestart gesturechange gestureend focus blur change reset select submit focusin focusout load unload beforeunload resize move DOMContentLoaded readystatechange error abort scroll".split(" ")),
qa={on(r,y,J,R){p(r,y,J,R,!1)},one(r,y,J,R){p(r,y,J,R,!0)},off(r,y,J,R){if("string"==typeof y&&r){var [fa,ra,Ba]=h(y,J,R);R=Ba!==y;var Da=d(r),Ra=Da[Ba]||{},Xa=y.startsWith(".");if(void 0===ra){if(Xa)for(var ua of Object.keys(Da)){J=y.slice(1);for(let [Sa,Ea]of Object.entries(Da[ua]||{}))Sa.includes(J)&&g(r,Da,ua,Ea.callable,Ea.delegationSelector)}for(let [Sa,Ea]of Object.entries(Ra))ua=Sa.replace(Tb,""),R&&!y.includes(ua)||g(r,Da,Ba,Ea.callable,Ea.delegationSelector)}else Object.keys(Ra).length&&
g(r,Da,Ba,ra,fa?J:null)}},trigger(r,y,J){if("string"!=typeof y||!r)return null;let R=wb(),fa=null,ra=!0,Ba=!0,Da=!1;y!==e(y)&&R&&(fa=R.Event(y,J),R(r).trigger(fa),ra=!fa.isPropagationStopped(),Ba=!fa.isImmediatePropagationStopped(),Da=fa.isDefaultPrevented());y=k(new Event(y,{bubbles:ra,cancelable:!0}),J);return Da&&y.preventDefault(),Ba&&r.dispatchEvent(y),y.defaultPrevented&&fa&&fa.preventDefault(),y}},ac={setDataAttribute(r,y,J){r.setAttribute(`data-bs-${f(y)}`,J)},removeDataAttribute(r,y){r.removeAttribute(`data-bs-${f(y)}`)},
getDataAttributes(r){if(!r)return{};let y={};for(let J of Object.keys(r.dataset).filter(R=>R.startsWith("bs")&&!R.startsWith("bsConfig"))){let R=J.replace(/^bs/,"");y[R=R.charAt(0).toLowerCase()+R.slice(1)]=l(r.dataset[J])}return y},getDataAttribute:(r,y)=>l(r.getAttribute(`data-bs-${f(y)}`))};class hc{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw Error('You have to implement the static method "NAME", for each component!');}_getConfig(r){return r=this._mergeConfigObj(r),
r=this._configAfterMerge(r),this._typeCheckConfig(r),r}_configAfterMerge(r){return r}_mergeConfigObj(r,y){let J=bb(y)?ac.getDataAttribute(y,"config"):{};return{...this.constructor.Default,...("object"==typeof J?J:{}),...(bb(y)?ac.getDataAttributes(y):{}),...("object"==typeof r?r:{})}}_typeCheckConfig(r,y=this.constructor.DefaultType){for(let [J,R]of Object.entries(y))if(y=r[J],y=bb(y)?"element":null==y?`${y}`:Object.prototype.toString.call(y).match(/\s([a-z]+)/i)[1].toLowerCase(),!(new RegExp(R)).test(y))throw TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${J}" provided type "${y}" but expected type "${R}".`);
}}class Zb extends hc{dispose(){for(let r of(za.remove(this._element,this.constructor.DATA_KEY),qa.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this)))this[r]=null}_queueCallback(r,y,J=!0){mb(r,y,J)}_getConfig(r){return r=this._mergeConfigObj(r,this._element),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}static getInstance(r){return za.get(Pb(r),this.DATA_KEY)}static getOrCreateInstance(r,y={}){return this.getInstance(r)||new this(r,"object"==typeof y?y:null)}static get VERSION(){return"5.3.8"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(r){return`${r}${this.EVENT_KEY}`}constructor(r,
y){super();(r=Pb(r))&&(this._element=r,this._config=this._getConfig(y),za.set(this._element,this.constructor.DATA_KEY,this))}}let yc=r=>{let y=r.getAttribute("data-bs-target");if(!y||"#"===y){r=r.getAttribute("href");if(!r||!r.includes("#")&&!r.startsWith("."))return null;r.includes("#")&&!r.startsWith("#")&&(r=`#${r.split("#")[1]}`);y=r&&"#"!==r?r.trim():null}return y?y.split(",").map(J=>rb(J)).join(","):null},La={find:(r,y=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(y,
r)),findOne:(r,y=document.documentElement)=>Element.prototype.querySelector.call(y,r),children:(r,y)=>[].concat(...r.children).filter(J=>J.matches(y)),parents(r,y){let J=[];for(r=r.parentNode.closest(y);r;)J.push(r),r=r.parentNode.closest(y);return J},prev(r,y){for(r=r.previousElementSibling;r;){if(r.matches(y))return[r];r=r.previousElementSibling}return[]},next(r,y){for(r=r.nextElementSibling;r;){if(r.matches(y))return[r];r=r.nextElementSibling}return[]},focusableChildren(r){let y='a button input textarea select details [tabindex] [contenteditable="true"]'.split(" ").map(J=>
`${J}:not([tabindex^="-"])`).join(",");return this.find(y,r).filter(J=>!ob(J)&&Ia(J))},getSelectorFromElement(r){return(r=yc(r))&&La.findOne(r)?r:null},getElementFromSelector(r){return(r=yc(r))?La.findOne(r):null},getMultipleElementsFromSelector(r){return(r=yc(r))?La.find(r):[]}},Qb=(r,y="hide")=>{let J=r.NAME;qa.on(document,`click.dismiss${r.EVENT_KEY}`,`[data-bs-dismiss="${J}"]`,function(R){(["A","AREA"].includes(this.tagName)&&R.preventDefault(),ob(this))||(R=La.getElementFromSelector(this)||this.closest(`.${J}`),
r.getOrCreateInstance(R)[y]())})};class vc extends Zb{static get NAME(){return"alert"}close(){if(!qa.trigger(this._element,"close.bs.alert").defaultPrevented){this._element.classList.remove("show");var r=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,r)}}_destroyElement(){this._element.remove();qa.trigger(this._element,"closed.bs.alert");this.dispose()}static jQueryInterface(r){return this.each(function(){let y=vc.getOrCreateInstance(this);if("string"==
typeof r){if(void 0===y[r]||r.startsWith("_")||"constructor"===r)throw TypeError(`No method named "${r}"`);y[r](this)}})}}Qb(vc,"close");Lb(vc);class D extends Zb{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(r){return this.each(function(){let y=D.getOrCreateInstance(this);"toggle"===r&&y[r]()})}}qa.on(document,"click.bs.button.data-api",'[data-bs-toggle="button"]',r=>{r.preventDefault();r=r.target.closest('[data-bs-toggle="button"]');
D.getOrCreateInstance(r).toggle()});Lb(D);let N={endCallback:null,leftCallback:null,rightCallback:null},W={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Y extends hc{static get Default(){return N}static get DefaultType(){return W}static get NAME(){return"swipe"}dispose(){qa.off(this._element,".bs.swipe")}_start(r){this._supportPointerEvents?this._eventIsPointerPenTouch(r)&&(this._deltaX=r.clientX):this._deltaX=r.touches[0].clientX}_end(r){this._eventIsPointerPenTouch(r)&&
(this._deltaX=r.clientX-this._deltaX);this._handleSwipe();yb(this._config.endCallback)}_move(r){this._deltaX=r.touches&&r.touches.length>1?0:r.touches[0].clientX-this._deltaX}_handleSwipe(){var r=Math.abs(this._deltaX);r<=40||(r/=this._deltaX,this._deltaX=0,r&&yb(r>0?this._config.rightCallback:this._config.leftCallback))}_initEvents(){this._supportPointerEvents?(qa.on(this._element,"pointerdown.bs.swipe",r=>this._start(r)),qa.on(this._element,"pointerup.bs.swipe",r=>this._end(r)),this._element.classList.add("pointer-event")):
(qa.on(this._element,"touchstart.bs.swipe",r=>this._start(r)),qa.on(this._element,"touchmove.bs.swipe",r=>this._move(r)),qa.on(this._element,"touchend.bs.swipe",r=>this._end(r)))}_eventIsPointerPenTouch(r){return this._supportPointerEvents&&("pen"===r.pointerType||"touch"===r.pointerType)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}constructor(r,y){super();(this._element=r)&&Y.isSupported()&&(this._config=this._getConfig(y),this._deltaX=0,this._supportPointerEvents=
!!window.PointerEvent,this._initEvents())}}let da={ArrowLeft:"right",ArrowRight:"left"},aa={interval:5E3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},wa={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ma extends Zb{static get Default(){return aa}static get DefaultType(){return wa}static get NAME(){return"carousel"}next(){this._slide("next")}nextWhenVisible(){!document.hidden&&Ia(this._element)&&this.next()}prev(){this._slide("prev")}pause(){this._isSliding&&
this._element.dispatchEvent(new Event("transitionend"));this._clearInterval()}cycle(){this._clearInterval();this._updateInterval();this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?qa.one(this._element,"slid.bs.carousel",()=>this.cycle()):this.cycle())}to(r){let y=this._getItems();if(!(r>y.length-1||r<0)){if(this._isSliding)return void qa.one(this._element,"slid.bs.carousel",()=>this.to(r));var J=this._getItemIndex(this._getActive());
J===r||this._slide(r>J?"next":"prev",y[r])}}dispose(){this._swipeHelper&&this._swipeHelper.dispose();super.dispose()}_configAfterMerge(r){return r.defaultInterval=r.interval,r}_addEventListeners(){this._config.keyboard&&qa.on(this._element,"keydown.bs.carousel",r=>this._keydown(r));"hover"===this._config.pause&&(qa.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),qa.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle()));this._config.touch&&Y.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(let r of La.find(".carousel-item img",
this._element))qa.on(r,"dragstart.bs.carousel",y=>y.preventDefault());this._swipeHelper=new Y(this._element,{leftCallback:()=>this._slide(this._directionToOrder("left")),rightCallback:()=>this._slide(this._directionToOrder("right")),endCallback:()=>{"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}})}_keydown(r){if(!/input|textarea/i.test(r.target.tagName)){var y=da[r.key];
y&&(r.preventDefault(),this._slide(this._directionToOrder(y)))}}_getItemIndex(r){return this._getItems().indexOf(r)}_setActiveIndicatorElement(r){if(this._indicatorsElement){var y=La.findOne(".active",this._indicatorsElement);y.classList.remove("active");y.removeAttribute("aria-current");(r=La.findOne(`[data-bs-slide-to="${r}"]`,this._indicatorsElement))&&(r.classList.add("active"),r.setAttribute("aria-current","true"))}}_updateInterval(){var r=this._activeElement||this._getActive();r&&(r=Number.parseInt(r.getAttribute("data-bs-interval"),
10),this._config.interval=r||this._config.defaultInterval)}_slide(r,y=null){if(!this._isSliding){var J=this._getActive(),R=r==="next",fa=y||nb(this._getItems(),J,R,this._config.wrap);if(fa!==J){var ra=this._getItemIndex(fa),Ba=Xa=>qa.trigger(this._element,Xa,{relatedTarget:fa,direction:this._orderToDirection(r),from:this._getItemIndex(J),to:ra});if(!Ba("slide.bs.carousel").defaultPrevented&&J&&fa){y=!!this._interval;this.pause();this._isSliding=!0;this._setActiveIndicatorElement(ra);this._activeElement=
fa;var Da=R?"carousel-item-start":"carousel-item-end",Ra=R?"carousel-item-next":"carousel-item-prev";fa.classList.add(Ra);fa.offsetHeight;J.classList.add(Da);fa.classList.add(Da);this._queueCallback(()=>{fa.classList.remove(Da,Ra);fa.classList.add("active");J.classList.remove("active",Ra,Da);this._isSliding=!1;Ba("slid.bs.carousel")},J,this._isAnimated());y&&this.cycle()}}}}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return La.findOne(".active.carousel-item",this._element)}_getItems(){return La.find(".carousel-item",
this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(r){return"rtl"===document.documentElement.dir?r==="left"?"prev":"next":r==="left"?"next":"prev"}_orderToDirection(r){return"rtl"===document.documentElement.dir?r==="prev"?"left":"right":r==="prev"?"right":"left"}static jQueryInterface(r){return this.each(function(){let y=Ma.getOrCreateInstance(this,r);if("number"!=typeof r){if("string"==typeof r){if(void 0===y[r]||r.startsWith("_")||
"constructor"===r)throw TypeError(`No method named "${r}"`);y[r]()}}else y.to(r)})}constructor(r,y){super(r,y);this._activeElement=this._interval=null;this._isSliding=!1;this._swipeHelper=this.touchTimeout=null;this._indicatorsElement=La.findOne(".carousel-indicators",this._element);this._addEventListeners();this._config.ride==="carousel"&&this.cycle()}}qa.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(r){var y=La.getElementFromSelector(this);if(y&&y.classList.contains("carousel"))return r.preventDefault(),
r=Ma.getOrCreateInstance(y),y=this.getAttribute("data-bs-slide-to"),y?r.to(y):"next"===ac.getDataAttribute(this,"slide")?r.next():r.prev(),void r._maybeEnableCycle()});qa.on(window,"load.bs.carousel.data-api",()=>{for(let r of La.find('[data-bs-ride="carousel"]'))Ma.getOrCreateInstance(r)});Lb(Ma);let ab={parent:null,toggle:!0},Xb={parent:"(null|element)",toggle:"boolean"};class Ub extends Zb{static get Default(){return ab}static get DefaultType(){return Xb}static get NAME(){return"collapse"}toggle(){this._isShown()?
this.hide():this.show()}show(){if(!this._isTransitioning&&!this._isShown()){var r=[];if(!(this._config.parent&&(r=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(J=>J!==this._element).map(J=>Ub.getOrCreateInstance(J,{toggle:!1}))),r.length&&r[0]._isTransitioning||qa.trigger(this._element,"show.bs.collapse").defaultPrevented)){for(let J of r)J.hide();var y=this._getDimension();this._element.classList.remove("collapse");this._element.classList.add("collapsing");this._element.style[y]=
0;this._addAriaAndCollapsedClass(this._triggerArray,!0);this._isTransitioning=!0;r=`scroll${y[0].toUpperCase()+y.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1;this._element.classList.remove("collapsing");this._element.classList.add("collapse","show");this._element.style[y]="";qa.trigger(this._element,"shown.bs.collapse")},this._element,!0);this._element.style[y]=`${this._element[r]}px`}}}hide(){if(!this._isTransitioning&&this._isShown()&&!qa.trigger(this._element,"hide.bs.collapse").defaultPrevented){var r=
this._getDimension();for(let y of(this._element.style[r]=`${this._element.getBoundingClientRect()[r]}px`,lb(this._element),this._element.classList.add("collapsing"),this._element.classList.remove("collapse","show"),this._triggerArray)){let J=La.getElementFromSelector(y);J&&!this._isShown(J)&&this._addAriaAndCollapsedClass([y],!1)}this._isTransitioning=!0;this._element.style[r]="";this._queueCallback(()=>{this._isTransitioning=!1;this._element.classList.remove("collapsing");this._element.classList.add("collapse");
qa.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}}_isShown(r=this._element){return r.classList.contains("show")}_configAfterMerge(r){return r.toggle=!!r.toggle,r.parent=Pb(r.parent),r}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(this._config.parent)for(let r of this._getFirstLevelChildren('[data-bs-toggle="collapse"]')){let y=La.getElementFromSelector(r);y&&this._addAriaAndCollapsedClass([r],this._isShown(y))}}_getFirstLevelChildren(r){let y=
La.find(":scope .collapse .collapse",this._config.parent);return La.find(r,this._config.parent).filter(J=>!y.includes(J))}_addAriaAndCollapsedClass(r,y){if(r.length)for(let J of r)J.classList.toggle("collapsed",!y),J.setAttribute("aria-expanded",y)}static jQueryInterface(r){let y={};return"string"==typeof r&&/show|hide/.test(r)&&(y.toggle=!1),this.each(function(){let J=Ub.getOrCreateInstance(this,y);if("string"==typeof r){if(void 0===J[r])throw TypeError(`No method named "${r}"`);J[r]()}})}constructor(r,
y){for(const J of(super(r,y),this._isTransitioning=!1,this._triggerArray=[],La.find('[data-bs-toggle="collapse"]')))r=La.getSelectorFromElement(J),y=La.find(r).filter(R=>R===this._element),null!==r&&y.length&&this._triggerArray.push(J);this._initializeChildren();this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown());this._config.toggle&&this.toggle()}}qa.on(document,"click.bs.collapse.data-api",'[data-bs-toggle="collapse"]',function(r){for(let y of(("A"===r.target.tagName||
r.delegateTarget&&"A"===r.delegateTarget.tagName)&&r.preventDefault(),La.getMultipleElementsFromSelector(this)))Ub.getOrCreateInstance(y,{toggle:!1}).toggle()});Lb(Ub);var Ob=["top","bottom","right","left"],Kb=Ob.reduce(function(r,y){return r.concat([y+"-start",y+"-end"])},[]),vb=[].concat(Ob,["auto"]).reduce(function(r,y){return r.concat([y,y+"-start",y+"-end"])},[]),Vb="beforeRead read afterRead beforeMain main afterMain beforeWrite write afterWrite".split(" ");let Jc={name:"applyStyles",enabled:!0,
phase:"write",fn:function(r){var y=r.state;Object.keys(y.elements).forEach(function(J){var R=y.styles[J]||{},fa=y.attributes[J]||{},ra=y.elements[J];t(ra)&&m(ra)&&(Object.assign(ra.style,R),Object.keys(fa).forEach(function(Ba){var Da=fa[Ba];!1===Da?ra.removeAttribute(Ba):ra.setAttribute(Ba,!0===Da?"":Da)}))})},effect:function(r){var y=r.state,J={popper:{position:y.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(y.elements.popper.style,J.popper),
y.styles=J,y.elements.arrow&&Object.assign(y.elements.arrow.style,J.arrow),function(){Object.keys(y.elements).forEach(function(R){var fa=y.elements[R],ra=y.attributes[R]||{};R=Object.keys(y.styles.hasOwnProperty(R)?y.styles[R]:J[R]).reduce(function(Ba,Da){return Ba[Da]="",Ba},{});t(fa)&&m(fa)&&(Object.assign(fa.style,R),Object.keys(ra).forEach(function(Ba){fa.removeAttribute(Ba)}))})}},requires:["computeStyles"]};var Mb=Math.max,nc=Math.min,wc=Math.round;let mc={name:"arrow",enabled:!0,phase:"main",
fn:function(r){var y,J=r.state,R=r.name,fa=r.options,ra=J.elements.arrow,Ba=J.modifiersData.popperOffsets,Da=v(J.placement);r=T(Da);Da=["left","right"].indexOf(Da)>=0?"height":"width";if(ra&&Ba){var Ra;fa=(Ra=fa.padding,L("number"!=typeof(Ra="function"==typeof Ra?Ra(Object.assign({},J.rects,{placement:J.placement})):Ra)?Ra:ja(Ra,Ob)));Ra=F(ra);var Xa="y"===r?"top":"left",ua="y"===r?"bottom":"right",Sa=J.rects.reference[Da]+J.rects.reference[r]-Ba[r]-J.rects.popper[Da];Ba=Ba[r]-J.rects.reference[r];
ra=(ra=O(ra))?"y"===r?ra.clientHeight||0:ra.clientWidth||0:0;Ba=ra/2-Ra[Da]/2+(Sa/2-Ba/2);Da=Mb(fa[Xa],nc(Ba,ra-Ra[Da]-fa[ua]));J.modifiersData[R]=((y={})[r]=Da,y.centerOffset=Da-Ba,y)}},effect:function(r){var y=r.state;r=r.options.element;r=void 0===r?"[data-popper-arrow]":r;null!=r&&("string"!=typeof r||(r=y.elements.popper.querySelector(r)))&&w(y.elements.popper,r)&&(y.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};var Ed={top:"auto",right:"auto",bottom:"auto",
left:"auto"};let $c={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(r){var y=r.state,J=r.options,R=J.gpuAcceleration;r=J.adaptive;J=J.roundOffsets;J=void 0===J||J;R={placement:v(y.placement),variation:V(y.placement),popper:y.elements.popper,popperRect:y.rects.popper,gpuAcceleration:void 0===R||R,isFixed:"fixed"===y.options.strategy};null!=y.modifiersData.popperOffsets&&(y.styles.popper=Object.assign({},y.styles.popper,ha(Object.assign({},R,{offsets:y.modifiersData.popperOffsets,position:y.options.strategy,
adaptive:void 0===r||r,roundOffsets:J}))));null!=y.modifiersData.arrow&&(y.styles.arrow=Object.assign({},y.styles.arrow,ha(Object.assign({},R,{offsets:y.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:J}))));y.attributes.popper=Object.assign({},y.attributes.popper,{"data-popper-placement":y.placement})},data:{}};var Oc={passive:!0};let jd={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(r){var y=r.state,J=r.instance;r=r.options;var R=r.scroll,fa=void 0===
R||R;r=r.resize;var ra=void 0===r||r,Ba=n(y.elements.popper),Da=[].concat(y.scrollParents.reference,y.scrollParents.popper);return fa&&Da.forEach(function(Ra){Ra.addEventListener("scroll",J.update,Oc)}),ra&&Ba.addEventListener("resize",J.update,Oc),function(){fa&&Da.forEach(function(Ra){Ra.removeEventListener("scroll",J.update,Oc)});ra&&Ba.removeEventListener("resize",J.update,Oc)}},data:{}};var Yd={left:"right",right:"left",bottom:"top",top:"bottom"},Nc={start:"end",end:"start"};let kd={name:"flip",
enabled:!0,phase:"main",fn:function(r){var y=r.state,J=r.options;r=r.name;if(!y.modifiersData[r]._skip){var R=J.mainAxis;R=void 0===R||R;var fa=J.altAxis;fa=void 0===fa||fa;var ra=J.fallbackPlacements,Ba=J.padding,Da=J.boundary,Ra=J.rootBoundary,Xa=J.altBoundary,ua=J.flipVariations,Sa=void 0===ua||ua,Ea=J.allowedAutoPlacements;J=y.options.placement;ua=v(J);ra=ra||(ua!==J&&Sa?function(Eb){if(v(Eb)==="auto")return[];var ub=Z(Eb);return[va(Eb),ub,va(ub)]}(J):[Z(J)]);var Ya=[J].concat(ra).reduce(function(Eb,
ub){var pb,dc,Qc,Rc,jg,kg,lg,mg,ng,og,Ze,$e;return Eb.concat(v(ub)==="auto"?(dc=(pb={placement:ub,boundary:Da,rootBoundary:Ra,padding:Ba,flipVariations:Sa,allowedAutoPlacements:Ea}).placement,Qc=pb.boundary,Rc=pb.rootBoundary,jg=pb.padding,kg=pb.flipVariations,mg=void 0===(lg=pb.allowedAutoPlacements)?vb:lg,0===(Ze=(og=(ng=V(dc))?kg?Kb:Kb.filter(function(Sc){return V(Sc)===ng}):Ob).filter(function(Sc){return mg.indexOf(Sc)>=0})).length&&(Ze=og),Object.keys($e=Ze.reduce(function(Sc,Kd){return Sc[Kd]=
X(y,{placement:Kd,boundary:Qc,rootBoundary:Rc,padding:jg})[v(Kd)],Sc},{})).sort(function(Sc,Kd){return $e[Sc]-$e[Kd]})):ub)},[]);J=y.rects.reference;ra=y.rects.popper;var Wa=new Map;ua=!0;for(var Ta=Ya[0],Ua=0;Ua<Ya.length;Ua++){var Za=Ya[Ua],Db=v(Za),cb=V(Za)==="start",Oa=["top","bottom"].indexOf(Db)>=0,sb=Oa?"width":"height",tb=X(y,{placement:Za,boundary:Da,rootBoundary:Ra,altBoundary:Xa,padding:Ba});cb=Oa?cb?"right":"left":cb?"bottom":"top";J[sb]>ra[sb]&&(cb=Z(cb));sb=Z(cb);Oa=[];if(R&&Oa.push(tb[Db]<=
0),fa&&Oa.push(tb[cb]<=0,tb[sb]<=0),Oa.every(function(Eb){return Eb})){Ta=Za;ua=!1;break}Wa.set(Za,Oa)}if(ua)for(R=function(Eb){var ub=Ya.find(function(pb){if(pb=Wa.get(pb))return pb.slice(0,Eb).every(function(dc){return dc})});if(ub)return Ta=ub,"break"},fa=Sa?3:1;fa>0&&"break"!==R(fa);fa--);y.placement!==Ta&&(y.modifiersData[r]._skip=!0,y.placement=Ta,y.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},ld={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(r){var y=
r.state;r=r.name;var J=y.rects.reference,R=y.rects.popper,fa=y.modifiersData.preventOverflow,ra=X(y,{elementContext:"reference"}),Ba=X(y,{altBoundary:!0});J=ba(ra,J);R=ba(Ba,R,fa);fa=ea(J);Ba=ea(R);y.modifiersData[r]={referenceClippingOffsets:J,popperEscapeOffsets:R,isReferenceHidden:fa,hasPopperEscaped:Ba};y.attributes.popper=Object.assign({},y.attributes.popper,{"data-popper-reference-hidden":fa,"data-popper-escaped":Ba})}},ad={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(r){var y=
r.state,J=r.name;r=r.options.offset;var R=void 0===r?[0,0]:r;r=vb.reduce(function(Ba,Da){var Ra,Xa,ua,Sa,Ea,Ya;return Ba[Da]=(Ra=y.rects,ua=["left","top"].indexOf(Xa=v(Da))>=0?-1:1,Ea=(Sa="function"==typeof R?R(Object.assign({},Ra,{placement:Da})):R)[0],Ya=Sa[1],Ea=Ea||0,Ya=(Ya||0)*ua,["left","right"].indexOf(Xa)>=0?{x:Ya,y:Ea}:{x:Ea,y:Ya}),Ba},{});var fa=r[y.placement],ra=fa.x;fa=fa.y;null!=y.modifiersData.popperOffsets&&(y.modifiersData.popperOffsets.x+=ra,y.modifiersData.popperOffsets.y+=fa);y.modifiersData[J]=
r}},bd={name:"popperOffsets",enabled:!0,phase:"read",fn:function(r){var y=r.state;y.modifiersData[r.name]=na({reference:y.rects.reference,element:y.rects.popper,placement:y.placement})},data:{}},md={name:"preventOverflow",enabled:!0,phase:"main",fn:function(r){var y=r.state,J=r.options;r=r.name;var R=J.mainAxis,fa=J.altAxis,ra=J.tether;ra=void 0===ra||ra;var Ba=J.tetherOffset,Da=void 0===Ba?0:Ba,Ra=X(y,{boundary:J.boundary,rootBoundary:J.rootBoundary,padding:J.padding,altBoundary:J.altBoundary}),
Xa=v(y.placement),ua=V(y.placement),Sa=!ua,Ea=T(Xa);J="x"===Ea?"y":"x";Ba=y.modifiersData.popperOffsets;var Ya=y.rects.reference,Wa=y.rects.popper;Da="function"==typeof Da?Da(Object.assign({},y.rects,{placement:y.placement})):Da;var Ta="number"==typeof Da?{mainAxis:Da,altAxis:Da}:Object.assign({mainAxis:0,altAxis:0},Da),Ua=y.modifiersData.offset?y.modifiersData.offset[y.placement]:null;Da={x:0,y:0};if(Ba){if(void 0===R||R){var Za,Db="y"===Ea?"top":"left",cb="y"===Ea?"bottom":"right",Oa="y"===Ea?"height":
"width";R=Ba[Ea];var sb=R+Ra[Db],tb=R-Ra[cb],Eb=ra?-Wa[Oa]/2:0,ub=ua==="start"?Ya[Oa]:Wa[Oa];ua=ua==="start"?-Wa[Oa]:-Ya[Oa];var pb=y.elements.arrow;pb=ra&&pb?F(pb):{width:0,height:0};var dc=y.modifiersData["arrow#persistent"]?y.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0};Db=dc[Db];cb=dc[cb];pb=Mb(0,nc(Ya[Oa],pb[Oa]));ub=Sa?Ya[Oa]/2-Eb-pb-Db-Ta.mainAxis:ub-pb-Db-Ta.mainAxis;Sa=Sa?-Ya[Oa]/2+Eb+pb+cb+Ta.mainAxis:ua+pb+cb+Ta.mainAxis;Eb=(Oa=y.elements.arrow&&O(y.elements.arrow))?
"y"===Ea?Oa.clientTop||0:Oa.clientLeft||0:0;Oa=null!=(Za=null==Ua?void 0:Ua[Ea])?Za:0;Za=ra?nc(sb,R+ub-Oa-Eb):sb;tb=ra?Mb(tb,R+Sa-Oa):tb;Za=Mb(Za,nc(R,tb));Ba[Ea]=Za;Da[Ea]=Za-R}if(void 0!==fa&&fa){var Qc,Rc;fa=Ba[J];R="y"===J?"height":"width";Za=fa+Ra["x"===Ea?"top":"left"];Ra=fa-Ra["x"===Ea?"bottom":"right"];Xa=-1!==["top","left"].indexOf(Xa);Ea=null!=(Rc=null==Ua?void 0:Ua[J])?Rc:0;Rc=Xa?Za:fa-Ya[R]-Wa[R]-Ea+Ta.altAxis;Ya=Xa?fa+Ya[R]+Wa[R]-Ea-Ta.altAxis:Ra;Wa=ra&&Xa?(Qc=Mb(Rc,nc(fa,Ya)))>Ya?Ya:
Qc:Mb(ra?Rc:Za,nc(fa,ra?Ya:Ra));Ba[J]=Wa;Da[J]=Wa-fa}y.modifiersData[r]=Da}},requiresIfExists:["offset"]};var E={placement:"bottom",modifiers:[],strategy:"absolute"},S=Ha(),ka=Ha({defaultModifiers:[jd,bd,$c,Jc]}),ya=Ha({defaultModifiers:[jd,bd,$c,Jc,ad,kd,md,mc,ld]});let Ga=Object.freeze(Object.defineProperty({__proto__:null,afterMain:"afterMain",afterRead:"afterRead",afterWrite:"afterWrite",applyStyles:Jc,arrow:mc,auto:"auto",basePlacements:Ob,beforeMain:"beforeMain",beforeRead:"beforeRead",beforeWrite:"beforeWrite",
bottom:"bottom",clippingParents:"clippingParents",computeStyles:$c,createPopper:ya,createPopperBase:S,createPopperLite:ka,detectOverflow:X,end:"end",eventListeners:jd,flip:kd,hide:ld,left:"left",main:"main",modifierPhases:Vb,offset:ad,placements:vb,popper:"popper",popperGenerator:Ha,popperOffsets:bd,preventOverflow:md,read:"read",reference:"reference",right:"right",start:"start",top:"top",variationPlacements:Kb,viewport:"viewport",write:"write"},Symbol.toStringTag,{value:"Module"})),ta="rtl"===document.documentElement.dir?
"top-end":"top-start",Na="rtl"===document.documentElement.dir?"top-start":"top-end",eb="rtl"===document.documentElement.dir?"bottom-end":"bottom-start",Hb="rtl"===document.documentElement.dir?"bottom-start":"bottom-end",lc="rtl"===document.documentElement.dir?"left-start":"right-start",Fc="rtl"===document.documentElement.dir?"right-start":"left-start",jc={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Xd={autoClose:"(boolean|string)",boundary:"(string|element)",
display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Aa extends Zb{static get Default(){return jc}static get DefaultType(){return Xd}static get NAME(){return"dropdown"}toggle(){return this._isShown()?this.hide():this.show()}show(){if(!ob(this._element)&&!this._isShown()){var r={relatedTarget:this._element};if(!qa.trigger(this._element,"show.bs.dropdown",r).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&
!this._parent.closest(".navbar-nav"))for(let y of[].concat(...document.body.children))qa.on(y,"mouseover",Gb);this._element.focus();this._element.setAttribute("aria-expanded",!0);this._menu.classList.add("show");this._element.classList.add("show");qa.trigger(this._element,"shown.bs.dropdown",r)}}}hide(){!ob(this._element)&&this._isShown()&&this._completeHide({relatedTarget:this._element})}dispose(){this._popper&&this._popper.destroy();super.dispose()}update(){this._inNavbar=this._detectNavbar();this._popper&&
this._popper.update()}_completeHide(r){if(!qa.trigger(this._element,"hide.bs.dropdown",r).defaultPrevented){if("ontouchstart"in document.documentElement)for(let y of[].concat(...document.body.children))qa.off(y,"mouseover",Gb);this._popper&&this._popper.destroy();this._menu.classList.remove("show");this._element.classList.remove("show");this._element.setAttribute("aria-expanded","false");ac.removeDataAttribute(this._menu,"popper");qa.trigger(this._element,"hidden.bs.dropdown",r)}}_getConfig(r){if("object"==
typeof(r=super._getConfig(r)).reference&&!bb(r.reference)&&"function"!=typeof r.reference.getBoundingClientRect)throw TypeError('DROPDOWN: Option "reference" provided type "object" without a required "getBoundingClientRect" method.');return r}_createPopper(){if(void 0===Ga)throw TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let r=this._element;"parent"===this._config.reference?r=this._parent:bb(this._config.reference)?r=Pb(this._config.reference):"object"==typeof this._config.reference&&
(r=this._config.reference);let y=this._getPopperConfig();this._popper=ya(r,this._menu,y)}_isShown(){return this._menu.classList.contains("show")}_getPlacement(){let r=this._parent;if(r.classList.contains("dropend"))return lc;if(r.classList.contains("dropstart"))return Fc;if(r.classList.contains("dropup-center"))return"top";if(r.classList.contains("dropdown-center"))return"bottom";let y="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return r.classList.contains("dropup")?
y?Na:ta:y?Hb:eb}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){let {offset:r}=this._config;return"string"==typeof r?r.split(",").map(y=>Number.parseInt(y,10)):"function"==typeof r?y=>r(y,this._element):r}_getPopperConfig(){let r={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||"static"===this._config.display)&&(ac.setDataAttribute(this._menu,
"popper","static"),r.modifiers=[{name:"applyStyles",enabled:!1}]),{...r,...yb(this._config.popperConfig,[void 0,r])}}_selectMenuItem({key:r,target:y}){let J=La.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(R=>Ia(R));J.length&&nb(J,y,r==="ArrowDown",!J.includes(y)).focus()}static jQueryInterface(r){return this.each(function(){let y=Aa.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===y[r])throw TypeError(`No method named "${r}"`);y[r]()}})}static clearMenus(r){if(2!==
r.button&&("keyup"!==r.type||"Tab"===r.key))for(let J of La.find('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled).show')){let R=Aa.getInstance(J);if(!R||!1===R._config.autoClose)continue;var y=r.composedPath();let fa=y.includes(R._menu);y.includes(R._element)||"inside"===R._config.autoClose&&!fa||"outside"===R._config.autoClose&&fa||R._menu.contains(r.target)&&("keyup"===r.type&&"Tab"===r.key||/input|select|option|textarea|form/i.test(r.target.tagName))||(y={relatedTarget:R._element},"click"===
r.type&&(y.clickEvent=r),R._completeHide(y))}}static dataApiKeydownHandler(r){var y=/input|textarea/i.test(r.target.tagName),J="Escape"===r.key;let R=["ArrowUp","ArrowDown"].includes(r.key);!R&&!J||y&&!J||(r.preventDefault(),y=this.matches('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')?this:La.prev(this,'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')[0]||La.next(this,'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)')[0]||La.findOne('[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',
r.delegateTarget.parentNode),J=Aa.getOrCreateInstance(y),R?(r.stopPropagation(),J.show(),J._selectMenuItem(r)):J._isShown()&&(r.stopPropagation(),J.hide(),y.focus()))}constructor(r,y){super(r,y);this._popper=null;this._parent=this._element.parentNode;this._menu=La.next(this._element,".dropdown-menu")[0]||La.prev(this._element,".dropdown-menu")[0]||La.findOne(".dropdown-menu",this._parent);this._inNavbar=this._detectNavbar()}}qa.on(document,"keydown.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',
Aa.dataApiKeydownHandler);qa.on(document,"keydown.bs.dropdown.data-api",".dropdown-menu",Aa.dataApiKeydownHandler);qa.on(document,"click.bs.dropdown.data-api",Aa.clearMenus);qa.on(document,"keyup.bs.dropdown.data-api",Aa.clearMenus);qa.on(document,"click.bs.dropdown.data-api",'[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',function(r){r.preventDefault();Aa.getOrCreateInstance(this).toggle()});Lb(Aa);let Ka={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},
Qa={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class fb extends hc{static get Default(){return Ka}static get DefaultType(){return Qa}static get NAME(){return"backdrop"}show(r){if(!this._config.isVisible)return void yb(r);this._append();let y=this._getElement();this._config.isAnimated&&y.offsetHeight;y.classList.add("show");this._emulateAnimation(()=>{yb(r)})}hide(r){this._config.isVisible?(this._getElement().classList.remove("show"),
this._emulateAnimation(()=>{this.dispose();yb(r)})):yb(r)}dispose(){this._isAppended&&(qa.off(this._element,"mousedown.bs.backdrop"),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){let r=document.createElement("div");r.className=this._config.className;this._config.isAnimated&&r.classList.add("fade");this._element=r}return this._element}_configAfterMerge(r){return r.rootElement=Pb(r.rootElement),r}_append(){if(!this._isAppended){var r=this._getElement();this._config.rootElement.append(r);
qa.on(r,"mousedown.bs.backdrop",()=>{yb(this._config.clickCallback)});this._isAppended=!0}}_emulateAnimation(r){mb(r,this._getElement(),this._config.isAnimated)}constructor(r){super();this._config=this._getConfig(r);this._isAppended=!1;this._element=null}}let ib={autofocus:!0,trapElement:null},qc={autofocus:"boolean",trapElement:"element"};class Mc extends hc{static get Default(){return ib}static get DefaultType(){return qc}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&
this._config.trapElement.focus(),qa.off(document,".bs.focustrap"),qa.on(document,"focusin.bs.focustrap",r=>this._handleFocusin(r)),qa.on(document,"keydown.tab.bs.focustrap",r=>this._handleKeydown(r)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,qa.off(document,".bs.focustrap"))}_handleFocusin(r){let {trapElement:y}=this._config;r.target===document||r.target===y||y.contains(r.target)||(r=La.focusableChildren(y),0===r.length?y.focus():this._lastTabNavDirection==="backward"?r[r.length-
1].focus():r[0].focus())}_handleKeydown(r){"Tab"===r.key&&(this._lastTabNavDirection=r.shiftKey?"backward":"forward")}constructor(r){super();this._config=this._getConfig(r);this._isActive=!1;this._lastTabNavDirection=null}}class af{getWidth(){return Math.abs(window.innerWidth-document.documentElement.clientWidth)}hide(){let r=this.getWidth();this._disableOverFlow();this._setElementAttributes(this._element,"padding-right",y=>y+r);this._setElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",
"padding-right",y=>y+r);this._setElementAttributes(".sticky-top","margin-right",y=>y-r)}reset(){this._resetElementAttributes(this._element,"overflow");this._resetElementAttributes(this._element,"padding-right");this._resetElementAttributes(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top","padding-right");this._resetElementAttributes(".sticky-top","margin-right")}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow");this._element.style.overflow=
"hidden"}_setElementAttributes(r,y,J){let R=this.getWidth();this._applyManipulationCallback(r,fa=>{if(!(fa!==this._element&&window.innerWidth>fa.clientWidth+R)){this._saveInitialAttribute(fa,y);var ra=window.getComputedStyle(fa).getPropertyValue(y);fa.style.setProperty(y,`${J(Number.parseFloat(ra))}px`)}})}_saveInitialAttribute(r,y){let J=r.style.getPropertyValue(y);J&&ac.setDataAttribute(r,y,J)}_resetElementAttributes(r,y){this._applyManipulationCallback(r,J=>{let R=ac.getDataAttribute(J,y);null!==
R?(ac.removeDataAttribute(J,y),J.style.setProperty(y,R)):J.style.removeProperty(y)})}_applyManipulationCallback(r,y){if(bb(r))y(r);else for(let J of La.find(r,this._element))y(J)}constructor(){this._element=document.body}}let rh={backdrop:!0,focus:!0,keyboard:!0},sh={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class wd extends Zb{static get Default(){return rh}static get DefaultType(){return sh}static get NAME(){return"modal"}toggle(r){return this._isShown?this.hide():this.show(r)}show(r){this._isShown||
this._isTransitioning||qa.trigger(this._element,"show.bs.modal",{relatedTarget:r}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add("modal-open"),this._adjustDialog(),this._backdrop.show(()=>this._showElement(r)))}hide(){this._isShown&&!this._isTransitioning&&(qa.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove("show"),this._queueCallback(()=>
this._hideModal(),this._element,this._isAnimated())))}dispose(){qa.off(window,".bs.modal");qa.off(this._dialog,".bs.modal");this._backdrop.dispose();this._focustrap.deactivate();super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new fb({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Mc({trapElement:this._element})}_showElement(r){document.body.contains(this._element)||document.body.append(this._element);this._element.style.display=
"block";this._element.removeAttribute("aria-hidden");this._element.setAttribute("aria-modal",!0);this._element.setAttribute("role","dialog");this._element.scrollTop=0;let y=La.findOne(".modal-body",this._dialog);y&&(y.scrollTop=0);this._element.offsetHeight;this._element.classList.add("show");this._queueCallback(()=>{this._config.focus&&this._focustrap.activate();this._isTransitioning=!1;qa.trigger(this._element,"shown.bs.modal",{relatedTarget:r})},this._dialog,this._isAnimated())}_addEventListeners(){qa.on(this._element,
"keydown.dismiss.bs.modal",r=>{"Escape"===r.key&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())});qa.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()});qa.on(this._element,"mousedown.dismiss.bs.modal",r=>{qa.one(this._element,"click.dismiss.bs.modal",y=>{this._element===r.target&&this._element===y.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display=
"none";this._element.setAttribute("aria-hidden",!0);this._element.removeAttribute("aria-modal");this._element.removeAttribute("role");this._isTransitioning=!1;this._backdrop.hide(()=>{document.body.classList.remove("modal-open");this._resetAdjustments();this._scrollBar.reset();qa.trigger(this._element,"hidden.bs.modal")})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(!qa.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented){var r=this._element.scrollHeight>
document.documentElement.clientHeight,y=this._element.style.overflowY;"hidden"===y||this._element.classList.contains("modal-static")||(r||(this._element.style.overflowY="hidden"),this._element.classList.add("modal-static"),this._queueCallback(()=>{this._element.classList.remove("modal-static");this._queueCallback(()=>{this._element.style.overflowY=y},this._dialog)},this._dialog),this._element.focus())}}_adjustDialog(){let r=this._element.scrollHeight>document.documentElement.clientHeight,y=this._scrollBar.getWidth(),
J=y>0;J&&!r&&(this._element.style["rtl"===document.documentElement.dir?"paddingLeft":"paddingRight"]=`${y}px`);!J&&r&&(this._element.style["rtl"===document.documentElement.dir?"paddingRight":"paddingLeft"]=`${y}px`)}_resetAdjustments(){this._element.style.paddingLeft="";this._element.style.paddingRight=""}static jQueryInterface(r,y){return this.each(function(){let J=wd.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===J[r])throw TypeError(`No method named "${r}"`);J[r](y)}})}constructor(r,
y){super(r,y);this._dialog=La.findOne(".modal-dialog",this._element);this._backdrop=this._initializeBackDrop();this._focustrap=this._initializeFocusTrap();this._isTransitioning=this._isShown=!1;this._scrollBar=new af;this._addEventListeners()}}qa.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(r){let y=La.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&r.preventDefault();qa.one(y,"show.bs.modal",J=>{J.defaultPrevented||qa.one(y,"hidden.bs.modal",()=>{Ia(this)&&
this.focus()})});(r=La.findOne(".modal.show"))&&wd.getInstance(r).hide();wd.getOrCreateInstance(y).toggle(this)});Qb(wd);Lb(wd);let th={backdrop:!0,keyboard:!0,scroll:!1},uh={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Tc extends Zb{static get Default(){return th}static get DefaultType(){return uh}static get NAME(){return"offcanvas"}toggle(r){return this._isShown?this.hide():this.show(r)}show(r){this._isShown||qa.trigger(this._element,"show.bs.offcanvas",{relatedTarget:r}).defaultPrevented||
(this._isShown=!0,this._backdrop.show(),this._config.scroll||(new af).hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add("showing"),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate();this._element.classList.add("show");this._element.classList.remove("showing");qa.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:r})},this._element,!0))}hide(){this._isShown&&(qa.trigger(this._element,
"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add("hiding"),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove("show","hiding");this._element.removeAttribute("aria-modal");this._element.removeAttribute("role");this._config.scroll||(new af).reset();qa.trigger(this._element,"hidden.bs.offcanvas")},this._element,!0)))}dispose(){this._backdrop.dispose();this._focustrap.deactivate();super.dispose()}_initializeBackDrop(){let r=
!!this._config.backdrop;return new fb({className:"offcanvas-backdrop",isVisible:r,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:r?()=>{"static"!==this._config.backdrop?this.hide():qa.trigger(this._element,"hidePrevented.bs.offcanvas")}:null})}_initializeFocusTrap(){return new Mc({trapElement:this._element})}_addEventListeners(){qa.on(this._element,"keydown.dismiss.bs.offcanvas",r=>{"Escape"===r.key&&(this._config.keyboard?this.hide():qa.trigger(this._element,"hidePrevented.bs.offcanvas"))})}static jQueryInterface(r){return this.each(function(){let y=
Tc.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===y[r]||r.startsWith("_")||"constructor"===r)throw TypeError(`No method named "${r}"`);y[r](this)}})}constructor(r,y){super(r,y);this._isShown=!1;this._backdrop=this._initializeBackDrop();this._focustrap=this._initializeFocusTrap();this._addEventListeners()}}qa.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(r){let y=La.getElementFromSelector(this);(["A","AREA"].includes(this.tagName)&&r.preventDefault(),
ob(this))||(qa.one(y,"hidden.bs.offcanvas",()=>{Ia(this)&&this.focus()}),(r=La.findOne(".offcanvas.show"))&&r!==y&&Tc.getInstance(r).hide(),Tc.getOrCreateInstance(y).toggle(this))});qa.on(window,"load.bs.offcanvas.data-api",()=>{for(let r of La.find(".offcanvas.show"))Tc.getOrCreateInstance(r).show()});qa.on(window,"resize.bs.offcanvas",()=>{for(let r of La.find("[aria-modal][class*=show][class*=offcanvas-]"))"fixed"!==getComputedStyle(r).position&&Tc.getOrCreateInstance(r).hide()});Qb(Tc);Lb(Tc);
let pg={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:"src srcset alt title width height".split(" "),li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},vh=new Set("background cite href itemtype longdesc poster src xlink:href".split(" ")),wh=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,xh=(r,y)=>{let J=
r.nodeName.toLowerCase();return y.includes(J)?!vh.has(J)||!!wh.test(r.nodeValue):y.filter(R=>R instanceof RegExp).some(R=>R.test(J))},yh={allowList:pg,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},zh={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Ah={entry:"(string|element|function|null)",selector:"(string|element)"};class Bh extends hc{static get Default(){return yh}static get DefaultType(){return zh}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(r=>
this._resolvePossibleFunction(r)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(r){return this._checkContent(r),this._config.content={...this._config.content,...r},this}toHtml(){var r=document.createElement("div");for(let [J,R]of(r.innerHTML=this._maybeSanitize(this._config.template),Object.entries(this._config.content)))this._setContent(r,R,J);r=r.children[0];let y=this._resolvePossibleFunction(this._config.extraClass);return y&&r.classList.add(...y.split(" ")),r}_typeCheckConfig(r){super._typeCheckConfig(r);
this._checkContent(r.content)}_checkContent(r){for(let [y,J]of Object.entries(r))super._typeCheckConfig({selector:y,entry:J},Ah)}_setContent(r,y,J){(r=La.findOne(J,r))&&((y=this._resolvePossibleFunction(y))?bb(y)?this._putElementInTemplate(Pb(y),r):this._config.html?r.innerHTML=this._maybeSanitize(y):r.textContent=y:r.remove())}_maybeSanitize(r){if(this._config.sanitize){var y=this._config.allowList;var J=this._config.sanitizeFn;if(r.length)if(J&&"function"==typeof J)y=J(r);else{r=(new window.DOMParser).parseFromString(r,
"text/html");for(let fa of[].concat(...r.body.querySelectorAll("*"))){var R=fa.nodeName.toLowerCase();if(Object.keys(y).includes(R)){J=[].concat(...fa.attributes);R=[].concat(y["*"]||[],y[R]||[]);for(let ra of J)xh(ra,R)||fa.removeAttribute(ra.nodeName)}else fa.remove()}y=r.body.innerHTML}else y=r}else y=r;return y}_resolvePossibleFunction(r){return yb(r,[void 0,this])}_putElementInTemplate(r,y){this._config.html?(y.innerHTML="",y.append(r)):y.textContent=r.textContent}constructor(r){super();this._config=
this._getConfig(r)}}let Ch=new Set(["sanitize","allowList","sanitizeFn"]),Dh={AUTO:"auto",TOP:"top",RIGHT:"rtl"===document.documentElement.dir?"left":"right",BOTTOM:"bottom",LEFT:"rtl"===document.documentElement.dir?"right":"left"},Eh={allowList:pg,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
title:"",trigger:"hover focus"},Fh={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class xd extends Zb{static get Default(){return Eh}static get DefaultType(){return Fh}static get NAME(){return"tooltip"}enable(){this._isEnabled=
!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout);qa.off(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler);this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title"));this._disposePopper();super.dispose()}show(){if("none"===this._element.style.display)throw Error("Please use show on visible elements");
if(this._isWithContent()&&this._isEnabled){var r=qa.trigger(this._element,this.constructor.eventName("show")),y=(hb(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(!r.defaultPrevented&&y){this._disposePopper();r=this._getTipElement();this._element.setAttribute("aria-describedby",r.getAttribute("id"));({container:y}=this._config);if(this._element.ownerDocument.documentElement.contains(this.tip)||(y.append(r),qa.trigger(this._element,this.constructor.eventName("inserted"))),
this._popper=this._createPopper(r),r.classList.add("show"),"ontouchstart"in document.documentElement)for(let J of[].concat(...document.body.children))qa.on(J,"mouseover",Gb);this._queueCallback(()=>{qa.trigger(this._element,this.constructor.eventName("shown"));!1===this._isHovered&&this._leave();this._isHovered=!1},this.tip,this._isAnimated())}}}hide(){if(this._isShown()&&!qa.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove("show"),
"ontouchstart"in document.documentElement)for(let r of[].concat(...document.body.children))qa.off(r,"mouseover",Gb);this._activeTrigger.click=!1;this._activeTrigger.focus=!1;this._activeTrigger.hover=!1;this._isHovered=null;this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),qa.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||
(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(r){r=this._getTemplateFactory(r).toHtml();if(!r)return null;r.classList.remove("fade","show");r.classList.add(`bs-${this.constructor.NAME}-auto`);var y=this.constructor.NAME;do y+=Math.floor(1E6*Math.random());while(document.getElementById(y));return r.setAttribute("id",y.toString()),this._isAnimated()&&r.classList.add("fade"),r}setContent(r){this._newContent=r;this._isShown()&&(this._disposePopper(),
this.show())}_getTemplateFactory(r){return this._templateFactory?this._templateFactory.changeContent(r):this._templateFactory=new Bh({...this._config,content:r,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(r){return this.constructor.getOrCreateInstance(r.delegateTarget,
this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains("fade")}_isShown(){return this.tip&&this.tip.classList.contains("show")}_createPopper(r){let y=Dh[yb(this._config.placement,[this,r,this._element]).toUpperCase()];return ya(this._element,r,this._getPopperConfig(y))}_getOffset(){let {offset:r}=this._config;return"string"==typeof r?r.split(",").map(y=>Number.parseInt(y,10)):"function"==typeof r?y=>r(y,this._element):r}_resolvePossibleFunction(r){return yb(r,
[this._element,this._element])}_getPopperConfig(r){r={placement:r,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:y=>{this._getTipElement().setAttribute("data-popper-placement",y.state.placement)}}]};return{...r,...yb(this._config.popperConfig,
[void 0,r])}}_setListeners(){for(let r of this._config.trigger.split(" "))if("click"===r)qa.on(this._element,this.constructor.eventName("click"),this._config.selector,y=>{y=this._initializeOnDelegatedTarget(y);y._activeTrigger.click=!(y._isShown()&&y._activeTrigger.click);y.toggle()});else if("manual"!==r){let y=r==="hover"?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),J=r==="hover"?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");qa.on(this._element,
y,this._config.selector,R=>{let fa=this._initializeOnDelegatedTarget(R);fa._activeTrigger["focusin"===R.type?"focus":"hover"]=!0;fa._enter()});qa.on(this._element,J,this._config.selector,R=>{let fa=this._initializeOnDelegatedTarget(R);fa._activeTrigger["focusout"===R.type?"focus":"hover"]=fa._element.contains(R.relatedTarget);fa._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()};qa.on(this._element.closest(".modal"),"hide.bs.modal",this._hideModalHandler)}_fixTitle(){let r=this._element.getAttribute("title");
r&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",r),this._element.setAttribute("data-bs-original-title",r),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(r,
y){clearTimeout(this._timeout);this._timeout=setTimeout(r,y)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(r){let y=ac.getDataAttributes(this._element);for(let J of Object.keys(y))Ch.has(J)&&delete y[J];return r={...y,...("object"==typeof r&&r?r:{})},r=this._mergeConfigObj(r),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}_configAfterMerge(r){return r.container=!1===r.container?document.body:Pb(r.container),"number"==typeof r.delay&&(r.delay={show:r.delay,
hide:r.delay}),"number"==typeof r.title&&(r.title=r.title.toString()),"number"==typeof r.content&&(r.content=r.content.toString()),r}_getDelegateConfig(){let r={};for(let [y,J]of Object.entries(this._config))this.constructor.Default[y]!==J&&(r[y]=J);return r.selector=!1,r.trigger="manual",r}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null);this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(r){return this.each(function(){let y=xd.getOrCreateInstance(this,r);
if("string"==typeof r){if(void 0===y[r])throw TypeError(`No method named "${r}"`);y[r]()}})}constructor(r,y){if(void 0===Ga)throw TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(r,y);this._isEnabled=!0;this._timeout=0;this._isHovered=null;this._activeTrigger={};this.tip=this._newContent=this._templateFactory=this._popper=null;this._setListeners();this._config.selector||this._fixTitle()}}Lb(xd);let Gh={...xd.Default,content:"",offset:[0,8],placement:"right",
template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Hh={...xd.DefaultType,content:"(null|string|element|function)"};class bf extends xd{static get Default(){return Gh}static get DefaultType(){return Hh}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(r){return this.each(function(){let y=
bf.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===y[r])throw TypeError(`No method named "${r}"`);y[r]()}})}}Lb(bf);let Ih={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Jh={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class qe extends Zb{static get Default(){return Ih}static get DefaultType(){return Jh}static get NAME(){return"scrollspy"}refresh(){for(let r of(this._initializeTargetsAndObservables(),
this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver(),this._observableSections.values()))this._observer.observe(r)}dispose(){this._observer.disconnect();super.dispose()}_configAfterMerge(r){return r.target=Pb(r.target)||document.body,r.rootMargin=r.offset?`${r.offset}px 0px -30%`:r.rootMargin,"string"==typeof r.threshold&&(r.threshold=r.threshold.split(",").map(y=>Number.parseFloat(y))),r}_maybeEnableSmoothScroll(){this._config.smoothScroll&&
(qa.off(this._config.target,"click.bs.scrollspy"),qa.on(this._config.target,"click.bs.scrollspy","[href]",r=>{var y=this._observableSections.get(r.target.hash);if(y){r.preventDefault();r=this._rootElement||window;y=y.offsetTop-this._element.offsetTop;if(r.scrollTo)return void r.scrollTo({top:y,behavior:"smooth"});r.scrollTop=y}}))}_getNewObserver(){return new IntersectionObserver(r=>this._observerCallback(r),{root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin})}_observerCallback(r){let y=
ra=>this._targetLinks.get(`#${ra.target.id}`),J=ra=>{this._previousScrollData.visibleEntryTop=ra.target.offsetTop;this._process(y(ra))},R=(this._rootElement||document.documentElement).scrollTop,fa=R>=this._previousScrollData.parentScrollTop;for(let ra of(this._previousScrollData.parentScrollTop=R,r))if(ra.isIntersecting)if(r=ra.target.offsetTop>=this._previousScrollData.visibleEntryTop,fa&&r){if(J(ra),!R)break}else fa||r||J(ra);else this._activeTarget=null,this._clearActiveClass(y(ra))}_initializeTargetsAndObservables(){for(let r of(this._targetLinks=
new Map,this._observableSections=new Map,La.find("[href]",this._config.target))){if(!r.hash||ob(r))continue;let y=La.findOne(decodeURI(r.hash),this._element);Ia(y)&&(this._targetLinks.set(decodeURI(r.hash),r),this._observableSections.set(r.hash,y))}}_process(r){this._activeTarget!==r&&(this._clearActiveClass(this._config.target),this._activeTarget=r,r.classList.add("active"),this._activateParents(r),qa.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:r}))}_activateParents(r){if(r.classList.contains("dropdown-item"))La.findOne(".dropdown-toggle",
r.closest(".dropdown")).classList.add("active");else for(let y of La.parents(r,".nav, .list-group"))for(let J of La.prev(y,".nav-link, .nav-item > .nav-link, .list-group-item"))J.classList.add("active")}_clearActiveClass(r){for(let y of(r.classList.remove("active"),La.find("[href].active",r)))y.classList.remove("active")}static jQueryInterface(r){return this.each(function(){let y=qe.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===y[r]||r.startsWith("_")||"constructor"===r)throw TypeError(`No method named "${r}"`);
y[r]()}})}constructor(r,y){super(r,y);this._targetLinks=new Map;this._observableSections=new Map;this._rootElement="visible"===getComputedStyle(this._element).overflowY?null:this._element;this._observer=this._activeTarget=null;this._previousScrollData={visibleEntryTop:0,parentScrollTop:0};this.refresh()}}qa.on(window,"load.bs.scrollspy.data-api",()=>{for(let r of La.find('[data-bs-spy="scroll"]'))qe.getOrCreateInstance(r)});Lb(qe);class yd extends Zb{static get NAME(){return"tab"}show(){let r=this._element;
if(!this._elemIsActive(r)){var y=this._getActiveElem(),J=y?qa.trigger(y,"hide.bs.tab",{relatedTarget:r}):null;qa.trigger(r,"show.bs.tab",{relatedTarget:y}).defaultPrevented||J&&J.defaultPrevented||(this._deactivate(y,r),this._activate(r,y))}}_activate(r,y){r&&(r.classList.add("active"),this._activate(La.getElementFromSelector(r)),this._queueCallback(()=>{"tab"===r.getAttribute("role")?(r.removeAttribute("tabindex"),r.setAttribute("aria-selected",!0),this._toggleDropDown(r,!0),qa.trigger(r,"shown.bs.tab",
{relatedTarget:y})):r.classList.add("show")},r,r.classList.contains("fade")))}_deactivate(r,y){r&&(r.classList.remove("active"),r.blur(),this._deactivate(La.getElementFromSelector(r)),this._queueCallback(()=>{"tab"===r.getAttribute("role")?(r.setAttribute("aria-selected",!1),r.setAttribute("tabindex","-1"),this._toggleDropDown(r,!1),qa.trigger(r,"hidden.bs.tab",{relatedTarget:y})):r.classList.remove("show")},r,r.classList.contains("fade")))}_keydown(r){if("ArrowLeft ArrowRight ArrowUp ArrowDown Home End".split(" ").includes(r.key)){r.stopPropagation();
r.preventDefault();var y=this._getChildren().filter(J=>!ob(J));if(["Home","End"].includes(r.key))r=y[r.key==="Home"?0:y.length-1];else{let J=["ArrowRight","ArrowDown"].includes(r.key);r=nb(y,r.target,J,!0)}r&&(r.focus({preventScroll:!0}),yd.getOrCreateInstance(r).show())}}_getChildren(){return La.find('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',this._parent)}_getActiveElem(){return this._getChildren().find(r=>
this._elemIsActive(r))||null}_setInitialAttributes(r,y){for(let J of(this._setAttributeIfNotExists(r,"role","tablist"),y))this._setInitialAttributesOnChild(J)}_setInitialAttributesOnChild(r){r=this._getInnerElement(r);let y=this._elemIsActive(r),J=this._getOuterElement(r);r.setAttribute("aria-selected",y);J!==r&&this._setAttributeIfNotExists(J,"role","presentation");y||r.setAttribute("tabindex","-1");this._setAttributeIfNotExists(r,"role","tab");this._setInitialAttributesOnTargetPanel(r)}_setInitialAttributesOnTargetPanel(r){let y=
La.getElementFromSelector(r);y&&(this._setAttributeIfNotExists(y,"role","tabpanel"),r.id&&this._setAttributeIfNotExists(y,"aria-labelledby",`${r.id}`))}_toggleDropDown(r,y){r=this._getOuterElement(r);if(r.classList.contains("dropdown")){var J=La.findOne(".dropdown-toggle",r);J&&J.classList.toggle("active",y);(J=La.findOne(".dropdown-menu",r))&&J.classList.toggle("show",y);r.setAttribute("aria-expanded",y)}}_setAttributeIfNotExists(r,y,J){r.hasAttribute(y)||r.setAttribute(y,J)}_elemIsActive(r){return r.classList.contains("active")}_getInnerElement(r){return r.matches('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]')?
r:La.findOne('.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), [data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',r)}_getOuterElement(r){return r.closest(".nav-item, .list-group-item")||r}static jQueryInterface(r){return this.each(function(){let y=yd.getOrCreateInstance(this);if("string"==typeof r){if(void 0===y[r]||r.startsWith("_")||"constructor"===r)throw TypeError(`No method named "${r}"`);y[r]()}})}constructor(r){super(r);
(this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'))&&(this._setInitialAttributes(this._parent,this._getChildren()),qa.on(this._element,"keydown.bs.tab",y=>this._keydown(y)))}}qa.on(document,"click.bs.tab",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',function(r){["A","AREA"].includes(this.tagName)&&r.preventDefault();ob(this)||yd.getOrCreateInstance(this).show()});qa.on(window,"load.bs.tab",()=>{for(let r of La.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))yd.getOrCreateInstance(r)});
Lb(yd);let Kh={animation:"boolean",autohide:"boolean",delay:"number"},Lh={animation:!0,autohide:!0,delay:5E3};class re extends Zb{static get Default(){return Lh}static get DefaultType(){return Kh}static get NAME(){return"toast"}show(){qa.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),this._element.offsetHeight,this._element.classList.add("show","showing"),this._queueCallback(()=>
{this._element.classList.remove("showing");qa.trigger(this._element,"shown.bs.toast");this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(qa.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add("showing"),this._queueCallback(()=>{this._element.classList.add("hide");this._element.classList.remove("showing","show");qa.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout();
this.isShown()&&this._element.classList.remove("show");super.dispose()}isShown(){return this._element.classList.contains("show")}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(r,y){switch(r.type){case "mouseover":case "mouseout":this._hasMouseInteraction=y;break;case "focusin":case "focusout":this._hasKeyboardInteraction=y}if(y)return void this._clearTimeout();r=
r.relatedTarget;this._element===r||this._element.contains(r)||this._maybeScheduleHide()}_setListeners(){qa.on(this._element,"mouseover.bs.toast",r=>this._onInteraction(r,!0));qa.on(this._element,"mouseout.bs.toast",r=>this._onInteraction(r,!1));qa.on(this._element,"focusin.bs.toast",r=>this._onInteraction(r,!0));qa.on(this._element,"focusout.bs.toast",r=>this._onInteraction(r,!1))}_clearTimeout(){clearTimeout(this._timeout);this._timeout=null}static jQueryInterface(r){return this.each(function(){let y=
re.getOrCreateInstance(this,r);if("string"==typeof r){if(void 0===y[r])throw TypeError(`No method named "${r}"`);y[r](this)}})}constructor(r,y){super(r,y);this._timeout=null;this._hasKeyboardInteraction=this._hasMouseInteraction=!1;this._setListeners()}}return Qb(re),Lb(re),{Alert:vc,Button:D,Carousel:Ma,Collapse:Ub,Dropdown:Aa,Modal:wd,Offcanvas:Tc,Popover:bf,ScrollSpy:qe,Tab:yd,Toast:re,Tooltip:xd}}();var Va={};for(let c of(!function(d){function b(x,F){for(var w=x.length;w--;)if(x[w]===F)return w;
return-1}function h(x,F,w){var G=g(x);void 0===w&&(w=F,F="all");for(var H=0;H<G.length;H++){var P=[];(x=G[H].split("+")).length>1&&(P=e(x),x=[x[x.length-1]]);(x=u(x=x[0]))in f||(f[x]=[]);f[x].push({shortcut:G[H],scope:F,method:w,key:G[H],mods:P})}}function p(){return n||"all"}function g(x){var F;return""==(F=x.replace(/\s/g,"").split(","))[F.length-1]&&(F[F.length-2]+=","),F}function e(x){x=x.slice(0,x.length-1);for(var F=0;F<x.length;F++)x[F]=q[x[F]];return x}function k(x,F,w){x.addEventListener&&
x.addEventListener(F,w,!1)}var l,f={},m={16:!1,18:!1,17:!1,91:!1},n="all",q={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},t={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},u=function(x){x=t[x]||x.toUpperCase().charCodeAt(0);return"function"==
typeof x?x():x},v=[];for(l=1;l<20;l++)t["f"+l]=111+l;var A={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(l in q)h[l]=!1;k(document,"keydown",function(x){!function(F){var w,G,H,P,B;if(-1==b(v,w=If(F.key))&&v.push(w),w in m)for(H in m[w]=!0,q)q[H]==w&&(h[H]=!0);else{for(l in m)m[l]=F[A[l]];if(h.filter.call(this,F)&&w in f){var O=0;for(B=p();O<f[w].length;O++)if((G=f[w][O]).scope==B||"all"==G.scope){for(H in P=G.mods.length>0,m)(!m[H]&&b(G.mods,+H)>-1||m[H]&&-1==b(G.mods,+H))&&(P=!1);(0!=
G.mods.length||m[16]||m[18]||m[17]||m[91])&&!P||!1!==G.method(F,G)||(F.preventDefault?F.preventDefault():F.returnValue=!1,F.stopPropagation&&F.stopPropagation(),F.cancelBubble&&(F.cancelBubble=!0))}}}}(x)});k(document,"keyup",function(x){var F;x=If(x.key);var w=b(v,x);if(w>=0&&v.splice(w,1),x in m)for(F in m[x]=!1,q)q[F]==x&&(h[F]=!1)});k(window,"focus",function(){for(l in m)m[l]=!1;for(l in q)h[l]=!1});var C=d.key;d.key=h;d.key.setScope=function(x){n=x||"all"};d.key.getScope=p;d.key.deleteScope=
function(x){var F,w;for(F in f){var G=0;for(w=f[F];G<w.length;)w[G].scope===x?w.splice(G,1):G++}};d.key.filter=function(x){x=(x.target||x.srcElement).tagName;return"INPUT"!=x&&"SELECT"!=x&&"TEXTAREA"!=x};d.key.isPressed=function(x){return"string"==typeof x&&(x=u(x)),-1!=b(v,x)};d.key.getPressedKeyCodes=function(){return v.slice(0)};d.key.noConflict=function(){var x=d.key;return d.key=C,x};d.key.unbind=function(x,F){var w,G,H,P,B=[];var O=0;for(w=g(x);O<w.length&&((G=w[O].split("+")).length>1&&(B=
e(G)),x=u(x=G[G.length-1]),void 0===F&&(F=p()),f[x]);O++)for(H=0;H<f[x].length;H++){var T;if(T=(P=f[x][H]).scope===F)a:if(P=P.mods,P.length!=B.length)T=!1;else{for(T=0;T<P.length;T++)if(P[T]!==B[T]){T=!1;break a}T=!0}T&&(f[x][H]={})}};Va=h}(Va||{}),Zc.prototype.clone=function(){for(var d=new Zc(Array(this.points.length)),b=0;b<this.points.length;b++)d.points[b]={x:this.points[b].x,y:this.points[b].y};return d},Zc.prototype.getTransformed=function(d){for(var b=new Zc(Array(this.points.length)),h=0;h<
this.points.length;h++)b.points[h]=d.getTransformedPoint(this.points[h]);return b},Zc.prototype.getCenter=function(){for(var d=this.points[0].x,b=this.points[0].y,h=1;h<this.points.length;h++)d+=this.points[h].x,b+=this.points[h].y;return{x:d/this.points.length,y:b/this.points.length}},Zc.prototype.containsPoint=function(d){var b,h=!1;var p=0;for(b=this.points.length-1;p<this.points.length;b=p++)this.points[p].y>d.y!=this.points[b].y>d.y&&d.x<(this.points[b].x-this.points[p].x)*(d.y-this.points[p].y)/
(this.points[b].y-this.points[p].y)+this.points[p].x&&(h=!h);return h},xb.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},xb.prototype.normalize=function(){var d=this.getLength();return this.x/=d,this.y/=d,this},xb.prototype.getDotProduct=function(d){return this.x*d.x+this.y*d.y},xb.prototype.scale=function(d){return this.x*=d,this.y*=d,this},xb.prototype.getScaled=function(d){var b=new xb(this.x,this.y);return b.scale(d),b},xb.prototype.getRounded=function(){return new xb(Math.round(this.x),
Math.round(this.y))},xb.prototype.getTruncated=function(){return new xb(~~this.x,~~this.y)},xb.prototype.getPerpendicular=function(){return new xb(-this.y,this.x)},xb.prototype.add=function(d){return this.x+=d.x,this.y+=d.y,this},xb.prototype.subtract=function(d){return this.x-=d.x,this.y-=d.y,this},xb.prototype.getSum=function(d){return new xb(this.x+d.x,this.y+d.y)},xb.subtractPoints=function(d,b){return new xb(d.x-b.x,d.y-b.y)},Dd.prototype=Object.create(Ja(Ib).prototype),Dd.prototype.constructor=
Dd,Wb.MODE_INDEX_DEFAULT=0,Wb.MODE_INDEX_USER=1,Wb.prototype.setMode=function(d,b){var h=this.modes[d];h!=b&&(h&&h.leave(),this.modes[d]=b,b.enter())},Wb.prototype.setDefaultMode=function(d){d.transient=!1;d.capture=!1;this.setMode(Wb.MODE_INDEX_DEFAULT,d)},Wb.prototype.setUserMode=function(d){for(var b=this.modes.length-1;b>Wb.MODE_INDEX_USER;b--)this.modes[b].leave(),this.modes.splice(b,1);d.transient=!1;d.capture=!1;this.setMode(Wb.MODE_INDEX_USER,d)},Wb.prototype.deliverEvent=function(d,b){for(var h=
this.modes.length-1;h>=0;h--){var p=this.modes[h];if(p[d].apply(p,b)||p.capture&&"paint"!=d)return!0}return!1},["mouseDown","mouseUp"]))Wb.prototype[c]=function(d,b,h){this.deliverEvent(c,[d,b,h])};for(let c of["mouseDrag","mouseMove"])Wb.prototype[c]=function(d,b){this.deliverEvent(c,[d,b])};for(let c of["keyDown","keyUp"])Wb.prototype[c]=function(d){this.deliverEvent(c,[d])&&d.preventDefault()};Wb.prototype.paint=function(c){this.deliverEvent("paint",[c])};Wb.prototype.push=function(c,d){var b=
this.peek();b&&b.suspend();c.transient=d;c.capture=!1;c.enter();this.modes.push(c)};Wb.prototype.peek=function(){return this.modes.length>0?this.modes[this.modes.length-1]:null};Wb.prototype.pop=function(){var c=this.modes.pop(),d=this.peek();return c&&c.leave(),d&&d.resume(),d};Wd.prototype=Object.create(Ja(Ib).prototype);Wd.prototype.constructor=Wd;Sb.prototype=Object.create(Ja(Ib).prototype);Sb.prototype.constructor=Ja(Ib);Zd.prototype=Object.create(Sb.prototype);Zd.prototype.constructor=Zd;$d.prototype=
Object.create(Sb.prototype);$d.prototype.constructor=$d;ae.prototype=Object.create(Sb.prototype);ae.prototype.constructor=ae;let se=window.devicePixelRatio||1,ed=Math.round(128*se),fd=Math.round(128*se);class Mf{_makeBitmap(){if(this._bitmapInvalid){var c=0,d=this._imageData.data;if(this._greyscale)for(var b=0;b<fd;b++){var h=255-Math.round(b/(fd-1)*255);for(var p=0;p<ed;p++)d[c+I.RED_BYTE_OFFSET]=h,d[c+I.GREEN_BYTE_OFFSET]=h,d[c+I.BLUE_BYTE_OFFSET]=h,d[c+I.ALPHA_BYTE_OFFSET]=255,c+=I.BYTES_PER_PIXEL}else for(b=
this.color.clone(),h=0;h<fd;h++)for(b.setValue(255-~~(h/(fd-1)*255)),p=0;p<ed;p++)b.setSaturation(Math.round(p/(ed-1)*255)),d[c+I.RED_BYTE_OFFSET]=b.rgb>>16&255,d[c+I.GREEN_BYTE_OFFSET]=b.rgb>>8&255,d[c+I.BLUE_BYTE_OFFSET]=255&b.rgb,d[c+I.ALPHA_BYTE_OFFSET]=255,c+=I.BYTES_PER_PIXEL;this._bitmapInvalid=!1}}paint(){this._makeBitmap();this._canvasContext.putImageData(this._imageData,0,0);let c=this.color.getSaturation()/255*(ed-1),d=(255-this.color.getValue())/255*(fd-1);Vd(this._canvasContext,"stroke");
this._canvasContext.lineWidth=1.5*se;this._canvasContext.beginPath();this._greyscale?(this._canvasContext.moveTo(0,d),this._canvasContext.lineTo(ed,d)):this._canvasContext.arc(c,d,5*se,0,2*Math.PI);this._canvasContext.stroke();this._canvasContext.globalCompositeOperation="source-over"}_mousePickColor(c){let d=this._canvas.getBoundingClientRect();var b=c.pageX-window.scrollX-d.left;c=Math.max(Math.min(255-~~(255*(c.pageY-window.scrollY-d.top)/127),255),0);this._greyscale?this.color.setGreyscale(c):
(b=Math.max(Math.min(~~(255*b/127),255),0),this.color.setHsv(this.color.getHue(),b,c));this.paint();this._controller.setCurColor(this.color)}_endDrag(c){this._canvas.releasePointerCapture(c.pointerId);this._capturedMouse=!1;this._canvas.removeEventListener("pointerup",this._handleEndDrag);this._canvas.removeEventListener("pointermove",this._handleMousePickColor)}_startDrag(c){this._capturedMouse||(this._capturedMouse=!0,this._canvas.setPointerCapture(c.pointerId),this._canvas.addEventListener("pointerup",
this._handleEndDrag),this._canvas.addEventListener("pointermove",this._handleMousePickColor));this._handleMousePickColor(c)}setHue(c){this.color.getHue()!=c&&(this.color.setHue(c),this._controller.setCurColor(this.color))}getElement(){return this._canvas}constructor(c,d){bc(this,"_controller",void 0);bc(this,"_canvas",void 0);bc(this,"_canvasContext",void 0);bc(this,"_imageData",void 0);bc(this,"_bitmapInvalid",!0);bc(this,"_capturedMouse",!1);bc(this,"_greyscale",!1);bc(this,"color",new jb(0));this._controller=
c;let b=document.createElement("canvas");this._canvas=b;b.className="chickenpaint-colorpicker-select";b.setAttribute("touch-action","none");b.width=ed;b.height=fd;b.style.width="128px";b.style.height="128px";this._canvasContext=b.getContext("2d");this._imageData=this._canvasContext.createImageData(ed,fd);this._canvasContext.getImageData(0,0,1,1);this._handleEndDrag=this._endDrag.bind(this);this._handleMousePickColor=this._mousePickColor.bind(this);b.addEventListener("pointerdown",h=>this._startDrag(h));
d&&this.color.copyFrom(d);c.on("colorChange",h=>{this.color.copyFrom(h);this._bitmapInvalid=!0;this.paint()});c.on("colorModeChange",h=>{this._greyscale="greyscale"==h;this._bitmapInvalid=!0;this.paint()});this.paint()}}class Nf{paint(){this._canvasContext.putImageData(this._imageData,0,0);let c=128*this.hue/360;Vd(this._canvasContext,"stroke");this._canvasContext.lineWidth=1.5;this._canvasContext.beginPath();this._canvasContext.moveTo(0,c);this._canvasContext.lineTo(24,c);this._canvasContext.stroke();
this._canvasContext.globalCompositeOperation="source-over"}_mousePickColor(c){let d=this._canvas.getBoundingClientRect();this.hue=Math.max(0,Math.min(359,~~(360*(c.pageY-d.top)/128)));this.paint();this.selecter&&this.selecter.setHue(this.hue)}_endDrag(c){this._canvas.releasePointerCapture(c.pointerId);this._capturedMouse=!1;this._canvas.removeEventListener("pointerup",this._handleEndDrag);this._canvas.removeEventListener("pointermove",this._handleMousePickColor)}_startDrag(c){this._capturedMouse||
(this._capturedMouse=!0,this._canvas.setPointerCapture(c.pointerId),this._canvas.addEventListener("pointerup",this._handleEndDrag),this._canvas.addEventListener("pointermove",this._handleMousePickColor));this._handleMousePickColor(c)}getElement(){return this._canvas}setHue(c){this.hue=c;this.paint()}constructor(c,d,b){bc(this,"hue",void 0);bc(this,"selecter",void 0);bc(this,"_canvas",void 0);bc(this,"_canvasContext",void 0);bc(this,"_imageData",void 0);bc(this,"_capturedMouse",!1);this.selecter=d;
this.hue=b||0;let h=document.createElement("canvas");this._canvas=h;c.on("colorChange",p=>{this.setHue(p.getHue())});c.on("colorModeChange",p=>{h.style.display="greyscale"==p?"none":"block"});h.setAttribute("touch-action","none");h.addEventListener("pointerdown",p=>this._startDrag(p));h.width=24;h.height=128;h.className="chickenpaint-colorpicker-slider";this._canvasContext=h.getContext("2d");this._imageData=this._canvasContext.createImageData(24,128);this._canvasContext.getImageData(0,0,1,1);this._handleEndDrag=
this._endDrag.bind(this);this._handleMousePickColor=this._mousePickColor.bind(this);(function(p){let g=new jb(65535),e=0,k=p.data;for(let l=0;l<p.height;l++){g.setHue(359*l/p.height);for(let f=0;f<p.width;f++)k[e+I.RED_BYTE_OFFSET]=g.rgb>>16&255,k[e+I.GREEN_BYTE_OFFSET]=g.rgb>>8&255,k[e+I.BLUE_BYTE_OFFSET]=255&g.rgb,k[e+I.ALPHA_BYTE_OFFSET]=255,e+=I.BYTES_PER_PIXEL}})(this._imageData);this.paint()}}be.prototype=Object.create(Sb.prototype);be.prototype.constructor=be;nd.prototype=Object.create(Ja(Ib).prototype);
nd.prototype.constructor=nd;Nb.prototype=Object.create(Ja(Ib).prototype);Nb.prototype.constructor=Nb;Fd.prototype=Object.create(Ja(Ib).prototype);Fd.prototype.constructor=Fd;od.prototype=Object.create(Sb.prototype);od.prototype.constructor=od;od.CPBrushPreview=function(c){function d(){e.clearRect(0,0,g.width,g.height);e.beginPath();e.arc(g.width/2,g.height/2,p/2*window.devicePixelRatio,0,2*Math.PI);e.stroke()}function b(l){let f=g.getBoundingClientRect();var m=l.clientX-f.left-g.clientWidth/2;l=l.clientY-
f.top-g.clientHeight/2;m=Math.max(1,Math.min(200,Math.round(2*Math.sqrt(m*m+l*l))));d();c.setBrushSize(m)}function h(l){k&&(k=!1,document.removeEventListener("pointerup",h,{capture:!1}),document.removeEventListener("pointermove",b,{capture:!1}))}let p=16,g=document.createElement("canvas"),e=g.getContext("2d"),k=!1;g.addEventListener("pointerdown",function(l){k||(k=!0,document.addEventListener("pointerup",h,{passive:!0,capture:!1}),document.addEventListener("pointermove",b,{passive:!0,capture:!1}),
b(l))});this.getElement=function(){return g};c.on("toolChange",function(l,f){f.size!=p&&(p=f.size,d())});g.width=64;g.height=64;window.devicePixelRatio>1&&(g.style.width=g.width+"px",g.style.height=g.height+"px",g.width*=window.devicePixelRatio,g.height*=window.devicePixelRatio);g.className="chickenpaint-brush-preview";e.strokeStyle="black";e.lineWidth=+window.devicePixelRatio;d()};ce.prototype=Object.create(Sb.prototype);ce.prototype.constructor=ce;de.prototype=Object.create(Sb.prototype);de.prototype.constructor=
de;ee.prototype=Object.create(Sb.prototype);ee.prototype.constructor=ee;fe.prototype=Object.create(Ja(Ib).prototype);fe.prototype.constructor=fe;let Rf=[{name:"File",mnemonic:"F",children:[{name:"Export as png",action:"CPExportAsPNG",mnemonic:"S",shortcut:"ctrl+s"},{name:"Export as zip",action:"CPExportAsZIP",title:U("Save the PNG image, CHI project file, and swatches file together as a ZIP package"),mnemonic:"S",shortcut:"shift+alt+s"},{name:"-"},{name:"Backup to browser storage",action:"CPSaveDBFromMenu",
title:U("Save the current drawing to the browser's local database"),mnemonic:"S"},{name:"Save Oekaki",action:"CPSend",title:U("Finish drawing and post to the server"),mnemonic:"S",shortcut:"ctrl+s"}]},{name:"Edit",mnemonic:"E",children:[{name:"Undo",action:"CPUndo",mnemonic:"U",shortcut:"ctrl+z"},{name:"Redo",action:"CPRedo",mnemonic:"R",shortcut:"ctrl+y"},{name:"Clear history",action:"CPClearHistory",mnemonic:"H",title:U("Removes all undo/redo information to regain memory")},{name:"-"},{name:"Cut",
action:"CPCut",mnemonic:"T",shortcut:"ctrl+x"},{name:"Copy",action:"CPCopy",mnemonic:"C",shortcut:"ctrl+c"},{name:"Copy merged",action:"CPCopyMerged",mnemonic:"Y",shortcut:"shift+ctrl+c"},{name:"Paste",action:"CPPaste",mnemonic:"P",shortcut:"ctrl+v"},{name:"-"},{name:"Select all",action:"CPSelectAll",mnemonic:"A",shortcut:"ctrl+a"},{name:"Deselect",action:"CPDeselectAll",mnemonic:"D",shortcut:"ctrl+d"},{name:"-"},{name:"Transform",action:"CPTransform",mnemonic:"T",shortcut:"ctrl+h"}]},{name:"Layers",
mnemonic:"L",children:[{name:"Duplicate",action:"CPLayerDuplicate",mnemonic:"D",shortcut:"shift+ctrl+d"},{name:"-"},{name:"Merge down",action:"CPLayerMergeDown",mnemonic:"E",shortcut:"ctrl+e"},{name:"Merge group",action:"CPGroupMerge",mnemonic:"G",shortcut:"shift+ctrl+g"},{name:"Merge all layers",action:"CPLayerMergeAll",shortcut:"shift+ctrl+e",mnemonic:"A"},{name:"Create merged layer",action:"CPCreateMergedLayer",shortcut:"shift+alt+e"},{name:"-"},{hideIfNotAvailable:!0,name:"Add layer mask",action:"CPAddLayerMask"},
{hideIfNotAvailable:!0,name:"Delete layer mask",action:"CPRemoveLayerMask",shortcut:"shift+m"},{hideIfNotAvailable:!0,name:"Apply layer mask",action:"CPApplyLayerMask",shortcut:"ctrl+m"},{name:"-"},{hideIfNotAvailable:!0,name:"Clip to the layer below",action:"CPCreateClippingMask"},{hideIfNotAvailable:!0,name:"Unclip from the layer below",action:"CPReleaseClippingMask"}]},{name:"Effects",mnemonic:"E",children:[{name:"Clear",action:"CPClear",mnemonic:"D",shortcut:"del,backspace"},{name:"Clear with texture",
action:"CPClearWithTexture",mnemonic:"T",shortcut:"shift+x"},{name:"Fill",action:"CPFill",mnemonic:"F",shortcut:"ctrl+f"},{name:"-"},{name:"Box blur...",action:"CPFXBoxBlur",mnemonic:"B"},{name:"Mosaic",action:"CPFXMosaic",mnemonic:"M"},{name:"Chromatic aberration",action:"CPChromaticAberration",mnemonic:"C"},{name:"-"},{name:"Color halftone",action:"CPColorHalftone",mnemonic:"C"},{name:"Mono halftone",action:"CPMonoHalftone",mnemonic:"M"},{name:"-"},{name:"Edge expand",action:"CPEdgeExpand",mnemonic:"E"},
{name:"-"},{name:"Monochromatic noise",action:"CPMNoise",mnemonic:"M",title:U("Fills the selection with noise")},{name:"Color noise",action:"CPCNoise",mnemonic:"C",title:U("Fills the selection with colored noise")},{name:"-"},{name:"Flip horizontal",action:"CPHFlip",mnemonic:"Q",shortcut:"q"},{name:"Flip vertical",action:"CPVFlip",mnemonic:"V"},{name:"Invert",action:"CPFXInvert",mnemonic:"I",shortcut:"ctrl+i",title:U("Invert the image colors")},{name:"-"},{name:"Convert brightness to opacity",action:"CPBrightnessToOpacity",
mnemonic:"B",title:U("Convert brightness to opacity")}]},{name:"View",mnemonic:"V",children:[{name:"Full-screen mode",action:"CPFullScreen",mnemonic:"F",checkbox:!0,checked:!1},{name:"-"},{name:"Zoom in",action:"CPZoomIn",mnemonic:"I",shortcut:"="},{name:"Zoom out",action:"CPZoomOut",mnemonic:"O",shortcut:"-"},{name:"Zoom 100%",action:"CPZoom100",mnemonic:"1",shortcut:"ctrl+0"},{name:"-"},{name:"Reset Rotation",action:"CPResetCanvasRotation",mnemonic:"R",shortcut:"alt+0"},{name:"-"},{name:"Flip View Horizontal",
action:"CPViewHFlip",mnemonic:"H",shortcut:"h"},{name:"-"},{name:"Smooth-out zoomed canvas",action:"CPLinearInterpolation",mnemonic:"L",title:U("Linear interpolation is used to give a smoothed looked to the picture when zoomed in"),checkbox:!0,checked:!0},{name:"-"},{name:"Show grid",action:"CPToggleGrid",mnemonic:"G",shortcut:"ctrl+g",checkbox:!0,checked:!1},{name:"Grid options...",action:"CPGridOptions",mnemonic:"D"}]},{name:"Palettes",mnemonic:"P",children:[{name:"Rearrange",action:"CPArrangePalettes",
title:U("Rearrange the palette windows")},{name:"Toggle palettes",action:"CPTogglePalettes",mnemonic:"P",shortcut:"tab",title:U("Hides or shows all palettes")},{name:"-"},{name:"Mobile mode",action:"CPToggleSetSmallScreenMode"},{name:"-"},{name:"Show tools",action:"CPPalTool",mnemonic:"T",checkbox:!0,checked:!0},{name:"Show color",action:"CPPalColor",mnemonic:"C",checkbox:!0,checked:!0},{name:"Show stroke",action:"CPPalStroke",mnemonic:"S",checkbox:!0,checked:!0},{name:"Show misc",action:"CPPalMisc",
mnemonic:"M",checkbox:!0,checked:!0},{name:"Show swatches",action:"CPPalSwatches",mnemonic:"W",checkbox:!0,checked:!0},{name:"Show textures",action:"CPPalTextures",mnemonic:"X",checkbox:!0,checked:!0},{name:"Show tool options",action:"CPPalBrush",mnemonic:"B",checkbox:!0,checked:!0},{name:"Show layers",action:"CPPalLayers",mnemonic:"L",checkbox:!0,checked:!0}]},{name:"Help",mnemonic:"H",children:[{name:"Tablet support",mnemonic:"T",action:"CPTabletSupport"},{name:"Shortcuts",mnemonic:"S",action:"CPShortcuts"},
{name:"-"},{name:"About",mnemonic:"A",action:"CPAbout"}]}];ge.prototype=Object.create(Ja(Ib).prototype);ge.prototype.constructor=ge;he.prototype=Object.create(Ja(Ib).prototype);he.prototype.constructor=he;let cf=navigator.userAgent.toLowerCase().includes("mac os"),Qe=cf?"\u2318":"Ctrl",Re=cf?"\u2325":"Alt",ch=cf?"\u2303":"Ctrl";ie.prototype=Object.create(Ja(Ib).prototype);ie.prototype.constructor=ie;let Hc={toolbarStyle:"new"};class lh extends Ja(Ib){setDefaults(){for(let c in Hc)Hc.hasOwnProperty(c)&&
this.set(c,Hc[c])}load(){let c={};try{c=JSON.parse(localStorage.getItem("chickenpaint-prefs"))}catch(d){console.error(d)}for(let d in c&&"object"==typeof c||(c={}),Hc)if(Hc.hasOwnProperty(d))try{this.set(d,c.hasOwnProperty(d)?c[d]:Hc[d])}catch(b){console.error(b)}}save(){try{let c=!1;for(let d in Hc)if(Hc.hasOwnProperty(d)&&this[d]!=Hc[d]){c=!0;break}c?localStorage.setItem("chickenpaint-prefs",JSON.stringify({toolbarStyle:this.toolbarStyle})):localStorage.removeItem("chickenpaint-prefs")}catch(c){console.error(c)}}set(c,
d){this[c]=d;this.emitEvent(c,[d])}get(c){return this[c]}constructor(){super();bc(this,"toolbarStyle",void 0);this.setDefaults()}}la.prototype=Object.create(Ja(Ib).prototype);la.prototype.constructor=la;la.UnsupportedBrowserException=function(c){this.message=c};la.UnsupportedBrowserException.prototype.toString=function(){let c="Sorry, your web browser does not support ChickenPaint.";return this.message?c+=" "+this.message:c+=" Please try a modern browser like Chrome, Safari, Firefox, or Edge.",c};
la.M_DRAW=0;la.M_FLOODFILL=1;la.M_RECT_SELECTION=2;la.M_MOVE_TOOL=3;la.M_ROTATE_CANVAS=4;la.M_COLOR_PICKER=5;la.M_GRADIENTFILL=6;la.M_TRANSFORM=7;la.M_PAN_CANVAS=8;la.T_PENCIL=0;la.T_ERASER=1;la.T_PEN=2;la.T_SOFTERASER=3;la.T_AIRBRUSH=4;la.T_DODGE=5;la.T_BURN=6;la.T_WATER=7;la.T_BLUR=8;la.T_SMUDGE=9;la.T_BLENDER=10;la.T_MAX=11;la.COLOR_MODE_RGB=0;la.COLOR_MODE_GREYSCALE=1;window.ChickenPaint=la}();
