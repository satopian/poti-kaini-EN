/*!
 * AXNOS Paint version 2.4.0 (2026-01-10T08:13:09.457Z)
 * (c) 2022「悪の巣」部屋番号13番：「趣味の悪い大衆酒場[Mad end dance hall]」
 * Licensed under MPL 2.0
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AXNOSPaint=t():e.AXNOSPaint=t()}(self,()=>(()=>{"use strict";var e={74(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADA0lEQVRYhe2XzW+UVRSHn3Pu+06nY1pbK4yQol0ZP0IKJSpRgVi78zuxJgZl4cqkC/8DpVFXWLubRLeKRowLnDQxhmAonbi1UKKYthgJtXwMVKfTmXln3ntc4MYFna/Ghshve+/5ned+5N5z4HaW/aN2PKSd5P8yEmnJq6WgW626FYimA+ptebMQTU1u9LxbPY47+n+q4csycBf3XYnCHd7xCGUHDqBMOQ6WereH528slX7fcLrRY7ggEbwfqJxzqEecDxJhvrvr7hsdyeQfIu6CcxIj4lEuhk6/gNTLzeRYfwc6O193pfLnBw++WRkcGizu2bPb9/cP9KmaWswajqvX8tcfuHTpYjQznfPfTmWTC7/OEwifHY3jt14TidsDcO5QIpDM7E+zqUQyJRqDJ0bF4QExj6CgHgNq1RpffvW1jY+/RxjwUqUSZ+sBuPUGt6a2LBeiwjt/rqy6/fv2qSmoghfFqQcDxIM4vBmqAYM7H5UTP5yU5cvLPRhH2wIoVovF0Lg2O3fm+d7uXtk1NIiYA/Vcz/9F2BGiElCKilgtRhM37QorBXI/5lLpnXxSvEx1vRxaj7AKn3rR70/OnKqpCF49Ehuvjr7Cd1NTYHD43cOMf/gBDkER9j6xF/Vue+2XxI56/nUBADogkzs1rWfmznpnYE6JoiqlagWvRhzHROUIb+AN7k3fQ2wx+ShV2hCAyrbHT5hxfvLIpFVrMXh4+KEHSae3IWYMjzzLyPAImKFqrJVLoJBMrtT1bvgh6urkydWyzLz43AtyZPIjnCooaAwxcPP/E1SUiY8nyGQyRX9/dz+/rdSnaFQa6pgItmtotx3PHrcLiwu2sDhv8/PztrC4aHPnfraxt8cskQhMw3CiEc+m/+0uup4qsDoJ9tjTB/aT7tsCZpSiMqdPT7NaLGLiztJZe4YC+Q0HADjGqDsUZt+IKB/wVYTQoVVFQl9Jqnwz3Lc1l11aWmvFuykN9Az0GHan+mlLm16U3l5leT2I/6QxuRXEpvQCG9Gcbrr+BiErU0sxKHoEAAAAAElFTkSuQmCC"},241(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABZ0lEQVQ4jZ3SPUjVYRQG8F9eBREXUcwuQhANrnEpidp0uzRcRKdqcGgKaYjGpsZwSQQnaWhoaLRNNykoxI9IJQcHBRHt3pQatA+H9/z19scSfOCF9z3vOc9zvgr+jzt4iRr+YOdfjk/RkLN14DOunCFCOLbkbH2YOCOuMVOdQSX/ie+nBDXjMeYwnxmv4hPKdY7FcCoHWYbnGEUXXKj76JV68RUraEc/LsV7Gsu4H9keZGnW4xA30IZJzKIb1zGEAtbQGkLHeBAKb1BCJ17hG3bxAbcxiI9BfCsLHojAh04m8TpSrKGKjSAUtY9Hf0qC8VGulBf4hR/SJDbxLmscLmIKUw3SWJZzBO8jg6aouxb3vfjfxxIuF+LxDNvSQsFqqG5jIdSeBEEPxkKgmilWpD0Yw02py3kUMYLFELqHlvo96MIw7uK3NIGfcdrC1oy3UhPX+XuRMnRIc78Wd5H6F2nUW6fEnB9Hz9lVhydI1Z8AAAAASUVORK5CYII="},323(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,'#axp_post_div_content{align-items:center;background:#eee;color:#333;display:flex;flex-direction:column;gap:15px 0;height:100%;overflow:auto;padding:10px}#axp_post_div_button,#axp_post_div_notice,.axpc_post_frame{max-width:1024px;width:100%}.axpc_post_frame{background-color:#dedede;border-radius:20px;display:grid;gap:10px 10px;grid-template-areas:"post_canvas  post_line  ." "post_canvas  post_line  post_div_input" "post_canvas  post_line  post_status" "post_canvas  post_line  .";grid-template-columns:150px 2px 1fr;grid-template-rows:repeat(4,max-content);padding:10px}.axpc_post_canvas{grid-area:post_canvas}.acpc_post_canvas p{text-align:center}#axp_post_div_thumbnailTitle{color:#1e7dc0;display:-webkit-box;font-size:13px;font-weight:600;-webkit-line-clamp:2;line-clamp:2;line-height:16px;margin:auto;width:134px;-webkit-box-orient:vertical;overflow:hidden;word-break:break-all}#axp_post_radio_bgTransparent,#axp_post_radio_bgTransparent~label,#axp_post_radio_bgWhite,#axp_post_radio_bgWhite~label{cursor:pointer}.axpc_post_line{background-image:linear-gradient(0deg,transparent,#aaa,transparent);grid-area:post_line}.axpc_post_thumbnailClick{text-align:center}#axp_post_div_input{grid-area:post_div_input}.axpc_post_input{align-items:center;display:grid;grid-template-areas:"name_property      name_required      ." "text_name          text_name          text_name" "title_property     title_required     ." "text_title         text_title         text_title" "message_property   message_required   ." "textarea_message   textarea_message   textarea_message" "watchList          watchList          watchList";grid-template-columns:max-content max-content 1fr}.axpc_post_message_property,.axpc_post_name_property,.axpc_post_title_property{background:#ccc;border:2px solid #ddd;border-bottom:none;border-radius:10px 10px 0 0;line-height:normal;margin-left:-2px;padding:2px 10px 5px}.axpc_post_message_required,.axpc_post_name_required,.axpc_post_title_required{background-color:#f44;border-radius:5px;color:#eee;font-size:.7em;font-weight:700;padding:.2em 3px;width:fit-content}#axp_post_text_name,#axp_post_text_title,#axp_post_textarea_message{margin-bottom:10px;margin-top:-3px}#axp_post_text_name,#axp_post_text_title{line-height:1.5lh;padding:0 4px}#axp_post_textarea_message{field-sizing:content;font-size:13px;height:auto;line-height:1.3em;min-height:4.5lh;padding:5px;resize:vertical}.axpc_post_name_property{grid-area:name_property}.axpc_post_name_required{grid-area:name_required}#axp_post_text_name{grid-area:text_name}.axpc_post_title_property{grid-area:title_property}.axpc_post_title_required{grid-area:title_required}#axp_post_text_title{grid-area:text_title}.axpc_post_message_property{grid-area:message_property}.axpc_post_message_required{grid-area:message_required}#axp_post_textarea_message{grid-area:textarea_message}.axpc_post_watchList{grid-area:watchList}.axpc_post_status{align-items:center;display:grid;grid-area:post_status;grid-template-areas:"size_property    size_colon    size_value" "bg_property      bg_colon      bg_value" "based_property   based_colon   based_value";grid-template-columns:max-content max-content 1fr}[class^=axpc_post_status_][class$=_property]{text-align:right}.axpc_post_status_size_property{grid-area:size_property}.axpc_post_status_bg_property{grid-area:bg_property}.axpc_post_status_based_property{grid-area:based_property}.axpc_post_status_size_value{grid-area:size_value}.axpc_post_status_based_value{grid-area:based_value}[class^=axpc_post_status_][class$=_colon]{text-align:center;width:1.5em}.axpc_post_status_size_colon{grid-area:size_colon}.axpc_post_status_bg_colon{grid-area:bg_colon}.axpc_post_status_based_colon{grid-area:based_colon}#axp_post_div_notice{background-color:#dedede;border-radius:20px;padding:20px}#axp_post_div_notice>u{font-size:120%;font-weight:700}#axp_post_div_notice div{margin:5px auto;text-indent:1em}#axp_post_div_button{background-color:#dedede;border-radius:20px;padding:20px}#axp_post_span_message{color:#d00;font-weight:600}#axp_post_button_upload{align-items:center;display:block;display:flex;justify-content:center;margin:auto;transition:.5s ease-in-out;width:260px}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}#axp_post_button_upload_loading{animation:spin 1s linear infinite;border:.25rem solid hsla(0,0%,100%,.2);border-radius:50%;border-top-color:#fff;height:24px;width:24px}.axpc_post_overlay{align-items:center;background:#0008;bottom:0;display:flex;justify-content:center;left:0;opacity:0;position:fixed;right:0;top:0;visibility:hidden}.axpc_post_overlay,.axpc_post_overlay *{cursor:zoom-out}.axpc_post_thumbnail{align-items:center;cursor:zoom-in;display:flex;height:120px;justify-content:center;margin:auto;width:120px}.axpc_post_thumbnail,.axpc_post_thumbnail>img{background-color:#fff}#axp_post_checkbox_popup{display:none}#axp_post_checkbox_popup:checked+.axpc_post_overlay{background-color:#0008;opacity:1;visibility:visible;width:100%;z-index:10}.axpc_post_overlayWindow{background:#fff5;border-radius:15px;line-height:0;margin:0 auto;max-height:100%;max-width:100%;min-width:fit-content;padding:15px;position:fixed;z-index:11}.axpc_post_overlayCloseButton{background:#fff;border:5px solid #666;border-radius:50%;box-sizing:border-box;color:#000;cursor:pointer;height:40px;padding:0;position:absolute;right:-35px;text-decoration:none;top:-35px;width:40px}.axpc_post_overlayCloseButton:after,.axpc_post_overlayCloseButton:before{background-color:#666;border-radius:15% 15% 15% 15%/50% 50% 50% 50%;content:"";display:block;height:22%;left:10%;position:absolute;top:38%;width:80%}.axpc_post_overlayCloseButton:before{transform:rotate(135deg)}.axpc_post_overlayCloseButton:after{transform:rotate(45deg)}.axpc_post_overlayCanvas{height:100%;max-height:calc(95vh - 110px);max-width:calc(100vw - 120px);object-fit:contain;width:100%}@media (max-width:599px){.axpc_post_frame{display:flex;flex-direction:column}.axpc_post_line{background:linear-gradient(90deg,transparent,#aaa,transparent);height:2px;margin:20px 10px}}',""]);const r=o},412(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAVRJREFUSEvdlEGOgzAMRR1gw2yAPYvhKNycm8AJQGKBhAR45KiJUpLgELWVOllVJM2zv3++gA8v8WEefCUQHyoFFR906EJ2REQQQl/D3sce4GBqPxQaC5QyVlUF4zjqmkKgMUAJS5IEjuOAsixhmqZg6F2gnBkt6ibLMti2DfI8h2VZgqB3gBpmzo3AVITZ6ZW0oUAL5oJSx+u6QpqmpteeGCFAL8zhUPWpefzoz2+UA7IwRSiKAuZ51jUg4q8Q4hYwGKZM5EgcK4V8Hb4FJgtzJMnbYC6gkkBanVse+1+G+blDeZjsXdc19L2auY2OgTk7pM4oI5Xj9n23aLEwL5A2mqaBYRgkzJT3IkVIHe6ZWQeeDNO2LXRd5xole7Fv/tYMEZFS+EdHhtGp451xvrLHcfoiTWNIiMLQMEQyrgKnSz1/ipbRm+Rcda/Yf0nVdwr5/8A/pWmGHVYGxLkAAAAOZVhJZk1NACoAAAAIAAAAAAAAANJTkwAAAABJRU5ErkJggg=="},473(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,".axpc_radio{font-size:12px}.axpc_radio input{display:none}.axpc_radio input[type=radio]:checked+label{background-color:#f7a312;border:2px solid #bf9701;color:#000;font-weight:700}.axpc_radio label{border:2px solid #ddd;border-radius:0;color:#777;display:inline-block;padding:5px 0;text-align:center;width:100px}.axpc_radio label:hover{border:2px solid #aaa;color:#aaa;cursor:pointer}.axpc_radio button{border:2px solid #000;border-radius:50px;color:#777;display:inline-block;margin:2px;padding:5px 0;text-align:center;width:100px}.axpc_radio button:hover{border:2px solid #aaa;color:#aaa;cursor:pointer}.axpc_radio button:active{border:2px solid #444;color:#000}.axpc_radio span{display:none}",""]);const r=o},509(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAALpJREFUSEvdlVEOgCAMQ+X+h9ZghJA6tg4cGv0yofRRNiBtY98O0xJrQwvBMByIACtQN4gnIQtVPT3AnMqCmn6mQNi7HpTyokQElPahhQrU5eESW63JjGeg1QiMD61pgZg2ZCGvAultmRFqCWd8pblniRhgW0tLX7RS91NA6VUwTa8gmPJ7wDZJ719MMZpwKRDrFJ5wKVC70kKOxVIgHvLShVINsUO1l6eO4Rb9H/j0hd363a62SFj1PgCQzVYKtNp/VQAAAABJRU5ErkJggg=="},540(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},587(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACeElEQVRYhe2WPWhTURSAv2sDyUtpCTwhMU4lrg0ShGwWpOpQMVAoTv3RUBUEp0Jw07oIWQUHQZ2F2qGJUAqawVZaMEUwWXovTgpWUYpoFnuPQ5oqhTR5qXld/ODB493DOd+7/3DI9HiMjwAxIAx8//c6zYkBz4AfgADbwGPA9aN4Gvi6U3jv8wpQ3RZ43aS4ABY4dZDkR9qIie3TpoDL3RZoRbjbAh/biLkIPAJOHkSmGTdoPgcE2Prrfb0bAmHg034SjuNINpuV+fn5SjcEAM4AP/cWDgaDMjk5Kaurq2KMscaYF14TB1q09wA3gRzgND7GYjGmpqbIZDL09/dTq9VqwEPgjleBVkyw87dKKRkYGJB8Pi/ValWMMWKMkfHxcQt8AEKdFGi1CsrRaHRrbGyMQqHA0tKS9Pb2SqlU2g3IZrOilDoGXOpEoCXGmAlTp6i1vhKPx5+mUinRWu/2wvT0tHCAXvDKWaWULRaLYowRrbWUy2Xp6+uzwG2vybwexwDvgQvGmPjo6ChKKUKhEEoptby8fAJ4APxqN1knW7EAd9fW1mR9/c++Mzw8DHAcONdBTs8ooDg4OLg7FzY2NiSdTgtQ8JKokyFo8G5zc/Oa67oqmUyilCISibCwsJAAnlDforvOLcdx7MrKijXGSKVSkWg0aoG8H8WhvuzeplIp2xiKXC5ngc/4tCQBksD27OysaK2lVCpZ6jelCb8EAO4ppWRubk601jI0NCTAcz8FQsCbRCIh1WpVZmZmBPiCj8MAEAe+ZTIZWVxcbFxYz/spAHAasCMjI+K6rgBX/RaA+v1hOxAIWOD+YQgAXAdeAkcPS+A/bfMbyDkQZkEBMg0AAAAASUVORK5CYII="},788(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(9365),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},1043(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(5306),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},1113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},1158(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,'.axpc_toggle_switch{background:#aaa5;border-radius:50px;cursor:pointer;height:32px;margin:0;overflow:hidden;position:relative;width:55px}.axpc_toggle_switch input[type=checkbox]{display:none}.axpc_toggle_switch:before{background:#e09c35;content:"";height:100%;left:-55px;top:0;width:100%}.axpc_toggle_switch:after,.axpc_toggle_switch:before{display:block;position:absolute;-webkit-transition:.2s ease-out;transition:.2s ease-out}.axpc_toggle_switch:after{background:#fff;border-radius:50px;box-shadow:0 9px 28px -6px rgba(0,0,0,.3);box-sizing:border-box;color:#333;content:"無";font-size:12px;font-weight:700;height:28px;left:2px;letter-spacing:.5px;line-height:1;padding:9px 0 0;text-align:center;top:2px;width:28px}.axpc_toggle_switch[data-checked=true]:before{left:0}.axpc_toggle_switch[data-checked=true]:after{box-shadow:0 9px 28px -6px rgba(0,0,0,.5);color:#333;content:"有";left:24px;padding:9px 0 0 1px}',""]);const r=o},1325(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,".axpc_checkbox{height:24px}.axpc_checkbox label{align-items:center;cursor:pointer;display:flex}.axpc_checkbox input{height:24px;margin-right:4px;width:24px}",""]);const r=o},1494(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAU1JREFUSEu9lk0SgyAMhWF04aHanssjeK72UG4c6RANDSH8inXjiJAvLz6IWt1zmTOs5uGDgQY+BpeWXgYGwY2ReVo7lgfNKSwGUHkEZoeLgA4UU4AAFtxx7TpJZbFCCuaQVFLnXLm+CcN4pc2pjpQXoDmFPAdTA2NlbwLaGNVQWtZahZh0FbQrcBgGte+7GsdRbdvmPsE0TWpdV3juAXSl/TuQKAhMjgbrpbDIQHzzt5qmyDwtJ02ueSTdyk+Zlo1PE4DTJ9MtLrenAEhq697FWtMVhaBuWRaAzPMMd8mV/Ju0mMZYEEI4lADE2HxQat90DsDwSkCjQrxgRj2Oo+j9OWK+gjbmlZKWk6hOVi0NtBGfGpsYzo1CT+UdgL69bEDRNCX91VMITlOPX0lRIbXascJBcybJuTT1j4lrgyRLlEmLeTK3PLfsw0uJfAF8q5UdxHjKFQAAAA5lWElmTU0AKgAAAAgAAAAAAAAA0lOTAAAAAElFTkSuQmCC"},1543(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,"#axp_custom{width:60px}.axpc_custom_button{background:#555;border:2px solid #000;border-radius:5px;color:#eee;cursor:pointer;font-family:Arial Black,Arial,sans-serif;font-size:20px;height:48px;margin-bottom:4px;text-align:center;width:48px}.axpc_custom_button:hover{border:2px solid #bbb}.axpc_custom_button:active{background:linear-gradient(#222,#444);border:2px solid #333}",""]);const r=o},1601(e){e.exports=function(e){return e[1]}},1950(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAALUlEQVQ4jWNkwAT/0fiM+OSZsBhAEhh4AxgZSPQzuvzAe4EqYYAORtPByEsHAKoFCBuY5JqoAAAAAElFTkSuQmCC"},1999(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,"#axp_alert_div_modalContainer{align-items:center;background-color:rgba(0,0,0,.3);display:flex;height:100%;justify-content:center;position:fixed;width:100%;z-index:10000}#axp_alert_div_alertBox{background-color:#fff;background-repeat:no-repeat;border:1px solid #fff;max-height:400px;max-width:600px;min-height:100px;min-width:350px;width:50%}#axp_alert_div_modalContainer>#alertBox{position:fixed}#axp_alert_div_alertBox h1{background-color:#555;border-bottom:1px solid #555;color:#fff;font:700 1em Raleway,arial;margin:0;padding:5px 0 5px 5px}#axp_alert_div_alertBox p{color:#000;height:auto;padding-left:5px;padding-top:30px;text-align:center;vertical-align:middle}#axp_alert_div_alertBox #axp_alert_button_cancelBtn,#axp_alert_div_alertBox #axp_alert_button_closeBtn{background-color:#555;border:0;border-radius:0;color:#fff;margin:10px auto;outline:0!important;padding:7px;text-align:center;text-decoration:none;text-transform:uppercase;width:100px}",""]);const r=o},2022(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,"#axp_saveload{background-color:rgba(0,0,0,.5);height:100%;left:0;overflow:auto;position:absolute;top:0;width:100%;z-index:5000}#axp_saveload>div{background-color:#eee;border:4px double #337;border-radius:5px;color:#000;margin:8px;padding:8px}#axp_saveload_div_insertHTML{background-color:#aaa;border:0 solid;cursor:pointer;display:flex;flex-wrap:wrap;justify-content:normal;padding:8px}#axp_saveload_button_close{font-size:15px;font-weight:bolder;margin-top:8px;width:100%}.axpc_saveload_loadSlot,.axpc_saveload_saveSlot{background-color:#ddd;border:2px solid #000;border-radius:10px;font-size:12px;font-weight:700;line-height:15px;min-height:180px;padding-top:4px;text-align:center;width:135px}.axpc_saveload_saveSlot:hover{background-color:#faa}.axpc_saveload_loadSlot:hover{background-color:#ffa}.axpc_saveload_thumbnall{align-items:center;border:1px solid #aaa;display:flex;height:124px;justify-content:center;margin:auto;width:124px}.axpc_saveload_refId{display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;overflow:hidden;-webkit-box-orient:vertical;color:#00f;max-height:30px;word-break:break-all}",""]);const r=o},2165(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAIFJREFUSEvVlEEOwCAIBOX/j6axCY1QN62yHPSsE1gGpRUdKeK2NFhVVUReHAq4dx3hNHCE3+DeDitrq5wOtsrPAbsoMvmO8xnNmFqB3JwVYOBP3dBF1NWvBUFt7UT1RMF2+Rzd3IJUrLXTrWR4NvlV3ZAx6QVZAu94G9+kP3pUxAVWlFAXgzcoGgAAAABJRU5ErkJggg=="},2287(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(4776),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},2326(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC5klEQVRYhe2VX0hTURzHP/dqsUFQlnOOoezB2Epd6INEaIwIJInECdZL0ZtPRS+LVPAPQoOigh4shF70yQeJQSVh+VIKFUgxF467ic9ZSGEw2HZPD+dO17gbzBw+tC8cuOec3/39vuf3F8oo439HRc5eBS4DOrCxHwSOANNAArABt4C3QCpHTgUuASHADcyVgpwf+AxUGYZCWXfTgF5fX58EfgOeUhDIxkXgjvF9GEj19vbqq6uroqmpSQAvgSAwUKxi1eTMYZxXA9eAk8ABwAVYgdOAMj8/r0SjUZxOpwAuADeN+0bgOnC0WDIAx5AJ2A2cA+LIl/uBp4AFUJBx/2XI/gACQBtwH9gyzh/uhgBArWEkG43AA+CgsZ8D0sBjwAl0ARtWqzUxMjIixsbGBDJxz+yWRAYqMiQDwAIyFACDhnILcA9I+3w+fXFxUY/H42JlZUW4XC4BvPhXAn7kS6qAq0BP1t0p4IvFYtFHR0d1TdNEPB7fXpOTkxkvdBVr1IaM9wmkB2qN8xA7WX4eEK2trfrS0pKebTizNE0THo9HID2XG9JtmFVBM3DW+EkHfiIzuhtZahmSDA8PK3a73VS5qqqMj4+jKIqPAl4wI7CALL2vxv4R8CZHJgR8m5iYQAiRTzctLS10dnaCzBOrmUxuKzbDGvCcv2dDEoiura1d6ejowOFwmHpBURTq6uqUmZmZauA78KEYAj3IPHiH+WDSgLbl5eXjfX19VFZWmpKoqakhHA4r6+vrXuAJOXOlEAE/shu+LyDzcXNz80YymaS9vT2vF9xuN7Ozs4dSqdQBcsJplgMZ3GUn6fIhBgxOTU0RDodNBYQQJBIJVFVVkBN0z1EBvGpoaBCRSGS7DGOxmIhEIqK/v19YLBYdGf/mUhAA2aq3AoGAiMViQtM0PRgMCpvNpiNnw20Ke3tPMAiIoaGhtNfrTSN7yGvAXmrDGVQAzwzDn5BVlLcDlgrqfhkuo4xd4w+Gc/4wRA2pHgAAAABJRU5ErkJggg=="},2356(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(6569),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},2633(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA4klEQVRIia2VWw7EIAhF0cx3F0bXWxfWDTgfEywq8hh7kyZ96LkIpCTQVY3vXMnzsgMiopteShG5dNPAEajDLCWC74Cvcrf7E4/OJI/wq9zdhgici5gfayNFZIFX6/L44sSjWyxFOKZkBRcNpIh42qR8a1oaSIBIbVwGZCJF6oneZQBg12HLQCuop6VVg1VBPZ1mGni6xWMiGkRakZ9GStlkEO1za+3yVxGBa3smg3/AmjLANCxeETH5RKvRmWAElgCeFE2zN3AqcRaTWg0o+tVs3VFFxAq/U9D1mtpMZs+v6gsVx3EXSmjQgwAAAABJRU5ErkJggg=="},2957(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAqElEQVRIibVVWRaAIAhEX6fp/mfpOvRlobKJMp8as0BRAT9QOC9akXppELt4rhVyfAbWe0OZko/EggjLVS0HGrlkqDOgPUzJuXa0ey2FmWARUwpOwOW+K1DaeDqBKTC5D6Br05QgSi7VUQHPF7uM8AyMpJ/ZSg82e8/WZ75FmCIwpqhwqD0SrHUNm+LoEhhXhSWIz18TmoHnR9OQvouyZwAFklZEQ3qLXjz+NU6cSgzSAAAAAElFTkSuQmCC"},2980(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC70lEQVRYhe2VT2hcVRSHv3Pue2/ezCTt1GiEVCVQoS6sqDvJPxCpiCQKops2ujJIsopRhFKw6FLt1o24sLZKLUItlVRjpGqLVaq0mFQkSasJTdMyVix1xmbuPS7iQMi/jhZXzrd77573/c677953oU6dOnVuADOT1kJr4UYcUmthd0tLbrR4sa0c7AkLmgkWIHg0xhLSo+/Md7/7FB/4/6aBRpooRZ+LVbY05Bvo6Ogkm6QgwlzxEl8d/QKQbxuzDYNXSleO/dMmlmFmtvha4/iNJIls4LkB+2HsjE1OTdnExIRNTk3Y2alJO3jooN17/30mgmmsA7U4qyybgWqhiCyMtRYK+svvM/39/fmh54cIFgDDDMT9/VAAHwIvDr7AR4cPmUutvVLi+Jre6stdr8v0wm/rAyHX/VgPsPCJjwx/yvAnwxCEY18ep6/vWZxGvLb7dbq6uoIv6Vvc9kC2lpnQ1QaqlMsFCEIuzUAQEGFkdITRkc8wEWbnZjnz40+gEEeOwaFBEWFzZvabh1byLc3StcIBmpI/siLKpblfQUAFkjTBOYcGIZvJkMQJ4gNe4J67t2hbV2f4E/pXcy7O1LWKAKK7rk2j/vyJE18TMDzGyzt3suuVXQBsfeRRDhz4EHOCeiWY8WB7R4SFrTH0Xc+vsHxhLGbuNFeB04ePfIwYSFDiJCWbyYN4ElGaNqzDTEE9JrD9mafp3dZrFcfu5nzzrSt5q5m69MZKJJF7c3xs3Pbse9985RoqIATEHAIEFGdgBs4rGkXs2PGSxlHExXLx4dXCoZZtCOw3c9uS5O1Kxfdu2nQnPT3d5fbONt248fbk5qabfsZzizhyIUiYmTlXPHnyez313an83r17Mj6bbqdUem+1bbgiqy/K3OOx030o04gE58SLuLOZNJ1d17j+cpTERcQFpxoilTGS6NUn9+PWctZ8FixlQ0v2jsvn5zenrtIC6cIvIvVomfHm/Pz0uatc+LfuOnXq1Pl/8RfZFzz+oFu3MQAAAABJRU5ErkJggg=="},3003(e,t,a){a.d(t,{A:()=>b});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s),r=a(4417),l=a.n(r),d=new URL(a(6158),a.b),c=new URL(a(8562),a.b),p=new URL(a(2980),a.b),_=new URL(a(74),a.b),h=o()(n()),u=l()(d),m=l()(c),x=l()(p),g=l()(_);h.push([e.id,`#axp_layer_div_button1{display:flex}#axp_layer_div_button2{display:grid;gap:0 6.66667px;grid-template-columns:50px repeat(3,32px);margin-bottom:8px}#axp_layer_button_create{height:32px;width:50px}#axp_layer_button_clear,#axp_layer_button_copy,#axp_layer_button_delete,#axp_layer_button_integrate{height:32px;width:32px}#axp_layer_button_clear{margin-left:5px}#axp_layer_select_blendMode{border-radius:8px;height:30px;margin-bottom:4px;margin-top:4px;width:100%}#axp_layer_ul_layerBox{background:transparent;border-radius:0 0 5px 5px;height:100%;list-style:none;margin:0;padding:0;position:relative}#axp_layer_ul_layerBox li{background:transparent;border:1px solid #000;border-radius:5px;-webkit-user-select:none;user-select:none}#axp_layer_ul_layerBox li.axpc_onGRAB{position:absolute;z-index:1}#axp_layer_ul_layerBox li.axpc_onGRAB *{cursor:grabbing}#axp_layer_ul_layerBox li:not(:last-child){margin-bottom:0}#axp_layer_ul_layerBox li:hover{background:hsla(0,0%,100%,.1)}#axp_layer_ul_layerBox li[data-selected=true]{background:#eb9a32}.axpc_layer_div_cell{align-items:center;display:flex;height:42px;justify-content:flex-start}.axpc_layer_div_cellLeftSide{display:flex}.axpc_layer_div_cellButtonEyeIcon{border-radius:4px 0 0 4px;cursor:pointer;height:42px;width:21px}.axpc_layer_div_cellButtonEye{border-radius:4px 0 0 4px}.axpc_layer_div_cellButtonContainer{display:flex;flex-direction:column}.axpc_layer_div_cellButton{border:2px solid #333;border-radius:2px;cursor:pointer;height:21px;width:21px}.axpc_layer_canvas_cellThumbnail{border:1px solid #000;--layer_canvas_cellThumb_color1:#aaa;--layer_canvas_cellThumb_color2:#ccc;--layer_canvas_cellThumb_size:12;background-image:repeating-conic-gradient(from 0deg,var(--layer_canvas_cellThumb_color1) 0deg 90deg,var(--layer_canvas_cellThumb_color2) 90deg 180deg);background-size:calc(100%/var(--layer_canvas_cellThumb_size)) calc(100%/var(--layer_canvas_cellThumb_size))}.axpc_layer_div_cellCliping{height:100%;width:0}.axpc_layer_div_cellCliping[data-mode=source-atop]{background:#000;background-image:url(${u});background-position:bottom;background-repeat:no-repeat;height:100%;isolation:isolate;width:8px}.axpc_layer_div_cellCliping[data-mode=invalid]{background:#000;background-image:url(${m});background-position:bottom;background-repeat:no-repeat;height:100%;isolation:isolate;width:8px}.axpc_layer_div_cellRightSide{align-items:flex-start;display:flex;flex-direction:column;height:100%;justify-content:center;position:relative;width:82px}.axpc_layer_div_cellRightSide[data-mode=source-atop]{width:74px}.axpc_layer_div_cellColorTag{border-radius:0 4px 4px 0;height:100%;width:8px}.axpc_layer_span_cellStatus{color:#ddd;font-size:11px}.axpc_layer_span_cellName{overflow-wrap:anywhere;-webkit-user-select:none;user-select:none;word-break:break-all}.axpc_layer_CANDRAG{cursor:grab}#axp_renamelayer_div_textarea{background:#555;border-radius:5px;margin-bottom:8px;padding:4px}#axp_renamelayer_text_newLayerName{border-radius:4px;font-size:16px;height:32px;margin-bottom:4px;margin-top:4px;padding:4px;width:100%}#axp_renamelayer_button_confirm{width:100%}#axp_renamelayer_button_confirm[data-enabled=false]{background:#aaa}#axp_renamelayer_button_confirm:hover[data-enabled=false]{border-color:#777 #333 #333 #777;border-style:solid;border-width:2px}#axp_renamelayer_button_flipH{background:#555 50% no-repeat url(${x});height:32px;width:32px}#axp_renamelayer_button_flipV{background:#555 50% no-repeat url(${g});height:32px;width:32px}#axp_renamelayer_div_colorTagContainer{background:#333;display:flex;justify-content:space-between;margin-bottom:4px}#axp_renamelayer_button_colorReset{height:28px;width:50%}#axp_renamelayer_div_colorTag{display:flex;flex-wrap:wrap}.axpc_renamelayer_button_colorTag{border-color:#777 #333 #333 #777;border-radius:5px;border-style:solid;border-width:2px;color:#eee;cursor:pointer;font-size:13px;height:32px;line-height:14px;padding-left:4px;text-align:left;width:50%}.axpc_renamelayer_button_colorTag:hover{border:2px solid #bbb}.axpc_renamelayer_button_colorTag:active{border:2px solid #333}.axpc_button_closeContainer{display:flex;justify-content:space-between;position:relative}.axpc_button_close{box-sizing:border-box;height:30px;position:relative;width:30px}.axpc_button_close:after,.axpc_button_close:before{background-color:#fff;border-radius:15% 15% 15% 15%/50% 50% 50% 50%;content:"";display:block;height:25%;left:1%;position:absolute;top:36%;width:100%}.axpc_button_close:before{transform:rotate(135deg)}.axpc_button_close:after{transform:rotate(45deg)}`,""]);const b=h},3088(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(1543),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},3243(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(9326),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},3440(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAt0lEQVRIib2VWw6EIAxFW+MydXWyz/oxw7RAQdri3IRERc6ljwDCWPQwL4UzH0vgZeCfBQrrByZZoM9miD/4CrBisr0CF8xtPbnU6wZ7mHAo3Zk45X4DCU79GvpSNAkHsEZgAGeVERyo59QJbw3ywtrECW8NNJMAXDeQCsL7BjXMCQcYdVEAKvWns+jstGZEX6Ykk/nYHm8MAbgGLXk+quGPXOS8+87dGhHBRQSfKPJYJr6T+X2pbgnMNdOnO8qdAAAAAElFTkSuQmCC"},3447(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(3462),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},3462(e,t,a){a.d(t,{A:()=>H});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s),r=a(4417),l=a.n(r),d=new URL(a(2957),a.b),c=new URL(a(3440),a.b),p=new URL(a(2633),a.b),_=new URL(a(1494),a.b),h=new URL(a(509),a.b),u=new URL(a(6902),a.b),m=new URL(a(412),a.b),x=new URL(a(8430),a.b),g=new URL(a(7852),a.b),b=new URL(a(6725),a.b),A=new URL(a(241),a.b),v=new URL(a(9819),a.b),f=new URL(a(8777),a.b),y=new URL(a(4800),a.b),C=new URL(a(1950),a.b),S=new URL(a(2980),a.b),O=new URL(a(74),a.b),E=o()(n()),w=l()(d),N=l()(c),I=l()(p),T=l()(_),j=l()(h),k=l()(u),L=l()(m),B=l()(x),M=l()(g),P=l()(b),R=l()(A),F=l()(v),D=l()(f),V=l()(y),G=l()(C),z=l()(S),U=l()(O);E.push([e.id,`.axpc_icon_msg_caution{background-image:url(${w})}.axpc_icon_msg_caution,.axpc_icon_msg_information{background-repeat:no-repeat;flex:0 0 24px;height:24px;width:24px}.axpc_icon_msg_information{background-image:url(${N})}.axpc_icon_msg_ng{background-image:url(${I})}.axpc_icon_msg_color,.axpc_icon_msg_ng{background-repeat:no-repeat;flex:0 0 24px;height:24px;width:24px}.axpc_icon_msg_color{background-image:url(${T})}.axpc_icon_window_all_down{background-image:url(${j});background-position:50%;background-repeat:no-repeat}.axpc_icon_window_all_up{background-image:url(${k})}.axpc_icon_window_all_up,.axpc_icon_window_pen{background-position:50%;background-repeat:no-repeat}.axpc_icon_window_pen{background-image:url(${L})}.axpc_icon_window_layer{background-image:url(${B});background-position:50%;background-repeat:no-repeat}.axpc_icon_window_colormaker{background-image:url(${T});background-position:50%;background-repeat:no-repeat}.axpc_icon_window_palette{background-image:url(${M});background-position:50%;background-repeat:no-repeat}.axpc_icon_window_subtool{background-image:url(${P});background-position:50%;background-repeat:no-repeat}.axpc_icon_eyeON{background:50% no-repeat url(${R})}.axpc_icon_eyeOFF{background:#555 50% no-repeat url(${F})}.axpc_icon_lockON{background-color:#aa3;background-image:url(${D})}.axpc_icon_lockOFF{background-color:#555;background-image:url(${V})}.axpc_icon_maskON{background:#ff4 50% no-repeat url(${G})}.axpc_icon_maskOFF{background:#555 50% no-repeat url(${G})}.axpc_icon_flipH{background:50% no-repeat url(${z})}.axpc_icon_flipV{background:50% no-repeat url(${U})}.axpc_icon_span{align-items:center;display:inline-flex;height:28px;justify-content:center;vertical-align:middle;width:28px}.axpc_icon_humburger,.axpc_icon_humburger:after,.axpc_icon_humburger:before{background-color:#fff;border-radius:2px;display:block;height:4px;position:absolute;transition:transform .4s cubic-bezier(.23,1,.32,1);width:30px}.axpc_icon_humburger:before{content:"";margin-top:-8px}.axpc_icon_humburger:after{content:"";margin-top:8px}#axp_main_checkbox_hamburger:checked+#axp_main_label_hamburger .axpc_icon_humburger:before{margin-top:0;transform:rotate(45deg)}#axp_main_checkbox_hamburger:checked+#axp_main_label_hamburger .axpc_icon_humburger{background:hsla(0,0%,100%,0)}#axp_main_checkbox_hamburger:checked+#axp_main_label_hamburger .axpc_icon_humburger:after{margin-top:0;transform:rotate(-45deg)}`,""]);const H=E},3524(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(1999),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},3990(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADvElEQVRYhe2WX0hkZRjGf58Dzik4Q+y0OSurO9jVkotd7PZHEtuLdKJg0CBqRBaUrYUGCQdRBxwYL/Im2G4yabcWY4vBC2nFULqKJMqiRELbhjOaBBGUmdK6Wu15u/iOtbPNOXM2pat9YOAc3j/PM+/53vf94A4OBhGgFlD/N/EzwFXgBmAD3wOvAqeACj8J9qO4GliKx+P3tLW1EQqFmJ+fJ5fLsba2JsAEkAR+3geHJy7V1dXJ8vKyWJYlhUJBCoWCWJYlo6OjYpqmAJ8BAa8kvspUAjGl1JlkMkkwGESpfwqplKK1tZXx8XEMw3gIOOeVyFOdCwxgMhaLHe7t7XV1ikQibG5uqoWFhRPAG8Cfpfz+SwWypmkez2QyZR07OzsBjgJxN5/bFfAk0JfNZqmqqirrXF1dTTgcVuiq7VuAAbzV0tKi4nHXP/Q3RITBwUHW19dt4OuDEJBRSh1Jp9O+nHO5HJOTkwJkgK/2K6ARGOzv76empsbVSUQAmJiYYGhoSETkIvCKV2I/Au4FLjY3N9Pd3V1EVAqzs7Nks1kRkfPAi4C7M+UnYQB4LxQKPTszM0MkEnF1FBGmp6cZGBiQnZ2dd4Au9HguS+CFl4HepqYmKisrWVlZoba2lkAgUDR8RIS5uTn6+vpke3v7AvCCH3IoX4HPg8HgyXA4bCulAltbWyilSCQSJJNJMQxDASwuLkoikWB3d/ftW8gV8ARw2nm/CqwBH/kRB7A6PDy8szfnl5aWJJPJiGmadkNDg53P52VqakpM07SBy7fEPo7eBdvAp85vFT0RPcdzkYCRkZHrqVRK2tvbJZ1OSz6fl7GxMRuQrq6uPfIvKB42jzpEH6O35s0459ga/Aj4NhqN2hUVFdLY2CiAdHR0iGVZdn19/Q661JeBu26KMYBl4AOPvN8BZ/wIOAtILBYTy7IkkUhINBqVnp6e39Cl/ZB/t3LUEXYad6z6FXAUkHA4bKdSqRvOjrfRN6DXgHCJmLuBRfSBO17CXoG+pDznR8AJh3CP+BvgJeBImbjDwOsuAp4GrqEHnC+cBSaBHuCQ3yAPXAHePYA8tw0FXAB+Bx70EzAIvH9A5AH0UtoCHvMToNDT6lIJmwHcDzzv2JeBN3Ef66fQ63gDaPer+BjFrXQf+tRmgB8c2waQA84Dv6Kv4XtdYQCPoL/1NcfmvslK4BCwCfyC7tk/gJ+AL9GH8RjF/f+w47vu+G+gW/UK8JQXkdcyegA46TwXgE/w3u0RoMXJeR09hn/0Ir8DgL8AaYBB3tIMzbAAAAAASUVORK5CYII="},4256(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC0UlEQVRYhe2VwUuTYRzHP48WeBm4am05OujFgzKcJdhfoMIQlIhBhBAqKl7Kswdlg0D/gg4hgoNgSlBQbBQd9JBph+FIXt/3GHUorLE3Yr2+vw6bus2tNpt12Reew/Pj+fH5Pr/n9zwP1FVX7dQA9AEX/wf8CvACsIH3QM+/hN8B9oGDnAE7N79+1uBG4GEOfAgXh8MhnZ2dkjMROCv4BeBxPhgQl8slq6urommaDA0NCfADuFtruAt4x3G5BRCfzydbW1tiGIYYhiGapsno6KgNpIFrtYJ7gY9kdy65YQ8MDNj58HwTHR0dAnwpZ6KhCrgfeANczg/6fD4WFxeV0+ksWCwixGIxkskkZI8sTonGrNRAL/ASaMnlNAAMDg4SjUZVU1PTCXgkEmF6ehqyVQJwAvcr5BXID6Q4LrkopWRsbEw0TTtRdl3XZWpqSvLX54YNPKgW3gN8LoaHQqETYMMwZG9vT2ZnZ8vBnwPnq4G7gX23213Q7QsLCyXhmqZJMBgsB09wiic65HK5fu7s7Mj4+PgBYAcCAVvXddF1vQC+ubkpfr+/GHo4EmSvbtVKTk5OHp3r/Py8rZSyJyYmCgxsb29Lb29v8a4PH6i3ZG9A1fIAB0tLS3Z+c4XDYVspJcPDw6JpmmxsbNhtbW0Wpcv+Grj0J9C5MvEmoKG1tfUooJQiGAyq5uZmZmZmxDRNtb6+rkzTbCzKFeAJEAQypzUAIJlMBkDlB/v7+/F4PIyMjIhpmqo4B3gK3AKsP8Gh/EP0CdhfWVkpBgDQ1dWllpeXlcPhKIZHgZuVwiH7pZaSBbh2d3dveL1e2tvblVKFXtxuN93d3bK2tnYYigC3yTZgxSpnAOCVZVktsVjMn0gkME0T27aVZVmkUimJx+MyNzen0un0dyAM3CPbfDVXH/AM+EDh/U4Djyj6nKpVyTP+zdqreTlfgW9/A6+rrroAfgHtW6W7+RvhCQAAAABJRU5ErkJggg=="},4301(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(4554),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},4417(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},4490(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(3003),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},4554(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,"#axp_launcher{width:auto}#axp_launcher_div_buttons,#axp_launcher_div_personalButtonsEntry{display:flex}.axpc_launcher_allButton,.axpc_launcher_personalButton{background-color:#ddd;border:2px solid #aaa;border-radius:5px;cursor:pointer;height:40px;margin:0 2px;position:relative;width:40px}.axpc_launcher_allButton>div,.axpc_launcher_personalButton>div{height:28px;margin:auto;opacity:1;pointer-events:none;width:28px}.axpc_launcher_personalButton.axpc_launcher_minimize{background-color:#888}.axpc_launcher_personalButton.axpc_launcher_minimize>div{opacity:.3}.axpc_launcher_allButton:hover,.axpc_launcher_personalButton:hover{border:2px solid #eee}.axpc_launcher_allButton:active,.axpc_launcher_personalButton:active{background-color:#555;border:2px solid #555}.axpc_launcher_sizeSmall{height:32px;width:32px}.axpc_launcher_sizeBig{height:48px;width:48px}#axp_launcher_separator{background-color:#888;height:auto;margin:0 2px;width:2px}",""]);const r=o},4776(e,t,a){a.d(t,{A:()=>_});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s),r=a(4417),l=a.n(r),d=new URL(a(9914),a.b),c=o()(n()),p=l()(d);c.push([e.id,`#axp_tool{width:300px}#axp_tool_div_content{display:flex}#axp_tool_div_leftSide{align-content:flex-start;align-items:flex-start;display:flex;flex-wrap:wrap;justify-content:center}#axp_tool_div_canvasSize{text-align:center}#axp_tool_span_canvasSize{font-size:13px}#axp_tool_div_minimap_outer{border:6px solid #888;cursor:grab;height:132px;margin-bottom:4px;margin-right:4px;margin-top:2px;position:relative;width:132px}#axp_tool_div_minimap_inner{align-items:center;background:#777;display:flex;height:120px;justify-content:center;width:120px}#axp_tool_div_minimap_line{border:2px solid red;position:absolute}#axp_tool_div_rightSide{display:flex;flex-direction:row;flex-wrap:wrap;gap:0 6px;justify-content:flex-start;margin-left:4px;margin-top:2px}#axp_tool_button_loupeReset{margin:0 5px 0 1px;width:62px}#axp_tool_button_loupeDown,#axp_tool_button_loupeUp{margin-right:4px;width:30px}#axp_tool_button_redo,#axp_tool_button_restore,#axp_tool_button_undo{width:100%}#axp_tool_button_flipH,#axp_tool_button_flipV,#axp_tool_button_load,#axp_tool_button_save,#axp_tool_button_transparent,#axp_tool_div_gridbutton{width:70px}#axp_tool_div_gridbutton{display:flex}#axp_tool_button_grid{width:50px}#axp_tool_button_gridConfig{background-image:url(${p});background-position:0 50%;background-repeat:no-repeat;height:100%;isolation:isolate;width:20px}#axp_tool_div_gridConfig{padding:4px 0}#axp_tool_div_gridConfig>div{column-gap:8px;display:flex}#axp_tool_div_gridConfig>div>div:nth-of-type(2){display:flex;padding-top:4px}.axpc_tool_div_gridConfigButton{border:2px solid #555;border-radius:8px;column-gap:8px;display:flex;margin-bottom:2px}.axpc_tool_div_gridConfigButton>div:first-of-type{align-items:center;background:#666;display:flex;justify-content:center;width:50px}#axp_tool_number_gridPixel1,#axp_tool_number_gridPixel2{border-radius:5px;font-family:Arial Black,Arial,sans-serif;height:32px;padding-left:2px;width:60px}#axp_gridconfig_range_gridColor{width:100%!important}`,""]);const _=c},4800(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAATUlEQVQ4jWNgoBAw4hD/T6x6bAbg0oxVD7oB/0mVYyLGFjxiOA0gGlBsAAuJ6jG8QbELkE0kFH1Y9dI8EHGlVKINoNgFFBtAMGApdgEA7jIGIGzoTUQAAAAASUVORK5CYII="},4984(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(9837),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},5042(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,".axpc_button{background:#555;border-color:#777 #333 #333 #777;border-radius:5px;border-style:solid;border-width:2px;color:#eee;cursor:pointer;font-family:MS Gothic,monospace,sans-serif;font-size:14px;height:30px;padding:0;text-align:center;text-decoration:none}.axpc_button:hover{border:2px solid #bbb}.axpc_button:active{background:linear-gradient(#222,#444);border:2px solid #333}.axpc_button:disabled,.axpc_button[data-selected=true]{background:#aaa}.axpc_button_width260{margin-top:4px;width:260px}",""]);const r=o},5056(e,t,a){e.exports=function(e){var t=a.nc;t&&e.setAttribute("nonce",t)}},5072(e){var t=[];function a(e){for(var a=-1,i=0;i<t.length;i++)if(t[i].identifier===e){a=i;break}return a}function i(e,i){for(var s={},o=[],r=0;r<e.length;r++){var l=e[r],d=i.base?l[0]+i.base:l[0],c=s[d]||0,p="".concat(d," ").concat(c);s[d]=c+1;var _=a(p),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==_)t[_].references++,t[_].updater(h);else{var u=n(h,i);i.byIndex=r,t.splice(r,0,{identifier:p,updater:u,references:1})}o.push(p)}return o}function n(e,t){var a=t.domAPI(t);a.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;a.update(e=t)}else a.remove()}}e.exports=function(e,n){var s=i(e=e||[],n=n||{});return function(e){e=e||[];for(var o=0;o<s.length;o++){var r=a(s[o]);t[r].references--}for(var l=i(e,n),d=0;d<s.length;d++){var c=a(s[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}s=l}}},5263(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFklEQVRYhe1WSRLDMAgTnT4iD8j/f+R7XlF6ouMkGLN4podWp8TCDhKYFvh10MKzeLD2sDaZpBfbtqX3rnCAAaC1dieYse+7xKhiSw6MlDMzmLWK3FFxwKMcrTXTiZQDK5QLnonv83EcqnIAJ+UehBxYqVwQcWCp8kwC94wmqjt+GFhKAJgrFx6VOdDXXuptqe94hqEe8M2Bz33v77cgOwEF5RJcPyyP3j2hBIho6IRgVvN0AqKOiNR1efWeJ3D3gKCvueKEVXPW+HAPFBSrsWEHFC76g3ZywuNAbsg74Ulgyd+2rxw+wMlRrQfUbvUe2K1d97tvQbTm3vhwLzGAV5HnWZzVhLOMqzyA/BzI3H8VX58Df7wBWFyk7NpwigYAAAAASUVORK5CYII="},5306(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,".axpc_NONE{display:none}.axpc_HIDDEN{visibility:hidden}.axpc_text_border{text-shadow:#000 2px 0,#000 -2px 0,#000 0 -2px,#000 0 2px,#000 2px 2px,#000 -2px 2px,#000 2px -2px,#000 -2px -2px,#000 1px 2px,#000 -1px 2px,#000 1px -2px,#000 -1px -2px,#000 2px 1px,#000 -2px 1px,#000 2px -1px,#000 -2px -1px}.axpc_background_mesh{background:#ccc;background-image:repeating-conic-gradient(from 0deg,transparent 0deg 90deg,#fff 90deg 180deg);background-position:0 0,8px 8px,8px 8px,16px 16px;background-size:16px 16px}.axpc_subwindow{background-color:transparent;height:100%;left:0;overflow:hidden;position:absolute;top:0;touch-action:none;-webkit-user-select:none;user-select:none;width:100%;z-index:2000}.axpc_subwindow>div{background-color:#333;border:2px solid #aaa;border-radius:5px;box-shadow:4px 4px 8px #777;color:#fff;height:auto;padding:8px;width:188px}.axpc_colorRect{border:2px solid #aaa;border-radius:5px;cursor:pointer;height:32px;margin:1px;width:32px}",""]);const r=o},5481(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,'.axpc_window{-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);background-color:rgba(0,0,0,.3);border-radius:8px;box-shadow:4px 4px 8px #000a;color:#fff;height:auto;line-height:14px;padding:2px;position:absolute;width:180px;z-index:1000}.axpc_window_attention{background-color:rgba(255,255,0,.3)}.axpc_window_header{display:grid;font-size:15px;grid-template-columns:minmax(18px,30px) minmax(0,1fr) 24px;height:30px;justify-content:right;margin:-2px -2px 0;padding:0}.axpc_window_header>div:first-of-type{font-size:13px;grid-area:1/2/2/3;height:30px;line-height:30px;overflow:hidden}.axpc_window_header>span{align-items:center;display:inline-flex;grid-area:1/1/2/2;justify-content:center}.axpc_window_header_dragZone{cursor:move;grid-area:1/1/2/3;height:30px;isolation:isolate;margin-left:-2px}.axpc_window_header_minimizeButton{background-color:#0000;border:0;border-top-right-radius:8px;cursor:pointer;grid-area:1/3/2/4;position:relative}.axpc_window_header_minimizeButton:hover{background-color:#f009}.axpc_window_header_minimizeButton:after,.axpc_window_header_minimizeButton:before{background-color:#ddd;border-radius:15% 15% 15% 15%/50% 50% 50% 50%;content:"";display:block;height:15%;left:10%;position:absolute;top:42%;width:80%}.axpc_window_header_minimizeButton:before{transform:rotate(135deg)}.axpc_window_header_minimizeButton:after{transform:rotate(45deg)}.axpc_window_content{background-color:rgba(0,0,0,.5);border-radius:8px;padding:5px}.axpc_window_hidden,.axpc_window_minimize{display:none}',""]);const r=o},5613(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEbElEQVRYhe2XX0jbVxTHP79sJHEVMkfMsoIMmYizukGp3QLSlxHmUOxE52CSVktAuz8Q9zAoWISJD0b3MAdzmXNjthmW4pgjsLdKkG6ToThYrJNkHc4urBlNZTYuzv3OHn5Jqmn+TSp72Rcuub/zO+ee77n3nJP7g//xH0PZh40ZaMzy7hfgykET+ESv158qLS3VJQWxWIxoNAqwCTwB3NzHugXhCHDn/PnzO6FQSEKhkASDQamrq5OamhqxWq0CfHxQzhXg64qKCgkEAinnU1NTAsiFCxdkbGxMgB3g8YMgcEpRFLl8+bIko19dXZWysjJpbGyUYDAogUBAzGbzv9oFXX4VQNv6d51OJ0ePHgVARJicnOT27dv09fUBYDQaOXPmDEA78Nj9IvAAMFxRUfGwy+VKCePxOOPj4/T09GCxWFLy5uZm9Hr9IeCt+0XAYTAYXhgZGcFoNAJa9KOjo8RiMdra2gBQFK2grFYrNpsN4Nn7QeBJYKSpqYna2tqUcGVlBY/HQ29vL2azOSUXEa5duyZ+v1+AzwohkKsPFAH+qqqquosXL1JSUgKAqqq0t7ejKAqXLl1Cp7sbg4iIy+W64/P5VoDjgOQj8GCOd28XFRXVud3ulHMRYXZ2lqWlJXw+H4qiICKp37W1NXw+30PAe4U4z0XgCHC2o6OD6upqRIR4PE44HObcuXPY7Xaqqqr2GIgI/f39AN8Bk4U4z0XgHeBQOBymoaGBra0tNjc32djYAMDhcNzjfGZmhrm5OQG6C3WejUAJ8NyJEydUg8Ggs9vtlJeXA1BZWUl3dzd+vx+bzZbK/Gg0ytDQkABfAN+nrWcErIn5TSC2+2WmKtgCtuvr63VDQ0O0trYCcPjwYWpqaujp6cHr9RKJRFLRDw4OEolEYsBru9YpBWaAG8D1xAiS/Z90D64cO3ZMXC6XAGIymURRFBkYGJCFhQXR6/XS2dkpwWBQhoeHRVEUFTibvgZaIqaPv4Gn8hF4A1BNJpN68uRJWV5elq6uLgHE5/OJw+EQo9EoHo9HLS4uVtGSLr2kr2YhIMB0PgKlaFsnbrdbQqGQTE9PCyATExMyPz+v6vX6HUAFviXzUQ7mIPBTUilbJ4wAHwKsr68jIuL1esViscji4qLa0tKibG9v64BFoClBJB0raDnQBXQCn+eLOh1PJxk7nU41cc4qcAv4FGhA65bZkH4kp8mwA7lQAtxJGKjAPFp7NRQewx68kolArlYcRcvsFwE/4AH+3KdzgGd2zcO5CLwK1AMLwAbgRNv2JIwJYslS2kTL+Kkczo8DryfmkkeX69zdKhV4Hu08K4G+BPv0rFYThE9zb17Ygd926cYBCzkQTVv4VxIlWeC4BXwFeIGfMxB9P5dzMhglDdUMz3+lydNt0p8DaB82OfEy8EcWAjeAj4CX0K7eJWg1vl4A4S/RGtweZLsRPQo40O4FMbQSnAd+zKL/CPAm0IJ2jUvid7Tj+AD4JpPhfj7N8sGaGDvAD/mU/wGTCPZygcR1iwAAAABJRU5ErkJggg=="},5835(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,'#axp_config_div_content{display:flex;height:100%;margin:0;padding:0}#axp_config_div_nav{background-color:#eee;height:100%;overflow:auto;overscroll-behavior:none;padding:10px;position:sticky;top:0;width:200px}#axp_config_div_nav button{background-color:#eee;border:0;border-radius:6px;color:#111;cursor:pointer;font-size:1em;font-weight:700;height:40px;margin:1px 0;padding-left:8px;text-align:left;width:160px}#axp_config_div_nav button.axpc_ACTIVE{background:#e09c35}.axpc_config_chapter{background-color:#eee;height:100%;overflow-y:scroll;padding:10px;width:calc(100% - 200px)}@media (max-width:599px){#axp_config_div_nav{display:none}.axpc_config_chapter{width:100%}}.axpc_config_section{color:#111;margin-bottom:50px}.axpc_config_sectionHeader{background:#ddf;font-weight:bolder;margin-top:8px;padding:8px}.axpc_config_group{border:2px solid #ddd;padding:16px}.axpc_config_group a{overflow-wrap:anywhere}.axpc_config_groupHeader{background:#ddd;margin-top:8px;padding:4px 16px}#axp_config_ul_canvasSizeHistory{border:1px solid #aaa;list-style-type:none;margin:0 0 8px;max-height:220px;overflow-y:auto;padding:0;width:200px}#axp_config_ul_canvasSizeHistory>li{cursor:pointer;height:25px;padding:2px 10px;text-align:center}#axp_config_ul_canvasSizeHistory>li:nth-child(2n){background:#ddd}#axp_config_ul_canvasSizeHistory>li[data-selected=true]{background:#f7a312!important}.axpc_config_table{border:2px solid #aaa;border-collapse:collapse}.axpc_config_table td:first-child{font-family:Consolas,monospace;font-size:12pt}.axpc_config_table th{background-color:#ddf;padding:0 8px}.axpc_config_table td{border:1px solid #aaa;padding:0 8px}#axp_config_div_paletteScroll{background:#ccc;max-height:228px;max-width:228px;overflow:auto}#axp_config_div_paletteBox{align-content:flex-start;background:#333;display:flex;flex-wrap:wrap;padding:4px}.axpc_config_colorRect{border-radius:3px;height:20px;margin:1px;width:20px}#axp_config_div_scale{width:200px}#axp_config_div_scaleButton{display:grid;grid-template-columns:1fr 30px 1fr;width:100%}#axp_config_button_addScale{width:100%}#axp_config_button_deleteScale,#axp_config_button_resetScale{margin-top:8px;width:100%}#axp_config_ul_scale{border:1px solid #aaa;list-style-type:none;margin:0;max-height:352px;overflow-y:scroll;padding:0;width:200px}#axp_config_ul_scale>li{cursor:pointer;height:25px;padding:2px 10px;text-align:center}#axp_config_ul_scale>li:nth-child(2n){background:#ddd}#axp_config_ul_scale>li[data-value="100"]{border:1px solid #333}#axp_config_ul_scale>li[data-selected=true]{background:#f7a312!important}#axp_config_div_colorTag{display:grid;gap:4px 10px;grid-template-columns:1fr 1fr;grid-template-rows:repeat(4,34px);margin-bottom:8px;width:300px}.axpc_config_div_colorTag{border:2px solid #222;border-radius:5px;width:154px}.axpc_config_text_colorTag{border-radius:5px;font-size:13px;height:30px;padding-left:4px;text-align:left;width:130px}.axpc_config_select_scaleTable{width:24px}.axpc_config_number_scaleValue,.axpc_config_number_sizeValue{width:60px}#axp_config_div_versionInfo{-webkit-user-select:all;user-select:all}',""]);const r=o},6158(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAoCAYAAADDo7u9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAZUlEQVQ4je1RWwqAMAxLZVfI/Q+YQ8wPKXSwOsQqCOarj0DSBvjxEiw2knrsSVq69Nm2kiggZNqFErcJzQuS5ubiB1tkD68t8wAgDwoIcZ9G/SxsZnAgAPMrgMPotSsk9ZXkN7EDuUc2YkzwIXMAAAAASUVORK5CYII="},6314(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var a="",i=void 0!==t[5];return t[4]&&(a+="@supports (".concat(t[4],") {")),t[2]&&(a+="@media ".concat(t[2]," {")),i&&(a+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),a+=e(t),i&&(a+="}"),t[2]&&(a+="}"),t[4]&&(a+="}"),a}).join("")},t.i=function(e,a,i,n,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(i)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(o[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);i&&o[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),a&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=a):c[2]=a),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),t.push(c))}},t}},6375(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEGUlEQVRYheWXz09jVRTHP6/8aLE0iFpt1LSQEAnhhzGxuEAoaS3q4Ewyq9GVrkB2A6EBDQQ3uGH+ABEJSTH+WAiRhJiaEH4YqIOMwcEKQ9tJZNBEQpQEdILQd1y8PiydQkuZWRi/yUtf3r33fL/3nHPPuYX/O3KyXFcAPA2YgL37JydzjAECHAIfAYZsDSkJ71bgApAbN/wXcB24EydLxC3gmfi7AG8B/mxF6PgmbizxUYEwcDlJ7IdJ89aTxrPCrRQCEoV8D7wSn2sFbiSN288r4M24oZNECBAD3o7PfxT4PEGA47wCCoCv0wjQE08XkYOWhD8BDyfYegq4dBZyA1rCpXJ9LMX33+OCk21cBr4C/oyvq85UwOspSHQB+hMDbgOfAB+g1QCd+CUgCEhFRYX09vZKZWWlAF+kI86N/yZnsBr/pqJ5ZgL4FNhImlcBXFMU5UJtbS0tLS00NDRgMBgQEUKh0MvA48BWOgFfosWxIk76MzAOfAwsp1hnA3xAa2VlpamjowOXy4WiaPtQVRW73U5eXp754ODgKvBuOk+AFlMH8MQpc3KA94G90tJSta2tLba2tvZ3JBKRaDQq4XBYhoaGpLq6OjGMYc5RKXUoQCPwncVikb6+PpmfnxdAqqqqpKurSwYHB8Xlcp2UR8+fh9wGfAaIy+WSQCAg0WhUIpGI+P1+cbvdKY+rxWKR3t5esdvtAlw7yfhprjGgxe62zWa7Mjo6yvDwMGVlZYgI29vbTE9PEwwGjy0ymUwoioKiKGxubuJ0OkErcqZ7KU5HGSAej0eWlpaOdh0KhcTn84nRaDy2Y0VRpKmpSRYWFmRubk5aW1vF4XAkhsEPvMAZesZDwGJxcbEEg0EJh8Oq3+8Xm812j7tdLpdMTk5KJBIRPSF1wWNjY1JSUpJYT+4A7+gk6dQ8Asw7nc7yvb09WV1dPRaympoa2tvbaWhoONXI1NSUtLS0CHAFeA5YQjvmGbmjCq1VH9V6q9VKf38/brf76OyfBBFhf3+furo6dnZ2fCQlZCbn80e0NnwXEJ/PJ7Ozs3g8nrTkAIqiYDQa8Xq9oPWKY8i0QFwHrgJiNpsP8/PzM1z2r4jm5mbQkvDZxLGzXEpvAFszMzOvFRUVUVNTo2TiAR1Wq5WRkRHD4eHht8AP2QgALXm25ubmXt3d3TXU19dnFIZYLEZPTw8rKysq8B7wW7YCdBG/LC8vX9zY2FAaGxvJzc1NOVFEWF9fp7OzUwKBwF3gDWAmC86UeBH4o7y8XF1cXFT1s59QA9SBgQHVbDarwK+csx+chCeBmw6H43B8fFzVi8/ExIR4vV79EhMAHnsQ5DqswM3CwsJYd3e3eDweURRF3/VF7sN1PRMUoF1eVGAN7Y9K8p3xgcOA1rr/W/gHfXHTs2UHg10AAAAASUVORK5CYII="},6518(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(323),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},6535(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(5042),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},6569(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,".reinvented-color-wheel,.reinvented-color-wheel--hue-handle,.reinvented-color-wheel--hue-wheel,.reinvented-color-wheel--sv-handle,.reinvented-color-wheel--sv-space{touch-action:manipulation;touch-action:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.reinvented-color-wheel{border-radius:50%;display:inline-block;line-height:0;position:relative}.reinvented-color-wheel--hue-wheel{border-radius:50%}.reinvented-color-wheel--sv-space{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.reinvented-color-wheel--hue-handle,.reinvented-color-wheel--sv-handle{border:2px solid #fff;border-radius:50%;box-shadow:inset 0 0 0 1px #000;box-sizing:border-box;position:absolute}.reinvented-color-wheel--hue-handle{pointer-events:none}",""]);const r=o},6725(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAANdJREFUSEvtlNENwyAMRMliDMBEjMBEDMBiqUyL5LgYjoiQfCRfKDr5+c6GzSz+tsU88wIp8X0w9mZqSKR7CAFieu9JNwf4K6aCqakrgFr3OYUZwNH5lQTUWFt5w7OTObecNiOCNkURadAa8LQzxKkEToMVuHTKgWcXBE0+s+4Foi8KaqkW68HhI4D8SdMa6mn44jQdlkLOORNjzAnR2Vqbzymlw/+ikY3BQD4rXlzOkDdRmy8MvMVhbz7kqKeBHY6uv6Z/DnCWI6XO/9O2/OKvdngx71v+A7ETgR2iyLtGAAAADmVYSWZNTQAqAAAACAAAAAAAAADSU5MAAAAASUVORK5CYII="},6766(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(473),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},6902(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAI9JREFUSEvt1tEOgCAIBVD9/4/OueXWXMC9mNgDPRbjCKRVS/BVg72SoNbx635IdYkKfugDG7fgPHCgglEoC86VzS0385kBQGUUioJWZTCKgCymztQCvZiIWqC0D0O3RV9EguKRmDP8zVvq/lHwznAJXD1NKLxXKH25tyzkKEi1xhusVejNqW6lo+DXFb3ma5EiGhbw8xrfAAAAAElFTkSuQmCC"},7130(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEKUlEQVRYhe2WXUikZRTHf+84ujrN6Gg4ss0kS22aQazlRZJ13UUYiF+IgaViF0nF3qngjd6EXSRC0VWEOkRJCH57oY4wUhHLQGxu69iG2dbU+JFfO7Y7c7p4ntlmZkdnDISC/vAw7/ue5z3nf/7nOecd+B//cWQAfcD1nJycW9nZ2beAL4G3tO3c8Z7ZbJaBgQGZn5+X1dVVmZ2dlaqqqggwct4kngckdhUXF0t3d7f4fD4pLCyMAG+fV/BC4LvKykqZm5sTj8cjIyMj0tHRIRaLRcrLy6WsrOwe8Ol5BDcBszabTbxer/j9fllfX7+/xsfHxWazCRABOlM5+yc1egd4c3h4mJKSEgzDiDM6HA6CwaD4fL5D4HUglCqbs+Ai0FtbW0tFRQUigojEbRARWVhYAPgI2E3l0HyG4CbgY4fDYe/q6nog8ygWFxfZ2NiIAJ+k6zRdvAq81NnZyeHhIYFA4AEFRITR0dEIMAt8ewbfKVEAbJLQdna7XRoaGsTtdovf75fJyUkxDCMCvJyu43RKYAI+KCoqemR6epq8vDwAgsEgy8vLuN1umpubaWxsZGdnBxH5Bpg6a4anoQUQq9UacTqd4nQ6xeVySX19vUxMTMja2pr09/dHVYmgSpWIF4HngBeAZ2MN6ShwNT8/n7a2NsPhcACwtbXF1NQU1dXV9PX10dTUhNfrZWZmZhP4PImPy4AdOES1/rV0CdiByz09PdTU1MQZ2tvbGRwcpLe3l6OjI5aWlgR4FzhO4qcUuAs8DARiDcl76W9cAn7weDzicrniOibaAa2traysrEg4HN4EnkhCwAR8iEo2C9gAemKNp2EXOBoaGiIcDscZDMPAZDLR0tIi2jaSJDhADvAHSv4Q8FMiu1QEro6NjRl1dXXi8/mOQ6HQ/exDoRCBQCA6CIZP8FGsf0X724lLJAWBKF4B3gcu5eXlGVarFYC9vT329/dFB39NB0lEKfAGqkP+BD4DfOkQMAGZQFi/LKgaVya8dwP46gQfuUAHkA9YgCPUN2IjuiFZF5iBJ4HHgQP90g2UdDf1SgcZQBlqiubqBNaB7cRgiXgUeBp4DPgV1TbplioKE/AMaujY9X1Akz9IReAp1MSyAuXAF8CdMwS3oD7bV1BtHFXxGvB94uZkBDJRkrlQ9c/VZE4jkY2SvEgHvYJS0Ar8COwDvwDBdAiYUL27rR1W6PvfUW20CzyEqmkB6oBaNfF8vXZi1m1gEfAnY56MQFBvztJOD1CHsgi4h1LFoq+3Ua2FJmUCftbXv6Gk/1o/S4pk/wm3UBPNrAlk6EAXdPBMlOR39PMClMSgpp2hA98EvKj/EckmJHDy6b6AqmUpKvss/ewiqgQ5OugxSqEDTfw2qtZ7+j5yUuBUBGJh1gGtmoQZJbWgzkUYNePvpuHr34e/AD3wjysuWELmAAAAAElFTkSuQmCC"},7616(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAChElEQVRYhe2VT0gUURzHP08rBnQPW21rdQi8KgtLCXv0tgiLoCcvgYaKiqeuYgdZIdA9eunQKRYKdyEICiPo4iHTDuISPN8co0siRIegfL8OO5Oz4245tirEfuDxZoY3fL7ze38GWrRoHm1AFrhyHvLrwCvAAh+BvrOU3wX2gQMvgPXu75y2uB145Il9ucRiMent7RUvRO605JeBp0ExIIlEQkqlkmitZWhoSIDvwL1myxPABw7LLYCkUinZ3NwU13XFdV3RWsv4+LgFvgG3myW/CXym+uXiNTswMGCD8mCInp4eAfYahWiLIE8D74BrwYepVIrl5WUVj8drBosIa2trVCoVqE7Za+oszOMGyABvgBveO20Ag4ODrK6uKsdxjsiLxSKzs7NQrRJAHLh/TF8NaeArhyUXpZRMTEyI1vpI2Y0xMjMzI8HxXrPAw6jyPuBLWJ7P54+IXdeV3d1dmZ+fbyR/CVyMIk8C+8lksma1Ly0t1ZVrrWVkZKSRfJsTHNH5RCLxY2dnRyYnJw8Am8vlrDFGjDE18o2NDUmn02Gp37apbt3jMzc3J0BlenpaRESMMbKwsGCVUnZqaqomwNbWlmQymfBX+wfUe6o7ILJcwhhjZHFx0SqlZHh4WLTWsr6+bru7u39Sv+xvgauR5B51A4iIuK4rKysr4jiOzWaz0tHR0WjOy8Clk8iDIWyjEKVSyXZ2dv5emCH5c+DCv8h99kZHRxtWolwuSywWC8ufEXGr/RHHcWyhUKhbCWOMFItFq5TyV/sToh3tf6Xd6w/6+/vrhujq6vL/dg+aLQ/zAvgUlHvix4R+TqeJP9e3Atdny9jYmADi9edDoVA4P3mL/5JfpBcZsB/cpIwAAAAASUVORK5CYII="},7659(e){var t={};e.exports=function(e,a){var i=function(e){if(void 0===t[e]){var a=document.querySelector(e);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[e]=a}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(a)}},7825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(a){!function(e,t,a){var i="";a.supports&&(i+="@supports (".concat(a.supports,") {")),a.media&&(i+="@media ".concat(a.media," {"));var n=void 0!==a.layer;n&&(i+="@layer".concat(a.layer.length>0?" ".concat(a.layer):""," {")),i+=a.css,n&&(i+="}"),a.media&&(i+="}"),a.supports&&(i+="}");var s=a.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,a)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7851(e,t,a){a.d(t,{A:()=>u});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s),r=a(4417),l=a.n(r),d=new URL(a(2165),a.b),c=new URL(a(7852),a.b),p=o()(n()),_=l()(d),h=l()(c);p.push([e.id,`#axp_makecolor_div_drawColor{align-items:start;display:grid;grid-template-columns:62px 3px 5px 5px 20px 34px 3px 4px 5px 25px;grid-template-rows:26px 5px 5px 29px}#axp_makecolor_div_drawColor>div:first-child{background:radial-gradient(circle at 100% 100%,#0000 10.3px,hsla(0,0%,100%,.3) 0);grid-area:2/3/4/5;height:100%}#axp_makecolor_div_drawColor>div:nth-child(2){background:hsla(0,0%,100%,.3);border-radius:10px 0 10px 10px;grid-area:1/1/5/3;height:65px;width:65px}#axp_makecolor_div_drawColor>div:nth-child(3){background:hsla(0,0%,100%,.3);border-radius:0 10px 10px 0;grid-area:1/3/2/9;height:100%}#axp_makecolor_div_mainColor{grid-area:1/1/5/3;height:55px;isolation:isolate;margin:5px;position:relative;width:55px;--axp-mixedcolor:#000}#axp_makecolor_div_mainColor:before{background-color:transparent;content:"";height:0;position:absolute;width:0}#axp_makecolor_div_mainColor[data-mixed=true]:before{background-color:var(--axp-mixedcolor);border-radius:3px;-webkit-clip-path:polygon(100% 0,0 0,0 100%);clip-path:polygon(100% 0,0 0,0 100%);content:"";height:51px;position:absolute;width:51px}#axp_makecolor_div_mainColor[data-mixed=true]:after{border:5px solid transparent;border-bottom:0;border-top:6px solid #eee;content:"";height:0;left:21px;position:absolute;top:-9px;width:0}#axp_makecolor_div_subColor{grid-area:3/6/5/7;isolation:isolate}#axp_makecolor_div_transparent{background-size:14px 14px;grid-area:3/8/5/11;isolation:isolate;margin:1px}#axp_makecolor_text_colorCode{grid-area:1/2/2/9;margin:4px 0 0;width:70px}#axp_makecolor_button_swapColor{background-image:url(${_});grid-area:3/4/5/6}#axp_makecolor_button_addColor,#axp_makecolor_button_swapColor{background-position:0 50%;background-repeat:no-repeat;background-size:85%;cursor:pointer;height:100%;isolation:isolate}#axp_makecolor_button_addColor{background-image:url(${h});grid-area:1/10/2/11}#axp_makecolor_div_RGBSlider>div{margin-bottom:2px}#axp_makecolor_div_RGBSlider>div>*{vertical-align:middle}#axp_makecolor_div_RGBSlider input[type=range]{margin-left:5px;margin-right:5px}#axp_makecolor_number_blue,#axp_makecolor_number_green,#axp_makecolor_number_red{border:0;width:40px}#axp_makecolor_div_mixedPalette>div{align-content:flex-start;background-color:#333;display:flex;flex-wrap:wrap;gap:1px;justify-content:center;margin-bottom:4px;margin-left:2px}.axpc_makecolor_mixedColorRect{border-radius:3px;cursor:pointer;height:20px;margin:1px;width:30px}#axp_makecolor_div_mainColor[data-selected=true],#axp_makecolor_div_subColor[data-selected=true],#axp_makecolor_div_transparent[data-selected=true],.axpc_makecolor_mixedColorRect[data-selected=true]{border:5px double red}`,""]);const u=p},7852(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAATdJREFUSEu9lk0SwiAMhcuR3OuMB/F4HsQZ3XskHCihIeQHotJdC7yPF0jSsC1+wmLeZgGjY0OqpjRYQTHOMUOokqw2/ZjVJcjpda2G3+eHal4CY+AwDEgWNM0r4M62CksLsTsJGO77SLy15jEUyLGGMVza2fGZ3ymQugMYLMZQHN4EbN0JQOu2UiB1Ci4zsLkkGFjcWbB8ViWceC7nUgZOwACCofQc4QL1IR2x45yTwtpfGqcYu6za2Uf/C+wynAC1CuMybQALb65u6rUNjRZZHNKar5LIbBFv+pACVHiHe1Q5xELPCXEOTWBahN3Sd0kANqk1y+ZAAfIl8OiWzM7aklcmeIC0eIthlFJl5gxpIzb/aaZvJ9o+1/UtoDs/R34xtDz2VoTO0IhDV2UT0+OnagNiyx1+AJdvkRMD1zotAAAADmVYSWZNTQAqAAAACAAAAAAAAADSU5MAAAAASUVORK5CYII="},7971(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(2022),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},7996(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(9199),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},8063(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(1158),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},8403(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADCUlEQVRYhe3WT0hlVRwH8M97o+9p+LRwpBbVokV/XAwY08ImfQwNtRFpUUyLSinIcBYxkC5FKCoqJyKoKBdB2SLsUbh6+Gg2pmBEYAiWSZGgm9FQZgZnHN9tce97vnk5pL4ZB2K+cLj3/s6539/3/M75/c7hFvaPx/A7vkPzQTqO4xVcQR7nsYrnDkrA65Hz97CCHnwZ2T7cK1l8HwJ+Rjdewzo28AJewtI++CrCH+iqhGA/ESjFZWEEbhpuR6wSgv3+HMfzSJdxXMI3+AEXb5SAY3gfj6TTaY2NjWBjY8PExIT19XX4BceFWXJdcQpBS0tLMDY2FiwsLFzVZmdng97e3iCRSAQY2g3hoT04fxSjnZ2dseHhYU1NTSAW2w5iVVWV1tZWm5ubpqenj+Aj/7FJS7Mghk9xeodxtRhub2/PDw0NicVienp6TE1NgWw2K5vNFgV1dHTAbWgo4TiGszh8LQGn8CImdxBwAg/09fXF4vHwl7m5OcvLyyCXy8nlcttqa2t3muwCHsb3aCwYq6LncXwQKXwwaovRYOhta2vLNzc3F8arrq6WTCaL7wVhsLJS3Hu1+ATJ6Ps3HMW70WSLAgiX4Cjui75nIgEv44l0Ol30EIvFZDIZqVQKDAwMCIKgSDQ5OUlYlhfLohBE7f7yCJzFZ3gGJ/FjZL8TZ7q7u4OurqsrbkPD9vLW1NRsewgC4+PjhQlcEJ6cBbwtPLpfLRhK98BpLOPzEtuTiURCf39/vDTE10I+nzcyMhLMzMwE+Lis+wT68QZ+KhhL03ATX0edf0a25q2trZNra2uXVldX1+rq6s6nUqka4XJdxNK5c+ca5ufnL2cymc3BwcGq0dFR+ALvlAmoFRamN4XLsCscEp7/s8LLRz6ZTK7U19f/nUwml4Wn4VbUt4iv8NRuydlbKb4L9/j39WsJv+KvvTj+X+BxfFspSSUXkrtx5GYIOCysnOW2t/BQpYJ2g2eFN+A54cbrEmbAhR2E3RDEI6erwvS7gjPCLDlQ3IGnce9BO76F64p/AOYd4dsL5+wgAAAAAElFTkSuQmCC"},8430(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAANZJREFUSEvNlsEVxCAIRKU9K7IEK7I998Gqi2K8hPGtt1z8zDhAKFw+dJkX/gZYUcp3CgUWY3RnllK2llYULIRAq0IojC3TQIiVbGM7wupACIwBDTiEDSDy3XT6GAhrAW3l5Kt7/g8XniYNQrlpi16bwHLObuJTShLSx0kDgD0DPWFM6erWxufvioRtJ80toHtIlJVT8MakQSirde4sIppnqVsPtIs0kGHHtlire1NMh21TKlFdrHgD+8r6bSazgJEw0xZomFnAnsBmo3k29D40s/r6j/AHMk9TGfZf1gYAAAAOZVhJZk1NACoAAAAIAAAAAAAAANJTkwAAAABJRU5ErkJggg=="},8440(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGG0lEQVRYhe2WXUxTZxzGn3N6zqFd+fCDshWYEai1hkGos8IEpRNOhVANEk1nnINkxBHEaNVAGk28KNBYkSaGeGFUnEYuLAyiGKdMlDQ6MWjVxCBmHXWY4VjrTLU0ODnvLgxdBQS/5tV+ybn6v//nec7/fc8H8D9vSElJiSUuLu5CbGzsraampg0f1DwnJ0cBgKSnp5PExEQCgGzcuPHaBwtQVVUVDYAkJCSQ7du3k5qaGgKAlJeXb3knYafT+ZFWq92+aNGihqSkpDaNRnM1Jydnj81mW2a1WunQtTabLWn16tWPOI4bjY+PJ/n5+UQsFo/s3r2be+sAer3+EE3TZMGCBUSj0RClUknkcjlhGIZIJBJ/WVnZaYvFEhPaU15ezlVXV+9TKBTPAJCoqKhFb+NNAUBycvIxQsiG1NRUUBQFkUgEjuPAcRy8Xi+6urrw+PFjlJaW6g4cONAxXsRgMKxIS0vrMZlM3jcNIAKAbdu2Rdnt9kKe5zFv3jzI5XLIZDLMmjUL8fHxyMzMBMuyaG9v31BRUXHxypUr90NF7ty547pw4UIAAMxm8zeDg4OXjEbjqc7OTs9rTQAA1Gr1bafTmaLT6aDT6YKTYBgGDMNALBbj7NmzaG9vF/Lz85nm5mYSKmQ0Gj/r6ek55HA40qVSKUQiUYfP59O9VgCn0zmb53mPQqHAunXroFKpwDAMaPrF+RMEAfX19XA4HPD7/VCr1bE9PT2DYyKFhYWX2trasmUyGXJzcyEIAux2OxEEgX6FbxCR0+kMMxgMg9nZ2VxVVRViYmIgEolAUS+Gs2/fPlRXVwPAzyqV6uuCgoIdra2tf1ZWVjJisdjo9/uv9Pb2ztXr9VAqlS/uiqIwMDBAFRQUJPT29rZNOQGtVpty7dq12zdu3AiaPn36FCaTCefPnwfP8z6r1fq5Wq3+ZazJbDZ/3NjY+NDtdmP58uWQyWQThJ8/f46WlhYIgkBNKIZAx8bGegOBACwWCy5evIg1a9YgMzMTd+/e/bGiouKLjo6OqDHz+vp6+Zw5cw7X1tY+lEqlMBgMk5r39/fDbrdDEATk5eVpp5wAALS2tm4qLS0t8nq9f2VnZ//W1dW1bfxCm832rclkOhQZGYnFixcjIiIieKejo6MICwvDzZs3ce/ePYyOjgb7oqOjWz0eT9GUAabi5MmTy0wm0/cul2tuVlYWFAoFKIoCwzDo6OiA2+2esp/juKfPnj2LeKsARUVFvtOnT0csWbIEPM+D47jgkwEAfX19OHHiBIaHhycXpygQQpCXlzcSHR1dm5yc3GAymR69VoCVK1c2nDlzZtOePXuCh3OM4eFh1NXVwefzTdqrVqvB8zwiIyPh9/thsViQlJQEl8uFmJiYP4aGhj4ZW8u8KkBYWJhNoVBsam5uxtq1awEAgUAAjY2N6O/vByFkQk9ERATMZjMkEgkIIWBZFizLYsaMGXC5XDyAn2bOnJkwNDQ0/QQA4OjRo3ElJSUDmzdvpu7fv49Tp05Nuk6pVGLr1q2YP3/+S1s0RkNDA9xu94Pr169/Or427SGsrKwsOHjwYLvP54MgCBPqhw8fRmJi4pQafr8fer0eGRkZcVevXv09tDbtq9JqtZ4pLi7WhZqHh4fDaDTi3Llz05oDgFQqRUpKCrq7u9PH10TTdgPo7u7+defOnX87HI4cpVKJpqYmqFQqiET/ttM0Hfx4cRwHsVgMiUQCqVSK8PBwyOVyXL58OTcQCFhDtafdglB27Njxg81mW33s2DGkpKSApungNf5JGY/f78fChQsneE67BaHU1dUVrVixonb9+vVwu91gWfalD9erYFkWXu+LfxWNRlPzJp6TYrVav6Mo6vn+/ftJX1/fS5fL5SIPHjwgHo+HPHnyhBBCSEtLCwFAVq1adfTIkSPydw4AALt27SqjKIp0dnaSVzEyMkKysrIIAJKRkaF9L8ah1NTUfMWyrLBly5YJ5rdu3SIURZHU1FTP8ePH57138zH27t0rmz179nBhYWFw5DzPEwCjxcXFDf+ZcSg2m02k1WoHABCapklubm7v0qVLoz+IeShlZWUlaWlpX35w43fhH0T4gcNKUi9fAAAAAElFTkSuQmCC"},8562(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAoCAYAAADDo7u9AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAg0lEQVQ4jdWRQQ6AMAgEB+NTeRZ/xYOpgSitxnqQU8su7AIwCgfvYUtFSjkHj4n4l0pKAlZ2ut+h6yGYSZpHwWgPFXY2CWBmqUJVpQRbbhlJTCBU2hMlXhPW9lBVaebiBtfITqud5gGoDwXh3N1TfxtyZTAR4HoK2I0+m8LMfCT5z9gA7PxXykWr3MUAAAAASUVORK5CYII="},8721(e,t,a){a.d(t,{A:()=>P});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s),r=a(4417),l=a.n(r),d=new URL(a(3990),a.b),c=new URL(a(5613),a.b),p=new URL(a(5263),a.b),_=new URL(a(9346),a.b),h=new URL(a(7130),a.b),u=new URL(a(2326),a.b),m=new URL(a(4256),a.b),x=new URL(a(7616),a.b),g=new URL(a(6375),a.b),b=new URL(a(8440),a.b),A=new URL(a(9247),a.b),v=new URL(a(8403),a.b),f=new URL(a(587),a.b),y=o()(n()),C=l()(d),S=l()(c),O=l()(p),E=l()(_),w=l()(h),N=l()(u),I=l()(m),T=l()(x),j=l()(g),k=l()(b),L=l()(A),B=l()(v),M=l()(f);y.push([e.id,`#axp_pen_div_content{display:flex}#axp_pen_div_leftSide{overflow:hidden;width:104px}#axp_pen_span_penName{line-height:1}#axp_pen_div_preview{background:hsla(0,0%,100%,.4);border:2px solid #aaa;cursor:pointer;height:104px;margin-top:4px;position:relative;width:104px}#axp_pen_canvas_previewPenSize{height:100px;position:absolute;width:100px;z-index:2}#axp_pen_canvas_previewSpuit{height:100px;image-rendering:pixelated;position:absolute;width:100px;z-index:1}#axp_pen_div_spuitColorRGBA{line-height:1.3em}#axp_pen_div_slider{display:flex;flex-flow:column;margin-top:8px}#axp_pen_div_selectbox{margin-top:8px}#axp_pen_select_drawMode,#axp_pen_select_fillMode{border-radius:5px;height:24px;width:100px}#axp_pen_div_rightSide{margin-left:12px}#axp_pen_div_rightSide>div{position:relative}#axp_pen_div_rightSide>div>button,#axp_penmode button{background-color:#aaa;background-position:2px 2px;background-repeat:no-repeat;border:3px solid #000;border-radius:5px;box-shadow:0 0 10px #000;cursor:pointer;height:44px;width:44px}#axp_pen_div_rightSide>div>button:hover,#axp_penmode button:hover{background-color:#aaa;border:3px solid #fff}#axp_pen_div_rightSide>div>button[data-selected=true]{background-color:#eeac60}#axp_pen_div_rightSide>div:not(:last-child)>button[data-selected=true]:before{border-color:transparent #eeac60;border-style:solid;border-width:8px 7px 8px 0;content:"";height:16px;left:-9px;position:absolute;top:6px}#axp_pen_div_rightSide>div:not(:last-child)>button[data-selected=true]:after{border-color:transparent #000;border-style:solid;border-width:4px 4px 4px 0;content:"";height:0;left:-8px;position:absolute;top:18px}#axp_penmode:not(.axpc_NONE)~#axp_main #axp_pen_div_rightSide>div:not(:last-child)>button[data-selected=true]:before{border-color:transparent #533c21}#axp_penmode{background-color:transparent;height:100%;left:0;overflow:auto;position:absolute;top:0;touch-action:none;width:100%;z-index:2000}#axp_penmode>div{background:rgba(0,0,0,.8);border-radius:8px;color:#fff;font-size:15px;padding-left:8px;-webkit-user-select:none;user-select:none}.axpc_penmode_round{background-image:url(${C})}.axpc_penmode_square{background-image:url(${S})}.axpc_penmode_dot{background-image:url(${O})}.axpc_penmode_fude{background-image:url(${E})}.axpc_penmode_crayon{background-image:url(${w})}.axpc_penmode_brush{background-image:url(${N})}.axpc_penmode_eraser_round{background-image:url(${I})}.axpc_penmode_eraser_dot{background-image:url(${T})}.axpc_penmode_fill{background-image:url(${j})}.axpc_penmode_fillgradation{background-image:url(${k})}.axpc_penmode_hand{background-image:url(${L})}.axpc_penmode_move{background-image:url(${B})}.axpc_penmode_spuit{background-image:url(${M})}`,""]);const P=y},8777(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAARUlEQVQ4jWNgGGjAiEP8P7HqsRmASzNWPegG/CdVjokYW/CI4TSAaDDwBiD7i1DoY9VLcy/gSmhEG0CxCyg2gGDAUuwCANwbBhtd7LHHAAAAAElFTkSuQmCC"},8886(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(5835),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},8906(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(7851),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},9128(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(1325),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},9148(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(8721),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},9184(e,t,a){a.r(t),a.d(t,{default:()=>g});var i=a(5072),n=a.n(i),s=a(7825),o=a.n(s),r=a(7659),l=a.n(r),d=a(5056),c=a.n(d),p=a(540),_=a.n(p),h=a(1113),u=a.n(h),m=a(5481),x={};x.styleTagTransform=u(),x.setAttributes=c(),x.insert=l().bind(null,"head"),x.domAPI=o(),x.insertStyleElement=_();n()(m.A,x);const g=m.A&&m.A.locals?m.A.locals:void 0},9199(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,".axpc_range{position:relative}.axpc_range_label{font-size:12px;padding-top:1px}.axpc_range_label,.axpc_range_value{color:#fff;line-height:14px;padding-left:4px;pointer-events:none;position:absolute;top:0;z-index:9999}.axpc_range_value{font-family:Arial Black,Arial,sans-serif;font-size:16px;padding-top:15px;width:100px}.axpc_range input[type=range]{appearance:none;border:3px solid #444;border-radius:8px;cursor:pointer;height:32px;overflow:hidden;position:relative;width:100px}.axpc_range input[type=range]::-webkit-slider-runnable-track{background:linear-gradient(#000,#555)}.axpc_range input[type=range]::-webkit-slider-thumb{appearance:none;background:#999;border:4px solid #777;border-radius:8px;box-shadow:-100vw 0 0 99vw #777;height:32px;width:32px}.axpc_range input[type=range]::-moz-range-track{background:linear-gradient(#000,#555);height:32px}.axpc_range input[type=range]::-moz-range-thumb{background:#999;border:4px solid #777;border-radius:8px!important;box-shadow:-100vw 0 0 100vw #777;box-sizing:border-box;height:32px;width:32px}#axp_layer_form_alpha div,#axp_layer_form_alpha input{width:129px!important}#axp_palette_form_column div,#axp_palette_form_column input{width:110px!important}.axpc_range_width228 div,.axpc_range_width228 input{width:228px!important}#axp_tool_form_gridH *,#axp_tool_form_gridV *{width:118px!important}",""]);const r=o},9247(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFwElEQVRYhe2XX0yTVxTAf7dOKgI2IhQsMXGGLRPBLkZXN4OQyoNparIGI1FTiUGCS0jUB5zREqPhwX/Loi5xD/7BiEYeQB7mn5hNJBpDIDMRcJrxVaIRlP5zogltld494PfZllZwe9xO0uTrPfec8/vOPffc+8F/XUSCsdlAPlCQQJcLfPEP4owCXcAvgO9DADOAR0Cu0WgU06dPj1XOmIHZbP7o6D6fj87OTsLh8M/Ad9G6T+LmrhRC5La2tlJUVIQQAinlOKlIlKypS11dHa2trTPix+MB5ppMJrF48WIALbj6PBWIaJupiO5DymQBpZQJAyUamww6PgMTnCVz4PV6GRkZ4d69e9qY2Wxm3rx5pKSkxPj5EERSgPjgKpDH42H//v1cu3YNgKysLPR6PT6fj1AoRG5uLjU1NWzcuBGdTqfZSikjHwWQiLqtrY19+/ZhNBo5dOgQy5cvx2QyIYTg5cuX+P1+mpubaWho4MSJE6SkpOBwONi2bRuRSOTtR2cg+u2bm5txuVxs376d6upq9Hp9THoNBgMGg4GFCxcSiUSw2WyEQiGOHz/O2rVrGRsbS0nke0oADx8+xOVyUVNTQ21trQYFEIlEePbsGVJKTCYTbW1tlJWVUV9fTzAY5OrVq5w7d447d+4APJ0sVmVeXp50u91SURTpdrtlf3+/LC4ulkuWLJGKosju7m7Z1NQkFUWRiqLILVu2SEAC0mKxSCGEPHPmjKa32+2aHhgDvo4OmHQbqqnt7e3l1q1b7NmzByEE7e3t7Nq1C4CRkRHOnz/Pjh07OHr0KF1dXUgpWbBgAUIIhBDajrhw4QIWi0UH/DAlAHWvt7S0UFhYqLXg6B7Q09NDMBikoqICu93OqlWrJvgAKCkpwWKxYLPZALInBYhuKPfv32fFihUxu8Ln8/Hq1SuGh4cxmUxkZWUhpWTNmjUAhEIhbe7AwABz5swBxs8SYNqkAGr6Xrx4wcDAAPn5+ZrOarVy8OBB0tPTycnJYWhoiKGhIQAKCsYPULfbrc33eDzx7t3Rf5Iugd/vp7KyEiklxcXF2vjs2bOx2+3odDqWLVuGwWDgypUrCCGYP38+aWlpPH78OMZXamoqUkp6enoAUoA/gD+BZUkBWlpaePToEWfPniU7+/2yqdkB0Ov1lJeX09jYSCgUQghBRkYG/f39wHiR+v1+rX46OzsBVtpstoUmk+kz4GhSAEVRKCgooLCwMGZcLUK1TpxOJ8+fP+fixYsArFu3DqvVipSSjIwMDhw4gNVqxev14na7qaqq4tixY2rB5sT328q8vLzGjo4Obt68SXV1NVarFafTidlsJi0tjfr6em7fvq0ZqB3v0qVL3Lhxg8zMzIQHWSQS4fr165SVlfHmzRusVisej+enpJ2wtLSUkydP0tDQwObNm9Hr9aSnp/P69Wtqa2sxGo309fXR1NTEtGnTGBsbi1kmNVvqs06nY/Xq1UgpOXz4MB6PRwKNCQFUo9LSUkpKSvD5fHR1dbF3714qKirYunUrAOXl5TgcDjZt2oTT6SQzMzNmqeIhpJS0t7dz6tQpCfwI/P7BC4kKk52djc1mY+bMmSxatCgmSFFRER0dHezcuXOCXfyJGggE2L17t5RS/gZ8D5PciOLFaDRy+vRpreJVmTVrlgaU7KYUDodlVVWV9Hq9L4FNwNuEAOFwWEYiERnvSAiBy+VicHCQ9evXc/fuXZ4+fcqDBw9wu90Eg8Gk4IODg2zYsEH09vZKwA480/zGzS0Drufk5LB06VKh1+snOFMURW0o2gsCOBwOceTIkQnznzx5gs1mk6OjoyPAt8DNaH18Ef4KfDk8PPzN5cuXv0oAGB20i/EPjgGguLu7uyHRxL6+PkZHRwFWAj3x+kS7oOfd7+ckwRPJp4FAgLq6OlJTU2M+XgKBgLqWfyUy/HdfG+9lDlAH5ACfA3Pj9P3Aat4t1/8SLX8D+hqAxFxJPLkAAAAASUVORK5CYII="},9326(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,"body{display:flex;height:100vh;height:100svh;margin:0;overscroll-behavior-y:none}#axp_main,body{flex-direction:column;overflow:hidden;padding:0;width:100%}#axp_main{background-color:#000;color:#fff;display:none;flex-grow:1;font-family:sans-serif;font-size:15px;margin:0 auto;touch-action:none;-webkit-user-select:none;user-select:none}:where(#axp_main) *{box-sizing:border-box;margin:0;padding:0}#axp_main_div_tab{align-items:flex-end;display:flex;min-height:30px}#axp_main_div_tab_menu{display:flex;list-style-type:none}#axp_main_div_tab_menu>div{background:#333;border-left:0 solid #000;border-radius:10px 10px 0 0;border-right:2px solid #000;border-top:2px solid #000;box-sizing:border-box;cursor:pointer;display:block;margin:0;padding:2px 0;text-align:center;width:98px}#axp_main_div_tab_menu>div:hover{background:#555}#axp_main_div_tab_menu>div[data-selected=true]{background:#777}#axp_main_label_hamburger{align-items:center;cursor:pointer;display:none;flex-direction:column;height:100%;justify-content:center;margin:0 8px;width:30px}#axp_main_checkbox_hamburger{display:none}@media (max-width:599px){#axp_main_label_hamburger{display:flex}#axp_main_div_tab_menu{align-items:center;background:#333;flex-direction:column;justify-content:center;left:0;margin-top:30px;overflow:hidden;position:absolute;top:0;width:100%;z-index:10000}#axp_main_checkbox_hamburger~div>div{border:0;height:0;margin:0;padding:0;transition:height .4s cubic-bezier(.23,1,.32,1)}#axp_main_checkbox_hamburger:checked~div>div{border:1px solid #333;height:2.5em;padding:.5em;transition:height .4s cubic-bezier(.23,1,.32,1)}#axp_main_div_tab_menu>div{border-radius:10px 10px 10px 10px;display:flex;justify-content:center;margin:0;padding:.5em 0;width:100%}}#axp_main_div_headerText{color:#fff;cursor:pointer;flex-grow:1;overflow:hidden;padding:4px 10px 0;text-overflow:ellipsis;white-space:pre}#axp_main_div_headerText:active{overflow:visible;white-space:normal}#axp_main_div_tabContent>article{display:none;flex-direction:column;flex-grow:1;overflow:hidden}#axp_main_div_tabContent input{font-size:13px}#axp_canvas{flex-grow:1;overflow:hidden;position:relative;width:100%}#axp_canvas_div_grayBackground{background-color:#777;height:100%;width:100%}#axp_canvas_canvas_main{image-rendering:pixelated;position:absolute;z-index:100}#axp_canvas_div_grid{image-rendering:auto;pointer-events:none;position:absolute;z-index:600}#axp_canvas_div_pointerPosition{bottom:0;color:#fff;font-size:18px;font-weight:500;right:0;z-index:800}#axp_canvas_div_debugInfo,#axp_canvas_div_pointerPosition{background:rgba(0,0,0,.7);box-shadow:#000;font-family:monospace;position:absolute}#axp_canvas_div_debugInfo{font-size:1em;height:50%;left:0;max-height:95%;overflow:hidden;resize:both;top:0;z-index:900}#axp_canvas_div_debugInfo>div:first-of-type{color:#fff;font-family:monospace;font-size:1em;height:24px;overflow:hidden}#axp_canvas_div_debugInfo>div:nth-of-type(2){background:transparent;color:#fff;font-family:monospace;font-size:1em;height:calc(100% - 24px);min-width:360px;overflow-x:hidden;overflow-y:scroll}#axp_canvas_div_penCursor{border:2px solid rgba(0,0,0,.3);pointer-events:none;position:absolute;z-index:700}#axp_config,#axp_config_div_menu,#axp_main_div_tabContent{display:flex;flex-direction:column;flex-grow:1;overflow:hidden}#axp_config_div_content,#axp_post{flex-grow:1}#axp_post{overflow:auto}#axp_footer{background-color:#222;color:#ddd;display:flex;flex-basis:31px;touch-action:none;-webkit-user-select:none;user-select:none}#axp_footer_div_message{background-color:transparent;font-family:sans-serif;font-size:15px;padding:4px}#axp_footer_div_icon{margin-left:8px;margin-top:2px}",""]);const r=o},9346(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAClUlEQVRYhd3Xz4tVZRzH8ddxBsa4zVxKB69zURkIctFMKEaUMBsH8w+wRYI6blyUmCuljbXLhUPQok2BRIzLAcF+EWO5mC5TqAiCooMhYhFFCuOPLLxPi+dcO9g9c3+NF/IDhwOH5/t9f855nvP9Pg9PkAp4Jb13Xa/iVwR80m34y/g9hQdMtxK8rEN4GSexIvPsVrcM9OBjrOwgR0c65N/Pnr32dgP+Yg68ipe6YeDTHAO/oe9xw1fhdo6BDx43HA7mwG9i/SNjl2HjUsITXK0Dr+LdOuNX4xf0LpWBrXXgAfPyf+kDeGOpDHxUB34P2xrE7UJxKQxU/PfTv99EXIJ9nZoo4cEj8C80X0178TVea9dAdv6r+AHPNBm7QTRbxdvtGtidgX+FpxuMT8S3/TaNqeK8DgrVGlzEO2nyPPXgLZzLGL6DY3i2VWgP9qfBe7C2ARw+S6EP8GVquNQqmNhUzvT394fR0dHs3F/BjkXirqXggXagNZVxc2RkJMzOzob5+flQqVTC9PR0dWJiIohv915O7JbUQFPqyXl+ZHh4ePPU1FQyODgoSRKFQkGpVErGxsYgmZubW4sP68T+JO6KduIyFhYzkFejnyoWi/cHBgaWhxAeznmSJBYWFszMzMD9RfJ+nho5gr9xCicamclqE+4ODQ1Vy+VyKJfLYXJyMlQqlTA+Ph7EBrOpyVwXxLXzerPwmg7LlN1SqRT6+vqqOKv5Fvsc7uJHLf7/L6Sg2sqvgXe3kKNX7B2ntNEDvhf3+sfFDcjzLcYP4ijebDQwr6gU8Zd4zNqKn/Fdg1wFbBePZ6fFxvNHuwZq2oJvxCm4LDage+l1CX9indiUboir/1IjaCsGiD2gkEKzCrie3v+/+gchBdKwQke8WgAAAABJRU5ErkJggg=="},9365(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,"#axp_palette_div_container{display:flex;flex-direction:column}#axp_palette_div_buttons{align-content:flex-start;background-color:transparent;display:flex;flex-wrap:wrap}#axp_palette_div_paletteBox{align-content:flex-start;background-color:#333;display:flex;flex-wrap:wrap}#axp_palette_button_addColor,#axp_palette_button_delete,#axp_palette_button_edit{height:32px;width:32px}.axpc_palette_colorRect{background-color:transparent;border:6px double transparent;border-radius:5px;cursor:pointer;height:30px;margin:1px;padding:0;width:30px}.axpc_palette_colorRect[data-selected=true]{border-color:#cecece}.axpc_palette_colorRect.axpc_onGRAB{cursor:grabbing;position:absolute;z-index:1}#axp_palette_div_column{margin-left:-6px;margin-top:-70px;position:absolute;z-index:2000}",""]);const r=o},9819(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA30lEQVQ4je3SvUpDQRAF4E+9VZArWFlIEAtJaSoVtLfPO/gAwUb7dCEvEF8jCGlCCrHWKqAS8acQjCIIKsFgcXchxYLaitMszJlzZs/M8B9/IOawjit84PQX3AOswgqucY/8h+QyRujGRBtDdLDwDTlHH+/Ynla8wE14a5hPkHdxiWc0YWYK3MFRyOUY4xx3yLCpsPsW6g4xyQK5hCpeMMAaHrCBLXziFWfoha8v4jF276AVrFBspoEn3KIehGLDPcXclqJAJeF3GSc4TmCz2Ec7Kg4SRZniNoYJbCIM8Qt3ny0eu9pmggAAAABJRU5ErkJggg=="},9837(e,t,a){a.d(t,{A:()=>r});var i=a(1601),n=a.n(i),s=a(6314),o=a.n(s)()(n());o.push([e.id,".axpc_number{margin:4px 0;min-height:30px}.axpc_number input{height:30px;padding-left:4px;width:85px}",""]);const r=o},9914(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAHFJREFUOE+tU0cOACAIs/9/NAYTTDUMjXpitTLR6ImIsA4Aqkd29Y0AexrIoEpOCfhnIzIb6+D02MGZ7fKC4bQzkOcb2Igga9zSMwvM6vRqn7hqApV/jjEaYUnwXMKXJp7O39uH90WKbuF4lb8f0+05d/uyv/FrQqysAAAAAElFTkSuQmCC"}},t={};function a(i){var n=t[i];if(void 0!==n)return n.exports;var s=t[i]={id:i,exports:{}};return e[i](s,s.exports,a),s.exports}a.m=e,a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.b="undefined"!=typeof document&&document.baseURI||self.location.href,a.nc=void 0;var i,n,s={};a.d(s,{default:()=>ye});class o{axpObj;windowSystems=[];zIndex_max=1e3;constructor(e){this.axpObj=e}add(e){this.windowSystems.push(e);let t=e.windowElement;this.zIndex_max++,t.style.zIndex=this.zIndex_max,t.addEventListener("pointerenter",t=>{this.enter(t,e)}),t.addEventListener("pointerleave",e=>{this.leave(e)}),t.addEventListener("pointerup",e=>{this.up(e)}),t.addEventListener("pointerdown",t=>{this.down(t,e)})}getSystem(e){for(const t of this.windowSystems)if(t.id===e)return t;return null}unminimize(e){const t=this.getSystem(e);t&&t.unminimize()}minimize(e){const t=this.getSystem(e);t&&t.minimize()}changeAllWindowHiddenClass(e){for(const t of this.windowSystems)t.isCanMinimize&&(e?t.hidden():t.visible())}allVisible(){this.changeAllWindowHiddenClass(!1)}allHidden(){this.changeAllWindowHiddenClass(!0)}restoreMinimize(e){if("axp_all"===e)return this.allHidden(),this.axpObj.launcher.minimizeButton(e),!0;return!!this.getSystem(e)&&(this.minimize(e),this.axpObj.launcher.minimizeButton(e),!0)}enter(e){this.axpObj.isDrawing?e.currentTarget.style.opacity="0.25":this.axpObj.ELEMENT.cursor.style.visibility="hidden"}leave(e){e.currentTarget.style.opacity="1",this.axpObj.msg("")}up(e){e.currentTarget.style.opacity="1"}updateZIndex(e){if(e.style.zIndex===this.zIndex_max);else{let t=e.style.zIndex;for(const a of this.windowSystems)a.windowElement===e?a.windowElement.style.zIndex=this.zIndex_max:a.windowElement.style.zIndex>t&&a.windowElement.style.zIndex--}}down(e,t){if(this.axpObj.isDrawing)return;e.stopPropagation();let a=e.currentTarget;if(this.updateZIndex(a),e.target.classList.contains("axpc_window_header_minimizeButton"))return this.minimize(t.windowElement.id),this.axpObj.launcher.minimizeButton(t.windowElement.id),void this.axpObj.configSystem.saveConfig("WDMIN_"+t.windowElement.id,!0);if(!e.target.classList.contains("axpc_window_header_dragZone"))return;i=e.pageX-a.offsetLeft,n=e.pageY-a.offsetTop;const s=(e,a)=>{var s=e-i,o=a-n,r=this.axpObj.ELEMENT.base.getBoundingClientRect(),l=r.width-t.windowElement.clientWidth,d=r.height-30;return s<0&&(s=0),o<0&&(o=0),s>=l&&(s=l),o>=d&&(o=d),{x:s,y:o}},o=e=>{let a=s(e.pageX,e.pageY);t.setPosition(a.x,a.y)},r=e=>{let a=s(e.pageX,e.pageY);t.setPosition(a.x,a.y);let i=a.x+","+a.y;this.axpObj.configSystem.saveConfig("WDPOS_"+t.windowElement.id,i),window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",r)};window.addEventListener("pointermove",o),window.addEventListener("pointerup",r)}setInitPosition(e,t,a){let i=!1;for(let n=0;n<this.windowSystems.length;n++)this.windowSystems[n].id===e&&(this.windowSystems[n].window_left=t,this.windowSystems[n].window_top=a,i=!0);return i}initPosition(){for(let e of this.windowSystems)e.setPosition()}resetPosition(){for(let e of this.windowSystems){e.resetPosition();let t="WDPOS_"+e.windowElement.id;this.axpObj.configSystem.deleteConfig(t)}}changeAutoAdjustPosition(){for(let e of this.windowSystems)e.setPosition()}}class r{axpObj;windowElement=null;launcherButtonElement=null;isCanMinimize=!1;name;id;type;window_width=0;window_height=0;window_left=0;window_top=0;constructor(e){this.axpObj=e}createHTML(e,t,a,i,n,s=!0){this.id=e,this.type=t,this.isCanMinimize=s;let o=document.createElement("div");o.setAttribute("id",e),o.setAttribute("class","axpc_window");let r=document.createElement("div");r.setAttribute("class","axpc_window_header");let l=document.createElement("div");if(l.textContent=a,i){let e=document.createElement("span");e.setAttribute("class",i),r.appendChild(e)}else l.style.gridArea="1/1/2/3",l.style.marginLeft="8px";if(r.appendChild(l),s){const t=document.createElement("button");t.setAttribute("class","axpc_MSG axpc_window_header_minimizeButton"),t.dataset.msg=`${a}ウィンドウを閉じます。`,r.appendChild(t);const n=document.createElement("button");n.classList.add("axpc_MSG","axpc_launcher_personalButton"),n.dataset.id=e,n.dataset.msg=`${a}ウィンドウを開閉します。`;const s=document.createElement("div");s.classList.add(i),n.appendChild(s),document.getElementById("axp_launcher_div_personalButtonsEntry").appendChild(n),this.launcherButtonElement=n}let d=document.createElement("div");d.setAttribute("class","axpc_MSG axpc_window_header_dragZone"),d.dataset.msg="ドラッグでツールウィンドウの位置を移動します。",r.appendChild(d),o.appendChild(r),this.axpObj.ELEMENT.base.appendChild(o),o.insertAdjacentHTML("beforeend",this.axpObj.translateHTML(n)),this.windowElement=document.getElementById(e),this.name=a}setPosition(e,t){let a=void 0===e?this.window_left:e,i=void 0===t?this.window_top:t;"on"===this.axpObj.config("axp_config_form_windowAutoAdjust")?(this.windowElement.style.left=`max(0px, min(100% - ${this.window_width}px, ${a}px))`,this.windowElement.style.top=`min(100% - 30px, ${i}px)`):(this.windowElement.style.left=`${a}px`,this.windowElement.style.top=`${i}px`),this.window_left=a,this.window_top=i}resetPosition(){let e=this.getDefaultPosition();this.setPosition(e.left,e.top)}minimize(){this.windowElement.classList.add("axpc_window_minimize")}unminimize(){this.windowElement.classList.remove("axpc_window_minimize")}hidden(){this.windowElement.classList.add("axpc_window_hidden")}visible(){this.windowElement.classList.remove("axpc_window_hidden")}}class l{static hide(e){let t;t="string"==typeof e?document.getElementById(e):e,t.classList.add("axpc_NONE")}static show(e){let t;t="string"==typeof e?document.getElementById(e):e,t.classList.remove("axpc_NONE")}}function d(e){const t=window.location.href;return new URL(e,t).href.split("/").pop()}function c(e,t,a,i){return Math.sqrt(Math.pow(a-e,2)+Math.pow(i-t,2))}function p(e){return"#"==e.slice(0,1)&&(e=e.slice(1)),3==e.length&&(e=e.slice(0,1)+e.slice(0,1)+e.slice(1,2)+e.slice(1,2)+e.slice(2,3)+e.slice(2,3)),[e.slice(0,2),e.slice(2,4),e.slice(4,6)].map(function(e){return parseInt(e,16)})}function _(e){return e.map(function(e){return("0"+e.toString(16)).slice(-2)}).join("").toUpperCase()}function h(e){for(var t,a,i=0;i<e.height;i++)for(var n=0;n<e.width/2;n++){t=4*(i*e.width+n),a=4*(i*e.width+e.width-n-1);var s=e.data[t+0],o=e.data[t+1],r=e.data[t+2],l=e.data[t+3];e.data[t+0]=e.data[a+0],e.data[t+1]=e.data[a+1],e.data[t+2]=e.data[a+2],e.data[t+3]=e.data[a+3],e.data[a+0]=s,e.data[a+1]=o,e.data[a+2]=r,e.data[a+3]=l}}function u(e){for(var t,a,i=0;i<e.height/2;i++)for(var n=0;n<e.width;n++){t=4*(i*e.width+n),a=4*((e.height-i-1)*e.width+n);var s=e.data[t+0],o=e.data[t+1],r=e.data[t+2],l=e.data[t+3];e.data[t+0]=e.data[a+0],e.data[t+1]=e.data[a+1],e.data[t+2]=e.data[a+2],e.data[t+3]=e.data[a+3],e.data[a+0]=s,e.data[a+1]=o,e.data[a+2]=r,e.data[a+3]=l}}function m(e,t,a){return(e-t)*(e-a)<=0}function x(e,t,a){let i=e;return e<t&&(i=t),e>a&&(i=a),i}function g(e,t){return t=(t=(t=(t=(t=(t=t.replace(/YYYY/,e.getFullYear())).replace(/MM/,("0"+(e.getMonth()+1)).slice(-2))).replace(/DD/,("0"+e.getDate()).slice(-2))).replace(/hh/,("0"+e.getHours()).slice(-2))).replace(/mm/,("0"+e.getMinutes()).slice(-2))).replace(/ss/,("0"+e.getSeconds()).slice(-2))}function b(e){return"#"==e.slice(0,1)&&(e=e.slice(1)),null!==e.match(/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)}function A(e){var t=e;return isNaN(t)&&(t=0),t=Math.min(255,t),t=Math.max(0,t)}function v(e,t){let a=p(t),i=document.createElement("canvas"),n=i.getContext("2d");i.width=4,i.height=4;const s=[0,10,2,8,5,15,7,13,1,11,3,9,4,14,6,12];let o=new ImageData(4,4),r=e;for(let e=0;e<r;e++){let t=4*s[e];o.data[t+0]=a[0],o.data[t+1]=a[1],o.data[t+2]=a[2],o.data[t+3]=255}return n.putImageData(o,0,0),n.createPattern(i,"repeat")}const f=[0,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,40,45,50,55,60,65,70,75,80,85,90,95,100,110,120,130,140,150,160,170,180,190,200],y=function(e){for(var t=0,a=0;a<f.length;a++){if(f[a]===e){t=a;break}if(f[a]>e)break;t=a}return t};class C{constructor(){this.base_x=0,this.base_y=0,this.base_index=0,this.old_x=0,this.old_y=0,this.end_x=0,this.end_y=0,this.drawmode=null,this.isLastDrawing=!1,this.input_position=[],this.name=null,this.type=null,this.size=null,this.index=null,this.alpha=null,this.threshold=null,this.toneLevel=null,this.blurLevel=null,this.gradation=null,this.radius=null,this.cursor="auto",this.usePenGuide=!1,this.usePenPreview=!1,this.usePenLock=!1,this.usePenStyle=!1,this.canUndo=!1,this.borderRadius=null,this.borderStyle=null,this.lineCap=null,this.lineJoin=null}init_save(){this.init_size=this.size,this.init_index=this.index,this.init_alpha=this.alpha}init(){this.size=this.init_size,this.index=this.init_index,this.alpha=this.init_alpha}getColor(){return this.axpObj.colorMakerSystem.getAdjustColor()}getColorRGB(){return this.axpObj.colorMakerSystem.getAdjustColorRGB()}blur(e){var t;this.CANVAS.draw_ctx.shadowColor=this.getColor(),(t=void 0===e?"on"===this.axpObj.config("axp_config_form_blurLevel")?this.blurLevel:0:Number(e))>0&&1!==this.CANVAS.draw_ctx.globalAlpha&&(this.CANVAS.draw_ctx.globalAlpha=this.CANVAS.draw_ctx.globalAlpha/Math.sqrt(2)),this.CANVAS.draw_ctx.shadowBlur=t,this.CANVAS.draw_ctx.shadowOffsetX=0,this.CANVAS.draw_ctx.shadowOffsetY=0}drawCursor(e){if(this.usePenLock&&this.axpObj.layerSystem.isWriteProtection())return this.axpObj.ELEMENT.view.style.cursor="not-allowed",void(this.axpObj.ELEMENT.cursor.style.visibility="hidden");if(this.axpObj.ELEMENT.view.style.cursor=this.cursor,this.usePenGuide){this.axpObj.ELEMENT.cursor.style.visibility="visible",this.axpObj.ELEMENT.cursor.style.borderRadius=`${this.borderRadius}%`,"normal"===this.borderStyle?"true"===document.getElementById("axp_makecolor_div_transparent").dataset.selected?this.axpObj.ELEMENT.cursor.style.borderStyle="dashed":this.axpObj.ELEMENT.cursor.style.borderStyle="solid":this.axpObj.ELEMENT.cursor.style.borderStyle=this.borderStyle,null!==this.radius&&(this.axpObj.ELEMENT.cursor.style.borderRadius=`${this.radius}%`);const t=parseInt(this.size*this.axpObj.scale/100);this.axpObj.ELEMENT.cursor.style.width=t+"px",this.axpObj.ELEMENT.cursor.style.height=t+"px";const a=this.getCursorPosition(e);this.axpObj.ELEMENT.cursor.style.left=a.x+"px",this.axpObj.ELEMENT.cursor.style.top=a.y+"px"}else this.axpObj.ELEMENT.cursor.style.visibility="hidden"}getCursorPosition(e){const t=this.getCursorPositionNormal(e);return{x:t.x,y:t.y}}getCursorPositionNormal(e){const t=parseInt(this.size*this.axpObj.scale/100),a=this.axpObj.ELEMENT.view.getBoundingClientRect();return{x:parseInt(e.clientX-a.left-t/2),y:parseInt(e.clientY-a.top-t/2)}}set_modeflag(){switch(this.drawmode=this.axpObj.CONST.DRAW_FREEHAND,this.axpObj.isSHIFT&&(this.axpObj.isLine=!0),document.getElementById("axp_pen_select_drawMode").value){case"option_line":this.axpObj.isLine=!0;break;case"option_rectangle":this.axpObj.isRect=!0,this.drawmode=this.axpObj.CONST.DRAW_RECT;break;case"option_circle":this.drawmode=this.axpObj.CONST.DRAW_CIRCLE}this.axpObj.isDrawing=!0,this.axpObj.isDrawn=!1,this.axpObj.isDrawCancel=!1,this.isLastDrawing=!1}reset_modeflag(){this.axpObj.isDrawing=!1,this.axpObj.isDrawn=!1,this.axpObj.isDrawCancel=!1,this.axpObj.isLine=!1,this.axpObj.isRect=!1,this.axpObj.isCircle=!1}init_globalCompositeOperation(e){let t;t=void 0!==e.task&&"transdraw"==e.task||"true"===document.getElementById("axp_makecolor_div_transparent").dataset.selected?"destination-out":this.axpObj.layerSystem.getMasked()?"source-atop":"source-over",this.axpObj.penSystem.CANVAS.draw_ctx.globalCompositeOperation=t}start(){}move(){}end(){}init_brush(){}draw(){}write(){this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}end_common(){this.axpObj.isDrawing&&(this.canUndo&&!this.axpObj.isDrawCancel&&(function(e,t){if(e.data.length!=t.data.length)return!1;for(var a=0;a<e.data.length;++a)if(e.data[a]!=t.data[a])return!1;return!0}(this.axpObj.layerSystem.load(),this.axpObj.layerSystem.getCurrentLayerImage())||(this.axpObj.undoSystem.setUndo({type:"draw",detail:this.type,layerObj:{id:this.axpObj.layerSystem.getId(),index:this.axpObj.layerSystem.getIndex(),mode:this.axpObj.layerSystem.getMode(),alpha:this.axpObj.layerSystem.getAlpha(),checked:this.axpObj.layerSystem.getChecked(),locked:this.axpObj.layerSystem.getLocked(),masked:this.axpObj.layerSystem.getMasked(),name:this.axpObj.layerSystem.getName(),image:this.axpObj.layerSystem.load()}}),this.axpObj.isBackgroundimage&&this.axpObj.drawBackground(),this.axpObj.saveSystem.autoSave())),this.reset_modeflag())}previewPenSize(){let e=this.axpObj.penSystem.CANVAS.pensize,t=this.axpObj.penSystem.CANVAS.pensize_ctx;t.clearRect(0,0,e.width,e.height);let a,i,n=this.axpObj.penSystem.CANVAS.spuit;if(this.axpObj.penSystem.CANVAS.spuit_ctx.clearRect(0,0,n.width,n.height),!this.usePenPreview)return;a="normal"!==this.borderStyle||"true"===document.getElementById("axp_makecolor_div_transparent").dataset.selected,t.globalCompositeOperation="source-over",t.globalAlpha=this.alpha/100,t.lineCap=this.lineCap,t.lineJoin=this.lineJoin,i=null!==this.size?this.size*(this.axpObj.scale/100):80;let s=i*this.borderRadius/100;this.createRoundRectPath(t,49.5-i/2,49.5-i/2,i,i,s),a?(t.strokeStyle="#000000",t.lineWidth=1,t.setLineDash([4,4]),t.stroke(),t.setLineDash([])):("on"===this.axpObj.config("axp_config_form_ToneLevel")&&null!==this.toneLevel&&16!==this.toneLevel?t.fillStyle=v(this.toneLevel,this.getColor()):t.fillStyle=this.getColor(),t.fill()),null!==this.size&&(t.globalAlpha=1,t.lineWidth=1,t.strokeStyle="#333",t.lineCap="round",t.lineJoin="round",t.beginPath(),t.moveTo(49.5,0),t.lineTo(49.5,99),t.moveTo(0,49.5),t.lineTo(99,49.5),t.stroke())}createRoundRectPath(e,t,a,i,n,s){e.beginPath(),e.moveTo(t+s,a),e.lineTo(t+i-s,a),e.arc(t+i-s,a+s,s,1.5*Math.PI,0,!1),e.lineTo(t+i,a+n-s),e.arc(t+i-s,a+n-s,s,0,.5*Math.PI,!1),e.lineTo(t+s,a+n),e.arc(t+s,a+n-s,s,.5*Math.PI,Math.PI,!1),e.lineTo(t,a+s),e.arc(t+s,a+s,s,Math.PI,1.5*Math.PI,!1),e.closePath()}}class S extends C{constructor(e){super(),this.axpObj=e.axpObj,this.CANVAS=e.CANVAS,this.name=this.axpObj._("@PENNAME.ROUND"),this.type="draw",this.size=1,this.index=y(this.size),this.alpha=100,this.toneLevel=16,this.blurLevel=0,this.usePenGuide=!0,this.usePenPreview=!0,this.usePenLock=!0,this.usePenStyle=!0,this.canUndo=!0,this.borderRadius=50,this.borderStyle="normal",this.lineCap="round",this.lineJoin="round",this.init_save()}init_brush(e){this.init_globalCompositeOperation(e),this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.lineWidth=this.size-.25,"on"===this.axpObj.config("axp_config_form_ToneLevel")&&null!==this.toneLevel&&16!==this.toneLevel?this.CANVAS.brush_ctx.strokeStyle=v(this.toneLevel,this.getColor()):this.CANVAS.brush_ctx.strokeStyle=this.getColor(),this.CANVAS.brush_ctx.lineCap=this.lineCap,this.CANVAS.brush_ctx.lineJoin=this.lineJoin,this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.blur()}start(e,t,a,i){this.axpObj.layerSystem.isWriteProtection()||(this.set_modeflag(),this.input_position=[],this.input_position.push({x:e,y:t}),this.axpObj.layerSystem.save(),this.init_brush(i),this.start_draw(e,t))}start_draw(e,t){this.CANVAS.brush_ctx.beginPath(),this.CANVAS.brush_ctx.moveTo(e,t)}move(e,t){this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.axpObj.isDrawn=!0,this.input_position.push({x:e,y:t}),this.draw())}draw(){this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size);let e=this.input_position[0],t=this.input_position[this.input_position.length-2],a=this.input_position[this.input_position.length-1],i=(n=t,{x:((s=a).x+n.x)/2,y:(s.y+n.y)/2});var n,s;switch(this.drawmode){case this.axpObj.CONST.DRAW_FREEHAND:{let n=!1;0!==Number(document.getElementById("axp_config_form_stabilizerValue").volume.value)&&(this.axpObj.isLine||this.isLastDrawing||(n=!0)),this.axpObj.isLine&&(this.CANVAS.brush_ctx.beginPath(),this.CANVAS.brush_ctx.moveTo(e.x,e.y)),n?this.CANVAS.brush_ctx.quadraticCurveTo(t.x,t.y,i.x,i.y):this.CANVAS.brush_ctx.lineTo(a.x,a.y);break}case this.axpObj.CONST.DRAW_RECT:this.CANVAS.brush_ctx.strokeRect(e.x,e.y,a.x-e.x,a.y-e.y);break;case this.axpObj.CONST.DRAW_CIRCLE:{const t=c(e.x,e.y,a.x,a.y);this.CANVAS.brush_ctx.beginPath(),this.CANVAS.brush_ctx.arc(e.x,e.y,t,0,2*Math.PI,!0);break}}this.CANVAS.brush_ctx.stroke(),this.write()}end(e,t){this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.isLastDrawing=!0,this.input_position.push({x:e,y:t}),this.draw()),this.end_common()}}class O extends S{constructor(e){super(e),this.name=this.axpObj._("@PENNAME.ERASER"),this.type="eraser",this.size=5,this.toneLevel=null,this.blurLevel=null,this.borderStyle="dashed",this.init_save()}init_brush(){this.CANVAS.draw_ctx.globalCompositeOperation="destination-out",this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.lineWidth=this.size,this.CANVAS.brush_ctx.strokeStyle="black",this.CANVAS.brush_ctx.lineCap=this.lineCap,this.CANVAS.brush_ctx.lineJoin=this.lineJoin}}class E extends S{img_draw;constructor(e){super(e),this.name=this.axpObj._("@PENNAME.DOT"),this.toneLevel=null,this.borderRadius=0,this.borderStyle="normal",this.lineCap="square",this.lineJoin="bevel",this.init_save()}getCursorPosition(e){const t=this.getCursorPositionDot(e);return{x:t.x,y:t.y}}getCursorPositionDot(e){const t=this.axpObj.ELEMENT.view.getBoundingClientRect();let a=this.axpObj.CANVAS.main.getBoundingClientRect(),i=Math.floor(100*(e.clientX-a.left)/this.axpObj.scale),n=Math.floor(100*(e.clientY-a.top)/this.axpObj.scale),s=this.size,o=Math.floor(i/s)*s,r=Math.floor(n/s)*s;return{x:parseInt(o*this.axpObj.scale/100)+a.left-t.left,y:parseInt(r*this.axpObj.scale/100)+a.top-t.top}}start_draw(){this.img_draw=new ImageData(this.axpObj.x_size,this.axpObj.y_size)}move(e,t){this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.axpObj.isDrawn=!0,this.input_position.push({x:e,y:t}),this.clear_brush(),this.draw())}clear_brush(){let e=!1;switch(this.axpObj.isLine&&(e=!0),this.drawmode){case this.axpObj.CONST.DRAW_RECT:case this.axpObj.CONST.DRAW_CIRCLE:e=!0}e&&(this.img_draw=new ImageData(this.axpObj.x_size,this.axpObj.y_size))}trans_dot(e){return Math.floor(e/this.size)*this.size+this.size/2}draw(){let e,t,a,i,n=this.getColorRGB();switch(a=this.trans_dot(this.input_position[this.input_position.length-1].x),i=this.trans_dot(this.input_position[this.input_position.length-1].y),this.drawmode){case this.axpObj.CONST.DRAW_FREEHAND:this.axpObj.isLine?(e=this.trans_dot(this.input_position[0].x),t=this.trans_dot(this.input_position[0].y)):(e=this.trans_dot(this.input_position[this.input_position.length-2].x),t=this.trans_dot(this.input_position[this.input_position.length-2].y)),this.drawLine(this.img_draw,e,t,a,i,this.size,n);break;case this.axpObj.CONST.DRAW_RECT:e=this.trans_dot(this.input_position[0].x),t=this.trans_dot(this.input_position[0].y),this.drawLine(this.img_draw,e,t,e,i,this.size,n),this.drawLine(this.img_draw,e,i,a,i,this.size,n),this.drawLine(this.img_draw,e,t,a,t,this.size,n),this.drawLine(this.img_draw,a,t,a,i,this.size,n);break;case this.axpObj.CONST.DRAW_CIRCLE:e=this.trans_dot(this.input_position[0].x),t=this.trans_dot(this.input_position[0].y),this.drawCircle(this.img_draw,e,t,a,i,this.size,n)}this.CANVAS.brush_ctx.putImageData(this.img_draw,0,0),this.write()}drawLine(e,t,a,i,n,s,o){const{width:r,data:l}=e,d=Math.abs(i-t),c=Math.abs(n-a),p=t<i?1:-1,_=a<n?1:-1;let h=d-c,u=t,m=a,x=-1,g=-1;for(;;){let e=Math.floor(u/s)*s,t=Math.floor(m/s)*s;if(e!==x||t!==g){let a=e+s-1,i=t+s-1;for(let n=e;n<=a;n++)for(let e=t;e<=i;e++)if(n>=0&&n<this.axpObj.x_size&&e>=0&&e<this.axpObj.y_size){const t=4*(n+e*r);l[t+0]=o[0],l[t+1]=o[1],l[t+2]=o[2],l[t+3]=255}x=e,g=t}if(u===i&&m===n)break;let a=2*h;a>-c&&(h-=c,u+=p),a<d&&(h+=d,m+=_)}}drawCircle(e,t,a,i,n,s,o){const{width:r,data:l}=e,d=parseInt(Math.sqrt(Math.pow(i-t,2)+Math.pow(n-a,2)));if(d<=0)return;var c=parseInt(128*d),p=0,_=0,h=0;const u=(e,t)=>{let a=Math.floor(e/s)*s,i=Math.floor(t/s)*s,n=a+s-1,d=i+s-1;for(let e=a;e<=n;e++)for(let t=i;t<=d;t++)if(e>=0&&e<this.axpObj.x_size&&t>=0&&t<this.axpObj.y_size){const a=4*(e+t*r);l[a+0]=o[0],l[a+1]=o[1],l[a+2]=o[2],l[a+3]=255}};for(;p<=c;)u(t+(_=parseInt(c/128)),a+(h=parseInt(p/128))),u(t-_,a-h),u(t-_,a+h),u(t+_,a-h),u(t+h,a+_),u(t-h,a-_),u(t-h,a+_),u(t+h,a-_),p+=parseInt(c/128),c-=parseInt(p/128)}}class w extends E{img_draw;constructor(e){super(e),this.name=this.axpObj._("@PENNAME.SQUARE_ERASER"),this.type="eraser",this.size=5,this.blurLevel=null,this.borderStyle="dashed",this.init_save()}getCursorPosition(e){const t=this.getCursorPositionNormal(e);return{x:t.x,y:t.y}}init_brush(){this.CANVAS.draw_ctx.globalCompositeOperation="destination-out",this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1}trans_dot(e){return e}drawLine(e,t,a,i,n,s,o){const{width:r,data:l}=e,d=Math.abs(i-t),c=Math.abs(n-a),p=t<i?1:-1,_=a<n?1:-1;let h=d-c,u=t,m=a,x=-1,g=-1;for(;;){let e=Math.round(u-s/2),t=Math.round(m-s/2);if(e!==x||t!==g){let a=e+s-1,i=t+s-1;for(let n=e;n<=a;n++)for(let e=t;e<=i;e++)if(n>=0&&n<this.axpObj.x_size&&e>=0&&e<this.axpObj.y_size){const t=4*(n+e*r);l[t+0]=o[0],l[t+1]=o[1],l[t+2]=o[2],l[t+3]=255}x=e,g=t}if(u===i&&m===n)break;let a=2*h;a>-c&&(h-=c,u+=p),a<d&&(h+=d,m+=_)}}drawCircle(e,t,a,i,n,s,o){const{width:r,data:l}=e,d=parseInt(Math.sqrt(Math.pow(i-t,2)+Math.pow(n-a,2)));if(d<=0)return;var c=parseInt(128*d),p=0,_=0,h=0;const u=(e,t)=>{let a=Math.floor(e/s)*s,i=Math.floor(t/s)*s,n=a+s-1,d=i+s-1;for(let e=a;e<=n;e++)for(let t=i;t<=d;t++)if(e>=0&&e<this.axpObj.x_size&&t>=0&&t<this.axpObj.y_size){const a=4*(e+t*r);l[a+0]=o[0],l[a+1]=o[1],l[a+2]=o[2],l[a+3]=255}};for(;p<=c;)u(t+(_=parseInt(c/128)),a+(h=parseInt(p/128))),u(t-_,a-h),u(t-_,a+h),u(t+_,a-h),u(t+h,a+_),u(t-h,a-_),u(t-h,a+_),u(t+h,a-_),p+=parseInt(c/128),c-=parseInt(p/128)}}class N extends C{constructor(e){super(),this.axpObj=e.axpObj,this.CANVAS=e.CANVAS,this.name=this.axpObj._("@PENNAME.FILL"),this.type="fill",this.alpha=100,this.threshold=2,this.toneLevel=16,this.usePenPreview=!0,this.usePenLock=!0,this.canUndo=!0,this.borderRadius=0,this.borderStyle="normal",this.lineCap="square",this.lineJoin="bevel",this.init_save()}init_brush(e){this.init_globalCompositeOperation(e),this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.lineWidth=this.size,this.CANVAS.brush_ctx.strokeStyle="",this.CANVAS.brush_ctx.lineCap="round",this.CANVAS.brush_ctx.lineJoin="round"}start(e,t,a,i){this.axpObj.layerSystem.isWriteProtection()||(this.set_modeflag(),this.init_brush(i))}end(e,t){if(this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.axpObj.layerSystem.save(),m(e,0,this.axpObj.x_size)&&m(t,0,this.axpObj.y_size))){var a,i=this.getColorRGB(),n=[i[0],i[1],i[2]];a="option_layer"===document.getElementById("axp_pen_select_fillMode").value?this.axpObj.layerSystem.getImage():this.axpObj.layerSystem.getCanvasImage();var s=new ImageData(this.axpObj.x_size,this.axpObj.y_size);this.regionFill(a,s,e,t,n),this.CANVAS.brush_ctx.putImageData(s,0,0),"on"===this.axpObj.config("axp_config_form_ToneLevel")&&null!==this.toneLevel&&16!==this.toneLevel&&(this.CANVAS.brush_ctx.globalCompositeOperation="destination-in",this.CANVAS.brush_ctx.fillStyle=v(this.toneLevel,"#000000"),this.CANVAS.brush_ctx.fillRect(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.write()}this.end_common()}}N.prototype.regionFill=function(e,t,a,i,n){let s=Number(document.getElementById("axp_pen_range_fillThreshold").value);var o=n;if(a<0||i<0||a>=e.width||i>=e.height)return;var r=new Array(3);r[0]=e.data[4*(i*e.width+a)+0],r[1]=e.data[4*(i*e.width+a)+1],r[2]=e.data[4*(i*e.width+a)+2];var l,d,c=!e.data[4*(i*e.width+a)+3],p=[{x:a,y:i}],_=[];const h=(e,t,a,i,n,s)=>{if(s[a*e.width+t])return!1;if(t<0||a<0||t>=e.width||a>=e.height)return!1;var o=new Array(3);o[0]=e.data[4*(a*e.width+t)+0],o[1]=e.data[4*(a*e.width+t)+1],o[2]=e.data[4*(a*e.width+t)+2];var r=e.data[4*(a*e.width+t)+3];return n?0===r:0!==r&&(o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2])},u=(t,a,i,n,s,o)=>{if(!0===s[i*t.width+a])return;if(a<0||i<0||a>=t.width||i>=t.height)return;let r=4*(i*e.width+a),l=255-50*(o-1);t.data[r+0]=n[0],t.data[r+1]=n[1],t.data[r+2]=n[2],t.data[r+3]<l&&(t.data[r+3]=l)};var m=0;const x=this.axpObj.CONST.MAX_SYSTEM_WIDTH*this.axpObj.CONST.MAX_SYSTEM_HEIGHT*4;for(;p.length;){if(!0===_[(d=p.pop()).y*e.width+d.x]);else if(h(e,d.x,d.y,r,c,_)){if(_[d.y*e.width+d.x]=!0,l=4*(d.y*e.width+d.x),t.data[l+0]=o[0],t.data[l+1]=o[1],t.data[l+2]=o[2],t.data[l+3]=255,h(e,d.x,d.y-1,r,c,_))p.push({x:d.x,y:d.y-1});else for(let e=1;e<s+1;e++)u(t,d.x,d.y-e,o,_,e);if(h(e,d.x+1,d.y,r,c,_))p.push({x:d.x+1,y:d.y});else for(let e=1;e<s+1;e++)u(t,d.x+e,d.y,o,_,e);if(h(e,d.x,d.y+1,r,c,_))p.push({x:d.x,y:d.y+1});else for(let e=1;e<s+1;e++)u(t,d.x,d.y+e,o,_,e);if(h(e,d.x-1,d.y,r,c,_))p.push({x:d.x-1,y:d.y});else for(let e=1;e<s+1;e++)u(t,d.x-e,d.y,o,_,e)}if(++m>x){alert("ERROR:塗り潰し中に異常が発生したため、処理を中断しました。");break}}};class I extends N{constructor(e){super(e),this.name=this.axpObj._("@PENNAME.GRADATION_FILL"),this.toneLevel=null,this.gradation=0,this.init_save()}previewPenSize(){let e=this.axpObj.penSystem.CANVAS.pensize,t=this.axpObj.penSystem.CANVAS.pensize_ctx;t.clearRect(0,0,e.width,e.height),t.globalCompositeOperation="source-over",t.globalAlpha=this.alpha/100;let a=80,i=this.gradation-270,n=Math.round(40*Math.cos(i*(Math.PI/180))),s=Math.round(40*Math.sin(i*(Math.PI/180))),o=40+n,r=40+s,l=40-n,d=40-s,c=t.createLinearGradient(o,r,l,d),p=this.axpObj.colorMakerSystem.getMainColor(),_=this.axpObj.colorMakerSystem.getSubColor();c.addColorStop(0,p),c.addColorStop(1,_),t.fillStyle=c,t.beginPath(),t.fillRect(10,10,a,a)}end(e,t){if(this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.axpObj.layerSystem.save(),m(e,0,this.axpObj.x_size)&&m(t,0,this.axpObj.y_size)))if("true"===document.getElementById("axp_makecolor_div_transparent").dataset.selected)this.axpObj.msg("@CAU0500",this.name);else{var a;a="option_layer"===document.getElementById("axp_pen_select_fillMode").value?this.axpObj.layerSystem.getImage():this.axpObj.layerSystem.getCanvasImage();var i=new ImageData(this.axpObj.x_size,this.axpObj.y_size);this.regionFill(a,i,e,t,[255,255,255]),this.CANVAS.brush_ctx.putImageData(i,0,0);let n=function(e){let t=e.width,a=e.height,i=0,n=0;for(var s=0;s<e.height;s++)for(var o=0;o<e.width;o++){let r=4*(o+s*e.height);0!==e.data[r+3]&&(t=Math.min(o,t),a=Math.min(s,a),i=Math.max(o,i),n=Math.max(s,n))}return{x0:t,y0:a,x1:i,y1:n}}(i),s=document.createElement("canvas");s.width=this.axpObj.x_size,s.height=this.axpObj.y_size;let o=s.getContext("2d"),r=Math.max(n.x1-n.x0,n.y1-n.y0)/2,l=this.gradation-270,d=n.x0+(n.x1-n.x0)/2,c=n.y0+(n.y1-n.y0)/2,p=Math.round(r*Math.cos(l*(Math.PI/180))),_=Math.round(r*Math.sin(l*(Math.PI/180))),h=d+p;h<n.x0&&(h=n.x0),h>n.x1&&(h=n.x1);let u=c+_;u<n.y0&&(u=n.y0),u>n.y1&&(u=n.y1);let m=d-p;m<n.x0&&(m=n.x0),m>n.x1&&(m=n.x1);let x=c-_;x<n.y0&&(x=n.y0),x>n.y1&&(x=n.y1);let g=o.createLinearGradient(h,u,m,x);g.addColorStop(0,this.axpObj.colorMakerSystem.getMainColor()),g.addColorStop(1,this.axpObj.colorMakerSystem.getSubColor()),o.fillStyle=g,o.beginPath(),o.fillRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.brush_ctx.globalCompositeOperation="source-in",this.CANVAS.brush_ctx.drawImage(s,0,0),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}this.end_common()}}class T extends C{constructor(e){super(),this.axpObj=e.axpObj,this.CANVAS=e.CANVAS,this.name=this.axpObj._("@PENNAME.HAND"),this.type="hand",this.cursor="grab",this.init_save()}start(e,t,a){this.axpObj.isDrawing=!0,this.axpObj.isDrawCancel=!1,this.baseCameraX=this.axpObj.cameraX,this.baseCameraY=this.axpObj.cameraY,this.baseInputX=a.clientX,this.baseInputY=a.clientY}move(e,t,a){if(this.axpObj.isDrawing&&!this.axpObj.isDrawCancel){const e=this.baseInputX-a.clientX,t=this.baseInputY-a.clientY;this.axpObj.cameraX=Math.round(this.baseCameraX+100*e/this.axpObj.scale),this.axpObj.cameraY=Math.round(this.baseCameraY+100*t/this.axpObj.scale),this.axpObj.refreshCanvas()}}end(){this.axpObj.isDrawing&&(this.axpObj.isDrawing=!1,this.axpObj.isDrawCancel=!1)}}class j extends C{constructor(e){super(),this.axpObj=e.axpObj,this.CANVAS=e.CANVAS,this.name=this.axpObj._("@PENNAME.EYEDROPPER"),this.type="spuit",this.cursor="crosshair",this.usePenPreview=!0,this.init_save()}previewPenSize(){let e=this.axpObj.penSystem.CANVAS.pensize,t=this.axpObj.penSystem.CANVAS.pensize_ctx;t.clearRect(0,0,e.width,e.height),t.globalCompositeOperation="source-over",t.globalAlpha=1,t.beginPath(),t.strokeStyle="#FF0000",t.lineWidth=3,t.strokeRect(40,40,20,20)}start(e,t,a){a.target.id===this.axpObj.CANVAS.main.id&&(this.axpObj.isDrawing=!0,this.axpObj.isDrawCancel=!1,this.axpObj.penSystem.spuit(a))}move(e,t,a){this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&this.axpObj.penSystem.spuit(a);const i=this.CANVAS.spuit,n=this.CANVAS.spuit_ctx;if(n.clearRect(0,0,i.width,i.height),m(e,-2,this.axpObj.x_size-1+2)&&m(t,-2,this.axpObj.y_size-1+2)){const a=Math.max(e-2,0),i=Math.max(t-2,0),s=Math.min(e+2,this.axpObj.x_size-1)-a+1,o=Math.min(t+2,this.axpObj.y_size-1)-i+1,r=this.axpObj.CANVAS.main_ctx.getImageData(a,i,s,o),l=a-(e-2),d=i-(t-2);n.putImageData(r,l,d)}let s="-",o="-",r="-",l="-";if(a.target.id===this.axpObj.CANVAS.main.id){const a=this.axpObj.CANVAS.main_ctx.getImageData(e,t,1,1);s=a.data[0],o=a.data[1],r=a.data[2],this.axpObj.assistToolSystem.getIsTransparent()&&(l=a.data[3])}document.getElementById("axp_pen_span_spuitColorRed").textContent=s,document.getElementById("axp_pen_span_spuitColorGreen").textContent=o,document.getElementById("axp_pen_span_spuitColorBlue").textContent=r,document.getElementById("axp_pen_span_spuitColorAlpha").textContent=l}end(){this.axpObj.isDrawing&&(this.axpObj.isDrawing=!1,this.axpObj.isDrawCancel=!1,this.axpObj.penSystem.autoChangePen())}}class k extends S{constructor(e){super(e),this.name=this.axpObj._("@PENNAME.SQUARE"),this.size=8,this.borderRadius=0,this.borderStyle="normal",this.lineCap="square",this.lineJoin="bevel",this.init_save()}}class L extends C{constructor(e){super(),this.axpObj=e.axpObj,this.CANVAS=e.CANVAS,this.name=this.axpObj._("@PENNAME.MOVE_TOOL"),this.type="move",this.cursor="move",this.usePenLock=!0,this.canUndo=!0,this.init_save()}start(e,t){this.axpObj.layerSystem.isWriteProtection()||(this.set_modeflag(),this.input_position=[],this.input_position.push({x:e,y:t}),this.axpObj.layerSystem.save())}move(e,t){this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.axpObj.isDrawn=!0,this.input_position.push({x:e,y:t}),this.draw())}draw(){let e=this.input_position[0],t=this.input_position[this.input_position.length-1];this.CANVAS.draw_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),t.x-e.x,t.y-e.y),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}end(e,t){this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.input_position.push({x:e,y:t}),this.draw()),this.end_common()}}class B extends S{constructor(e){super(e),this.name=this.axpObj._("@PENNAME.CALLIGRAPHY"),this.size=5,this.toneLevel=null,this.usePenStyle=!1,this.init_save()}start_draw(){this.CANVAS.brush_ctx.lineWidth=this.size/2}move(e,t){this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.axpObj.isDrawn=!0,this.input_position.push({x:e,y:t}),this.draw())}draw(){let e=this.input_position[this.input_position.length-2].x,t=this.input_position[this.input_position.length-2].y,a=this.input_position[this.input_position.length-1].x,i=this.input_position[this.input_position.length-1].y;const n=c(e,t,a,i);let s=this.CANVAS.brush_ctx.lineWidth;if(1.4*n>this.size){let o=2*parseInt(1.4*n/this.size),r=(a-e)/o,l=(i-t)/o;for(let a=0;a<o;a++)s*=.9,s=Math.max(Math.min(this.size,s),1),this.CANVAS.brush_ctx.lineWidth=s,this.CANVAS.brush_ctx.beginPath(),this.CANVAS.brush_ctx.moveTo(e+r*a,t+l*a),this.CANVAS.brush_ctx.lineTo(e+r*(a+1),t+l*(a+1)),this.CANVAS.brush_ctx.stroke(),this.CANVAS.brush_ctx.closePath()}else s=this.CANVAS.brush_ctx.lineWidth+.03*this.size,s=Math.max(Math.min(this.size,s),1),this.CANVAS.brush_ctx.lineWidth=s,this.CANVAS.brush_ctx.beginPath(),this.CANVAS.brush_ctx.moveTo(e,t),this.CANVAS.brush_ctx.lineTo(a,i),this.CANVAS.brush_ctx.stroke(),this.CANVAS.brush_ctx.closePath();this.write()}}class M extends E{constructor(e){super(e),this.name=this.axpObj._("@PENNAME.CRAYON"),this.size=15,this.toneLevel=null,this.radius=50,this.borderRadius=50,this.borderStyle="normal",this.lineCap="square",this.lineJoin="bevel",this.init_save()}getCursorPosition(e){const t=this.getCursorPositionNormal(e);return{x:t.x,y:t.y}}trans_dot(e){return e}getRandomPosition(e){let t,a,i=1-this.radius/50,n=1-i;for(;;){t=2*Math.random()-1,a=2*Math.random()-1;const e=Math.abs(t),s=Math.abs(a);if(!(e>i&&s>i))break;let o=(e-i)/n,r=(s-i)/n;if(o*o+r*r<1)break}return t=parseInt(t*e/2),a=parseInt(a*e/2),{x:t,y:a}}drawLine(e,t,a,i,n,s,o){const{width:r,data:l}=e,d=Math.abs(i-t),c=Math.abs(n-a),p=t<i?1:-1,_=a<n?1:-1,h=20+2*s;let u=d-c,m=t,x=a,g=-1,b=-1;for(;;){let e=m,t=x;if(e!==g||t!==b){for(let a=0;a<h;a++){let a=this.getRandomPosition(s),i=a.x+e,n=a.y+t,d=parseInt(30*Math.random())+20;if(i>=0&&i<this.axpObj.x_size&&n>=0&&n<this.axpObj.y_size){const e=4*(i+n*r);l[e+0]=o[0],l[e+1]=o[1],l[e+2]=o[2],l[e+3]=d}}g=e,b=t}if(m===i&&x===n)break;let a=2*u;a>-c&&(u-=c,m+=p),a<d&&(u+=d,x+=_)}}drawCircle(e,t,a,i,n,s,o){const{width:r,data:l}=e,d=20+2*s,c=parseInt(s/2),p=parseInt(Math.sqrt(Math.pow(i-t,2)+Math.pow(n-a,2)));if(p<=0)return;var _=parseInt(128*p),h=0,u=0,m=0;const x=(e,t)=>{let a=e+s,i=t+s;for(let n=0;n<d;n++){let n=parseInt(Math.random()*(a-e)+e)-c,s=parseInt(Math.random()*(i-t)+t)-c,d=parseInt(30*Math.random())+20;if(n>=0&&n<this.axpObj.x_size&&s>=0&&s<this.axpObj.y_size){const e=4*(n+s*r);l[e+0]=o[0],l[e+1]=o[1],l[e+2]=o[2],l[e+3]=d}}};for(;h<=_;)x(t+(u=parseInt(_/128)),a+(m=parseInt(h/128))),x(t-u,a-m),x(t-u,a+m),x(t+u,a-m),x(t+m,a+u),x(t-m,a-u),x(t-m,a+u),x(t+m,a-u),h+=parseInt(_/128),_-=parseInt(h/128)}}class P extends S{constructor(e){super(e),this.name=this.axpObj._("@PENNAME.AIRBRUSH"),this.size=100,this.alpha=30,this.toneLevel=null,this.usePenStyle=!1,this.init_save()}init_brush(e){this.init_globalCompositeOperation(e),this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.blur()}move(e,t){this.axpObj.isDrawing&&!this.axpObj.isDrawCancel&&(this.axpObj.isDrawn=!0,this.input_position.push({x:e,y:t}),this.draw())}draw(){var e=this.size/2,t=this.CANVAS.brush_ctx.createRadialGradient(this.input_position.at(-1).x,this.input_position.at(-1).y,0,this.input_position.at(-1).x,this.input_position.at(-1).y,e),a=this.getColorRGB(),i="rgba("+a[0]+","+a[1]+","+a[2]+","+this.alpha/100+")",n="rgba("+a[0]+","+a[1]+","+a[2]+",0)";t.addColorStop(0,i),t.addColorStop(1,n),this.CANVAS.brush_ctx.fillStyle=t,this.CANVAS.brush_ctx.fillRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.write()}}a(9148);class R extends r{pen_mode;exec_pen_mode;isTemporary=!1;temporaryMode;saveElement;saveMode;saveIcon;saveMsg;penObj=[];CONST={};CANVAS={draw:null,draw_ctx:null,brush:null,brush_ctx:null,tone:null,tone_ctx:null,spuit:null,spuit_ctx:null,pensize:null,pensize_ctx:null};base_index=null;old_x;old_y;preview_dragstart_x;preview_dragstart_y;stabilizerX=0;stabilizerY=0;constructor(e){super(e)}getDefaultPosition(){return{left:0,top:100}}init(){this.createHTML("axp_pen","PEN",this.axpObj._("@WINDOW.PEN_TOOL"),"axpc_icon_window_pen",'\x3c!-- ペンツール --\x3e\n<div class="axpc_window_content">\n    <div id="axp_pen_div_content">\n        \x3c!-- ペンツール左側 --\x3e\n        <div id="axp_pen_div_leftSide">\n            <span id="axp_pen_span_penName" class="axpc_MSG" data-msg="@PEN0001"></span>\n            \x3c!-- プレビュー領域 --\x3e\n            <div id="axp_pen_div_preview" class="axpc_MSG" data-msg="@PEN0200">\n                <canvas id="axp_pen_canvas_previewPenSize"></canvas>\n                <canvas id="axp_pen_canvas_previewSpuit"></canvas>\n            </div>\n            \x3c!-- スライダー領域 --\x3e\n            <div id="axp_pen_div_slider">\n                \x3c!-- ペンの不透明度 --\x3e\n                <form id="axp_pen_form_alpha" class="axpc_range axpc_text_border"\n                    oninput="result.value=parseInt(volume.value)">\n                    <input type="range" id="axp_pen_range_alpha" name="volume" min="5" max="100" value="100" step="5"\n                        class="axpc_MSG" data-msg="@PEN0002">\n                    <div class="axpc_range_label">${_("@COMMON.OPACITY")}</div>\n                    <div class="axpc_range_value"><output name="result"></output></div>\n                </form>\n                \x3c!-- ペンの太さ --\x3e\n                <form id="axp_pen_form_penSize" class="axpc_range axpc_text_border">\n                    <input type="range" id="axp_pen_range_penSize" name="volume" min="1" max="100" value="1" step="1"\n                        class="axpc_MSG" data-msg="@PEN0003">\n                    <div class="axpc_range_label">${_("@PEN.SIZE")}</div>\n                    <div class="axpc_range_value"><output name="result"></output></div>\n                </form>\n                \x3c!-- バケツの境界補正 --\x3e\n                <form id="axp_pen_form_fillThreshold" oninput="result.value=parseInt(volume.value)"\n                    class="axpc_range axpc_text_border">\n                    <input type="range" id="axp_pen_range_fillThreshold" name="volume" value="0" step="1" min="0"\n                        max="5" class="axpc_MSG" data-msg="@PEN0004">\n                    <div class="axpc_range_label">${_("@PEN.GROW_FILL_AREA")}</div>\n                    <div class="axpc_range_value"><output name="result"></output></div>\n                </form>\n                \x3c!-- バケツのグラデーション角度 --\x3e\n                <form id="axp_pen_form_fillGradationDeg" oninput="result.value=parseInt(volume.value)"\n                    class="axpc_range axpc_text_border">\n                    <input type="range" id="axp_pen_range_fillGradationDeg" name="volume" value="0" step="15" min="0"\n                        max="360" class="axpc_MSG" data-msg="@PEN0005">\n                    <div class="axpc_range_label">${_("@PEN.ANGLE")}</div>\n                    <div class="axpc_range_value"><output name="result"></output></div>\n                </form>\n                \x3c!-- クレヨンの丸み --\x3e\n                <form id="axp_pen_form_radius" oninput="result.value=parseInt(volume.value)"\n                    class="axpc_range axpc_text_border">\n                    <input type="range" id="axp_pen_range_radius" name="volume" value="50" step="1" min="0" max="50"\n                        class="axpc_MSG" data-msg="@PEN0010">\n                    <div class="axpc_range_label">${_("@PEN.ROUNDNESS")}</div>\n                    <div class="axpc_range_value"><output name="result"></output></div>\n                </form>\n                \x3c!-- ぼかし度（オプション） --\x3e\n                <form id="axp_pen_form_blur" oninput="result.value=parseInt(volume.value)"\n                    class="axpc_range axpc_text_border">\n                    <input type="range" id="axp_pen_range_blur" name="volume" value="0" step="1" min="0" max="5"\n                        class="axpc_MSG" data-msg="@PEN0009">\n                    <div class="axpc_range_label">${_("@PEN.BLUR")}</div>\n                    <div class="axpc_range_value"><output name="result"></output></div>\n                </form>\n                \x3c!-- トーン濃度（オプション） --\x3e\n                <form id="axp_pen_form_toneLevel" oninput="result.value=parseInt(volume.value)"\n                    class="axpc_range axpc_text_border">\n                    <input type="range" id="axp_pen_range_toneLevel" name="volume" value="16" step="1" min="1" max="16"\n                        class="axpc_MSG" data-msg="@PEN0006">\n                    <div class="axpc_range_label">${_("@PEN.TONE_DENSITY")}</div>\n                    <div class="axpc_range_value"><output name="result"></output></div>\n                </form>\n                \x3c!-- 手ぶれ補正（オプション） --\x3e\n                <form id="axp_pen_form_stabilizer" oninput="result.value=parseInt(volume.value)"\n                    class="axpc_range axpc_text_border">\n                    <input type="range" id="axp_pen_range_stabilizer" name="volume" value="2" step="1" min="0" max="10"\n                        class="axpc_MSG" data-msg="@CFG0040">\n                    <div class="axpc_range_label">${_("@PEN.STABILIZER")}</div>\n                    <div class="axpc_range_value"><output name="result"></output></div>\n                </form>\n            </div>\n\n            <div id="axp_pen_div_spuitColorRGBA">\n                <div>${_("@COMMON.RED")}:<span id="axp_pen_span_spuitColorRed">-</span></div>\n                <div>${_("@COMMON.GREEN")}:<span id="axp_pen_span_spuitColorGreen">-</span></div>\n                <div>${_("@COMMON.BLUE")}:<span id="axp_pen_span_spuitColorBlue">-</span></div>\n                <div>${_("@COMMON.ALPHA")}:<span id="axp_pen_span_spuitColorAlpha">-</span></div>\n            </div>\n\n            <div id="axp_pen_div_selectbox">\n                <select id="axp_pen_select_drawMode" class="axpc_MSG" data-msg="@PEN0007">\n                    <option value="option_normal">${_("@PEN.OPTION_FREE_HAND")}</option>\n                    <option value="option_line">${_("@PEN.OPTION_STRAIGHT")}</option>\n                    <option value="option_rectangle">${_("@PEN.OPTION_RECT")}</option>\n                    <option value="option_circle">${_("@PEN.OPTION_CIRCLE")}</option>\n                </select>\n                <select id="axp_pen_select_fillMode" class="axpc_MSG axpc_NONE" data-msg="@PEN0008">\n                    <option value="option_all">${_("@PEN.OPTION_FILL_SAMPLE_ALL")}</option>\n                    <option value="option_layer">${_("@PEN.OPTION_FILL_SAMPLE_CURRENT")}</option>\n                </select>\n            </div>\n\n        </div>\n        \x3c!-- ペンツール右側 --\x3e\n        <div id="axp_pen_div_rightSide">\n            <div>\n                <button data-idx="0" id="axp_pen_button_penBase" class="axpc_FUNC" data-function="func_switch_pen"\n                    data-selected="true" data-msg="@PEN0050"></button>\n            </div>\n            <div>\n                <button data-idx="1" id="axp_pen_button_eraserBase" class="axpc_FUNC" data-function="func_switch_eraser"\n                    data-msg="@PEN0051"></button>\n            </div>\n            <div>\n                <button data-idx="2" id="axp_pen_button_fillBase" class="axpc_FUNC" data-function="func_switch_fill"\n                    data-msg="@PEN0052"></button>\n            </div>\n            <div>\n                <button data-idx="3" id="axp_pen_button_handBase" class="axpc_FUNC" data-function="func_switch_hand"\n                    data-msg="@PEN0053"></button>\n            </div>\n            <div>\n                <button data-idx="4" id="axp_pen_button_spuitBase" class="axpc_FUNC" data-function="func_switch_spuit"\n                    data-msg="@PEN0054"></button>\n            </div>\n        </div>\n    </div>\n</div>'),document.getElementById("axp_canvas").insertAdjacentHTML("beforeend",this.axpObj.translateHTML('\x3c!-- ペンツールサブメニュー --\x3e\n<div id="axp_penmode" class="axpc_NONE">\n    <div>\n        <span id="axp_penmode_span_modeName"></span>\n        <article data-name="${_(\'@PENGROUP.PEN\')}">\n            \x3c!-- ※idをそのままペン種別名として使用するため命名規則例外 --\x3e\n            <button id="axp_penmode_round" class="axpc_FUNC axpc_penmode_round" data-idx="0" data-msg="@PEN0100"\n                data-function="func_switch_axp_penmode_round"></button>\n            <button id="axp_penmode_square" class="axpc_FUNC axpc_penmode_square" data-idx="0" data-msg="@PEN0101"\n                data-function="func_switch_axp_penmode_square"></button>\n            <button id="axp_penmode_dot" class="axpc_FUNC axpc_penmode_dot" data-idx="0" data-msg="@PEN0102"\n                data-function="func_switch_axp_penmode_dot"></button>\n            <button id="axp_penmode_fude" class="axpc_FUNC axpc_penmode_fude" data-idx="0" data-msg="@PEN0103"\n                data-function="func_switch_axp_penmode_fude"></button>\n            <button id="axp_penmode_crayon" class="axpc_FUNC axpc_penmode_crayon" data-idx="0"\n                data-function="func_switch_axp_penmode_crayon" data-msg="@PEN0104"></button>\n            <button id="axp_penmode_brush" class="axpc_FUNC axpc_penmode_brush" data-idx="0"\n                data-function="func_switch_axp_penmode_brush" data-msg="@PEN0105"></button>\n        </article>\n        <article data-name="${_(\'@PENGROUP.ERASER\')}">\n            <button id="axp_penmode_eraser_round" class="axpc_FUNC axpc_penmode_eraser_round" data-idx="1"\n                data-function="func_switch_axp_penmode_eraser_round" data-msg="@PEN0110"></button>\n            <button id="axp_penmode_eraser_dot" class="axpc_FUNC axpc_penmode_eraser_dot" data-idx="1"\n                data-function="func_switch_axp_penmode_eraser_dot" data-msg="@PEN0111"></button>\n        </article>\n        <article data-name="${_(\'@PENGROUP.FILL\')}">\n            <button id="axp_penmode_fill" class="axpc_FUNC axpc_penmode_fill" data-idx="2"\n                data-function="func_switch_axp_penmode_fill" data-msg="@PEN0120"></button>\n            <button id="axp_penmode_fillgradation" class="axpc_FUNC axpc_penmode_fillgradation"\n                data-function="func_switch_axp_penmode_fillgradation" data-idx="2" data-msg="@PEN0121"></button>\n        </article>\n        <article data-name="${_(\'@PENGROUP.TOOL\')}">\n            <button id="axp_penmode_hand" class="axpc_FUNC axpc_penmode_hand" data-idx="3"\n                data-function="func_switch_axp_penmode_hand" data-msg="@PEN0130"></button>\n            <button id="axp_penmode_move" class="axpc_FUNC axpc_penmode_move" data-idx="3"\n                data-function="func_switch_axp_penmode_move" data-msg="@PEN0131"></button>\n        </article>\n        <article data-name="${_(\'@PENGROUP.EYEDROPPER\')}">\n            <button id="axp_penmode_spuit" class="axpc_penmode_spuit" data-idx="4"></button>\n        </article>\n    </div>\n</div>\n\x3c!--追加用HTMLここまで --\x3e')),this.window_width=180;const e=this.getDefaultPosition();this.window_left=e.left,this.window_top=e.top,this.CANVAS.draw=document.createElement("canvas"),this.CANVAS.draw_ctx=this.CANVAS.draw.getContext("2d",{willReadFrequently:!0}),this.CANVAS.brush=document.createElement("canvas"),this.CANVAS.brush_ctx=this.CANVAS.brush.getContext("2d"),this.CANVAS.pensize=document.getElementById("axp_pen_canvas_previewPenSize"),this.CANVAS.pensize.width=100,this.CANVAS.pensize.height=100,this.CANVAS.pensize_ctx=this.CANVAS.pensize.getContext("2d"),this.CANVAS.spuit=document.getElementById("axp_pen_canvas_previewSpuit"),this.CANVAS.spuit.width=5,this.CANVAS.spuit.height=5,this.CANVAS.spuit_ctx=this.CANVAS.spuit.getContext("2d"),this.penObj.axp_penmode_round=new S({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_eraser_round=new O({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_eraser_dot=new w({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_fill=new N({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_fillgradation=new I({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_hand=new T({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_spuit=new j({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_square=new k({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_move=new L({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_dot=new E({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_fude=new B({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_crayon=new M({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.axp_penmode_brush=new P({axpObj:this.axpObj,CANVAS:this.CANVAS});let t=document.querySelectorAll("#axp_pen_div_rightSide>div>button"),a=document.querySelectorAll("#axp_penmode>div>article>button:first-of-type");t.forEach((e,t)=>{e.dataset.addmsg=a[t].dataset.msg,e.dataset.set=a[t].id,e.classList.add(this.getClassIcon(a[t].id))}),this.pen_mode=a[0].id}getClassIcon(e){return e.replace("axp_","axpc_")}resetCanvas(){this.CANVAS.draw.width=this.axpObj.x_size,this.CANVAS.brush.width=this.axpObj.x_size*this.axpObj.CONST.DRAW_MULTI,this.CANVAS.draw.height=this.axpObj.y_size,this.CANVAS.brush.height=this.axpObj.y_size*this.axpObj.CONST.DRAW_MULTI}switchMainButton(e,t=null){if(!this.isSwitchable())return;let a=e;if("4"===a.dataset.idx||t||"true"!==a.dataset.selected)this.switchButton(a);else{let e=document.querySelectorAll("#axp_pen_div_rightSide>div>button");for(const t of e)t!==a&&(t.style.opacity="0.3");let t=Number(a.dataset.idx),i=document.querySelectorAll("#axp_penmode>div>article");for(const e of i)l.hide(e);let n=i[Number(t)];document.getElementById("axp_penmode_span_modeName").textContent=`${n.dataset.name}${this.axpObj._("@PEN.TYPE")}`,l.show(n);const s=document.getElementById("axp_canvas").getBoundingClientRect();let o=document.getElementById("axp_pen_div_leftSide").getBoundingClientRect(),r=document.querySelector("#axp_penmode>div");r.style.width=o.width+5+"px",r.style.height=o.height+4+"px",r.style.marginLeft=o.left-4-s.left+"px",r.style.marginTop=o.top-2-s.top+"px",this.axpObj.isModalOpen=!0,this.axpObj.msg("@AXP5010"),l.show("axp_penmode")}}switchSubButton(e){if(!this.isSwitchable())return;let t=e;const a=document.querySelector(`#axp_pen_div_rightSide>div>button[data-idx="${t.dataset.idx}"]`);a.classList.remove(this.getClassIcon(a.dataset.set)),a.classList.add(this.getClassIcon(t.id)),a.dataset.set=t.id,a.dataset.addmsg=t.dataset.msg;t.id;this.switchButton(a)}switchButton(e){const t=document.querySelectorAll("#axp_pen_div_rightSide>div>button");for(const e of t)e.dataset.selected="false";e.dataset.selected="true";let a=e.dataset.set;this.changePenMode(a)}isSwitchable(){return this.axpObj.isCTRL?(this.axpObj.msg("@CAU5000"),!1):!this.axpObj.isSPACE||(this.axpObj.msg("@CAU5001"),!1)}startEvent(){this.changeOrderSlider(),document.getElementById("axp_penmode").addEventListener("pointermove",e=>{"axp_penmode"===e.target.id&&this.axpObj.msg("@AXP5010")}),document.getElementById("axp_penmode").addEventListener("click",e=>{this.axpObj.isModalOpen=!1,l.hide(e.currentTarget);let t=document.querySelectorAll("#axp_pen_div_rightSide>div>button");for(const e of t)e.style.opacity="1"}),document.getElementById("axp_pen_range_penSize").addEventListener("input",e=>{const t=Number(e.target.value),a=this.getName(),i=this.setIndex(t);document.getElementById("axp_pen_form_penSize").result.value=i,this.axpObj.msg("@AXP5000",a,i),this.previewPenSize(),this.axpObj.configSystem.saveConfig("P-SIZ_"+this.pen_mode,i)}),document.getElementById("axp_pen_range_alpha").addEventListener("input",e=>{let t=Number(e.target.value),a=this.getName();this.setAlpha(t),this.axpObj.msg("@AXP5001",a,t),this.previewPenSize(),this.axpObj.configSystem.saveConfig("P-ALP_"+this.pen_mode,t)}),document.getElementById("axp_pen_range_fillThreshold").addEventListener("input",e=>{let t=Number(e.target.value),a=this.getName();this.setThreshold(t),this.axpObj.msg("@AXP5002",a,t),this.axpObj.configSystem.saveConfig("P-THR_"+this.pen_mode,t)}),document.getElementById("axp_pen_range_fillGradationDeg").addEventListener("input",e=>{const t=Number(e.target.value),a=this.getName();this.setGradation(t),this.axpObj.msg("@AXP5003",a,t),this.previewPenSize(),this.axpObj.configSystem.saveConfig("P-DEG_"+this.pen_mode,t)}),document.getElementById("axp_pen_range_toneLevel").addEventListener("input",e=>{let t=Number(e.target.value),a=this.getName();this.setToneLevel(t),this.axpObj.msg("@AXP5004",a,t),this.previewPenSize(),this.axpObj.configSystem.saveConfig("P-TON_"+this.pen_mode,t)}),document.getElementById("axp_pen_range_blur").addEventListener("input",e=>{let t=Number(e.target.value);this.setBlurLevel(t),this.axpObj.msg("@AXP5008",this.getName(),t),this.previewPenSize(),this.axpObj.configSystem.saveConfig("P-BLU_"+this.pen_mode,t)}),document.getElementById("axp_pen_form_radius").addEventListener("input",e=>{let t=Number(e.target.value);this.setRadius(t),this.axpObj.msg("@AXP5009",this.getName(),t),this.previewPenSize(),this.axpObj.configSystem.saveConfig("P-RAD_"+this.pen_mode,t)});const e=e=>{if("pointerdown"===e.type&&(e.target.classList.add("axpc_onGRAB"),this.preview_dragstart_x=e.offsetX,this.preview_dragstart_y=e.offsetY),e.target.classList.contains("axpc_onGRAB")){let r=e.currentTarget,l=this.getName();if("axp_penmode_fillgradation"===this.pen_mode){let t=e.offsetX-this.preview_dragstart_x,a=((e,t)=>{let a=Math.atan2(e,t);return a<0&&(a+=2*Math.PI),Math.round(180*a/Math.PI)})(e.offsetY-this.preview_dragstart_y,t)-270;return a<0&&(a+=360),this.axpObj.msg("@AXP5003",l,a),this.setGradation(a),document.getElementById("axp_pen_range_fillGradationDeg").value=a,document.getElementById("axp_pen_form_fillGradationDeg").result.value=a,this.previewPenSize(),void this.axpObj.configSystem.saveConfig("P-DEG_"+this.pen_mode,a)}var t=r.width/2,a=r.height/2,i=e.offsetX,n=e.offsetY,s=2*Math.sqrt(Math.pow(i-t,2)+Math.pow(n-a,2)),o=Math.min(200,Math.max(1,parseInt(100*s/this.axpObj.scale)));if(!this.setSize(o))return void this.axpObj.msg("@CAU0203",l);this.changePenMode(),this.axpObj.msg("@AXP5000",l,o)}};this.CANVAS.pensize.addEventListener("pointerdown",e),this.CANVAS.pensize.addEventListener("pointermove",e),this.CANVAS.pensize.addEventListener("pointerleave",()=>{this.axpObj.msg("")});const t=e=>{e.target.classList.contains("axpc_onGRAB")&&(e.target.classList.remove("axpc_onGRAB"),this.getSize()&&this.axpObj.configSystem.saveConfig("P-SIZ_"+this.pen_mode,this.getSize()))};this.CANVAS.pensize.addEventListener("pointerup",t),this.CANVAS.pensize.addEventListener("pointerleave",t)}start(e,t,a,i,n){if(this.axpObj.codeCHANGE_SIZE_KEY)return this.base_index=this.getIndex(),this.old_x=a.clientX,void(this.old_y=a.clientY);this.exec_pen_mode=i,this.penObj[this.exec_pen_mode].start(e,t,a,n),this.stabilizerX=a.clientX,this.stabilizerY=a.clientY}move(e,t,a){let i=this.getName();if(this.axpObj.codeCHANGE_SIZE_KEY&&null!==this.base_index){let e=a.clientX-this.old_x,t=Math.trunc(Math.max(1,Math.min(100,Number(this.base_index)+e))),n=this.setIndex(t);this.changePenMode(),this.axpObj.msg("@AXP5000",i,n)}let n=this.exec_pen_mode||this.pen_mode;if(a.target.id!==this.axpObj.CANVAS.main.id&&a.target.id!==this.axpObj.ELEMENT.view.id||this.penObj[n].drawCursor(a),"draw"===this.penObj[n].type||"eraser"===this.penObj[n].type){const e=Number(document.getElementById("axp_config_form_stabilizerValue").volume.value);if(0!==e){if(c(this.stabilizerX,this.stabilizerY,a.clientX,a.clientY)<e)return;this.stabilizerX=a.clientX,this.stabilizerY=a.clientY}}this.penObj[n].move(e,t,a)}end(e,t,a){this.axpObj.codeCHANGE_SIZE_KEY&&null!==this.base_index&&(this.base_index=null,this.getSize()&&this.axpObj.configSystem.saveConfig("P-SIZ_"+this.pen_mode,this.getSize())),this.exec_pen_mode&&(this.penObj[this.exec_pen_mode].end(e,t,a),this.exec_pen_mode=null)}getSize(){return this.penObj[this.pen_mode].size}setSize(e){let t=null;return null!==this.penObj[this.pen_mode].size&&(this.penObj[this.pen_mode].size=e,t=y(e),this.penObj[this.pen_mode].index=t),t}setPenSize(e){let t=this.setSize(e),a=this.getName();t?(this.axpObj.msg("@AXP5000",a,e),this.changePenMode(),this.axpObj.configSystem.saveConfig("P-SIZ_"+this.pen_mode,this.getSize())):this.axpObj.msg("@CAU0203",a)}getIndex(){return this.penObj[this.pen_mode].index}setIndex(e){let t;if(null===this.penObj[this.pen_mode].size)throw new Error("内部エラー：不正な太さ指定です");return this.penObj[this.pen_mode].index=e,t=f[e],this.penObj[this.pen_mode].size=t,t}getAlpha(){return this.penObj[this.pen_mode].alpha}setAlpha(e){if(null===this.penObj[this.pen_mode].alpha)throw new Error("内部エラー：不正な不透明度指定です");this.penObj[this.pen_mode].alpha=e}getThreshold(){return this.penObj[this.pen_mode].threshold}setThreshold(e){if(null===this.penObj[this.pen_mode].threshold)throw new Error("内部エラー：不正な塗り残し補正指定です");this.penObj[this.pen_mode].threshold=e}getGradation(){return this.penObj[this.pen_mode].gradation}setGradation(e){if(null===this.penObj[this.pen_mode].gradation)throw new Error("内部エラー：不正な角度指定です");this.penObj[this.pen_mode].gradation=e}getToneLevel(){return void 0!==this.penObj[this.pen_mode].toneLevel?this.penObj[this.pen_mode].toneLevel:null}setToneLevel(e){if(null===this.penObj[this.pen_mode].toneLevel)throw new Error("内部エラー：不正なトーン濃度指定です");this.penObj[this.pen_mode].toneLevel=Number(e)}getBlurLevel(){return void 0!==this.penObj[this.pen_mode].blurLevel?this.penObj[this.pen_mode].blurLevel:null}setBlurLevel(e){if(null===this.penObj[this.pen_mode].blurLevel)throw new Error("内部エラー：不正なぼかし度指定です");this.penObj[this.pen_mode].blurLevel=Number(e)}getRadius(){return void 0!==this.penObj[this.pen_mode].radius?this.penObj[this.pen_mode].radius:null}setRadius(e){if(null===this.penObj[this.pen_mode].radius)throw new Error("内部エラー：不正な丸み指定です");this.penObj[this.pen_mode].radius=Number(e),this.penObj[this.pen_mode].borderRadius=Number(e)}getType(){return this.penObj[this.pen_mode].type}getName(){return this.penObj[this.pen_mode].name}resetPenStyle(){Object.keys(this.penObj).forEach(e=>{this.penObj[e].init()})}getPenMode(){return this.pen_mode}changePenModeTemporary(e){if(this.isTemporary)return;this.isTemporary=!0,this.temporaryMode=e,this.saveMode=this.getPenMode();const t=document.querySelectorAll("#axp_pen_div_rightSide>div>button");for(const e of t)"true"===e.dataset.selected&&(this.saveElement=e,e.dataset.selected="false");switch(e){case"axp_penmode_spuit":this.axpObj.ELEMENT.view.style.cursor="crosshair",this.axpObj.ELEMENT.cursor.style.visibility="hidden",this.axpObj.msg("@AXP5005"),document.getElementById("axp_pen_button_spuitBase").dataset.selected="true";break;case"axp_penmode_hand":{this.axpObj.ELEMENT.view.style.cursor="grab",this.axpObj.ELEMENT.cursor.style.visibility="hidden",this.axpObj.msg("@AXP5006");let t=document.getElementById("axp_pen_button_handBase");t.dataset.selected="true",this.saveIcon=t.dataset.set,t.classList.remove(this.getClassIcon(this.saveIcon)),t.classList.add(this.getClassIcon(e)),this.saveMsg=t.dataset.msg,t.dataset.msg=document.getElementById(e).dataset.msg;break}}this.changePenMode(e)}restorePenModeTemporary(e){if(this.isTemporary&&this.temporaryMode==e){switch(this.isTemporary=!1,e){case"axp_penmode_spuit":document.getElementById("axp_pen_button_spuitBase").dataset.selected="false";break;case"axp_penmode_hand":{let t=document.getElementById("axp_pen_button_handBase");t.dataset.selected="false",t.dataset.msg=this.saveMsg,t.classList.remove(this.getClassIcon(e)),t.classList.add(this.getClassIcon(this.saveIcon));break}}this.saveElement.dataset.selected="true",this.changePenMode(this.saveMode),this.temporaryMode=null,this.saveMode=null,this.saveElement=null,this.saveIcon=null,this.saveMsg=null,this.axpObj.msg("")}}changePenMode(e){e&&(this.pen_mode=e);let t=this.getType();const a=(e,t,a=!0)=>{null===t||!1===a?l.hide(e):(l.show(e),document.getElementById(e).volume.value="axp_pen_form_penSize"===e?this.getIndex():t,document.getElementById(e).result.value=t)};a("axp_pen_form_penSize",this.getSize()),a("axp_pen_form_alpha",this.getAlpha()),a("axp_pen_form_fillThreshold",this.getThreshold()),a("axp_pen_form_fillGradationDeg",this.getGradation()),a("axp_pen_form_radius",this.getRadius()),a("axp_pen_form_toneLevel",this.getToneLevel(),"on"===this.axpObj.config("axp_config_form_ToneLevel")),a("axp_pen_form_blur",this.getBlurLevel(),"on"===this.axpObj.config("axp_config_form_blurLevel")),a("axp_pen_form_stabilizer",document.getElementById("axp_config_form_stabilizerValue").volume.value,"draw"===t&&document.getElementById("axp_config_checkbox_stabilize").checked),this.penObj[this.pen_mode].usePenStyle?l.show("axp_pen_select_drawMode"):l.hide("axp_pen_select_drawMode"),"fill"===t?l.show("axp_pen_select_fillMode"):l.hide("axp_pen_select_fillMode"),"spuit"===t?l.show("axp_pen_div_spuitColorRGBA"):l.hide("axp_pen_div_spuitColorRGBA"),this.penObj[this.pen_mode].usePenPreview?document.getElementById("axp_pen_div_preview").style.visibility="visible":document.getElementById("axp_pen_div_preview").style.visibility="hidden",this.previewPenSize(),document.getElementById("axp_pen_span_penName").textContent=this.getName()}previewPenSize(){this.penObj[this.pen_mode].previewPenSize()}spuit(e){if(e.target.id===this.axpObj.CANVAS.main.id){var t=this.axpObj.CANVAS.main.getBoundingClientRect(),a=parseInt(100*(e.clientX-t.left)/this.axpObj.scale),i=parseInt(100*(e.clientY-t.top)/this.axpObj.scale),n=this.axpObj.CANVAS.main_ctx.getImageData(a,i,1,1),s=n.data[0],o=n.data[1],r=n.data[2];this.axpObj.colorMakerSystem.selectPalette(),this.axpObj.colorMakerSystem.setMainColor("#"+_([s,o,r])),this.axpObj.msg("@COL0001",this.axpObj.colorMakerSystem.getMainColorRGB())}else this.axpObj.msg("@CAU5002")}autoChangePen(){"on"===this.axpObj.config("axp_config_form_autoChangeSpuitToPen")&&(this.axpObj.isCTRL||this.switchMainButton(document.getElementById("axp_pen_button_penBase"),"spuit"))}fillAll(){const e=this.axpObj.layerSystem.getId();let t;this.axpObj.undoSystem.setUndo({type:"draw",detail:"fillall",layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(e)]}),t="true"===document.getElementById("axp_makecolor_div_transparent").dataset.selected||"eraser"===this.getType()?"destination-out":this.axpObj.layerSystem.getMasked()?"source-atop":"source-over",this.CANVAS.draw_ctx.globalCompositeOperation=t,this.CANVAS.draw_ctx.globalAlpha=this.getAlpha()/100,this.CANVAS.draw_ctx.shadowBlur=0;let a=this.getToneLevel(),i=this.axpObj.colorMakerSystem.getAdjustColor();"on"===this.axpObj.config("axp_config_form_ToneLevel")&&null!==a&&16!==a?this.CANVAS.brush_ctx.fillStyle=v(a,i):this.CANVAS.brush_ctx.fillStyle=i,this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.brush_ctx.fillRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.getImage(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}rotate90(){const e=this.axpObj.layerSystem.getId();this.axpObj.undoSystem.setUndo({type:"draw",detail:"rotate90",layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(e)]}),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.getImage(),0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size));const t=e=>{let t=e.width,a=e.height,i=0,n=0;t>a?n=Math.trunc((t-a)/2):i=Math.trunc((a-t)/2),t=a=Math.max(t,a);let s=document.createElement("canvas"),o=s.getContext("2d");s.width=t,s.height=a,o.clearRect(0,0,t,a),o.putImageData(e,i,n);let r,l=o.getImageData(0,0,t,a),d=t;for(r=0;r<d/2;++r){let e=r,a=d-1-r;for(let i=e;i<a;i++){let n=a-i+e,s=4*(e*t+i),o=4*(n*t+e),r=4*(a*t+n),d=4*(i*t+a);var c,p,_,h;c=l.data[s+0],p=l.data[s+1],_=l.data[s+2],h=l.data[s+3],l.data[s+0]=l.data[o+0],l.data[s+1]=l.data[o+1],l.data[s+2]=l.data[o+2],l.data[s+3]=l.data[o+3],l.data[o+0]=l.data[r+0],l.data[o+1]=l.data[r+1],l.data[o+2]=l.data[r+2],l.data[o+3]=l.data[r+3],l.data[r+0]=l.data[d+0],l.data[r+1]=l.data[d+1],l.data[r+2]=l.data[d+2],l.data[r+3]=l.data[d+3],l.data[d+0]=c,l.data[d+1]=p,l.data[d+2]=_,l.data[d+3]=h}}o.putImageData(l,0,0),this.axpObj.layerSystem.write(o.getImageData(i,n,e.width,e.height))};this.axpObj.x_size===this.axpObj.y_size?(e=>{let t,a=e.width,i=a;for(t=0;t<i/2;++t){let l=t,d=i-1-t;for(let t=l;t<d;t++){let i=d-t+l,c=4*(l*a+t),p=4*(i*a+l),_=4*(d*a+i),h=4*(t*a+d);var n,s,o,r;n=e.data[c+0],s=e.data[c+1],o=e.data[c+2],r=e.data[c+3],e.data[c+0]=e.data[p+0],e.data[c+1]=e.data[p+1],e.data[c+2]=e.data[p+2],e.data[c+3]=e.data[p+3],e.data[p+0]=e.data[_+0],e.data[p+1]=e.data[_+1],e.data[p+2]=e.data[_+2],e.data[p+3]=e.data[_+3],e.data[_+0]=e.data[h+0],e.data[_+1]=e.data[h+1],e.data[_+2]=e.data[h+2],e.data[_+3]=e.data[h+3],e.data[h+0]=n,e.data[h+1]=s,e.data[h+2]=o,e.data[h+3]=r}}})(this.axpObj.layerSystem.getImage()):t(this.axpObj.layerSystem.getImage()),this.axpObj.layerSystem.updateCanvas()}modeChangeSizeOn(e,t){if(this.axpObj.codeCHANGE_SIZE_KEY)return;let a=this.getName();null!==this.getSize()?(this.axpObj.codeCHANGE_SIZE_KEY=t,this.axpObj.msg("@AXP5007",`[ ${e} ]:`)):this.axpObj.msg("@CAU0203",a)}modeChangeSizeOff(){this.axpObj.codeCHANGE_SIZE_KEY&&(this.axpObj.codeCHANGE_SIZE_KEY=null),this.axpObj.msg("")}changeOrderSlider(){"size"===this.axpObj.config("axp_config_form_pentoolRangeOrder")?document.getElementById("axp_pen_form_penSize").style.order="-1":document.getElementById("axp_pen_form_penSize").style.order="0"}upPenSize(){let e=this.getName(),t=this.getSize();if(null!==t)if(t=Number(t),t>=200)this.axpObj.msg("@CAU0204",e);else{for(var a=this.getIndex();f[a]===t;)a++;t=f[a],this.setPenSize(t)}else this.axpObj.msg("@CAU0203",e)}downPenSize(){let e=this.getName(),t=this.getSize();if(null!==t)if(t=Number(t),t<=1)this.axpObj.msg("@CAU0205",e);else{for(var a=this.getIndex();f[a]===t;)a--;t=f[a],this.setPenSize(t)}else this.axpObj.msg("@CAU0203",e)}changePenAlpha(e){let t=this.getName(),a=this.getAlpha();if(null!==a){if(a=Number(a),"up"===e){if(a>=100)return void this.axpObj.msg("@CAU0201,",t);a+=5}else{if(a<=5)return void this.axpObj.msg("@CAU0202",t);a-=5}this.axpObj.msg("@AXP0003",t,a),this.axpObj.penSystem.setAlpha(a),this.axpObj.penSystem.previewPenSize(),document.getElementById("axp_pen_form_alpha").result.value=a,document.getElementById("axp_pen_range_alpha").value=a,this.axpObj.configSystem.saveConfig("P-ALP_"+this.axpObj.penSystem.pen_mode,a)}else this.axpObj.msg("@CAU0200",t)}}a(4490);const F=[{name:"下描き",color:"#f33"},{name:"線画",color:"#fa3"},{name:"下塗り",color:"#ff3"},{name:"彩色",color:"#5f5"},{name:"陰影",color:"#5ff"},{name:"ハイライト",color:"#55f"},{name:"背景",color:"#faf"},{name:"その他",color:"#fff"}];class D{constructor(e){this.id=e.id,this.index=e.index,this.mode=e.mode,this.alpha=e.alpha,this.checked=e.checked,this.locked=e.locked,this.masked=e.masked,this.name=e.name,this.tag=e.tag,this.image=e.image,this.rafPendingDraw=!1,this.rafPendingThumbnail=!1}}class V extends r{layer_counter=0;currentLayer=null;layerObj=[];CANVAS={backscreen_trans:null,backscreen_trans_ctx:null,backscreen_white:null,backscreen_white_ctx:null,tmp:null,tmp_ctx:null,merge:null,merge_ctx:null,thumbnail_ctx:[],clip:null,clip_ctx:null,layer_ctx:[]};CONST={LAYER_MAX:8,X_LAYER_MAX:40,Y_LAYER_MAX:40};imageForUndo;colorTagList=null;constructor(e){super(e)}getDefaultPosition(){return{left:0,top:400}}init(){this.createHTML("axp_layer","LAY",this.axpObj._("@WINDOW.LAYER"),"axpc_icon_window_layer",'\x3c!-- レイヤー --\x3e\n<div class="axpc_window_content">\n    <select id="axp_layer_select_blendMode" class="axpc_MSG" data-msg="@LAY0001">\n        <option value="source-over">${_("@LAYER.OPTION_NORMAL")}</option>\n        <option value="source-atop">${_("@LAYER.OPTION_CLIPING")}</option>\n        <option value="multiply">${_("@LAYER.OPTION_MULTIPLY")}</option>\n        <option value="screen">${_("@LAYER.OPTION_SCREEN")}</option>\n        <option value="overlay">${_("@LAYER.OPTION_OVERLAY")}</option>\n        <option value="darken">${_("@LAYER.OPTION_DARKEN")}</option>\n        <option value="lighten">${_("@LAYER.OPTION_LIGHTEN")}</option>\n        <option value="color-dodge">${_("@LAYER.OPTION_DODGE")}</option>\n        <option value="color-burn">${_("@LAYER.OPTION_BURN")}</option>\n        <option value="hard-light">${_("@LAYER.OPTION_HARD_LIGHT")}</option>\n        <option value="soft-light">${_("@LAYER.OPTION_SOFT_LIGHT")}</option>\n        <option value="difference">${_("@LAYER.OPTION_DIFFERENCE")}</option>\n        <option value="exclusion">${_("@LAYER.OPTION_EXCLUSION")}</option>\n    </select>\n    <div id="axp_layer_div_button1">\n        <form id="axp_layer_form_alpha" oninput="result.value=parseInt(volume.value)"\n            class="axpc_range axpc_text_border">\n            <input type="range" id="axp_layer_range_alpha" name="volume" value="100" min="0" max="100" step="5"\n                class="axpc_MSG" data-msg="@LAY0002">\n            <div class="axpc_range_label">${_("@COMMON.OPACITY")}</div>\n            <div class="axpc_range_value"><output name="result"></output></div>\n        </form>\n        <button class="axpc_FUNC axpc_button" data-function="func_layer_clear" data-msg="@LAY0003"\n            id="axp_layer_button_clear">${_("@LAYER.BUTTON_CLEAR")}</button>\n    </div>\n    <div id="axp_layer_div_button2">\n        <button id="axp_layer_button_create" class="axpc_FUNC axpc_button" data-function="func_layer_create"\n            data-msg="@LAY0004">${_("@LAYER.BUTTON_NEW")}</button>\n        <button id="axp_layer_button_integrate" class="axpc_FUNC axpc_button" data-function="func_layer_integrate"\n            data-msg="@LAY0005">${_("@LAYER.BUTTON_MERGE")}</button>\n        <button id="axp_layer_button_copy" class="axpc_FUNC axpc_button" data-function="func_layer_copy"\n            data-msg="@LAY0006">${_("@LAYER.BUTTON_COPY")}</button>\n        <button id="axp_layer_button_delete" class="axpc_FUNC axpc_button" data-function="func_layer_delete"\n            data-msg="@LAY0007">${_("@LAYER.BUTTON_DEL")}</button>\n    </div>\n</div>\n<ul id="axp_layer_ul_layerBox" class="axpc_MSG" data-msg="@LAY0008"></ul>'),this.window_width=180;const e=this.getDefaultPosition();this.window_left=e.left,this.window_top=e.top,this.CANVAS.backscreen_white=document.createElement("canvas"),this.CANVAS.backscreen_white_ctx=this.CANVAS.backscreen_white.getContext("2d"),this.CANVAS.backscreen_trans=document.createElement("canvas"),this.CANVAS.backscreen_trans_ctx=this.CANVAS.backscreen_trans.getContext("2d"),this.CANVAS.tmp=document.createElement("canvas"),this.CANVAS.tmp_ctx=this.CANVAS.tmp.getContext("2d"),this.CANVAS.merge=document.createElement("canvas"),this.CANVAS.merge_ctx=this.CANVAS.merge.getContext("2d"),this.CANVAS.clip=document.createElement("canvas"),this.CANVAS.clip_ctx=this.CANVAS.clip.getContext("2d")}resetCanvas(){this.x_size=this.axpObj.x_size,this.y_size=this.axpObj.y_size,this.CANVAS.backscreen_white.width=this.x_size,this.CANVAS.backscreen_white.height=this.y_size,this.CANVAS.backscreen_trans.width=this.x_size,this.CANVAS.backscreen_trans.height=this.y_size,this.CANVAS.tmp.width=this.x_size,this.CANVAS.tmp.height=this.y_size,this.CANVAS.merge.width=this.x_size,this.CANVAS.merge.height=this.y_size,this.CANVAS.clip.width=this.x_size,this.CANVAS.clip.height=this.y_size,this.layer_counter=0,this.currentLayer=null,this.layerObj.splice(0),this.CANVAS.thumbnail_ctx.splice(0),this.axpObj.ENV.multiCanvas&&this.CANVAS.layer_ctx.splice(0);const e=document.getElementById("axp_layer_ul_layerBox");for(;e.firstChild;)e.removeChild(e.firstChild)}startEvent(){document.getElementById("axp_layer_select_blendMode").addEventListener("change",e=>{this.setBlendMode(e.target.value),this.updateCanvas()}),document.getElementById("axp_layer_range_alpha").addEventListener("input",e=>{const t=Number(e.target.value);this.setAlpha(t),this.updateCanvas(),this.axpObj.msg("@AXP0003",this.getName(),t)}),null===this.colorTagList&&this.resetColorTagList();const e=e=>{this.currentLayer.querySelector(".axpc_layer_span_cellName").textContent=e},t=e=>{this.currentLayer.querySelector(".axpc_layer_div_cellColorTag").style.backgroundColor=e},a=()=>{this.axpObj.closeSubwindow("axp_renamelayer")};document.getElementById("axp_renamelayer").addEventListener("click",()=>{a()}),document.querySelector("#axp_renamelayer>div").addEventListener("click",e=>{e.stopPropagation()}),document.getElementById("axp_renamelayer_button_close").addEventListener("click",()=>{a()});const i=()=>{let t=this.normalizeLayerName(document.getElementById("axp_renamelayer_text_newLayerName").value,20);""===t?this.axpObj.msg("@CAU4007"):(e(t),this.setName(t),this.axpObj.msg("@INF4005",t),this.axpObj.closeSubwindow("axp_renamelayer"))};document.getElementById("axp_renamelayer_button_confirm").addEventListener("click",e=>{"true"===e.target.dataset.enabled&&i()}),document.getElementById("axp_renamelayer_button_confirm").addEventListener("pointerenter",e=>{"true"===e.target.dataset.enabled?this.axpObj.msg("@AXP4010"):this.axpObj.msg("@AXP4013")}),document.getElementById("axp_renamelayer_text_newLayerName").addEventListener("keydown",e=>{e.key&&"Enter"===e.key&&("true"===document.getElementById("axp_renamelayer_button_confirm").dataset.enabled?i():a())}),document.getElementById("axp_renamelayer_text_newLayerName").addEventListener("input",()=>{document.getElementById("axp_renamelayer_button_confirm").dataset.enabled="true"}),document.getElementById("axp_renamelayer_button_colorReset").addEventListener("click",()=>{this.setTag(-1),t(this.getTagBackground(-1)),this.axpObj.msg("@INF4009")});const n=document.getElementById("axp_renamelayer_div_colorTag"),s=document.getElementById("axp_config_div_colorTag");for(let a=0;a<this.colorTagList.length;a++){const i=n.appendChild(this.createTagHTML(this.colorTagList[a]));i.addEventListener("click",()=>{const i=this.colorTagList[a].name,n=this.replaceDuplicateLayerName(i),s=this.colorTagList[a].color;e(n),t(s),this.setName(n),this.setTag(a),this.axpObj.msg("@INF4005",n),this.axpObj.closeSubwindow("axp_renamelayer")}),i.addEventListener("pointerenter",()=>{this.axpObj.msg("@AXP4012")});s.appendChild(this.createTagConfigHTML(this.colorTagList[a],a)).querySelector("input").addEventListener("change",e=>{let t=this.normalizeLayerName(e.target.value,8);""===t?(e.target.value=this.colorTagList[a].name,this.axpObj.msg("@CAU4008")):(e.target.value=t,this.colorTagList[a].name=t,document.querySelectorAll(".axpc_renamelayer_button_colorTag")[a].textContent=t,this.axpObj.configSystem.saveConfig("COTAG",this.colorTagList),this.axpObj.msg("@INF4008",t))})}document.getElementById("axp_renamelayer_button_flipH").addEventListener("click",()=>{this.flip_h(),this.axpObj.msg("@INF1001"),this.axpObj.undoSystem.setUndo({type:"flip_h",id:this.axpObj.layerSystem.getId()})}),document.getElementById("axp_renamelayer_button_flipV").addEventListener("click",()=>{this.flip_v(),this.axpObj.msg("@INF1003"),this.axpObj.undoSystem.setUndo({type:"flip_v",id:this.axpObj.layerSystem.getId()})})}getNewLayerName(){const e=(t,a=1)=>{let i,n=`${t}${a}`,s=!1;for(let e=0;e<this.layerObj.length;e++)if(n==this.layerObj[e].name){s=!0;break}return i=s?e(t,a+1):n,i};return e(this.axpObj._("@LAYER.NEWLAYER_TEMPLATE"))}replaceDuplicateLayerName(e,t=1){let a,i,n=!1;a=1===t?e:`${e}(${t})`;for(let e=0;e<this.layerObj.length;e++)if(e===this.getLayerIndex(this.currentLayer.dataset.id));else if(a==this.layerObj[e].name){n=!0;break}return i=n?this.replaceDuplicateLayerName(e,t+1):a,i}normalizeLayerName(e,t){let a;return a=e.trim(),a=a.substring(0,t),a}resetColorTagList(e=null){let t=null!==e?e:F;this.colorTagList=[];for(let e=0;e<t.length;e++)this.colorTagList.push({name:t[e].name,color:F[e].color})}updateAllColorTag(){for(let e=0;e<this.colorTagList.length;e++)document.querySelectorAll(".axpc_renamelayer_button_colorTag")[e].textContent=this.colorTagList[e].name,document.querySelectorAll(".axpc_config_text_colorTag")[e].value=this.colorTagList[e].name}createTagHTML(e){const t=document.createElement("button");return t.setAttribute("class","axpc_renamelayer_button_colorTag"),t.textContent=e.name,t.style.background=`linear-gradient(90deg,#555, #555 89%, ${e.color} 90%)`,t}createTagConfigHTML(e,t){const a=document.createElement("div");a.setAttribute("class","axpc_config_div_colorTag"),a.style.background=`linear-gradient(90deg,#777, #777 89%, ${e.color} 90%)`;const i=document.createElement("input");return i.setAttribute("type","text"),i.setAttribute("id",`axp_config_text_colorTag${t}`),i.setAttribute("class","axpc_config_text_colorTag"),i.value=e.name,a.appendChild(i),a}deleteLayer(e){var t,a,i=document.querySelectorAll("#axp_layer_ul_layerBox>li");for(let n=0;n<i.length;n++)if(i[n].dataset.id==e){t=i[n],a=n;break}a>=1&&a--;var n=this.getLayerIndex(e);this.layerObj.splice(n,1),this.CANVAS.thumbnail_ctx.splice(n,1),this.axpObj.ENV.multiCanvas&&this.CANVAS.layer_ctx.splice(n,1),this.updateLayerIndex(),document.getElementById("axp_layer_ul_layerBox").removeChild(t),i=document.querySelectorAll("#axp_layer_ul_layerBox>li");var s=!1;for(let e=0;e<i.length;e++)if("true"==i[e].dataset.selected){s=!0;break}s||this.setCurrentLayer(i[a])}clear(e){this.layerObj[this.getLayerIndex(e)].image=this.CANVAS.tmp_ctx.createImageData(this.axpObj.x_size,this.axpObj.y_size)}getLocked(e=null){return e?this.layerObj[e].locked:this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].locked}getChecked(e=null){return e?this.layerObj[e].checked:this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].checked}getMasked(e=null){return e?this.layerObj[e].masked:this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].masked}getTag(e=null){return e?this.layerObj[e].tag:this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].tag}getTagBackground(e){return-1===e?"#00000000":this.colorTagList[e].color}getAlpha(e=null){return e?this.layerObj[e].alpha:this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].alpha}getLayerElement(e){return document.querySelector(`#axp_layer_ul_layerBox>li:nth-of-type(${e+1})`)}getClupMode(){return this.currentLayer.querySelector(".axpc_layer_div_cellCliping").dataset.mode}getClupParentName(){let e=this.getLayerIndex(this.currentLayer.dataset.id)+1,t="";for(;e<this.layerObj.length&&"source-atop"===this.layerObj[e].mode;)e++;return e<this.layerObj.length&&(t=this.layerObj[e].name),t}setAlpha(e,t=null){if(t){this.layerObj[t].alpha=e;this.getLayerElement(t).querySelector(".axpc_layer_div_cellButtonEye").style.background=this.getEyeBackground(e)}else{this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].alpha=e;this.currentLayer.querySelector(".axpc_layer_div_cellButtonEye").style.background=this.getEyeBackground(e)}}getName(e=null){return e?this.layerObj[e].name:this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].name}getMode(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].mode}getId(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].id}getIndex(){let e;return e=null===this.currentLayer?0:this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].index,e}getImage(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image}getCanvasImage(){return this.axpObj.assistToolSystem.getIsTransparent()?this.CANVAS.backscreen_trans_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size):this.CANVAS.backscreen_white_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)}getCanvas(){return this.axpObj.assistToolSystem.getIsTransparent()?this.CANVAS.backscreen_trans:this.CANVAS.backscreen_white}getCurrentLayerImage(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image}write(e){this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image=e}setImageId(e,t){this.layerObj[this.getLayerIndex(t)].image=e}setName(e){this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].name=e}setBlendMode(e){this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].mode=e,this.displayBlendMode(this.currentLayer)}setTag(e){this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].tag=e}displayBlendMode(e){const t=e.querySelector(".axpc_layer_span_cellStatus"),a=this.layerObj[this.getLayerIndex(e.dataset.id)].mode;if("none"===this.axpObj.config("axp_config_form_blendModeDisplayType"))t.textContent="";else if("unusual"===this.axpObj.config("axp_config_form_blendModeDisplayType")&&"source-over"===a)t.textContent="";else{const e=document.querySelector(`#axp_layer_select_blendMode>option[value='${a}']`).textContent;t.textContent=e}e.querySelector(".axpc_layer_div_cellCliping").dataset.mode=a;e.querySelector(".axpc_layer_div_cellRightSide").dataset.mode=a}updateBlendModeDisplayAll(){const e=document.querySelectorAll("#axp_layer_ul_layerBox>li");for(const t of e)this.displayBlendMode(t)}setLayerCounter(e){this.layer_counter=e}isWriteProtection(e=null){return!(!this.getLocked(e)&&this.getChecked(e)&&0!=this.getAlpha(e))}getReasonTextForWriteProtection(e=null){let t=null;return 0==this.getAlpha(e)&&(t="不透明度0%"),this.getChecked(e)||(t="非表示"),this.getLocked(e)&&(t="ロック状態"),t}save(){this.imageForUndo=this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image}load(){return this.imageForUndo}flip_h(e){if("all"==e)for(const e of this.layerObj)h(e.image);else isNaN(e)?h(this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image):h(this.layerObj[this.getLayerIndex(e)].image);this.draw(),this.drawThumbnail()}flip_v(e){if("all"==e)for(const e of this.layerObj)u(e.image);else isNaN(e)?u(this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image):u(this.layerObj[this.getLayerIndex(e)].image);this.draw(),this.drawThumbnail()}getLayerIndex(e){for(var t=-1,a=0;a<this.layerObj.length;a++)if(this.layerObj[a].id==e){t=a;break}return t}newLayer(){this.layer_counter++;let e={x_size:this.axpObj.x_size,y_size:this.axpObj.y_size,id:this.layer_counter,name:this.getNewLayerName(),alpha:100,mode:"source-over",checked:!0,locked:!1,masked:!1,tag:-1,image:this.CANVAS.tmp_ctx.createImageData(this.axpObj.x_size,this.axpObj.y_size),insert_idx:this.getIndex()};return this.createLayer(e),e.id}copyLayer(e){this.layer_counter++;let t={x_size:this.axpObj.x_size,y_size:this.axpObj.y_size,id:this.layer_counter,name:this.getNewLayerName(),alpha:e.alpha,mode:e.mode,checked:e.checked,locked:e.locked,masked:e.masked,tag:e.tag,image:this.CANVAS.tmp_ctx.createImageData(this.axpObj.x_size,this.axpObj.y_size),insert_idx:this.getIndex()};return t.image.data.set(e.image.data),this.createLayer(t),t.id}restoreLayer(e){let t={x_size:this.axpObj.x_size,y_size:this.axpObj.y_size,id:e.layerObj.id,name:e.layerObj.name,alpha:e.layerObj.alpha,mode:e.layerObj.mode,checked:e.layerObj.checked,locked:e.layerObj.locked,masked:e.layerObj.masked,tag:void 0===e.layerObj.tag?-1:e.layerObj.tag,image:e.layerObj.image,insert_idx:e.layerObj.index};return this.createLayer(t),t.id}createLayer(e){const t=this.createLayerHTML(e),a=e.insert_idx,i=document.getElementById("axp_layer_ul_layerBox");if(i.insertBefore(t,i.children[a]),this.axpObj.ENV.multiCanvas){const e=document.createElement("canvas");e.width=this.x_size,e.height=this.y_size;const t=e.getContext("2d");this.CANVAS.layer_ctx.splice(a,0,t)}let n=t.querySelector("canvas").getContext("2d");return n.setTransform(1,0,0,1,0,0),n.scale(this.CONST.X_LAYER_MAX/Math.max(this.x_size,this.y_size),this.CONST.X_LAYER_MAX/Math.max(this.x_size,this.y_size)),this.CANVAS.thumbnail_ctx.splice(a,0,n),this.layerObj.splice(a,0,new D(e)),this.updateLayerIndex(),this.setCurrentLayer(t),this.displayBlendMode(t),e.id}getEyeBackground(e){return`linear-gradient(0deg, #ddd, #ddd ${e-1}%, #999 ${e}%)`}createLayerHTML(e){const t=document.createElement("div");t.setAttribute("data-id",e.id),t.setAttribute("class","axpc_layer_div_cellButtonEyeIcon"),e.checked?t.classList.add("axpc_icon_eyeON"):t.classList.add("axpc_icon_eyeOFF"),t.addEventListener("pointerenter",e=>{let t=e.target.classList.contains("axpc_icon_eyeON")?"表示":"非表示";this.axpObj.msg("@AXP4000","表示状態",t),"mouse"===e.pointerType&&1===e.buttons&&(this.axpObj.isDrawing||(e.target.classList.contains("axpc_icon_eyeON")?(e.target.classList.remove("axpc_icon_eyeON"),e.target.classList.add("axpc_icon_eyeOFF"),this.layerObj[this.getLayerIndex(e.target.dataset.id)].checked=!1):(e.target.classList.remove("axpc_icon_eyeOFF"),e.target.classList.add("axpc_icon_eyeON"),this.layerObj[this.getLayerIndex(e.target.dataset.id)].checked=!0),t=e.target.classList.contains("axpc_icon_eyeON")?"表示":"非表示",this.axpObj.msg("@INF4006","表示状態",t),this.updateCanvas()))},!1),t.addEventListener("pointerdown",e=>{e.stopPropagation(),e.target.classList.contains("axpc_icon_eyeON")?(e.target.classList.remove("axpc_icon_eyeON"),e.target.classList.add("axpc_icon_eyeOFF"),this.layerObj[this.getLayerIndex(e.target.dataset.id)].checked=!1):(e.target.classList.remove("axpc_icon_eyeOFF"),e.target.classList.add("axpc_icon_eyeON"),this.layerObj[this.getLayerIndex(e.target.dataset.id)].checked=!0);var t=e.target.classList.contains("axpc_icon_eyeON")?"表示":"非表示";this.axpObj.msg("@INF4006","表示状態",t),this.updateCanvas()},!1);const a=document.createElement("div");a.setAttribute("class","axpc_layer_div_cellButtonEye"),a.setAttribute("data-id",e.id),a.style.background=this.getEyeBackground(e.alpha),a.appendChild(t);var i=document.createElement("div");e.locked?i.setAttribute("class","axpc_layer_div_cellButton axpc_icon_lockON"):i.setAttribute("class","axpc_layer_div_cellButton axpc_icon_lockOFF"),i.setAttribute("data-id",e.id),i.addEventListener("pointerenter",e=>{var t=e.target.classList.contains("axpc_icon_lockON")?"ロック":"なし";this.axpObj.msg("@AXP4000","ロック状態",t)},!1),i.addEventListener("pointerdown",e=>{e.stopPropagation(),e.target.classList.contains("axpc_icon_lockON")?(e.target.classList.remove("axpc_icon_lockON"),e.target.classList.add("axpc_icon_lockOFF"),this.layerObj[this.getLayerIndex(e.target.dataset.id)].locked=!1):(e.target.classList.remove("axpc_icon_lockOFF"),e.target.classList.add("axpc_icon_lockON"),this.layerObj[this.getLayerIndex(e.target.dataset.id)].locked=!0);var t=e.target.classList.contains("axpc_icon_lockON")?"ロック":"なし";this.axpObj.msg("@INF4006","ロック状態",t)},!1);let n=document.createElement("div");e.masked?n.setAttribute("class","axpc_layer_div_cellButton axpc_icon_maskON"):n.setAttribute("class","axpc_layer_div_cellButton axpc_icon_maskOFF"),n.setAttribute("data-id",e.id),n.addEventListener("pointerenter",e=>{var t=e.target.classList.contains("axpc_icon_maskON")?"ロック":"なし";this.axpObj.msg("@AXP4000","透明部分のロック状態",t)},!1),n.addEventListener("pointerdown",e=>{e.stopPropagation(),e.target.classList.contains("axpc_icon_maskON")?(e.target.classList.remove("axpc_icon_maskON"),e.target.classList.add("axpc_icon_maskOFF"),this.layerObj[this.getLayerIndex(e.target.dataset.id)].masked=!1):(e.target.classList.remove("axpc_icon_maskOFF"),e.target.classList.add("axpc_icon_maskON"),this.layerObj[this.getLayerIndex(e.target.dataset.id)].masked=!0);var t=e.target.classList.contains("axpc_icon_maskON")?"ロック":"なし";this.axpObj.msg("@INF4006","透明部分のロック状態",t)},!1);let s=document.createElement("div");s.setAttribute("class","axpc_layer_div_cellButtonContainer"),s.appendChild(i),s.appendChild(n);let o=document.createElement("canvas");o.setAttribute("class","axpc_layer_canvas_cellThumbnail axpc_layer_CANDRAG"),o.width=this.CONST.X_LAYER_MAX,o.height=this.CONST.Y_LAYER_MAX;let r=document.createElement("span");r.setAttribute("class","axpc_layer_span_cellName axpc_layer_CANDRAG"),r.textContent=e.name;let l=document.createElement("span");l.setAttribute("class","axpc_layer_span_cellStatus axpc_layer_CANDRAG");let d=document.createElement("div");d.setAttribute("class","axpc_layer_div_cellLeftSide"),d.appendChild(a),d.appendChild(s);let c=document.createElement("div");c.setAttribute("class","axpc_layer_div_cellRightSide axpc_layer_CANDRAG"),c.appendChild(r),c.appendChild(l);let p=document.createElement("div");p.setAttribute("class","axpc_layer_div_cellCliping axpc_layer_CANDRAG");let _=document.createElement("div");_.setAttribute("class","axpc_layer_div_cell"),_.appendChild(d),_.appendChild(p),_.appendChild(o),_.appendChild(c);const h=document.createElement("div");h.setAttribute("class","axpc_layer_div_cellColorTag axpc_layer_CANDRAG"),h.style.background=this.getTagBackground(e.tag),_.appendChild(h);let u=document.createElement("li");return u.setAttribute("data-selected",""),u.setAttribute("data-name","Layer"+e.id),u.setAttribute("data-id",e.id),u.setAttribute("id","layer"+e.id),u.appendChild(_),u.addEventListener("pointerdown",e=>{e.target.classList.contains("axpc_layer_CANDRAG")&&(this.drag_down(e),this.axpObj.msg("@AXP4001"),this.setCurrentLayer(e.currentTarget))}),c.addEventListener("dblclick",e=>{this.openRenameLayerWindow(e)}),u}openRenameLayerWindow(){this.axpObj.openSubwindow("axp_renamelayer",this.currentLayer);const e=this.currentLayer.querySelector(".axpc_layer_span_cellName").textContent,t=document.getElementById("axp_renamelayer_text_newLayerName");t.value=e,document.getElementById("axp_renamelayer_button_confirm").dataset.enabled="false",t.focus(),t.select()}drag_down(e){const t=e.currentTarget,a=e.pageX,i=e.pageY,n=t.offsetWidth;G.idx_source=z.index(t),G.target=t,G.diffX=a,G.diffY=i,G.ofx=t.offsetLeft,G.ofy=t.offsetTop,G.cloneName=z.insertClone(t,z.index(t)),t.style.width=`${n}px`,t.classList.add("axpc_onGRAB");const s=e=>{const t=G.target,a=e.pageX,i=e.pageY,n=G.ofx+a-G.diffX,s=G.ofy+i-G.diffY;t.style.left=`${n}px`,t.style.top=`${s}px`,z.swap(t)},o=()=>{const e=G.target,t=`.${G.cloneName}`,a=document.querySelector(t);G.cloneName="",a.remove(),e.removeAttribute("style"),e.classList.remove("axpc_onGRAB"),window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",o);for(var i=document.querySelectorAll("#axp_layer_ul_layerBox>li"),n=0;n<i.length&&i[n].dataset.id!==e.dataset.id;n++);if(n!==G.idx_source){let e=this.layerObj.splice(G.idx_source,1);this.layerObj.splice(n,0,e[0]);let t=this.CANVAS.thumbnail_ctx.splice(G.idx_source,1);if(this.CANVAS.thumbnail_ctx.splice(n,0,t[0]),this.axpObj.ENV.multiCanvas){let e=this.CANVAS.layer_ctx.splice(G.idx_source,1);this.CANVAS.layer_ctx.splice(n,0,e[0])}this.updateLayerIndex(),this.updateCanvas()}};window.addEventListener("pointermove",s),window.addEventListener("pointerup",o)}setCurrentLayer(e){const t=document.querySelectorAll("#axp_layer_ul_layerBox>li");for(const e of t)e.dataset.selected="";this.currentLayer=e,this.currentLayer.dataset.selected="true";const a=this.getAlpha();document.getElementById("axp_layer_range_alpha").value=a,document.getElementById("axp_layer_form_alpha").result.value=a,document.getElementById("axp_layer_select_blendMode").value=this.getMode(),document.getElementById("axp_layer_select_blendMode").blur()}selectCurrentLayerIndex(e){const t=document.querySelectorAll("#axp_layer_ul_layerBox>li");for(const a of t)if(0===e){this.setCurrentLayer(a);break}}updateLayerIndex(){for(let e=0;e<this.layerObj.length;e++)this.layerObj[e].index=e}draw(){let e=this.axpObj.CANVAS.main_ctx;this.CANVAS.backscreen_trans_ctx.beginPath(),this.CANVAS.backscreen_trans_ctx.clearRect(0,0,this.x_size,this.y_size),this.axpObj.assistToolSystem.getIsTransparent()||(this.CANVAS.backscreen_trans_ctx.save(),this.CANVAS.backscreen_trans_ctx.globalAlpha=1,this.CANVAS.backscreen_trans_ctx.fillStyle="#ffffff",this.CANVAS.backscreen_trans_ctx.fillRect(0,0,this.x_size,this.y_size),this.CANVAS.backscreen_trans_ctx.restore());let t=this.layerObj.length-1;for(let e=this.layerObj.length-1;e>=0;e--){let a,i=this.layerObj[e];a=this.axpObj.ENV.multiCanvas?this.CANVAS.layer_ctx[e]:this.CANVAS.tmp_ctx,a.putImageData(i.image,0,0);const n=Math.max(this.axpObj.x_size,this.axpObj.y_size);this.CANVAS.thumbnail_ctx[e].clearRect(0,0,n,n);const s=1;if(this.CANVAS.thumbnail_ctx[e].drawImage(a.canvas,this.axpObj.ctx_map_shift_x-s,this.axpObj.ctx_map_shift_y-s),this.CANVAS.thumbnail_ctx[e].drawImage(a.canvas,this.axpObj.ctx_map_shift_x,this.axpObj.ctx_map_shift_y),!(t<e))if("source-atop"===i.mode){this.getLayerElement(e).querySelector(".axpc_layer_div_cellCliping").dataset.mode="invalid"}else{let n=a.canvas;if(0!==e&&"source-atop"===this.layerObj[e-1].mode){for(t=e-1,this.CANVAS.clip_ctx.globalCompositeOperation="source-over",this.CANVAS.clip_ctx.globalAlpha=1,this.CANVAS.clip_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size);t>=0&&"source-atop"===this.layerObj[t].mode;){this.getLayerElement(t).querySelector(".axpc_layer_div_cellCliping").dataset.mode=this.layerObj[t].mode,this.layerObj[t].checked&&(this.axpObj.ENV.multiCanvas?(this.CANVAS.layer_ctx[t].putImageData(this.layerObj[t].image,0,0),this.CANVAS.clip_ctx.globalAlpha=this.layerObj[t].alpha/100,this.CANVAS.clip_ctx.drawImage(this.CANVAS.layer_ctx[t].canvas,0,0)):(a.putImageData(this.layerObj[t].image,0,0),this.CANVAS.clip_ctx.globalAlpha=this.layerObj[t].alpha/100,this.CANVAS.clip_ctx.drawImage(a.canvas,0,0))),t--}this.CANVAS.merge_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.merge_ctx.putImageData(i.image,0,0),this.CANVAS.merge_ctx.globalCompositeOperation="source-atop",this.CANVAS.merge_ctx.globalAlpha=1,this.CANVAS.merge_ctx.drawImage(this.CANVAS.clip_ctx.canvas,0,0),n=this.CANVAS.merge}i.checked&&(this.CANVAS.backscreen_trans_ctx.globalCompositeOperation=i.mode,this.CANVAS.backscreen_trans_ctx.globalAlpha=i.alpha/100,this.CANVAS.backscreen_trans_ctx.drawImage(n,0,0))}}this.CANVAS.backscreen_white_ctx.beginPath(),this.CANVAS.backscreen_white_ctx.clearRect(0,0,this.x_size,this.y_size),this.CANVAS.backscreen_white_ctx.globalAlpha=1,this.CANVAS.backscreen_white_ctx.fillStyle="#ffffff",this.CANVAS.backscreen_white_ctx.fillRect(0,0,this.x_size,this.y_size),this.CANVAS.backscreen_white_ctx.drawImage(this.CANVAS.backscreen_trans,0,0),this.axpObj.assistToolSystem.getIsTransparent()?(e.clearRect(0,0,this.x_size,this.y_size),e.drawImage(this.CANVAS.backscreen_trans,0,0)):e.drawImage(this.CANVAS.backscreen_white,0,0),this.axpObj.isBackgroundimage&&!this.axpObj.isDrawing&&this.axpObj.drawBackground()}drawThumbnail(){let e=this.axpObj.assistToolSystem.CANVAS.thumbnail_ctx;e.clearRect(0,0,this.axpObj.assistToolSystem.CANVAS.thumbnail.width,this.axpObj.assistToolSystem.CANVAS.thumbnail.height),this.axpObj.assistToolSystem.getIsTransparent()?e.drawImage(this.CANVAS.backscreen_trans,0,0,this.axpObj.assistToolSystem.CANVAS.thumbnail.width,this.axpObj.assistToolSystem.CANVAS.thumbnail.height):e.drawImage(this.CANVAS.backscreen_white,0,0,this.axpObj.assistToolSystem.CANVAS.thumbnail.width,this.axpObj.assistToolSystem.CANVAS.thumbnail.height)}updateCanvas(){this.rafPendingDraw||(this.rafPendingDraw=!0,requestAnimationFrame(()=>{this.draw(),this.rafPendingDraw=!1})),this.rafPendingThumbnail||(this.rafPendingThumbnail=!0,requestAnimationFrame(()=>{this.drawThumbnail(),this.rafPendingThumbnail=!1}))}downloadImage(){let e=document.createElement("a");this.axpObj.assistToolSystem.getIsTransparent()?e.href=this.CANVAS.backscreen_trans.toDataURL("image/png"):e.href=this.CANVAS.backscreen_white.toDataURL("image/png");let t="ap"+g(new Date,"YYYYMMDD_hhmmss")+".png";e.download=t,e.click()}buttonCreateLayer(){if(this.layerObj.length>=this.CONST.LAYER_MAX)this.axpObj.msg("@CAU4002",this.CONST.LAYER_MAX);else{var e=this.newLayer();this.axpObj.msg("@INF4001",this.getName()),this.axpObj.undoSystem.setUndo({type:"layer-create",layerObj:this.layerObj[this.getLayerIndex(e)]})}}buttonIntegrateLayer(){var e=this.getLayerIndex(this.currentLayer.dataset.id);if(e>=this.layerObj.length-1)return void this.axpObj.msg("@CAU4005");var t=e+1,a=this.layerObj[t].id;const i=this.getName(),n=this.getName(t);if(this.isWriteProtection())return void this.axpObj.msg("@CAU4006",i,this.getReasonTextForWriteProtection());if(this.isWriteProtection(t))return void this.axpObj.msg("@CAU4006",n,this.getReasonTextForWriteProtection(t));this.axpObj.undoSystem.setUndo({type:"layer-integrate",layerObj:this.layerObj[e],layerObj_dest:this.layerObj[t]});let s,o,r=this.axpObj.penSystem.CANVAS.draw,l=this.axpObj.penSystem.CANVAS.draw_ctx;if(l.clearRect(0,0,r.width,r.height),l.shadowBlur=0,this.axpObj.ENV.multiCanvas?(s=this.CANVAS.layer_ctx[t],o=this.CANVAS.layer_ctx[e]):(s=this.CANVAS.tmp_ctx,o=this.CANVAS.tmp_ctx),this.CANVAS.merge_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),l.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),o.putImageData(this.layerObj[t].image,0,0),l.globalAlpha=Number(this.layerObj[t].alpha/100),l.globalCompositeOperation="source-over",l.drawImage(o.canvas,0,0),this.layerObj[t].masked){this.CANVAS.clip_ctx.putImageData(this.layerObj[t].image,0,0);const a=this.CANVAS.clip_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size);for(let e=0,t=a.data.length;e<t;e+=4){a.data[e+3]>0&&(a.data[e+3]=255)}this.CANVAS.clip_ctx.putImageData(a,0,0),this.CANVAS.merge_ctx.globalAlpha=1,this.CANVAS.merge_ctx.globalCompositeOperation="source-over",this.CANVAS.merge_ctx.drawImage(this.CANVAS.clip_ctx.canvas,0,0),s.putImageData(this.layerObj[e].image,0,0),this.CANVAS.merge_ctx.globalAlpha=Number(this.layerObj[e].alpha/100),this.CANVAS.merge_ctx.globalCompositeOperation="source-in",this.CANVAS.merge_ctx.drawImage(s.canvas,0,0),l.globalAlpha=1,l.globalCompositeOperation=this.layerObj[e].mode,l.drawImage(this.CANVAS.merge_ctx.canvas,0,0)}else s.putImageData(this.layerObj[e].image,0,0),this.CANVAS.merge_ctx.globalAlpha=Number(this.layerObj[e].alpha/100),this.CANVAS.merge_ctx.globalCompositeOperation="source-over",this.CANVAS.merge_ctx.drawImage(s.canvas,0,0),l.globalAlpha=1,"source-atop"===this.layerObj[e].mode&&"source-atop"===this.layerObj[t].mode?l.globalCompositeOperation="source-over":l.globalCompositeOperation=this.layerObj[e].mode,l.drawImage(this.CANVAS.merge_ctx.canvas,0,0);this.layerObj[t].image=l.getImageData(0,0,r.width,r.height),this.setAlpha(100,t),this.deleteLayer(this.getId()),this.updateCanvas();for(var d=document.querySelectorAll("#axp_layer_ul_layerBox>li"),c=0;c<d.length;c++)if(Number(d[c].dataset.id)===Number(a)){this.setCurrentLayer(d[c]);break}this.axpObj.msg("@INF4004",i,n)}buttonCopyLayer(){if(this.layerObj.length>=this.CONST.LAYER_MAX)return void this.axpObj.msg("@CAU4002",this.CONST.LAYER_MAX);const e=this.getId(),t=this.getName();var a=this.copyLayer(this.layerObj[this.getLayerIndex(e)]),i=this.getName();this.updateCanvas(),this.axpObj.msg("@INF4002",t,i),this.axpObj.undoSystem.setUndo({type:"layer-copy",layerObj:this.layerObj[this.getLayerIndex(a)]})}buttonDeleteLayer(){if(this.getLocked())return void this.axpObj.msg("@CAU4003",this.getName());if(this.layerObj.length<=1)return void this.axpObj.msg("@CAU4004");const e=this.getId(),t=this.getName();this.axpObj.undoSystem.setUndo({type:"layer-delete",layerObj:this.layerObj[this.getLayerIndex(e)]}),this.deleteLayer(e),this.updateCanvas(),this.axpObj.msg("@INF4003",t)}buttonClearLayer(){this.getLocked()?this.axpObj.msg("@CAU4000",this.getName()):!function(e){for(var t=0;t<e.height;t++)for(var a=0;a<e.width;a++){let i=4*(a+t*e.height);if(0!==e.data[i+3])return!1}return!0}(this.getImage())?(this.axpObj.undoSystem.setUndo({type:"layer-clear",layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(this.getId())]}),this.clear(this.getId()),this.updateCanvas(),this.axpObj.msg("@INF4000",this.getName())):this.axpObj.msg("@CAU4001",this.getName())}}let G={target:null,diffX:0,diffY:0,ofx:0,ofy:0,idx_source:null};const z={index(e){const t=e.parentElement.children;return[].slice.call(t).indexOf(e)},insertClone(e,t){const a=`ddItemClone_${Math.trunc(1e4*Math.random())}`,i=e.cloneNode(!0),n=e.parentElement.children;return i.classList.add("axpc_HIDDEN"),i.classList.add(a),n[t].insertAdjacentElement("afterend",i),a},swap(e){const t=z.index(e),a=t+1,i=e.parentElement,n=i.querySelectorAll(`:scope > *:not(.axpc_onGRAB):not(.${G.cloneName})`);for(let s=0,o=n.length;s<o;s++){const o=e.offsetWidth,r=e.offsetHeight,l=e.getBoundingClientRect(),d=l.left,c=l.top,p=n[s],_=p.offsetWidth,h=p.offsetHeight,u=p.getBoundingClientRect(),m=u.left,x=u.top+h/2;if(m<=d+o&&m+_>=d&&(c<=x&&c+r>=x)){const n=i.children[a];i.insertBefore(n,t>s?p:p.nextSibling),i.insertBefore(e,n);break}}}};a(788);const U=["#000000","#333333","#777777","#cccccc","#32486f","#1b25b5","#ba09ba","#ff3bde","#0cc3e8","#852f04","#b80410","#d12c2c","#e88460","#ff8b1f","#56bc9d","#0fc23c","#87ee6d","#ffff47","#fffcb4","#ffc076","#ffc4b5","#ffe4d6","#fff5df","#ffffff"];class H extends r{CONST={COLOR_MAX:50};currentPalette={column:5,palette:[]};isEditMode=!1;elementCurrentPalette;elementPaletteBox;constructor(e){super(e)}getDefaultPosition(){return{left:this.axpObj.paintBodyElement.clientWidth-this.window_width-74,top:250}}init(){this.createHTML("axp_palette","PLT",this.axpObj._("@WINDOW.SWATCHES"),"axpc_icon_window_palette",'\x3c!-- パレット --\x3e\n<div class="axpc_window_content">\n    \x3c!-- 列数サブウィンドウ --\x3e\n    <div id="axp_palette_div_column" class="axpc_NONE">\n        <form id="axp_palette_form_column" class="axpc_range axpc_text_border">\n            <input type="range" id="axp_palette_range_column" class="axpc_MSG" name="volume" value="3" step="1" min="1"\n                max="24" data-msg="@PLT0001">\n            <div class="axpc_range_label">${_("@SWATCHES.COLUMNS")}</div>\n            <div class="axpc_range_value"><output name="result"></output></div>\n        </form>\n    </div>\n    <div id="axp_palette_div_container">\n        \x3c!-- パレット操作ボタン（更新、登録、削除 --\x3e\n        <div id="axp_palette_div_buttons">\n            <button id="axp_palette_button_edit" class="axpc_MSG axpc_button"\n                data-msg="@PLT0002">${_("@SWATCHES.EDIT")}</button>\n            <button id="axp_palette_button_addColor" class="axpc_MSG axpc_button"\n                data-msg="@PLT0003">${_("@SWATCHES.SET")}</button>\n            <button id="axp_palette_button_delete" class="axpc_MSG axpc_button axpc_NONE"\n                data-msg="@PLT0004">${_("@SWATCHES.DEL")}</button>\n        </div>\n        \x3c!-- カラーパレットを表示するためのエリア --\x3e\n        <div id="axp_palette_div_paletteBox"></div>\n    </div>\n</div>'),this.window_width=46;const e=this.getDefaultPosition();this.window_left=e.left,this.window_top=e.top,this.elementPaletteBox=document.getElementById("axp_palette_div_paletteBox"),this.setPaletteArray()}startEvent(){document.getElementById("axp_palette_button_edit").onclick=()=>{if(this.isEditMode||(this.axpObj.colorMakerSystem.setMainColor(this.getColor()),this.axpObj.penSystem.previewPenSize()),this.isEditMode=!this.isEditMode,this.isEditMode){if(document.getElementById("axp_palette_button_edit").dataset.selected="true",l.show("axp_palette_button_delete"),document.getElementById("axp_config_checkbox_paletteColumnEdit").checked){const e=document.getElementById("axp_palette_div_column");l.show(e)}document.getElementById("axp_palette").classList.add("axpc_window_attention"),this.axpObj.msg("@INF3000")}else l.hide("axp_palette_button_delete"),l.hide("axp_palette_div_column"),document.getElementById("axp_palette_button_edit").dataset.selected="false",document.getElementById("axp_palette").classList.remove("axpc_window_attention"),this.axpObj.msg("@INF3001")};document.getElementById("axp_palette_button_delete").onclick=()=>{if(this.currentPalette.palette.length<=1)return void this.axpObj.msg("@CAU3000");let e;for(e=0;e<this.elementPaletteBox.childElementCount&&this.elementPaletteBox.children[e]!==this.elementCurrentPalette;e++);this.currentPalette.palette.splice(e,1),this.axpObj.saveSystem.save_palette(this.currentPalette.palette),this.elementPaletteBox.removeChild(this.elementCurrentPalette),this.updatePaletteColumn(),e===this.elementPaletteBox.childElementCount&&e--,this.elementCurrentPalette=this.elementPaletteBox.children[e],this.elementCurrentPalette.dataset.selected="true";let t=this.elementCurrentPalette.dataset.color;this.axpObj.colorMakerSystem.setMainColor(t),this.axpObj.penSystem.previewPenSize(),this.axpObj.msg("@INF3002")},document.getElementById("axp_palette_button_addColor").addEventListener("click",()=>{this.addcolor()}),document.getElementById("axp_palette_range_column").oninput=e=>{this.setPaletteColumn(e.target.value)}}addcolor(){let e=this.axpObj.colorMakerSystem.getAdjustColor();if(this.currentPalette.palette.length>=this.CONST.COLOR_MAX)this.axpObj.msg("@CAU3001",this.CONST.COLOR_MAX);else{var t=document.getElementById("axp_palette_div_paletteBox");this.elementCurrentPalette.dataset.selected="",this.elementCurrentPalette=t.appendChild(this.createPaletteHTML(e)),this.elementCurrentPalette.dataset.selected="true",this.currentPalette.palette.push(e),this.axpObj.saveSystem.save_palette(this.currentPalette.palette),this.updatePaletteColumn(),this.axpObj.msg("@INF3003",p(e))}}drag_down(e){const t=e.currentTarget,a=e.pageX,i=e.pageY;Y.idx_source=W.index(t),Y.target=t,Y.diffX=a,Y.diffY=i,Y.ofx=t.offsetLeft,Y.ofy=t.offsetTop;const n=Y.ofx,s=Y.ofy;t.style.left=`${n}px`,t.style.top=`${s}px`,Y.cloneName=W.insertClone(t,W.index(t)),t.classList.add("axpc_onGRAB");const o=e=>{const t=Y.target,a=e.pageX,i=e.pageY,n=Y.ofx+a-Y.diffX,s=Y.ofy+i-Y.diffY;t.style.left=`${n}px`,t.style.top=`${s}px`,W.swap(t)},r=()=>{const e=Y.target,t=`.${Y.cloneName}`,a=document.querySelector(t);if(Y.cloneName="",a.remove(),e.classList.remove("axpc_onGRAB"),window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",r),Y.idx_dest=W.index(e),Y.idx_source!==Y.idx_dest){const e=this.currentPalette.palette[Y.idx_source];this.currentPalette.palette.splice(Y.idx_source,1),this.currentPalette.palette.splice(Y.idx_dest,0,e),this.axpObj.saveSystem.save_palette(this.currentPalette.palette)}};window.addEventListener("pointermove",o),window.addEventListener("pointerup",r)}getColor(){return this.elementCurrentPalette.dataset.color}setColor(e){if(!this.isEditMode)return;let t;for(t=0;t<this.elementPaletteBox.childElementCount&&this.elementPaletteBox.children[t]!==this.elementCurrentPalette;t++);this.elementCurrentPalette.style.backgroundColor=e,this.elementCurrentPalette.dataset.color=e,this.currentPalette.palette[t]=e,this.axpObj.saveSystem.save_palette(this.currentPalette.palette)}setPaletteArray(e){if(void 0===e&&(e=U,this.currentPalette.column=3),e.length>this.CONST.COLOR_MAX)throw new Error("colorPalette MAX over");for(let t=0;t<e.length;t++)"#"!==e[t].substring(0,1)&&(e[t]="#"+e[t]);this.currentPalette.palette.splice(0);for(let t of e)this.currentPalette.palette.push(t)}setPaletteColumn(e){let t=Number(e);t>this.currentPalette.palette.length&&(t=0),this.currentPalette.column=t,this.updatePaletteColumn(),this.axpObj.configSystem.saveConfig("PLTCO",t)}createPalette(){for(;this.elementPaletteBox.firstChild;)this.elementPaletteBox.removeChild(this.elementPaletteBox.firstChild);for(const e of this.currentPalette.palette)this.elementPaletteBox.appendChild(this.createPaletteHTML(e));this.elementCurrentPalette=document.querySelector("#axp_palette_div_paletteBox :first-child"),this.elementCurrentPalette.dataset.selected="true",this.updatePaletteColumn()}updatePaletteColumn(){const e=this.currentPalette.palette.length,t=this.currentPalette.column,a=0!==t?Math.ceil(e/t):1;let i,n=document.getElementById("axp_palette"),s=document.getElementById("axp_palette_div_container"),o=document.getElementById("axp_palette_div_buttons"),r=document.getElementById("axp_palette_div_paletteBox");0===t?(i=e,s.style.flexDirection="row",o.style.flexWrap="nowrap"):(i=t,s.style.flexDirection="column",o.style.flexWrap="wrap");let l=32*i,d=l+14;r.style.width=l+"px",n.style.width=0!==t&&i<=2?d+"px":"auto",this.currentPalette.height=32*a;let c=t,p=t;0===t&&(c=e+1,p="∞"),document.getElementById("axp_palette_range_column").max=e+1,document.getElementById("axp_palette_range_column").value=c,document.getElementById("axp_palette_form_column").result.value=p,document.getElementById("axp_config_form_paletteColumnValue").volume.max=e+1,document.getElementById("axp_config_form_paletteColumnValue").volume.value=c,document.getElementById("axp_config_form_paletteColumnValue").result.value=p,this.axpObj.configSystem.dispPalettebox(document.getElementById("axp_config_div_paletteBox"),this.currentPalette)}createPaletteHTML(e){const t=document.createElement("button");return t.setAttribute("class","axpc_palette_colorRect"),t.dataset.color=e,t.style.backgroundColor=e,t.addEventListener("pointerenter",e=>{this.isEditMode?this.axpObj.msg("@AXP3000"):this.axpObj.msg("@AXP3001",p(e.target.dataset.color))}),t.addEventListener("pointerdown",e=>{var t=e.target.dataset.color;this.isEditMode&&this.drag_down(e),this.axpObj.colorMakerSystem.selectPalette(),this.elementCurrentPalette.dataset.selected="",this.elementCurrentPalette=e.target,this.elementCurrentPalette.dataset.selected="true",this.axpObj.colorMakerSystem.setMainColor(t),this.axpObj.penSystem.changePenMode(),this.axpObj.msg("@COL0001",p(t))}),t}}const W={index(e){const t=e.parentElement.children;return[].slice.call(t).indexOf(e)},insertClone(e,t){const a=`ddItemClone_${Math.trunc(1e4*Math.random())}`,i=e.cloneNode(!0),n=e.parentElement.children;return i.classList.add("axpc_HIDDEN"),i.classList.add(a),n[t].insertAdjacentElement("afterend",i),a},swap(e){const t=W.index(e),a=t+1,i=e.parentElement,n=i.querySelectorAll(`:scope > *:not(.axpc_onGRAB):not(.${Y.cloneName})`);for(let s=0,o=n.length;s<o;s++){const o=e.offsetWidth,r=e.offsetHeight,l=e.getBoundingClientRect(),d=l.left,c=l.top,p=n[s],_=p.offsetWidth,h=p.offsetHeight,u=p.getBoundingClientRect(),m=u.left+_/2,x=u.top+h/2;if(d<=m&&d+o>=m&&(c<=x&&c+r>=x)){const n=i.children[a];i.insertBefore(n,t>s?p:p.nextSibling),i.insertBefore(e,n);break}}}};let Y={target:null,diffX:0,diffY:0,ofx:0,ofy:0,idx_source:null,idx_dest:null};var X=function(){var e=function(e){var t=e[0],a=e[1]/100,i=e[2]/100;return 0===i?[0,0,0]:[t,100*(2*(a*=(i*=2)<=1?i:2-i)/(i+a)),100*((i+a)/2)]};var t=function(e){var t,a,i=e[0],n=e[1]/100,s=e[2]/100;return t=n*s,[i,100*(t=(t/=(a=(2-n)*s)<=1?a:2-a)||0),100*(a/=2)]};function a(e){var t=e[0],a=e[1],i=e[2],n=Math.max(t,a,i),s=n-Math.min(t,a,i),o=s&&60*(n===t?(a-i)/s%6:n===a?(i-t)/s+2:(t-a)/s+4);return[o<0?o+360:o,n&&100*s/n,100*n/255]}function i(e){var t=e[0]/60,a=e[1]/100,i=e[2]/100,n=i*a,s=i-n,o=255*(n*(1-Math.abs(t%2-1))+s)+.5|0,r=255*(n+s)+.5|0,l=255*s+.5|0,d=0|t;return 1===d?[o,r,l]:2===d?[l,r,o]:3===d?[l,o,r]:4===d?[o,l,r]:5===d?[r,l,o]:[r,o,l]}var n=function(e,t,a){return Math.min(Math.max(e,t),a)};function s(e){var t=Math.round(n(e,0,255)).toString(16);return 1==t.length?"0"+t:t}var o=function(e){var t=4===e.length?s(255*e[3]):"";return"#"+s(e[0])+s(e[1])+s(e[2])+t};var r=function(e){4!==e.length&&5!==e.length||(e=function(e){for(var t="#",a=1;a<e.length;a++){var i=e.charAt(a);t+=i+i}return t}(e));var t=[parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16)];if(9===e.length){var a=parseFloat((parseInt(e.substring(7,9),16)/255).toFixed(2));t.push(a)}return t};function l(e,t){return e?[_(e[0])?c(e[0]):t[0],_(e[1])?p(e[1]):t[1],_(e[2])?p(e[2]):t[2]]:t}function d(e){return[c(e[0]),p(e[1]),p(e[2])]}function c(e){var t=Math.round(e%360*10)/10;return t<0?t+360:t}function p(e){return e<0?0:e>100?100:(10*e+.5|0)/10}function _(e){return"number"==typeof e&&isFinite(e)}var h="undefined"!=typeof globalThis?globalThis:self,u="PointerEvent"in h?function(e,t,a){e.addEventListener("pointerdown",function(e){0===e.button&&!1!==t(e)&&this.setPointerCapture(e.pointerId)}),e.addEventListener("pointermove",function(e){this.hasPointerCapture(e.pointerId)&&a(e)})}:"ontouchend"in h?function(e,t,a){var i=!1;e.addEventListener("touchstart",function(e){1===e.touches.length&&!1!==t(e.touches[0])&&(i=!0,e.preventDefault())}),e.addEventListener("touchmove",function(e){i&&1===e.touches.length&&(e.preventDefault(),a(e.touches[0]))})}:function(e,t,a){var i=function(e){a(e)},n=function(){removeEventListener("mouseup",n),removeEventListener("mousemove",i)};e.addEventListener("mousedown",function(e){0===e.button&&!1!==t(e)&&(addEventListener("mousemove",i),addEventListener("mouseup",n))})},m={hsv:[0,100,100],hsl:[0,100,50],wheelDiameter:200,wheelThickness:20,handleDiameter:16,wheelReflectsSaturation:!0,onChange:function(){}},x=h.DOMMatrix||h.WebKitCSSMatrix||h.MSCSSMatrix,g=function(e,t){return e===t||e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},b=function(){function n(e){var t=this;this.options=e,this.wheelDiameter=this.options.wheelDiameter||m.wheelDiameter,this.wheelThickness=this.options.wheelThickness||m.wheelThickness,this.handleDiameter=this.options.handleDiameter||m.handleDiameter,this.onChange=this.options.onChange||m.onChange,this.wheelReflectsSaturation=void 0!==this.options.wheelReflectsSaturation?this.options.wheelReflectsSaturation:m.wheelReflectsSaturation,this.rootElement=this.options.appendTo.appendChild(A("div","reinvented-color-wheel")),this.hueWheelElement=this.rootElement.appendChild(A("canvas","reinvented-color-wheel--hue-wheel")),this.hueWheelContext=this.hueWheelElement.getContext("2d"),this.hueHandleElement=this.rootElement.appendChild(A("div","reinvented-color-wheel--hue-handle")),this.svSpaceElement=this.rootElement.appendChild(A("canvas","reinvented-color-wheel--sv-space")),this.svSpaceContext=this.svSpaceElement.getContext("2d"),this.svHandleElement=this.rootElement.appendChild(A("div","reinvented-color-wheel--sv-handle")),this._redrawHueWheel=function(){t._redrawHueWheelRequested=!1;var e=t.wheelDiameter,a=e/2,i=a-t.wheelThickness/2,n=Math.PI/180,s=t.wheelReflectsSaturation?",".concat(t._hsl[1],"%,").concat(t._hsl[2],"%)"):",100%,50%)",o=t.hueWheelContext;o.clearRect(0,0,e,e),o.lineWidth=t.wheelThickness;for(var r=0;r<360;r++)o.beginPath(),o.arc(a,a,i,(r-90.7)*n,(r-89.3)*n),o.strokeStyle="hsl("+r+s,o.stroke()},this.hueWheelContext.imageSmoothingEnabled=!1,this.svSpaceContext.imageSmoothingEnabled=!1,this._hsv=l(e.hsv?e.hsv:e.hsl?n.hsl2hsv(e.hsl):e.rgb?n.rgb2hsv(e.rgb):e.hex?n.rgb2hsv(n.hex2rgb(e.hex)):void 0,m.hsv),this._hsl=d(n.hsv2hsl(this._hsv)),this._rgb=n.hsv2rgb(this._hsv),this._hex=n.rgb2hex(this._rgb);var a=function(e,a){var i=t._inverseTransform.multiply(new x("matrix(1,0,0,1,".concat(e,",").concat(a,")")));return{x:i.e,y:i.f}},i=function(e){t._inverseTransform=function(e){for(var t=[e];null!==(e=e.parentElement);)t.push(e);for(var a=new x,i=t.length-1;i>=0;i--){var n=getComputedStyle(t[i]),s=n.transform;if(s&&"none"!==s){var o=n.transformOrigin.split(" ").map(parseFloat);a=a.translate(o[0],o[1]).multiply(new x(s)).translate(-o[0],-o[1])}}return a.inverse()}(e);var i=e.getBoundingClientRect();t._center=a(i.left+i.width/2,i.top+i.height/2)},s=function(e){var i=a(e.clientX,e.clientY),n=i.x-t._center.x,s=i.y-t._center.y,o=Math.atan2(s,n);t.hsv=[180*o/Math.PI+90,t.hsv[1],t.hsv[2]]},o=function(e){var i=a(e.clientX,e.clientY),n=100/t.svSpaceElement.width,s=(i.x-t._center.x)*n+50,o=(t._center.y-i.y)*n+50;t.hsv=[t._hsv[0],s,o]},r=function(e){i(t.svSpaceElement),o(e)};u(this.hueWheelElement,function(e){i(t.hueWheelElement);var n=a(e.clientX,e.clientY),o=n.x-t._center.x,r=n.y-t._center.y,l=t.wheelDiameter/2-t.wheelThickness;if(o*o+r*r<l*l)return!1;s(e)},s),u(this.svSpaceElement,r,o),u(this.svHandleElement,r,o),this.redraw()}return Object.defineProperty(n.prototype,"hsv",{get:function(){return this._hsv},set:function(e){g(this._hsv,e)||this._setHSV(e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hsl",{get:function(){return this._hsl},set:function(e){g(this._hsl,e)||this._setHSV(n.hsl2hsv(e))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rgb",{get:function(){return this._rgb},set:function(e){g(this._rgb,e)||this._setHSV(n.rgb2hsv(e))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hex",{get:function(){return this._hex},set:function(e){this._hex!==e&&(this.rgb=n.hex2rgb(e))},enumerable:!1,configurable:!0}),n.prototype.setHSV=function(){this.hsv=arguments},n.prototype.setHSL=function(){this.hsl=arguments},n.prototype.redraw=function(){this.hueWheelElement.width=this.hueWheelElement.height=this.wheelDiameter,this.svSpaceElement.width=this.svSpaceElement.height=(this.wheelDiameter-2*this.wheelThickness)*Math.SQRT1_2-6;var e=this.hueHandleElement.style,t=this.svHandleElement.style;e.width=e.height=t.width=t.height="".concat(this.handleDiameter,"px"),e.marginLeft=e.marginTop=t.marginLeft=t.marginTop="".concat(-this.handleDiameter/2,"px"),this._redrawHueWheel(),this._redrawHueHandle(),this._redrawSvSpace(),this._redrawSvHandle()},n.prototype._setHSV=function(e){var t=this._hsv,a=this._hsv=l(e,t),i=t[0]-a[0],s=t[1]-a[1]||t[2]-a[2];i&&(this._hsl=[a[0],this._hsl[1],this._hsl[2]],this._redrawHueHandle(),this._updateSvBackground()),s&&(this._hsl=d(n.hsv2hsl(a)),this._redrawSvHandle(),this.wheelReflectsSaturation&&!this._redrawHueWheelRequested&&(requestAnimationFrame(this._redrawHueWheel),this._redrawHueWheelRequested=!0)),(i||s)&&(this._rgb=n.hsv2rgb(a),this._hex=n.rgb2hex(this._rgb),this.onChange(this))},n.prototype._redrawSvSpace=function(){this._updateSvBackground();var e=this.svSpaceElement.width,t=this.svSpaceContext,a=t.createLinearGradient(0,0,e,0),i=t.createLinearGradient(0,0,0,e);a.addColorStop(0,"rgba(255,255,255,1)"),a.addColorStop(1,"rgba(255,255,255,0)"),i.addColorStop(0,"rgba(0,0,0,0)"),i.addColorStop(1,"rgba(0,0,0,1)"),t.fillStyle=a,t.fillRect(0,0,e,e),t.fillStyle=i,t.fillRect(0,0,e,e)},n.prototype._updateSvBackground=function(){this.svSpaceElement.style.backgroundColor="hsl(".concat(this._hsv[0],",100%,50%)")},n.prototype._redrawHueHandle=function(){var e=this.wheelDiameter/2,t=e-this.wheelThickness/2,a=(this._hsv[0]-90)*Math.PI/180,i=this.hueHandleElement.style;i.left="".concat(t*Math.cos(a)+e,"px"),i.top="".concat(t*Math.sin(a)+e,"px")},n.prototype._redrawSvHandle=function(){var e=this.svSpaceElement.width,t=this.svHandleElement.style,a=(this.wheelDiameter-e)/2,i=this._hsv;t.left="".concat(a+e*i[1]/100,"px"),t.top="".concat(a+e*(1-i[2]/100),"px")},n.default=n,n.defaultOptions=m,n.hsv2hsl=t,n.hsl2hsv=e,n.hsv2rgb=i,n.rgb2hsv=a,n.rgb2hex=o,n.hex2rgb=r,n}();function A(e,t){var a=document.createElement(e);return a.className=t,a}return b}();a(8906),a(2356);class q extends r{maincolor;subcolor;colorWheel;colorWheel_subwindow;CONST={};constructor(e){super(e)}getDefaultPosition(){return{left:this.axpObj.paintBodyElement.clientWidth-this.window_width-120-10,top:250}}init(){this.createHTML("axp_makecolor","MKC",this.axpObj._("@WINDOW.COLOR"),"axpc_icon_window_colormaker",'\x3c!-- 色作成 --\x3e\n<div class="axpc_window_content">\n    \x3c!-- 混色パレット（オプション） --\x3e\n    <div id="axp_makecolor_div_mixedPalette">\n        <div></div>\n    </div>\n    \x3c!-- 描画色 --\x3e\n    <div id="axp_makecolor_div_drawColor">\n        <div></div>\n        <div></div>\n        <div></div>\n        \x3c!-- メインカラー／サブカラー、透明色 --\x3e\n        <div id="axp_makecolor_div_mainColor" class="axpc_FUNC axpc_colorRect" data-function="func_switch_maincolor"\n            data-msg="@MKC0001" data-selected="true">\n        </div>\n        <div id="axp_makecolor_div_subColor" class="axpc_FUNC axpc_colorRect" data-function="func_switch_subcolor"\n            data-msg="@MKC0002"></div>\n        <div id="axp_makecolor_div_transparent" class="axpc_FUNC axpc_colorRect axpc_background_mesh"\n            data-function="func_switch_transparent" data-msg="@MKC0003">\n        </div>\n        \x3c!-- カラーコード --\x3e\n        <input id="axp_makecolor_text_colorCode" class="axpc_MSG" data-msg="@MKC0004" maxlength="7" value="#000000">\n        \x3c!-- パレット登録ボタン --\x3e\n        <div id="axp_makecolor_button_addColor" class="axpc_MSG" data-msg="@MKC0005"></div>\n        \x3c!-- メイン／サブ入れ替えボタン --\x3e\n        <div id="axp_makecolor_button_swapColor" class="axpc_MSG" data-msg="@MKC0006"></div>\n    </div>\n    \x3c!-- RGBスライダー --\x3e\n    <div id="axp_makecolor_div_RGBSlider">\n        <div class="axpc_range">\n            <span>${_("@COMMON.RED")}</span><input id="axp_makecolor_range_red" class="axpc_MSG range_color"\n                type="range" min="0" max="255" value="0" data-msg="@MKC0007"><input id="axp_makecolor_number_red"\n                class="axpc_MSG" type="number" min="0" max="255" value="0" maxlength="3" data-msg="@MKC0008">\n        </div>\n        <div class="axpc_range">\n            <span>${_("@COMMON.GREEN")}</span><input id="axp_makecolor_range_green" class="axpc_MSG range_color"\n                type="range" min="0" max="255" value="0" data-msg="@MKC0009"><input id="axp_makecolor_number_green"\n                class="axpc_MSG" type="number" min="0" max="255" value="0" maxlength="3" data-msg="@MKC0010">\n        </div>\n        <div class="axpc_range">\n            <span>${_("@COMMON.BLUE")}</span><input id="axp_makecolor_range_blue" class="axpc_MSG range_color"\n                type="range" min="0" max="255" value="0" data-msg="@MKC0011"><input id="axp_makecolor_number_blue"\n                class="axpc_MSG" type="number" min="0" max="255" value="0" maxlength="3" data-msg="@MKC0012">\n        </div>\n    </div>\n    \x3c!-- カラーピッカー --\x3e\n    <div id="axp_makecolor_div_colorPicker" class="axpc_MSG" data-msg="@MKC0013">\n        <div></div>\n    </div>\n</div>'),this.window_width=180;const e=this.getDefaultPosition();this.window_left=e.left,this.window_top=e.top,document.getElementById("axp_makecolor_div_mainColor").style.backgroundColor="#000000",document.getElementById("axp_makecolor_div_subColor").style.backgroundColor="#FFFFFF",this.maincolor="#000000",this.subcolor="#FFFFFF",this.createTemporaryPalette(),this.colorWheel=new X({appendTo:document.querySelector("#axp_makecolor_div_colorPicker>div"),rgb:[0,0,0],wheelDiameter:166,wheelThickness:20,handleDiameter:16,wheelReflectsSaturation:!1,onChange:e=>{this.setMainColor(e.hex,"picker")}})}startEvent(){document.getElementById("axp_makecolor_button_swapColor").addEventListener("click",()=>{let e=this.maincolor;this.maincolor=this.subcolor,this.subcolor=e,this.displayColorMaker(),this.axpObj.msg("@COL0003",p(this.maincolor),p(this.subcolor))}),document.getElementById("axp_makecolor_button_addColor").addEventListener("click",()=>{this.axpObj.colorPaletteSystem.addcolor()});const e=()=>{let e="#"+_([Number(document.getElementById("axp_makecolor_range_red").value),Number(document.getElementById("axp_makecolor_range_green").value),Number(document.getElementById("axp_makecolor_range_blue").value)]);this.setMainColor(e)};document.getElementById("axp_makecolor_range_red").oninput=e,document.getElementById("axp_makecolor_range_green").oninput=e,document.getElementById("axp_makecolor_range_blue").oninput=e,document.getElementById("axp_makecolor_text_colorCode").onchange=()=>{var e=document.getElementById("axp_makecolor_text_colorCode").value;if(b(e)){var t=p(e),a="#"+_(t).toUpperCase();this.setMainColor(a),this.axpObj.msg("@INF2000",a,t)}else this.axpObj.msg("@CAU2000")};const t=()=>{let e="#"+_([A(document.getElementById("axp_makecolor_number_red").value),A(document.getElementById("axp_makecolor_number_green").value),A(document.getElementById("axp_makecolor_number_blue").value)]);this.setMainColor(e)};document.getElementById("axp_makecolor_number_red").onchange=t,document.getElementById("axp_makecolor_number_green").onchange=t,document.getElementById("axp_makecolor_number_blue").onchange=t}selectMainColor(){this.selectPalette("main"),this.setMainColor(this.maincolor),this.axpObj.msg("@COL0001",p(this.maincolor))}selectSubColor(){this.selectPalette("sub"),this.setMainColor(this.subcolor),this.axpObj.msg("@COL0001",p(this.subcolor))}selectTransparent(){this.selectPalette("transparent"),this.setMainColor(this.maincolor),this.axpObj.msg("@COL0002")}getMainColor(){return this.maincolor}getMainColorRGB(){return p(this.maincolor)}setMainColor(e,t=null){"true"===document.getElementById("axp_makecolor_div_subColor").dataset.selected?(this.subcolor=e,document.getElementById("axp_makecolor_div_subColor").style.backgroundColor=e):(this.maincolor=e,document.getElementById("axp_makecolor_div_mainColor").style.backgroundColor=e,document.getElementById("axp_makecolor_text_colorCode").value=e.toUpperCase()),"picker"!==t&&(this.colorWheel.hex=e);let a=e.slice(1).match(/.{2}/g);document.getElementById("axp_makecolor_range_red").value=parseInt(a[0],16),document.getElementById("axp_makecolor_range_green").value=parseInt(a[1],16),document.getElementById("axp_makecolor_range_blue").value=parseInt(a[2],16),document.getElementById("axp_makecolor_number_red").value=parseInt(a[0],16),document.getElementById("axp_makecolor_number_green").value=parseInt(a[1],16),document.getElementById("axp_makecolor_number_blue").value=parseInt(a[2],16),this.axpObj.colorPaletteSystem.setColor(e),this.axpObj.penSystem.previewPenSize(),this.updateTemporaryPalette();let i=document.querySelector('#axp_makecolor_div_mixedPalette>div>div[data-selected="true"]');i&&document.getElementById("axp_makecolor_div_mainColor").style.setProperty("--axp-mixedcolor",i.dataset.color)}get drawingColorName(){return"true"===document.getElementById("axp_makecolor_div_subColor").dataset.selected?"サブカラー":"メインカラー"}get addPaletteName(){return document.querySelector('#axp_makecolor_div_mixedPalette>div>div[data-selected="true"]')?"混色パレット":"true"===document.getElementById("axp_makecolor_div_subColor").dataset.selected?"サブカラー":"メインカラー"}displayColorMaker(){let e;document.getElementById("axp_makecolor_div_mainColor").style.backgroundColor=this.maincolor,document.getElementById("axp_makecolor_text_colorCode").value=this.maincolor.toUpperCase(),document.getElementById("axp_makecolor_div_subColor").style.backgroundColor=this.subcolor,e="true"===document.getElementById("axp_makecolor_div_subColor").dataset.selected?this.subcolor:this.maincolor,this.colorWheel.hex=e;let t=e.slice(1).match(/.{2}/g);document.getElementById("axp_makecolor_range_red").value=parseInt(t[0],16),document.getElementById("axp_makecolor_range_green").value=parseInt(t[1],16),document.getElementById("axp_makecolor_range_blue").value=parseInt(t[2],16),document.getElementById("axp_makecolor_number_red").value=parseInt(t[0],16),document.getElementById("axp_makecolor_number_green").value=parseInt(t[1],16),document.getElementById("axp_makecolor_number_blue").value=parseInt(t[2],16),this.axpObj.colorPaletteSystem.setColor(e),this.axpObj.penSystem.previewPenSize(),this.updateTemporaryPalette()}selectPalette(e="none"){let t=document.querySelector('#axp_makecolor_div_mixedPalette>div>div[data-selected="true"]');switch(t&&(t.dataset.selected=""),"none"===e&&("true"===document.getElementById("axp_makecolor_div_subColor").dataset.selected||(e="main")),e){case"main":document.getElementById("axp_makecolor_div_mainColor").dataset.selected="true",document.getElementById("axp_makecolor_div_subColor").dataset.selected="false",document.getElementById("axp_makecolor_div_transparent").dataset.selected="false";break;case"sub":document.getElementById("axp_makecolor_div_mainColor").dataset.selected="false",document.getElementById("axp_makecolor_div_subColor").dataset.selected="true",document.getElementById("axp_makecolor_div_transparent").dataset.selected="false";break;case"transparent":document.getElementById("axp_makecolor_div_mainColor").dataset.selected="false",document.getElementById("axp_makecolor_div_subColor").dataset.selected="false",document.getElementById("axp_makecolor_div_transparent").dataset.selected="true"}"object"==typeof e?(e.dataset.selected="true",document.getElementById("axp_makecolor_div_mainColor").dataset.selected="false",document.getElementById("axp_makecolor_div_subColor").dataset.selected="false",document.getElementById("axp_makecolor_div_transparent").dataset.selected="false",document.getElementById("axp_makecolor_div_mainColor").dataset.mixed="true"):document.getElementById("axp_makecolor_div_mainColor").dataset.mixed="false"}createTemporaryPalette(){const e=document.querySelector("#axp_makecolor_div_mixedPalette>div");for(;e.firstChild;)e.removeChild(e.firstChild);const t=(e,t)=>{const a=document.createElement("div");a.setAttribute("class","axpc_makecolor_mixedColorRect"),a.dataset.color=e,a.style.backgroundColor=e;const i=5*(t+1);return a.addEventListener("pointerenter",e=>{this.axpObj.msg("@AXP2000",i,p(e.target.dataset.color))}),a.addEventListener("click",e=>{var t=e.target.dataset.color;this.selectPalette(e.target),this.setMainColor(this.maincolor),this.axpObj.msg("@COL0004",i,p(t))}),a};for(let a=0;a<20;a++)e.appendChild(t(this.adjust(a),a))}updateTemporaryPalette(){const e=document.querySelectorAll("#axp_makecolor_div_mixedPalette>div>div");let t=0;for(let a of e)a.dataset.color=this.adjust(t),a.style.backgroundColor=this.adjust(t),t++}adjust(e){let t,a,i,n=p(this.maincolor),s=p(this.subcolor),o=5*(e+1)/100;return t=Math.floor(s[0]*o+n[0]*(1-o)),a=Math.floor(s[1]*o+n[1]*(1-o)),i=Math.floor(s[2]*o+n[2]*(1-o)),"#"+_([t,a,i])}getAdjustColor(){return this.getPaletteColor()}getAdjustColorRGB(){return p(this.getAdjustColor())}getPaletteColor(){let e=document.querySelector('#axp_makecolor_div_mixedPalette>div>div[data-selected="true"]');return e?e.dataset.color:"true"===document.getElementById("axp_makecolor_div_subColor").dataset.selected?this.subcolor:this.maincolor}getPaletteColorRGB(){return p(this.getPaletteColor())}getSubColor(){return this.subcolor}setSubColor(e){this.subcolor=e,document.getElementById("axp_makecolor_div_subColor").style.backgroundColor=e}swap_maincolor(){"true"===document.getElementById("axp_makecolor_div_subColor").dataset.selected?(this.selectPalette("main"),this.setMainColor(this.maincolor),this.axpObj.msg("@COL0001",p(this.maincolor))):(this.selectPalette("sub"),this.setMainColor(this.subcolor),this.axpObj.msg("@COL0001",p(this.subcolor))),this.axpObj.penSystem.previewPenSize()}swap_transparent(){"true"===document.getElementById("axp_makecolor_div_transparent").dataset.selected?(this.selectPalette("main"),this.setMainColor(this.maincolor),this.axpObj.msg("@COL0001",p(this.maincolor))):(this.selectPalette("transparent"),this.setMainColor(this.maincolor),this.axpObj.msg("@COL0002")),this.axpObj.penSystem.previewPenSize()}updateMakeColorType(){switch(this.axpObj.config("axp_config_form_makeColorTypeMixed")){case"off":l.hide("axp_makecolor_div_mixedPalette"),this.selectPalette("main");break;case"on":l.show("axp_makecolor_div_mixedPalette")}switch(this.axpObj.config("axp_config_form_makeColorTypeRGB")){case"off":l.hide("axp_makecolor_div_RGBSlider");break;case"on":l.show("axp_makecolor_div_RGBSlider")}switch(this.axpObj.config("axp_config_form_makeColorTypePicker")){case"off":l.hide("axp_makecolor_div_colorPicker");break;case"on":l.show("axp_makecolor_div_colorPicker")}}}a(2287),a(2356);class K extends r{isDragingMap=!1;isGrid=!1;isTransparent=!1;elementProcessingColor=null;constructor(e){super(e)}CANVAS={thumbnail:null,thumbnail_ctx:null};CONST={X_LOUPE_MAX:120,Y_LOUPE_MAX:120};getDefaultPosition(){return{left:this.axpObj.paintBodyElement.clientWidth-this.window_width-10,top:10}}init(){this.createHTML("axp_tool","AST",this.axpObj._("@WINDOW.MISC"),"axpc_icon_window_subtool",'\x3c!-- 補助ツール --\x3e\n<div class="axpc_window_content">\n    \x3c!-- 補助ツールメイン --\x3e\n    <div id="axp_tool_div_content">\n        \x3c!-- 補助ツール左側 --\x3e\n        <div id="axp_tool_div_leftSide">\n            <div id="axp_tool_div_canvasSize">\n                <span id="axp_tool_span_canvasSize" class="axpc_MSG" data-msg="@AST0001"></span>\n            </div>\n            <div id="axp_tool_div_minimap_outer" class="axpc_MSG" data-msg="@AST0002">\n                <div id="axp_tool_div_minimap_line" class="axpc_NONE"></div>\n                <div id="axp_tool_div_minimap_inner">\n                    <canvas id="axp_tool_canvas_minimap" class="axpc_background_mesh"></canvas>\n                </div>\n            </div>\n\n            <button id="axp_tool_button_loupeDown" class="axpc_FUNC axpc_button" data-function="func_loupe_down"\n                data-msg="@AST0003">-</button>\n            <button id="axp_tool_button_loupeReset" class="axpc_FUNC axpc_button" data-function="func_loupe_reset"\n                data-msg="@AST0004">100%</button>\n            <button id="axp_tool_button_loupeUp" class="axpc_FUNC axpc_button" data-function="func_loupe_up"\n                data-msg="@AST0005">+</button>\n        </div>\n        \x3c!-- 補助ツール右側 --\x3e\n        <div id="axp_tool_div_rightSide">\n            <button id="axp_tool_button_undo" class="axpc_FUNC axpc_button" data-function="func_undo"\n                data-msg="@AST0006">${_("@MISC.BUTTON_UNDO")}(0)</button>\n            <button id="axp_tool_button_redo" class="axpc_FUNC axpc_button" data-function="func_redo"\n                data-msg="@AST0007">${_("@MISC.BUTTON_REDO")}(0)</button>\n            <button id="axp_tool_button_restore" class="axpc_FUNC axpc_button" data-function="func_restore"\n                data-msg="@AST0008">${_("@MISC.BUTTON_RESTORE_AUTOSAVE")}</button>\n\n            <button id="axp_tool_button_save" class="axpc_FUNC axpc_button" data-function="func_save"\n                data-msg="@AST0009">${_("@MISC.BUTTON_SAVE")}</button>\n            <button id="axp_tool_button_load" class="axpc_FUNC axpc_button" data-function="func_load"\n                data-msg="@AST0010">${_("@MISC.BUTTON_LOAD")}</button>\n\n            <button id="axp_tool_button_flipH" class="axpc_FUNC axpc_button" data-function="func_flip_h"\n                data-msg="@AST0011">${_("@MISC.BUTTON_FLIP_H")}</button>\n            <button id="axp_tool_button_flipV" class="axpc_FUNC axpc_button" data-function="func_flip_v"\n                data-msg="@AST0012">${_("@MISC.BUTTON_FLIP_V")}</button>\n\n            <button id="axp_tool_button_transparent" class="axpc_FUNC axpc_button" data-function="func_transparent"\n                data-msg="@AST0013">${_("@MISC.BUTTON_BG_ALPHA")}</button>\n            <div id="axp_tool_div_gridbutton">\n                <button id="axp_tool_button_grid" class="axpc_FUNC axpc_button" data-function="func_grid"\n                    data-msg="@AST0014">${_("@MISC.BUTTON_GRID")}</button>\n                <button id="axp_tool_button_gridConfig" class="axpc_MSG axpc_button" data-msg="@AST0015"></button>\n            </div>\n        </div>\n    </div>\n    \x3c!-- 補助線設定サブメニュー --\x3e\n    <div id="axp_tool_div_gridConfig" class="axpc_NONE">\n        \x3c!-- 主線副線斜め --\x3e\n        <div>\n            \x3c!-- 左側のボタン --\x3e\n            <div>\n                \x3c!-- 主線 --\x3e\n                <div class="axpc_tool_div_gridConfigButton">\n                    <div>\n                        <div>${_("@GRID.MAIN")}</div>\n                    </div>\n                    <div id="axp_tool_checkbox_gridVH" class="axpc_MSG axpc_toggle_switch axp_grid_switch"\n                        data-msg="@AST0103">\n                        <input type="checkbox" name="check" checked />\n                    </div>\n                    <div id="axp_tool_color_gridVH" class="axpc_MSG axpc_colorRect axp_common_inputcolor"\n                        data-msg="@AST0104" style="background-color: #000000" data-colorcode="#00000066"></div>\n                </div>\n                \x3c!-- 副線 --\x3e\n                <div class="axpc_tool_div_gridConfigButton">\n                    <div>\n                        <div>${_("@GRID.SUB")}</div>\n                    </div>\n                    <div id="axp_tool_checkbox_gridSubDivision" class="axpc_MSG axpc_toggle_switch axp_grid_switch"\n                        data-msg="@AST0105">\n                        <input type="checkbox" name="check" checked />\n                    </div>\n                    <div id="axp_tool_color_gridSubDivision" class="axpc_MSG axpc_colorRect axp_common_inputcolor"\n                        data-msg="@AST0106" style="background-color: #000000" data-colorcode="#00000026"></div>\n                </div>\n                \x3c!-- 斜め --\x3e\n                <div class="axpc_tool_div_gridConfigButton">\n                    <div>\n                        <div>${_("@GRID.DIAG")}</div>\n                    </div>\n                    <div id="axp_tool_checkbox_gridDiagonal" class="axpc_MSG axpc_toggle_switch axp_grid_switch"\n                        data-msg="@AST0107">\n                        <input type="checkbox" name="check" />\n                    </div>\n                    <div id="axp_tool_color_gridDiagonal" class="axpc_MSG axpc_colorRect axp_common_inputcolor"\n                        data-msg="@AST0108" style="background-color: #ff0000" data-colorcode="#ff000066"></div>\n                </div>\n            </div>\n            \x3c!-- 右側のスライダー --\x3e\n            <div>\n                \x3c!-- 分割数スライダー ※縦横連動のためaxpc_SAVE対象外 --\x3e\n                <div>\n                    <form id="axp_tool_form_gridH" class="axpc_range axpc_text_border"\n                        oninput="result.value=parseInt(volume.value)">\n                        <input type="range" id="axp_tool_range_gridH" name="volume" min="2" max="16" value="6"\n                            class="axpc_MSG" data-msg="@AST0100">\n                        <div class="axpc_range_label">${_("@GRID.DIVISIONS_H")}</div>\n                        <div class="axpc_range_value"><output name="result">6</output></div>\n                    </form>\n                    <form id="axp_tool_form_gridV" class="axpc_range axpc_text_border"\n                        oninput="result.value=parseInt(volume.value)">\n                        <input type="range" id="axp_tool_range_gridV" name="volume" min="2" max="16" value="6"\n                            class="axpc_MSG" data-msg="@AST0101">\n                        <div class="axpc_range_label">${_("@GRID.DIVISIONS_V")}</div>\n                        <div class="axpc_range_value"><output name="result">6</output></div>\n                    </form>\n                    <div class="axpc_checkbox axpc_MSG" data-msg="@AST0102">\n                        <label>\n                            <input id="axp_tool_checkbox_gridVHLink" class="axpc_SAVE" type="checkbox"\n                                checked>${_("@GRID.CONSTRAIN")}\n                        </label>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- ピクセル単位指定１ --\x3e\n        <div class="axpc_tool_div_gridConfigButton">\n            <div>\n                <div>px(1)</div>\n            </div>\n            <div id="axp_tool_checkbox_gridPixel1" class="axpc_MSG axpc_toggle_switch axp_grid_switch"\n                data-msg="@AST0109">\n                <input type="checkbox" name="check" />\n            </div>\n            <div id="axp_tool_color_gridPixel1" class="axpc_MSG axpc_colorRect axp_common_inputcolor"\n                data-msg="@AST0110" style="background-color: #0000ff" data-colorcode="#0000ff66">\n            </div>\n            <div>\n                <input type="number" id="axp_tool_number_gridPixel1" class="axpc_MSG" data-msg="@AST0111" min="1"\n                    max="100" value="10" maxlength="3">\n                <span>px</span>\n            </div>\n        </div>\n        \x3c!-- ピクセル単位指定２ --\x3e\n        <div class="axpc_tool_div_gridConfigButton">\n            <div>\n                <div>px(2)</div>\n            </div>\n            <div id="axp_tool_checkbox_gridPixel2" class="axpc_MSG axpc_toggle_switch axp_grid_switch"\n                data-msg="@AST0112">\n                <input type="checkbox" name="check" />\n            </div>\n            <div id="axp_tool_color_gridPixel2" class="axpc_MSG axpc_colorRect axp_common_inputcolor"\n                data-msg="@AST0113" style="background-color: #0000ff" data-colorcode="#0000ff26">\n            </div>\n            <div>\n                <input type="number" id="axp_tool_number_gridPixel2" class="axpc_MSG" data-msg="@AST0114" min="1"\n                    max="100" value="1" maxlength="3">\n                <span>px</span>\n            </div>\n        </div>\n    </div>\n</div>'),this.window_width=300;const e=this.getDefaultPosition();this.window_left=e.left,this.window_top=e.top,this.CANVAS.thumbnail=document.getElementById("axp_tool_canvas_minimap"),this.CANVAS.thumbnail_ctx=this.CANVAS.thumbnail.getContext("2d"),this.colorWheel_subwindow=new X({appendTo:document.getElementById("axp_gridconfig_div_colorPicker"),rgb:[0,0,0],wheelDiameter:166,wheelThickness:20,handleDiameter:16,wheelReflectsSaturation:!1,onChange:()=>{this.changeGridColor()}})}resetCanvas(){document.getElementById("axp_tool_span_canvasSize").textContent=`${this.axpObj._("@COMMON.WIDTH")}:${this.axpObj.x_size} ${this.axpObj._("@COMMON.HEIGHT")}:${this.axpObj.y_size}`;let e,t,a=Number(this.axpObj.x_size),i=Number(this.axpObj.y_size);const n=this.CONST.X_LOUPE_MAX/Math.max(a,i);e=Math.round(a*n),t=Math.round(i*n),this.CANVAS.thumbnail.width=e,this.CANVAS.thumbnail.height=t,this.CANVAS.thumbnail_ctx.clearRect(0,0,e,t),this.axpObj.ctx_map_shift_x=0,this.axpObj.ctx_map_shift_y=0,a>i&&(this.axpObj.ctx_map_shift_y=(a-i)/2),a<i&&(this.axpObj.ctx_map_shift_x=(i-a)/2)}startEvent(){const e=e=>{const t=this.CANVAS.thumbnail.getBoundingClientRect(),a=x(e.clientX-t.left-6,4,this.CONST.X_LOUPE_MAX-4-1),i=x(e.clientY-t.top-6,4,this.CONST.Y_LOUPE_MAX-4-1),n=this.axpObj.ELEMENT.view.getBoundingClientRect(),s=this.axpObj.CANVAS.main.getBoundingClientRect(),o=n.width+s.width,r=n.height+s.height,l=a*o/this.CONST.X_LOUPE_MAX-o/2,d=i*r/this.CONST.Y_LOUPE_MAX-r/2;this.axpObj.cameraX=Math.round(100*l/this.axpObj.scale),this.axpObj.cameraY=Math.round(100*d/this.axpObj.scale),this.axpObj.refreshCanvas()};document.getElementById("axp_tool_div_minimap_outer").onpointerdown=t=>{this.isDragingMap=!0,e(t)},document.getElementById("axp_tool_div_minimap_outer").onpointermove=t=>{this.isDragingMap&&e(t)},document.getElementById("axp_tool_div_minimap_outer").onpointercancel=document.getElementById("axp_tool_div_minimap_outer").onpointerleave=document.getElementById("axp_tool_div_minimap_outer").onpointerup=()=>{this.isDragingMap=!1};const t=e=>{const t=e.target.value,a=document.getElementById("axp_tool_form_gridH"),i=document.getElementById("axp_tool_form_gridV");document.getElementById("axp_tool_checkbox_gridVHLink").checked&&(a.volume.value=t,a.result.value=t,i.volume.value=t,i.result.value=t),this.axpObj.updateGrid(),this.axpObj.configSystem.saveConfig("RANGE_axp_tool_form_gridH",a.volume.value),this.axpObj.configSystem.saveConfig("RANGE_axp_tool_form_gridV",i.volume.value)};document.getElementById("axp_tool_range_gridH").addEventListener("input",t),document.getElementById("axp_tool_range_gridV").addEventListener("input",t),document.getElementById("axp_tool_checkbox_gridVHLink").addEventListener("change",e=>{if(e.target.checked){const e=document.getElementById("axp_tool_range_gridH").value;document.getElementById("axp_tool_form_gridV").volume.value=e,document.getElementById("axp_tool_form_gridV").result.value=e,this.axpObj.updateGrid(),this.axpObj.configSystem.saveConfig("RANGE_axp_tool_form_gridV",e)}});const a=e=>{let t=e.target.value,a=x(Number(t),1,100);e.target.value=a,this.axpObj.updateGrid(),this.axpObj.configSystem.saveConfig(`VALUE_${e.target.id}`,a)};document.getElementById("axp_tool_number_gridPixel1").addEventListener("change",a),document.getElementById("axp_tool_number_gridPixel2").addEventListener("change",a);const i=document.querySelectorAll(".axpc_toggle_switch");for(const e of i){const t=e.querySelector("input");t.checked?e.dataset.checked="true":e.dataset.checked="false",e.addEventListener("click",()=>{t.checked?(t.checked=!1,e.dataset.checked="false"):(t.checked=!0,e.dataset.checked="true"),this.axpObj.configSystem.saveConfig(`TOGSW_${e.id}`,t.checked)})}const n=document.querySelectorAll(".axp_grid_switch");for(const e of n)e.addEventListener("click",()=>{this.axpObj.updateGrid()});document.getElementById("axp_tool_button_gridConfig").addEventListener("click",e=>{let t="true"===e.target.dataset.selected;e.target.dataset.selected=t?"false":"true",t?l.hide("axp_tool_div_gridConfig"):l.show("axp_tool_div_gridConfig")});const s=document.querySelectorAll(".axp_common_inputcolor");for(const e of s)e.addEventListener("click",e=>{this.elementProcessingColor=e.target;let t=this.elementProcessingColor.dataset.colorcode,a=t.substring(0,7),i=Math.round(100*parseInt(t.substring(7,9),16)/255);const n=document.getElementById("axp_gridconfig_form_gridColor");n.volume.value=i,n.result.value=i,this.colorWheel_subwindow.hex=a,this.axpObj.openSubwindow("axp_gridconfig",e.target)});document.getElementById("axp_gridconfig_range_gridColor").addEventListener("input",()=>{this.changeGridColor()}),document.getElementById("axp_gridconfig").addEventListener("click",()=>{this.elementProcessingColor=null,this.axpObj.closeSubwindow("axp_gridconfig")}),document.querySelector("#axp_gridconfig>div").addEventListener("click",e=>{e.stopPropagation()}),document.getElementById("axp_gridconfig_button_confirm").addEventListener("click",()=>{this.elementProcessingColor=null,this.axpObj.closeSubwindow("axp_gridconfig")})}changeGridColor(){let e=this.colorWheel_subwindow.hex,t=`${e}${Math.trunc(255*document.getElementById("axp_gridconfig_range_gridColor").value/100).toString(16)}`;this.elementProcessingColor.style.backgroundColor=e,this.elementProcessingColor.dataset.colorcode=t,this.axpObj.updateGrid(),this.axpObj.configSystem.saveConfig(`GRIDC_${this.elementProcessingColor.id}`,t)}flip_h(){this.axpObj.layerSystem.flip_h("all"),this.axpObj.msg("@INF1000"),this.axpObj.undoSystem.setUndo({type:"flip_h",id:"all"})}flip_v(){this.axpObj.layerSystem.flip_v("all"),this.axpObj.msg("@INF1002"),this.axpObj.undoSystem.setUndo({type:"flip_v",id:"all"})}grid(){this.isGrid=!this.isGrid,document.getElementById("axp_tool_button_grid").dataset.selected=this.isGrid?"true":"false",this.isGrid?(l.show("axp_canvas_div_grid"),this.axpObj.refreshCanvas()):l.hide("axp_canvas_div_grid");var e=this.isGrid?"表示":"非表示";this.axpObj.msg("@INF1004",e)}transparent(){this.isTransparent=!this.isTransparent,document.getElementById("axp_tool_button_transparent").dataset.selected=this.isTransparent?"true":"false",this.axpObj.layerSystem.draw();var e=this.isTransparent?"透過":"白地";this.axpObj.msg("@INF1005",e),this.axpObj.layerSystem.updateCanvas();let t=document.querySelectorAll("input[name=axp_post_radio_bg]");for(let e of t)"transparent"===e.value?e.checked=this.isTransparent:e.checked=!this.isTransparent}getIsTransparent(){return this.isTransparent}setIsTransparent(e){this.isTransparent=e,document.getElementById("axp_tool_button_transparent").dataset.selected=this.isTransparent?"true":"false",e?document.getElementById("axp_post_radio_bgTransparent").checked=!0:document.getElementById("axp_post_radio_bgWhite").checked=!0}mapguide(){var e=this.axpObj.ELEMENT.view.getBoundingClientRect(),t=this.axpObj.CANVAS.main.getBoundingClientRect(),a=0,i=0,n=0,s=0,o=!1,r=!1;if(t.top<0){const e=Math.abs(t.top),a=120*(1-(t.height-e)/t.height);n=a,i+=parseInt(a),o=!0}var d=t.top+t.height;if(e.height<d){const a=d-e.height,n=120*(1-(t.height-a)/t.height);i+=parseInt(n),o=!0}if(t.left<0){const e=Math.abs(t.left),i=120*(1-(t.width-e)/t.width);s=i,a+=parseInt(i),o=!0}var c=t.left+t.width;if(e.width<c){const i=c-e.width,n=120*(1-(t.width-i)/t.width);a+=parseInt(n),o=!0}o&&(r=!0,(s>120||n>120)&&(r=!1),(120-a<1||120-i<1)&&(r=!1));const p=document.getElementById("axp_tool_div_minimap_line");r?(l.show(p),p.style.left=-1+s+"px",p.style.top=-1+n+"px",p.style.width=121-a+"px",p.style.height=121-i+"px"):l.hide(p)}}a(3088);class Q extends r{constructor(e){super(e)}getDefaultPosition(){return{left:200,top:10}}init(){this.createHTML("axp_custom","CSM",this.axpObj._("@WINDOW.CUSTOM_BUTTONS"),null,'\x3c!-- カスタムボタン --\x3e\n<div class="axpc_window_content">\n    <div id="axp_custom_div_buttons">\n        \x3c!-- メッセージテキストはconfig.jsで自動設定 --\x3e\n        <button class="axpc_MSG axpc_custom_button" data-index="1">1</button>\n        <button class="axpc_MSG axpc_custom_button" data-index="2">2</button>\n        <button class="axpc_MSG axpc_custom_button" data-index="3">3</button>\n    </div>\n</div>',!1),this.window_width=40;const e=this.getDefaultPosition();this.window_left=e.left,this.window_top=e.top}startEvent(){const e=document.querySelectorAll("#axp_custom button");for(const t of e)t.addEventListener("click",()=>{this.axpObj.callTask(`axp_config_custom_button${t.dataset.index}`,null)})}}a(4301);class J extends r{constructor(e){super(e)}minimizeWindowStack=[];getDefaultPosition(){return{left:0,top:0}}init(){this.createHTML("axp_launcher","LAU",this.axpObj._("@WINDOW.LAUNCHER"),null,'\x3c!-- ランチャー --\x3e\r\n<div class="axpc_window_content">\r\n    <div id="axp_launcher_div_buttons">\r\n        \x3c!-- 一括ボタン --\x3e\r\n        <button class="axpc_MSG axpc_launcher_allButton" data-id="axp_all" data-msg="@LAU0001">\r\n            <div class="axpc_icon_window_all_down"></div>\r\n        </button>\r\n        \x3c!-- 個別ボタン外枠 --\x3e\r\n        <div id="axp_launcher_div_personalButtons">\r\n            <div id="axp_launcher_div_personalButtonsEntry">\r\n                \x3c!-- 区切り --\x3e\r\n                <div id="axp_launcher_separator"></div>\r\n                \x3c!-- 個別ボタンは自動生成 --\x3e\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</div>',!1),this.window_width=54;const e=this.getDefaultPosition();this.window_left=e.left,this.window_top=e.top}startEvent(){const e=document.querySelectorAll(".axpc_launcher_personalButton");for(const t of e)t.addEventListener("click",a=>{if(a.target.classList.contains("axpc_launcher_minimize")){if(a.target.classList.remove("axpc_launcher_minimize"),this.axpObj.dragWindow.unminimize(a.target.dataset.id),this.axpObj.configSystem.deleteConfig("WDMIN_"+a.target.dataset.id),document.getElementById("axp_config_checkbox_singleWindowMode").checked)for(const a of e)a.dataset.id!==t.dataset.id&&(a.classList.contains("axpc_launcher_minimize")||(a.classList.add("axpc_launcher_minimize"),this.axpObj.dragWindow.minimize(a.dataset.id),this.axpObj.configSystem.saveConfig("WDMIN_"+a.dataset.id,!0)))}else a.target.classList.add("axpc_launcher_minimize"),this.axpObj.dragWindow.minimize(a.target.dataset.id),this.axpObj.configSystem.saveConfig("WDMIN_"+a.target.dataset.id,!0)});const t=document.querySelector(".axpc_launcher_allButton");t.addEventListener("click",e=>{e.target.classList.contains("axpc_launcher_minimize")?(e.target.classList.remove("axpc_launcher_minimize"),e.target.querySelector("div").classList.remove("axpc_icon_window_all_up"),l.show("axp_launcher_div_personalButtons"),this.axpObj.dragWindow.allVisible(),this.axpObj.configSystem.deleteConfig("WDMIN_"+t.dataset.id)):(e.target.classList.add("axpc_launcher_minimize"),e.target.querySelector("div").classList.add("axpc_icon_window_all_up"),l.hide("axp_launcher_div_personalButtons"),this.axpObj.dragWindow.allHidden(),this.axpObj.configSystem.saveConfig("WDMIN_"+t.dataset.id,!0))}),this.setButtonSize(this.axpObj.config("axp_config_form_minimizeButtonType"))}minimizeButton(e){const t=document.querySelectorAll(".axpc_launcher_personalButton,.axpc_launcher_allButton");for(const a of t)a.dataset.id===e&&(a.classList.add("axpc_launcher_minimize"),"axp_all"===e&&(a.querySelector("div").classList.add("axpc_icon_window_all_up"),l.hide("axp_launcher_div_personalButtons")))}unminimizeButton(e){const t=document.querySelectorAll(".axpc_launcher_personalButton");for(const a of t)a.dataset.id===e&&a.classList.remove("axpc_launcher_minimize")}setButtonSize(e){const t=document.querySelectorAll(".axpc_launcher_personalButton,.axpc_launcher_allButton");for(const a of t)switch(a.classList.remove("axpc_launcher_sizeSmall"),a.classList.remove("axpc_launcher_sizeBig"),e){case"small":a.classList.add("axpc_launcher_sizeSmall");break;case"big":a.classList.add("axpc_launcher_sizeBig")}}setSingleWindowMode(e,t=!1){const a=document.querySelector(".axpc_launcher_allButton");if(a.classList.contains("axpc_launcher_minimize")&&(a.classList.remove("axpc_launcher_minimize"),a.querySelector("div").classList.remove("axpc_icon_window_all_up"),l.show("axp_launcher_div_personalButtons"),this.axpObj.dragWindow.allVisible(),this.axpObj.configSystem.deleteConfig("WDMIN_"+a.dataset.id)),e)if(l.hide(a),l.hide("axp_launcher_separator"),t);else{const e=document.querySelectorAll(".axpc_launcher_personalButton");for(const t of e)t.classList.contains("axpc_launcher_minimize")||(t.classList.add("axpc_launcher_minimize"),this.axpObj.dragWindow.minimize(t.dataset.id),this.axpObj.configSystem.saveConfig("WDMIN_"+t.dataset.id,!0))}else{l.show(a),l.show("axp_launcher_separator");const e=document.querySelectorAll(".axpc_launcher_personalButton");for(const t of e)t.classList.contains("axpc_launcher_minimize")&&(t.classList.remove("axpc_launcher_minimize"),this.axpObj.dragWindow.unminimize(t.dataset.id),this.axpObj.configSystem.deleteConfig("WDMIN_"+t.dataset.id))}}}class ${constructor(e){this.type=e.type,this.detail=e.detail,this.id=e.id,this.layerObj=e.layerObj?new D(e.layerObj):null,this.layerObj_dest=e.layerObj_dest?new D(e.layerObj_dest):null}}class Z{axpObj;undoObj=[];redoObj=[];isUndoing=!1;isRedoing=!1;undoButtonElement=null;redoButtonElement=null;constructor(e){this.axpObj=e}init(){this.setUndoButtonElement(document.getElementById("axp_tool_button_undo")),this.setRedoButtonElement(document.getElementById("axp_tool_button_redo"))}resetCanvas(){this.undoObj.splice(0),this.redoObj.splice(0),this.dispCount()}dispCount(){this.undoButtonElement.textContent=`${this.axpObj._("@MISC.BUTTON_UNDO")}(${this.undoObj.length})`,this.redoButtonElement.textContent=`${this.axpObj._("@MISC.BUTTON_REDO")}(${this.redoObj.length})`}setUndoButtonElement(e){this.undoButtonElement=e}setRedoButtonElement(e){this.redoButtonElement=e}setUndo(e){this.isRedoing||this.redoObj.splice(0),this.undoObj.length>=this.axpObj.undo_max&&this.undoObj.shift();let t=new $(e);this.undoObj.push(t),this.dispCount()}undo(){if(this.undoObj.length<=0)return void this.axpObj.msg("@CAU0400");const e=this.undoObj.pop();this.isUndoing=!0;let t="";switch(e.type){case"draw":t=this.getDetailText(e.detail),this.axpObj.undoSystem.setRedo({type:e.type,detail:e.detail,layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(e.layerObj.id)]}),this.axpObj.layerSystem.setImageId(e.layerObj.image,e.layerObj.id);break;case"layer-create":t="[レイヤー:新規]",this.setRedo(e),this.axpObj.layerSystem.deleteLayer(e.layerObj.id);break;case"layer-copy":t="[レイヤー:複製]",this.setRedo(e),this.axpObj.layerSystem.deleteLayer(e.layerObj.id);break;case"layer-delete":t="[レイヤー:削除]",this.setRedo(e),this.axpObj.layerSystem.restoreLayer(e);break;case"layer-clear":t="[レイヤー:クリア]",this.setRedo(e),this.axpObj.layerSystem.setImageId(e.layerObj.image,e.layerObj.id);break;case"layer-integrate":{t="[レイヤー:統合]",this.axpObj.undoSystem.setRedo({type:e.type,layerObj:e.layerObj,layerObj_dest:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(e.layerObj_dest.id)]}),this.axpObj.layerSystem.restoreLayer(e);let a=e.layerObj_dest;const i=this.axpObj.layerSystem.getLayerIndex(a.id);this.axpObj.layerSystem.layerObj[i].image=a.image,this.axpObj.layerSystem.setAlpha(a.alpha,i);break}case"flip_h":this.setRedo(e),this.axpObj.layerSystem.flip_h(e.id),t="all"==e.id?"[左右反転:全体]":"[左右反転:単体]";break;case"flip_v":this.setRedo(e),this.axpObj.layerSystem.flip_v(e.id),t="all"==e.id?"[上下反転:全体]":"[上下反転:単体]"}this.isUndoing=!1,this.axpObj.msg("@INF0400",t,this.undoObj.length),this.axpObj.layerSystem.updateCanvas(),this.dispCount()}setRedo(e){this.redoObj.length>=this.axpObj.undo_max&&(this.redoObj.shift(),alert("REDO error"));let t=new $(e);this.redoObj.push(t)}redo(){if(this.redoObj.length<=0)return void this.axpObj.msg("@CAU0401");this.isRedoing=!0;const e=this.redoObj.pop();let t="";switch(e.type){case"draw":t=this.getDetailText(e.detail),this.axpObj.undoSystem.setUndo({type:e.type,detail:e.detail,layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(e.layerObj.id)]}),this.axpObj.layerSystem.setImageId(e.layerObj.image,e.layerObj.id);break;case"layer-create":t="[レイヤー:新規]",this.setUndo(e),this.axpObj.layerSystem.restoreLayer(e);break;case"layer-copy":t="[レイヤー:複製]",this.setUndo(e),this.axpObj.layerSystem.restoreLayer(e);break;case"layer-delete":t="[レイヤー:削除]",this.setUndo(e),this.axpObj.layerSystem.deleteLayer(e.layerObj.id);break;case"layer-clear":t="[レイヤー:クリア]",this.setUndo(e),this.axpObj.layerSystem.clear(e.layerObj.id);break;case"layer-integrate":{t="[レイヤー:統合]",this.setUndo({type:e.type,layerObj:e.layerObj,layerObj_dest:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(e.layerObj_dest.id)]});let a=e.layerObj_dest;const i=this.axpObj.layerSystem.getLayerIndex(a.id);this.axpObj.layerSystem.layerObj[i].image=a.image,this.axpObj.layerSystem.setAlpha(a.alpha,i),this.axpObj.layerSystem.deleteLayer(e.layerObj.id);break}case"flip_h":this.setUndo(e),this.axpObj.layerSystem.flip_h(e.id),t="all"==e.id?"[左右反転:全体]":"[左右反転:単体]";break;case"flip_v":this.setUndo(e),this.axpObj.layerSystem.flip_v(e.id),t="all"==e.id?"[上下反転:全体]":"[上下反転:単体]"}this.isRedoing=!1,this.axpObj.msg("@INF0401",t,this.redoObj.length),this.axpObj.layerSystem.updateCanvas(),this.dispCount()}getDetailText(e){let t;switch(e){case"eraser":t="[消しゴム]";break;case"move":t="[移動ツール]";break;case"fill":t="[バケツ]";break;case"fillall":t="[全面塗り潰し]";break;case"rotate90":t="[90°回転]";break;default:t="[線の描画]"}return t}}const ee=(e,t=!1)=>{let a=document.getElementsByTagName("body")[0].appendChild(document.createElement("div"));a.id="axp_alert_div_modalContainer";let i=a.appendChild(document.createElement("div"));i.id="axp_alert_div_alertBox",i.style.visiblity="visible",i.appendChild(document.createElement("h1")).appendChild(document.createTextNode("メッセージ")),i.appendChild(document.createElement("p")).innerText=e;let n=i.appendChild(document.createElement("div"));n.style.display="flex";let s,o=n.appendChild(document.createElement("button"));return o.id="axp_alert_button_closeBtn",o.appendChild(document.createTextNode("Ok")),o.focus(),t?(s=n.appendChild(document.createElement("button")),s.id="axp_alert_button_cancelBtn",s.appendChild(document.createTextNode("キャンセル"))):s=null,{alertObj:i,btn_ok:o,btn_cancel:s}};function te(){document.getElementsByTagName("body")[0].removeChild(document.getElementById("axp_alert_div_modalContainer"))}function ae(e){return new Promise(function(t,a){!function(e,t,a){if(document.getElementById("axp_alert_div_modalContainer"))return;const i=ee(e,!0);i.btn_ok.onclick=function(){te(),t()},i.btn_cancel.onclick=function(){te(),a()},i.alertObj.style.display="block"}(e,t,a)})}a(8886);const ie=[["1","1","func_undo"],["2","2","none"],["3","3","none"]],ne=[["*","ASTERISK","none"],["+","PLUS","func_loupe_up"],[",","COMMA","none"],["-","MINUS","func_loupe_down"],[".","DOT","none"],["/","SLASH","none"],["1","1","none"],["2","2","none"],["3","3","none"],["4","4","none"],["5","5","none"],["6","6","none"],["7","7","none"],["8","8","none"],["9","9","none"],["0","0","func_loupe_reset"],[":","COLON","none"],[";","SEMICOLON","func_loupe_up"],["A","A","none"],["B","B","func_backgroundimage"],["C","C","func_swap_transparent"],["D","D","none"],["E","E","func_size_up"],["F","F","none"],["G","G","func_grid"],["H","H","func_flip_h"],["I","I","func_init_window_positon"],["J","J","none"],["K","K","func_rotate"],["L","L","func_load"],["M","M","func_flip_h"],["N","N","none"],["O","O","none"],["P","P","func_swap_pixelated"],["Q","Q","func_size_change"],["R","R","func_restore"],["S","S","func_save"],["T","T","func_transparent"],["U","U","func_fill_all"],["V","V","func_flip_v"],["W","W","func_size_down"],["X","X","func_swap_maincolor"],["Y","Y","func_redo"],["Z","Z","func_undo"],["Backspace","BACKSPACE","func_undo"],["Enter","ENTER","none"],["↑","ARROWUP","func_scroll_up"],["↓","ARROWDOWN","func_scroll_down"],["←","ARROWLEFT","func_scroll_left"],["→","ARROWRIGHT","func_scroll_right"]],se=new Map;class oe{axpObj;CONST={CANVAS_SIZE_HISTORY_MAX:8};configObj;configCanvasSizeHistory=[];optionlist=[{value:"optgroup",name:"機能無し"},{value:"none",name:"---"},{value:"/optgroup"},{value:"optgroup",name:"ペンツール選択"},{value:"func_switch_pen",name:"選択:ペン"},{value:"func_switch_eraser",name:"選択:消しゴム"},{value:"func_switch_fill",name:"選択:バケツ"},{value:"func_switch_hand",name:"選択:ツール"},{value:"func_switch_spuit",name:"選択:スポイト"},{value:"func_switch_toggle",name:"選択:ペン／消しゴム切替"},{value:"/optgroup"},{value:"optgroup",name:"ペン種別"},{value:"func_switch_axp_penmode_round",name:"ペン種別:丸ペン"},{value:"func_switch_axp_penmode_square",name:"ペン種別:角ペン"},{value:"func_switch_axp_penmode_dot",name:"ペン種別:ドットペン"},{value:"func_switch_axp_penmode_fude",name:"ペン種別:筆ペン"},{value:"func_switch_axp_penmode_crayon",name:"ペン種別:クレヨン"},{value:"func_switch_axp_penmode_brush",name:"ペン種別:エアブラシ"},{value:"/optgroup"},{value:"optgroup",name:"消しゴム種別"},{value:"func_switch_axp_penmode_eraser_round",name:"消しゴム種別:消しゴム"},{value:"func_switch_axp_penmode_eraser_dot",name:"消しゴム種別:角消しゴム"},{value:"/optgroup"},{value:"optgroup",name:"バケツ種別"},{value:"func_switch_axp_penmode_fill",name:"バケツ種別:バケツ"},{value:"func_switch_axp_penmode_fillgradation",name:"バケツ種別:階調バケツ"},{value:"/optgroup"},{value:"optgroup",name:"ツール種別"},{value:"func_switch_axp_penmode_hand",name:"ツール種別:ハンド"},{value:"func_switch_axp_penmode_move",name:"ツール種別:移動ツール"},{value:"/optgroup"},{value:"optgroup",name:"ペンの太さ"},{value:"func_size",name:"ペンの太さ（値指定）"},{value:"func_size_change",name:"ペンの太さ調整"},{value:"func_size_up",name:"ペンの太さを１段階上げる"},{value:"func_size_down",name:"ペンの太さを１段階下げる"},{value:"/optgroup"},{value:"optgroup",name:"ペンの不透明度"},{value:"func_alpha_up",name:"ペンの不透明度を１段階上げる"},{value:"func_alpha_down",name:"ペンの不透明度を１段階下げる"},{value:"/optgroup"},{value:"optgroup",name:"描画色の選択"},{value:"func_switch_maincolor",name:"メインカラーを選択"},{value:"func_switch_subcolor",name:"サブカラーを選択"},{value:"func_switch_transparent",name:"透明色を選択"},{value:"func_swap_maincolor",name:"メイン／サブカラー切替"},{value:"func_swap_transparent",name:"メイン／透過色切替"},{value:"/optgroup"},{value:"optgroup",name:"レイヤー操作"},{value:"func_layer_create",name:"レイヤーの新規作成"},{value:"func_layer_integrate",name:"レイヤーの統合"},{value:"func_layer_copy",name:"レイヤーのコピー"},{value:"func_layer_delete",name:"レイヤーの削除"},{value:"func_layer_clear",name:"レイヤーのクリア"},{value:"func_fill_all",name:"全面塗り潰し"},{value:"func_rotate",name:"90°回転"},{value:"/optgroup"},{value:"optgroup",name:"補助ツール"},{value:"func_undo",name:"アンドゥ"},{value:"func_redo",name:"リドゥ"},{value:"func_restore",name:"自動保存から復元"},{value:"func_save",name:"セーブ"},{value:"func_load",name:"ロード"},{value:"func_flip_h",name:"全レイヤー左右反転"},{value:"func_flip_v",name:"全レイヤー上下反転"},{value:"func_transparent",name:"背景透過"},{value:"func_grid",name:"補助線"},{value:"/optgroup"},{value:"optgroup",name:"拡大率"},{value:"func_loupe",name:"拡大率（値指定）"},{value:"func_loupe_down",name:"拡大率を１段階縮小"},{value:"func_loupe_reset",name:"拡大率とキャンバス位置のリセット"},{value:"func_loupe_up",name:"拡大率を１段階拡大"},{value:"/optgroup"},{value:"optgroup",name:"画面スクロール"},{value:"func_scroll_up",name:"画面を上スクロール"},{value:"func_scroll_down",name:"画面を下スクロール"},{value:"func_scroll_left",name:"画面を左スクロール"},{value:"func_scroll_right",name:"画面を右スクロール"},{value:"/optgroup"},{value:"optgroup",name:"補助線分割数"},{value:"func_grid_up_h",name:"分割数:横を増やす"},{value:"func_grid_down_h",name:"分割数:横を減らす"},{value:"func_grid_up_v",name:"分割数:縦を増やす"},{value:"func_grid_down_v",name:"分割数:縦を減らす"},{value:"/optgroup"},{value:"optgroup",name:"その他"},{value:"func_init_window_positon",name:"ツールウィンドウの位置初期化"},{value:"func_swap_pixelated",name:"キャンバス全体のぼかし切替"},{value:"func_backgroundimage",name:"背景タイルプレビュー"},{value:"func_download",name:"画像をPNG形式でファイルに保存"},{value:"/optgroup"}];constructor(e){this.axpObj=e,this.configObj=new Map}init(){document.getElementById("axp_config").insertAdjacentHTML("afterbegin",this.axpObj.translateHTML('\x3c!-- 設定タブ --\x3e\r\n<div id="axp_config_div_menu">\r\n    <div id="axp_config_div_content">\r\n        <div id="axp_config_div_nav">\r\n            <div id="axp_config_div_navButton">\r\n                <button class="axpc_MSG axpc_ACTIVE" data-msg="@CFG2001">${_("@SETTINGS.MENU_CANVAS")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2002">${_("@SETTINGS.MENU_TOOL_WINDOWS")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2003">${_("@SETTINGS.MENU_PEN_TOOL")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2004">${_("@SETTINGS.MENU_COLOR")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2005">${_("@SETTINGS.MENU_SWATCHES")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2006">${_("@SETTINGS.MENU_LAYER")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2007">${_("@SETTINGS.MENU_MISC")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2008">${_("@SETTINGS.MENU_CUSTOM_BUTTONS")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2009">${_("@SETTINGS.MENU_MOUSE")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2010">${_("@SETTINGS.MENU_TOUCH_PANEL")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2011">${_("@SETTINGS.MENU_KEYBOARD")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2013">${_("@SETTINGS.MENU_STARTUP")}</button>\r\n                <button class="axpc_MSG" data-msg="@CFG2020"\r\n                    id="axp_config_button_version">${_("@SETTINGS.MENU_VER_INFO")}</button>\r\n            </div>\r\n        </div>\r\n        <div class="axpc_config_chapter" id="axp_config_div_pageMain">\r\n            <div class="axpc_config_section" data-title="キャンバス">\r\n                <div class="axpc_config_group" data-title="キャンバスの初期化">\r\n                    <u>画像サイズ</u><br>\r\n                    <div style="display: flex;">\r\n                        <div class="axpc_number axpc_MSG" data-msg="@CFG0300">\r\n                            <label>横\r\n                                <input id="axp_config_number_oekakiWidth" type="number">\r\n                            </label>×\r\n                        </div>\r\n                        <div class="axpc_number axpc_MSG" data-msg="@CFG0301">\r\n                            <label>縦\r\n                                <input id="axp_config_number_oekakiHeight" type="number">[px]\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n                    <span id="axp_config_span_canvasSizeLimit"></span><br>\r\n                    [履歴]<br>\r\n                    <ul id="axp_config_ul_canvasSizeHistory" class="axpc_MSG" data-msg="@CFG0016">\r\n                    </ul>\r\n                    <button id="axp_config_button_newCanvas" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0017">新規キャンバス</button>\r\n                    <br>\r\n                    <button id="axp_config_button_changeCanvasSize" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0018">画像を保持したままサイズ変更</button>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="画像の書き出し">\r\n                    <button class="axpc_MSG axpc_button axpc_button_width260" data-msg="@CFG0019"\r\n                        id="axp_config_button_pngDownload">画像をPNG形式でファイルに保存</button>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="キャンバス全体のぼかし（アンチエイリアシング）">\r\n                    <form id="axp_config_form_antialiasing" class="axpc_radio">\r\n                        <span data-msg="@CFG0020" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0021" data-value="on">あり</span>\r\n                    </form>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="ポインタ座標の表示">\r\n                    <form id="axp_config_form_displayPosition" class="axpc_radio">\r\n                        <span data-msg="@CFG0022" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0023" data-value="upperleft">左上</span>\r\n                        <span data-msg="@CFG0024" data-value="upperright">右上</span>\r\n                        <span data-msg="@CFG0010" data-value="lowerleft">左下</span>\r\n                        <span data-msg="@CFG0025" data-value="lowerright">右下</span>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="ツールウィンドウ">\r\n                <div class="axpc_config_group" data-title="ツールウィンドウ位置の自動調整">\r\n                    <form id="axp_config_form_windowAutoAdjust" class="axpc_radio">\r\n                        <span data-msg="@CFG0028" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0029" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="位置初期化">\r\n                    <button id="axp_config_button_resetWindow" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0030">全ウィンドウ位置の初期化</button>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="表示ウィンドウ">\r\n                    <u>アイコンサイズ</u>\r\n                    <form id="axp_config_form_minimizeButtonType" class="axpc_radio">\r\n                        <span data-msg="@CFG0036" data-value="small">小</span>\r\n                        <span data-msg="@CFG0036" data-value="medium" data-default="y">中</span>\r\n                        <span data-msg="@CFG0036" data-value="big">大</span>\r\n                    </form>\r\n                    <div style="margin-top: 8px;"></div>\r\n                    <div class="axpc_checkbox axpc_MSG" data-msg="@CFG0037">\r\n                        <label>\r\n                            <input id="axp_config_checkbox_singleWindowMode" class="axpc_SAVE"\r\n                                type="checkbox">単一ウィンドウモードを使用する\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="ペンツール" data-icon="axpc_icon_window_pen">\r\n                <div class="axpc_config_group" data-title="手ぶれ補正">\r\n                    <u>補正の強さ</u>\r\n                    <form id="axp_config_form_stabilizerValue" oninput="result.value=parseInt(volume.value)"\r\n                        class="axpc_range axpc_range_width228 axpc_SAVE">\r\n                        <input type="range" name="volume" value="2" step="1" min="0" max="10" class="axpc_MSG"\r\n                            data-msg="@CFG0040">\r\n                        <div class="axpc_range_label axpc_text_border">手ぶれ補正</div>\r\n                        <div class="axpc_range_value axpc_text_border"><output name="result">2</output></div>\r\n                    </form>\r\n                    <div style="margin-top: 4px;"></div>\r\n                    <div class="axpc_checkbox axpc_MSG" data-msg="@CFG0041">\r\n                        <label>\r\n                            <input id="axp_config_checkbox_stabilize" class="axpc_SAVE"\r\n                                type="checkbox">ペンツールウィンドウ内にレンジスライダーを表示する\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="スポイト">\r\n                    <u>使用後ペンに切り替える</u>\r\n                    <form id="axp_config_form_autoChangeSpuitToPen" class="axpc_radio">\r\n                        <span data-msg="@CFG0043" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0044" data-value="on">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>長押しスポイト</u>\r\n                    <form id="axp_config_form_useLongtap" class="axpc_radio">\r\n                        <span data-msg="@CFG0045" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0046" data-value="on">あり</span>\r\n                    </form>\r\n                    <div style="margin-top: 16px;"></div>\r\n                    <form id="axp_config_form_longtapDurationValue" oninput="result.value=parseInt(volume.value)"\r\n                        class="axpc_range axpc_range_width228 axpc_SAVE">\r\n                        <input type="range" name="volume" value="700" step="100" min="500" max="1500" class="axpc_MSG"\r\n                            data-msg="@CFG0047">\r\n                        <div class="axpc_range_label axpc_text_border">長押し反応時間</div>\r\n                        <div class="axpc_range_value axpc_text_border"><output name="result">700</output></div>[ミリ秒]\r\n                    </form>\r\n                    <form id="axp_config_form_longtapStabilizerValue" oninput="result.value=parseInt(volume.value)"\r\n                        class="axpc_range axpc_range_width228 axpc_SAVE">\r\n                        <input type="range" name="volume" value="5" step="1" min="0" max="10" class="axpc_MSG"\r\n                            data-msg="@CFG0048">\r\n                        <div class="axpc_range_label axpc_text_border">長押し受付範囲</div>\r\n                        <div class="axpc_range_value axpc_text_border"><output name="result">5</output></div>[px]\r\n                    </form>\r\n                    （※長押し操作が反応しない場合、受付範囲を大きくしてください）\r\n                </div>\r\n                <div class="axpc_config_group" data-title="レンジスライダー">\r\n                    <u>ぼかし度</u>\r\n                    <form id="axp_config_form_blurLevel" class="axpc_radio">\r\n                        <span data-msg="@CFG0200" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0201" data-value="on">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>トーン濃度</u>\r\n                    <form id="axp_config_form_ToneLevel" class="axpc_radio">\r\n                        <span data-msg="@CFG0049" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0050" data-value="on">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>太さと不透明度の表示順序</u>\r\n                    <form id="axp_config_form_pentoolRangeOrder" class="axpc_radio">\r\n                        <span data-msg="@CFG0051" data-value="size" data-default="y">太さ->不透明度</span>\r\n                        <span data-msg="@CFG0052" data-value="alpha">不透明度->太さ</span>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="色作成" data-icon="axpc_icon_window_colormaker">\r\n                <div class="axpc_config_group" data-title="使用する色作成ツール">\r\n                    <u>混色パレット</u>\r\n                    <form id="axp_config_form_makeColorTypeMixed" class="axpc_radio">\r\n                        <span data-msg="@CFG0053" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0054" data-value="on">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>RGBスライダー</u>\r\n                    <form id="axp_config_form_makeColorTypeRGB" class="axpc_radio">\r\n                        <span data-msg="@CFG0055" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0056" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>カラーピッカー</u>\r\n                    <form id="axp_config_form_makeColorTypePicker" class="axpc_radio">\r\n                        <span data-msg="@CFG0057" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0058" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="パレット" data-icon="axpc_icon_window_palette">\r\n                <div class="axpc_config_group" data-title="パレットのレイアウト">\r\n                    <u>横幅（列の数）</u><br>\r\n                    <form id="axp_config_form_paletteColumnValue" class="axpc_range axpc_range_width228">\r\n                        \x3c!-- axpc_SAVE 対象外 --\x3e\r\n                        <input type="range" class="axpc_MSG" name="volume" value="3" step="1" min="1" max="24"\r\n                            data-msg="@CFG0063">\r\n                        <div class="axpc_range_label axpc_text_border">横幅</div>\r\n                        <div class="axpc_range_value axpc_text_border"><output name="result"></output></div>[列]\r\n                    </form>\r\n                    <div style="margin-top: 4px;"></div>\r\n                    <div class="axpc_checkbox axpc_MSG" data-msg="@CFG0062">\r\n                        <label>\r\n                            <input id="axp_config_checkbox_paletteColumnEdit" class="axpc_SAVE" type="checkbox"\r\n                                checked>パレット編集モード時にレンジスライダーを表示する\r\n                        </label>\r\n                    </div>\r\n                    <div style="margin-top: 8px;"></div>\r\n                    \x3c!-- カラーパレットを表示するためのエリア --\x3e\r\n                    <div id="axp_config_div_paletteText"></div>\r\n                    <div id="axp_config_div_paletteScroll">\r\n                        <div id="axp_config_div_paletteBox"></div>\r\n                    </div>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="パレットのインポート・エクスポート／初期化">\r\n                    <button id="axp_config_button_saveColor" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0064">パレットファイルに保存</button>\r\n                    <br>\r\n                    <button id="axp_config_button_loadColor" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0065">パレットファイルの読込</button>\r\n                    <br>\r\n                    <button id="axp_config_button_resetColor" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0066">パレットの初期化</button>\r\n                    <input type="file" id="axp_config_file_loadColor" accept=".txt" style="display: none;">\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="レイヤー" data-icon="axpc_icon_window_layer">\r\n                <div class="axpc_config_group" data-title="合成モードの表示">\r\n                    <form id="axp_config_form_blendModeDisplayType" class="axpc_radio">\r\n                        <span data-msg="@CFG0120" data-value="none">なし</span>\r\n                        <span data-msg="@CFG0121" data-value="all">全表示</span>\r\n                        <span data-msg="@CFG0122" data-value="unusual" data-default="y">通常以外表示</span>\r\n                    </form>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="レイヤー名の登録">\r\n                    レイヤー名の変更時、文字入力の代わりに登録した名前を使用できます。\r\n                    <div id="axp_config_div_colorTag" class="axpc_MSG" data-msg="@CFG0123"></div>\r\n                    <button id="axp_config_button_resetColorTag" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0124">レイヤー名の初期化</button>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="補助ツール" data-icon="axpc_icon_window_subtool">\r\n                <div class="axpc_config_group" data-title="アンドゥ／リドゥ可能回数">\r\n                    <form id="axp_config_form_undoMaxValue" oninput="result.value=parseInt(volume.value)"\r\n                        class="axpc_range axpc_range_width228 axpc_SAVE">\r\n                        <input type="range" name="volume" value="25" step="1" min="10" max="50" class="axpc_MSG"\r\n                            data-msg="@CFG0067">\r\n                        <div class="axpc_range_label axpc_text_border">回数</div>\r\n                        <div class="axpc_range_value axpc_text_border"><output name="result">25</output></div>[回]\r\n                    </form>\r\n                    （※変更した値を有効にするにはAXNOS Paintを再起動する必要があります）\r\n                </div>\r\n                <div class="axpc_config_group" data-title="拡大率">\r\n                    <div id="axp_config_div_scale">\r\n                        <div id="axp_config_div_scaleButton">\r\n                            <input id="axp_config_number_scale" type="number" maxlength="3" min="25" max="1600"\r\n                                value="125" size="5" class="axpc_MSG" data-msg="@CFG0211">\r\n                            <span>[%]</span>\r\n                            <button id="axp_config_button_addScale" class="axpc_MSG axpc_button"\r\n                                data-msg="@CFG0070">追加</button>\r\n                        </div>\r\n                        （※最小25～最大1600）\r\n                        <button id="axp_config_button_deleteScale" class="axpc_MSG axpc_button"\r\n                            data-msg="@CFG0071">選択した拡大率を削除</button>\r\n                        <ul id="axp_config_ul_scale" class="axpc_MSG" data-msg="@CFG0212">\r\n                        </ul>\r\n                        <button id="axp_config_button_resetScale" class="axpc_MSG axpc_button"\r\n                            data-msg="@CFG0072">拡大率の初期化</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="カスタムボタン">\r\n                <div class="axpc_config_group" data-title="カスタムボタンと機能割り当て">\r\n                    <u>ボタンの表示</u>\r\n                    <form id="axp_config_form_useCustomButton" class="axpc_radio">\r\n                        <span data-msg="@CFG0080" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0081" data-value="on">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <div id="axp_config_div_customButtonFunction">\r\n                        <table id="axp_config_table_customButton" class="axpc_MSG axpc_config_table"\r\n                            data-msg="@CFG0112">\r\n                            <thead>\r\n                                <tr>\r\n                                    <th>ボタン</th>\r\n                                    <th>機能</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="マウス">\r\n                <div class="axpc_config_group" data-title="マウス右ボタン">\r\n                    <form id="axp_config_form_mouseRightButton" class="axpc_radio">\r\n                        <span data-msg="@CFG0082" data-value="none">なし</span>\r\n                        <span data-msg="@CFG0083" data-value="undo" data-default="y">アンドゥ</span>\r\n                        <span data-msg="@CFG0084" data-value="spuit">スポイト</span>\r\n                        <span data-msg="@CFG0085" data-value="hand">ハンド</span>\r\n                        <span data-msg="@CFG0086" data-value="loupe">拡大率100%</span>\r\n                        <span data-msg="@CFG0087" data-value="swapcolor">ﾒｲﾝ色切替</span>\r\n                        <span data-msg="@CFG0088" data-value="swaptrans">透明色切替</span>\r\n                        <span data-msg="@CFG0400" data-value="transdraw">透明色描画</span>\r\n                    </form>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="マウスホイールボタン">\r\n                    <form id="axp_config_form_mouseWheelButton" class="axpc_radio">\r\n                        <span data-msg="@CFG0082" data-value="none">なし</span>\r\n                        <span data-msg="@CFG0083" data-value="undo">アンドゥ</span>\r\n                        <span data-msg="@CFG0084" data-value="spuit" data-default="y">スポイト</span>\r\n                        <span data-msg="@CFG0085" data-value="hand">ハンド</span>\r\n                        <span data-msg="@CFG0086" data-value="loupe">拡大率100%</span>\r\n                        <span data-msg="@CFG0087" data-value="swapcolor">ﾒｲﾝ色切替</span>\r\n                        <span data-msg="@CFG0088" data-value="swaptrans">透明色切替</span>\r\n                        <span data-msg="@CFG0400" data-value="transdraw">透明色描画</span>\r\n                    </form>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="マウスホイール回転">\r\n                    <form id="axp_config_form_mouseWheelRotate" class="axpc_radio">\r\n                        <span data-msg="@CFG0089" data-value="none">なし</span>\r\n                        <span data-msg="@CFG0090" data-value="loupe" data-default="y">拡大/縮小</span>\r\n                        <span data-msg="@CFG0091" data-value="scroll">スクロール</span>\r\n                    </form>\r\n                    <div class="axpc_checkbox axpc_MSG" data-msg="@CFG0220">\r\n                        <label>\r\n                            <input id="axp_config_checkbox_mouseWheelDirection" class="axpc_SAVE" type="checkbox">回転方向反転\r\n                        </label>\r\n                    </div>\r\n                    <div class="axpc_checkbox axpc_MSG" data-msg="@CFG0223">\r\n                        <label>\r\n                            <input id="axp_config_checkbox_mouseWheelPointerTracking" class="axpc_SAVE" type="checkbox"\r\n                                checked>ポインタ位置を中心に拡大／縮小\r\n                        </label>\r\n                    </div>\r\n                    <div class="axpc_number axpc_MSG" data-msg="@CFG0221">\r\n                        <label>スクロール移動量\r\n                            <input id="axp_config_number_mouseWheelMoveSize" class="axpc_SAVE" type="number" min="1"\r\n                                max="100" value="30">[px]（※最小1～最大100）\r\n                        </label>\r\n                    </div>\r\n                    <div class="axpc_number axpc_MSG" data-msg="@CFG0222">\r\n                        <label>連続入力抑止時間\r\n                            <input id="axp_config_number_mouseWheelSleepTime" class="axpc_SAVE" type="number" min="0"\r\n                                max="500" value="0">[ミリ秒]\r\n                        </label>\r\n                    </div>\r\n                    （※最小0～最大500。0を指定すると入力抑止を行いません。<br>\r\n                    　タッチパッドのホイール操作感度が高すぎる場合に設定してください）\r\n                </div>\r\n                <div class="axpc_config_group" data-title="タッチパッド">\r\n                    <u>キャンバスの拡大／縮小</u>（ピンチアウト／ピンチイン）\r\n                    <form id="axp_config_form_mouseWheelZoom" class="axpc_radio">\r\n                        <span data-msg="@CFG0097" data-value="off" data-default="y">なし</span>\r\n                        <span data-msg="@CFG0098" data-value="on">あり</span>\r\n                    </form>\r\n                    （※「あり」設定時、環境によってマウスホイールと競合する場合があります）\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="タッチパネル">\r\n                <div class="axpc_config_group" data-title="タッチ操作">\r\n                    <u>機能割り当て</u>（１本指タッチ）\r\n                    <form id="axp_config_form_touchDrawType" class="axpc_radio">\r\n                        <span data-msg="@CFG0092" data-value="none">なし</span>\r\n                        <span data-msg="@CFG0093" data-value="draw" data-default="y">描画</span>\r\n                        <span data-msg="@CFG0094" data-value="hand">ハンド</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>キャンバスの移動</u>（２本指スワイプ）\r\n                    <form id="axp_config_form_touchHand" class="axpc_radio">\r\n                        <span data-msg="@CFG0095" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0096" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>キャンバスの拡大／縮小</u>（ピンチ操作）\r\n                    <form id="axp_config_form_touchZoom" class="axpc_radio">\r\n                        <span data-msg="@CFG0097" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0098" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="タップ操作">\r\n                    <u>アンドゥ</u>（２本指タップ）\r\n                    <form id="axp_config_form_touchUndo" class="axpc_radio">\r\n                        <span data-msg="@CFG0099" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0100" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>リドゥ</u>（３本指タップ）\r\n                    <form id="axp_config_form_touchRedo" class="axpc_radio">\r\n                        <span data-msg="@CFG0101" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0102" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                    <div style="margin-top: 16px;"></div>\r\n                    <form id="axp_config_form_touchDurationValue" oninput="result.value=parseInt(volume.value)"\r\n                        class="axpc_range axpc_range_width228 axpc_SAVE">\r\n                        <input type="range" name="volume" value="300" step="100" min="100" max="1000" class="axpc_MSG"\r\n                            data-msg="@CFG0103">\r\n                        <div class="axpc_range_label axpc_text_border">タップ制限時間</div>\r\n                        <div class="axpc_range_value axpc_text_border"><output name="result">300</output></div>[ミリ秒]\r\n                    </form>\r\n                    <form id="axp_config_form_touchThresholdValue" oninput="result.value=parseInt(volume.value)"\r\n                        class="axpc_range axpc_range_width228 axpc_SAVE">\r\n                        <input type="range" name="volume" value="5" step="1" min="0" max="10" class="axpc_MSG"\r\n                            data-msg="@CFG0401">\r\n                        <div class="axpc_range_label axpc_text_border">タップ受付範囲</div>\r\n                        <div class="axpc_range_value axpc_text_border"><output name="result">5</output></div>[px]\r\n                    </form>\r\n                    （※タップ操作が反応しない場合、受付範囲を大きくしてください）\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="キーボード">\r\n                <div class="axpc_config_group" data-title="ショートカットと機能割り当て">\r\n                    <div class="axpc_checkbox axpc_MSG" data-msg="@CFG0111">\r\n                        <label>\r\n                            <input id="axp_config_checkbox_shortcutKeyHiddenNofunc" class="axpc_SAVE"\r\n                                type="checkbox">割り当て無しのキーを非表示にする\r\n                        </label>\r\n                    </div>\r\n                    <div style="margin-top: 8px;"></div>\r\n                    <table id="axp_config_table_shortcutKey" class="axpc_MSG axpc_config_table" data-msg="@CFG0112">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>キー</th>\r\n                                <th>機能</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr>\r\n                                <td>[ SPACE ]</td>\r\n                                <td>ハンドツール</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[ SHIFT ]</td>\r\n                                <td>直線</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[ CTRL ]</td>\r\n                                <td>スポイト</td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="ショートカットのインポート・エクスポート／初期化">\r\n                    <button id="axp_config_button_saveShortcut" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0113">ショートカットファイルに保存</button>\r\n                    <br>\r\n                    <button id="axp_config_button_loadShortcut" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0114">ショートカットファイルの読込</button>\r\n                    <br>\r\n                    <button id="axp_config_button_resetShortcut" class="axpc_MSG axpc_button axpc_button_width260"\r\n                        data-msg="@CFG0115">ショートカットの初期化</button>\r\n                    <input type="file" id="axp_config_file_loadShortcut" accept=".txt" style="display: none;">\r\n                </div>\r\n                <div class="axpc_config_group" data-title="画面スクロール">\r\n                    <div class="axpc_checkbox axpc_MSG" data-msg="@CFG0230">\r\n                        <label>\r\n                            <input id="axp_config_checkbox_moveDirection" class="axpc_SAVE" type="checkbox">スクロール方向反転\r\n                        </label>\r\n                    </div>\r\n                    <div class="axpc_number axpc_MSG" data-msg="@CFG0108">\r\n                        <label>スクロール移動量\r\n                            <input id="axp_config_number_moveSize" class="axpc_SAVE" type="number" min="1" max="100"\r\n                                value="30">[px]（※最小1～最大100）\r\n                        </label>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="起動時">\r\n                <div class="axpc_config_group" data-title="前回の状態の復元">\r\n                    <u>ツールウィンドウ位置</u>\r\n                    <form id="axp_config_form_saveLastWindowPosition" class="axpc_radio">\r\n                        <span data-msg="@CFG0026" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0027" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>ペンツールの設定値</u>\r\n                    <form id="axp_config_form_saveLastPenValue" class="axpc_radio">\r\n                        <span data-msg="@CFG0034" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0035" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                    <br>\r\n                    <u>カラーパレットの色</u>\r\n                    <form id="axp_config_form_saveLastPalleteColor" class="axpc_radio">\r\n                        <span data-msg="@CFG0059" data-value="off">なし</span>\r\n                        <span data-msg="@CFG0060" data-value="on" data-default="y">あり</span>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n            <div class="axpc_config_section" data-title="バージョン情報" id="axp_config_div_version">\r\n                <div class="axpc_config_group" data-title="バージョン情報">\r\n                    <div id="axp_config_div_versionInfo"></div>\r\n                    © 2022 「悪の巣」部屋番号13番：「趣味の悪い大衆酒場[Mad end dance hall]」<br>\r\n                    <br>\r\n                    ◆ github<br>\r\n                    <a href="https://github.com/axnospaint/axnospaint-lib" target="_blank" rel="noopener"\r\n                        style="text-decoration: none;color:#00f;overflow-wrap: break-word;">\r\n                        https://github.com/axnospaint/axnospaint-lib</a>\r\n                    <br><br>\r\n\r\n                    ◆ Petit Note用改造版<br>\r\n                    <a href="https://github.com/satopian/axnospaint_for_Petit_Note" target="_blank" rel="noopener"\r\n                        style="text-decoration: none;color:#00f;overflow-wrap: break-word;">\r\n                        https://github.com/satopian/axnospaint_for_Petit_Note</a>\r\n                    <br><br>\r\n                    ◆ AXNOS Paint:ヘルプ - ニコニコ大百科<br>\r\n                    <a href="https://dic.nicovideo.jp/id/5703111" target="_blank" rel="noopener"\r\n                        style="text-decoration: none;color:#00f">\r\n                        https://dic.nicovideo.jp/id/5703111</a>\r\n                    <br>\r\n                </div>\r\n                <div class="axpc_config_group" data-title="デバッグ情報表示">\r\n                    <details>\r\n                        <summary><span style="color:#f00"><b>※不具合発生時の動作検証用です。通常時は使用しないでください。</b></span></summary>\r\n                        <div class="axpc_checkbox axpc_MSG" data-msg="チェックするとデバッグモードを有効になります。">\r\n                            <label>\r\n                                <input id="axp_config_checkbox_useDebugMode" class="axpc_SAVE"\r\n                                    type="checkbox">デバッグ情報を表示する\r\n                            </label>\r\n                        </div>\r\n                    </details>\r\n                </div>\r\n            </div>\r\n            <div style="height: calc(100vh);"></div>\r\n            <div class="axpc_config_section" data-title="ページの終端です。">\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>')),document.getElementById("axp_config_div_versionInfo").textContent=`${this.axpObj.CONST.APP_TITLE} version 2.4.0 (2026-01-10T08:13:09.457Z)`}deployHTML(){const e=document.querySelectorAll(".axpc_config_section");for(const t of e){const e=document.createElement("div");e.setAttribute("class","axpc_config_sectionHeader");const a=document.createElement("span");t.dataset.icon&&(a.classList.add("axpc_icon_span"),a.classList.add(t.dataset.icon));const i=document.createElement("span");i.textContent=t.dataset.title,e.appendChild(a),e.appendChild(i),t.insertAdjacentElement("afterbegin",e)}const t=document.querySelectorAll(".axpc_config_group");for(const e of t){const t=document.createElement("div");t.setAttribute("class","axpc_config_groupHeader"),t.textContent=e.dataset.title,e.insertAdjacentElement("beforebegin",t)}const a=document.querySelectorAll(".axpc_radio");for(const e of a){e.classList.add("axpc_SAVE");const t=e.querySelectorAll("span");for(let a=0;a<t.length;a++){const i=document.createElement("input"),n=`${e.id}${a}`;i.setAttribute("type","radio"),i.setAttribute("id",n),i.setAttribute("name",e.id),i.setAttribute("value",t[a].dataset.value),t[a].dataset.default&&(i.checked=!0),e.appendChild(i);const s=document.createElement("label");s.setAttribute("for",n),s.setAttribute("class","axpc_MSG"),s.dataset.msg=t[a].dataset.msg,s.textContent=t[a].textContent,e.appendChild(s)}}const i=document.querySelector("#axp_config_table_customButton>tbody");for(let e=0;e<ie.length;e++){let t=this.createKeyConfigHTML("button",ie[e]);t.dataset.linkIndex=e+1,i.appendChild(t),this.selectCustom(t.id)}const n=document.querySelector("#axp_config_table_shortcutKey>tbody");for(let e=0;e<ne.length;e++){let t=this.createKeyConfigHTML("key",ne[e]);n.appendChild(t),this.selectCustom(t.id)}}startEvent(){const e=e=>{const t=document.querySelector("#axp_config_div_navButton .axpc_ACTIVE");null!==t&&t.classList.remove("axpc_ACTIVE"),e.classList.add("axpc_ACTIVE")},t={root:document.querySelector("#axp_config_div_pageMain"),rootMargin:"0px 0px -100% 0px",threshold:0},a=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const a=document.querySelector(`#axp_config_div_navButton > button:nth-of-type(${t.target.dataset.idx})`);e(a)}})},t),i=document.querySelectorAll(".axpc_config_section");for(let e=0;e<i.length-1;e++)i[e].dataset.idx=e+1,a.observe(i[e]);const n=document.querySelectorAll("#axp_config_div_navButton button"),s=document.querySelectorAll(".axpc_config_section");for(let t=0;t<n.length;t++)n[t].addEventListener("click",a=>{"Safari"===this.axpObj.browser?s[t].scrollIntoView({behavior:"smooth"}):(s[t].scrollIntoView(),e(a.target))});const o=document.getElementsByClassName("axpc_SAVE");for(const e of o)e.addEventListener("change",e=>{switch(e.target.type){case"range":this.saveConfig(`RANGE_${e.currentTarget.id}`,e.target.value);break;case"checkbox":this.saveConfig(`CHECK_${e.currentTarget.id}`,e.target.checked);break;case"radio":this.saveConfig(`RADIO_${e.currentTarget.id}`,e.target.value);break;case"number":{let t=Number(e.target.value);isNaN(t)&&(t=e.target.min),t=x(Number(t),e.target.min,e.target.max),e.target.value=t,this.saveConfig(`VALUE_${e.target.id}`,t);break}}});document.getElementById("axp_config_span_canvasSizeLimit").textContent=`(※最小${this.axpObj.minWidth}×${this.axpObj.minHeight} ～ 最大${this.axpObj.maxWidth}×${this.axpObj.maxHeight})`;const r=document.getElementById("axp_config_number_oekakiWidth");r.min=this.axpObj.minWidth,r.max=this.axpObj.maxWidth,r.value=this.axpObj.x_size;const l=document.getElementById("axp_config_number_oekakiHeight");l.min=this.axpObj.minHeight,l.max=this.axpObj.maxHeight,l.value=this.axpObj.y_size,r.onchange=()=>{r.value=this.axpObj.checkCanvasSize_x(r.value)},l.onchange=()=>{l.value=this.axpObj.checkCanvasSize_y(l.value)},document.getElementById("axp_config_button_newCanvas").onclick=()=>{let e=r.value=this.axpObj.checkCanvasSize_x(r.value),t=l.value=this.axpObj.checkCanvasSize_y(l.value);ae(`現在の描画内容を破棄して新規キャンバス（${e}×${t}）を作成します。\nよろしいですか？\n（※この処理はアンドゥできません）`).then(()=>{this.axpObj.selectTab("0"),this.axpObj.setCanvasSize(e,t),this.axpObj.resetCanvas(),this.axpObj.layerSystem.newLayer(),this.axpObj.layerSystem.updateCanvas(),this.addCanvasSizeHistory(e,t),this.updateCanvasSizeHistory(),this.axpObj.oekaki_id=null,this.axpObj.draftImageFile=null,this.axpObj.oekaki_bbs_pageno=null,this.axpObj.oekaki_bbs_title=null,alert(`新規キャンバスを作成しました。横:${e} 縦:${t}`)}).catch(()=>{})},document.getElementById("axp_config_button_changeCanvasSize").onpointerdown=()=>{if(this.axpObj.restrictDraftCanvasResizing&&(null!==this.axpObj.oekaki_id||null!==this.axpObj.draftImageFile))return void alert("下書き機能を利用したキャンバスは、サイズの変更ができません。");let e=r.value=this.axpObj.checkCanvasSize_x(r.value),t=l.value=this.axpObj.checkCanvasSize_y(l.value);ae(`キャンバスサイズを${e}×${t}に変更します。\nよろしいですか？\n（※この処理はアンドゥできません）`).then(()=>{this.axpObj.selectTab("0");var a=this.axpObj.layerSystem.layerObj.map(e=>({...e}));this.axpObj.setCanvasSize(e,t);const i=document.createElement("canvas");i.width=e,i.height=t;const n=i.getContext("2d",{willReadFrequently:!0});for(let i of a)n.clearRect(0,0,e,t),n.putImageData(i.image,0,0),i.image=n.getImageData(0,0,e,t);var s={version:this.axpObj.saveSystem.CONST.DATA_VERSION,id:null,created:null,src:null,x_max:e,y_max:t,counter:this.axpObj.layerSystem.layer_counter,layer:a,transparent:this.axpObj.assistToolSystem.getIsTransparent()};this.axpObj.saveSystem.restoreData(s),a=null,s=null,this.addCanvasSizeHistory(e,t),this.updateCanvasSizeHistory(),alert(`キャンバスサイズを変更しました。横:${e} 縦:${t}`)}).catch(()=>{})},document.getElementById("axp_config_form_antialiasing").onchange=()=>{this.set_canvas_antialiasing()},document.getElementById("axp_config_button_pngDownload").onmousedown=()=>{this.axpObj.TASK.func_download()},document.getElementById("axp_config_form_displayPosition").onchange=()=>{this.set_display_position()},document.getElementById("axp_config_button_resetWindow").addEventListener("click",()=>{this.axpObj.dragWindow.resetPosition(),alert("全ウィンドウ位置を初期化しました。")}),document.getElementById("axp_config_form_windowAutoAdjust").onchange=()=>{this.axpObj.dragWindow.changeAutoAdjustPosition()},document.getElementById("axp_config_form_minimizeButtonType").onchange=e=>{this.axpObj.launcher.setButtonSize(e.target.value)},document.getElementById("axp_config_checkbox_singleWindowMode").onchange=e=>{this.axpObj.launcher.setSingleWindowMode(e.target.checked)},document.getElementById("axp_config_form_ToneLevel").onchange=()=>{this.axpObj.penSystem.changePenMode()},document.getElementById("axp_config_form_blurLevel").onchange=()=>{this.axpObj.penSystem.changePenMode()},document.getElementById("axp_config_form_pentoolRangeOrder").onchange=()=>{this.axpObj.penSystem.changeOrderSlider()},document.getElementById("axp_config_checkbox_stabilize").onchange=()=>{this.axpObj.penSystem.changePenMode()},document.getElementById("axp_config_form_stabilizerValue").onchange=e=>{document.getElementById("axp_pen_form_stabilizer").volume.value=e.target.value,document.getElementById("axp_pen_form_stabilizer").result.value=e.target.value},document.getElementById("axp_pen_form_stabilizer").onchange=e=>{document.getElementById("axp_config_form_stabilizerValue").volume.value=e.target.value,document.getElementById("axp_config_form_stabilizerValue").result.value=e.target.value,this.saveConfig("RANGE_axp_config_form_stabilizerValue",e.target.value)},document.getElementById("axp_config_form_useLongtap").onchange=()=>{this.set_longtap_use()},this.set_longtap_use(),document.getElementById("axp_config_form_makeColorTypeRGB").addEventListener("change",()=>{this.axpObj.colorMakerSystem.updateMakeColorType()}),document.getElementById("axp_config_form_makeColorTypePicker").addEventListener("change",()=>{this.axpObj.colorMakerSystem.updateMakeColorType()}),document.getElementById("axp_config_form_makeColorTypeMixed").addEventListener("change",()=>{this.axpObj.colorMakerSystem.updateMakeColorType()}),document.getElementById("axp_config_form_paletteColumnValue").addEventListener("input",e=>{this.axpObj.colorPaletteSystem.setPaletteColumn(e.target.value)}),document.getElementById("axp_config_button_saveColor").onclick=()=>{let e=new Array;e.push("column,"+this.axpObj.colorPaletteSystem.currentPalette.column+"\n");for(const t of this.axpObj.colorPaletteSystem.currentPalette.palette)e.push(t+"\n");var t="ap_color"+g(new Date,"YYYYMMDD_hhmmss")+".txt",a=new Blob(e,{type:"text/plain"}),i=document.createElement("a");i.href=URL.createObjectURL(a),i.download=t,i.click()},document.getElementById("axp_config_button_loadColor").onclick=()=>{document.getElementById("axp_config_file_loadColor").click()},document.getElementById("axp_config_file_loadColor").onclick=e=>{e.target.value=""},document.getElementById("axp_config_file_loadColor").onchange=e=>{var t=e.target.files;if(0!==t.length){var a=new FileReader;a.readAsText(t[0]),a.onload=()=>{var e=a.result.split(/\r\n|\n/),t=e.length-1;if(0===t)return void alert("有効なデータファイルではありません。");let i={column:5,palette:[]};for(var n=0;n<t;n++){let t=e[n];if("column"===t.substr(0,6)){let e=t.split(",")[1];if(isNaN(e)||!m(Number(e),0,this.axpObj.colorPaletteSystem.CONST.COLOR_MAX))return void alert("columnが不正な値のため、読込を中止しました。\n行数:"+(n+1)+" 内容:"+t);i.column=Number(e);continue}if("side"===t.substr(0,4))continue;if(i.palette.length>=this.axpObj.colorPaletteSystem.CONST.COLOR_MAX)break;let a=t;if(!b(a))return void alert("カラーコードに誤りがあるため、読込を中止しました。\n行数:"+(n+1)+" 内容:"+t);i.palette.push(a)}0!==i.palette.length?(this.axpObj.colorPaletteSystem.setPaletteArray(i.palette),this.axpObj.colorPaletteSystem.currentPalette.column=i.column,this.axpObj.colorPaletteSystem.createPalette(),this.dispPalettebox(document.getElementById("axp_config_div_paletteBox"),i),this.axpObj.saveSystem.save_palette(i.palette),this.axpObj.configSystem.saveConfig("PLTCO",i.column),alert("カラーパレットを正常に読み込みました。\nパレット数:"+i.palette.length)):alert("パレットデータが１色もありません。")}}},document.getElementById("axp_config_button_resetColor").onclick=()=>{ae("カラーパレットを初期状態に戻します。\nよろしいですか？\n（※この処理はアンドゥできません）").then(()=>{this.axpObj.colorPaletteSystem.setPaletteArray(),this.axpObj.colorPaletteSystem.createPalette(),this.dispPalettebox(document.getElementById("axp_config_div_paletteBox"),this.axpObj.colorPaletteSystem.currentPalette),this.axpObj.saveSystem.save_palette(this.axpObj.colorPaletteSystem.currentPalette.palette),this.axpObj.configSystem.saveConfig("PLTCO",this.axpObj.colorPaletteSystem.currentPalette.column),alert("カラーパレットを初期化しました。")}).catch(()=>{})},document.getElementById("axp_config_form_blendModeDisplayType").onchange=()=>{this.axpObj.layerSystem.updateBlendModeDisplayAll()},document.getElementById("axp_config_button_resetColorTag").onclick=()=>{ae("カラータグ名を初期状態に戻します。\nよろしいですか？\n（※この処理はアンドゥできません）").then(()=>{this.axpObj.layerSystem.resetColorTagList(),this.axpObj.layerSystem.updateAllColorTag(),this.axpObj.configSystem.deleteConfig("COTAG"),alert("カラータグ名を初期化しました。")}).catch(()=>{})};const d=()=>{const e=document.querySelectorAll("#axp_config_ul_scale>li");this.axpObj.currentScaleTable=[];for(const t of e)this.axpObj.currentScaleTable.push(Number(t.dataset.value));this.updateKeyCustomizationScaleTable(this.axpObj.currentScaleTable)};document.getElementById("axp_config_button_addScale").addEventListener("click",()=>{const e=Number(document.getElementById("axp_config_number_scale").value),t=this.axpObj.CONST.SCALE_MIN,a=this.axpObj.CONST.SCALE_MAX,i=this.axpObj.CONST.SCALE_TABLE_MAX;if(m(e,t,a)){const t=document.querySelectorAll("#axp_config_ul_scale>li");if(t.length>=i)return void this.axpObj.msg("@CAU0100",i);let a=-1;for(let i=0;i<t.length;i++){if(e===Number(t[i].dataset.value)){a=-999;break}if(e<Number(t[i].dataset.value)){a=i;break}}if(-999===a)this.axpObj.msg("@CAU0101",e);else{const i=document.getElementById("axp_config_ul_scale"),n=document.createElement("li");n.dataset.value=String(e),n.textContent=`${e}%`,-1===a?i.appendChild(this.createHTMLListScale(e)):i.insertBefore(this.createHTMLListScale(e),t[a]),d(),this.saveConfig("SCALE",this.axpObj.currentScaleTable),this.axpObj.msg("@INF0100",e)}}else this.axpObj.msg("@CAU0102",t,a)}),document.getElementById("axp_config_button_deleteScale").addEventListener("click",()=>{const e=document.querySelectorAll("#axp_config_ul_scale>li");let t=null;for(const a of e)if("true"===a.dataset.selected){t=a;break}t?"100"===t.dataset.value||(t.remove(),d(),this.saveConfig("SCALE",this.axpObj.currentScaleTable),this.axpObj.msg("@INF0101",t.dataset.value)):this.axpObj.msg("@CAU0103")}),document.getElementById("axp_config_button_resetScale").addEventListener("click",()=>{ae("拡大率の設定を初期状態に戻します。\nよろしいですか？").then(()=>{this.axpObj.currentScaleTable=this.axpObj.CONST.SCALE_VALUE,this.createConfigScaleTable(this.axpObj.currentScaleTable),this.updateKeyCustomizationScaleTable(this.axpObj.currentScaleTable),this.saveConfig("SCALE",this.axpObj.currentScaleTable),alert("拡大率の設定を初期化しました。")}).catch(()=>{})}),document.getElementById("axp_config_form_useCustomButton").onchange=()=>{this.axpObj.dispCustomButton()},document.getElementById("axp_config_checkbox_shortcutKeyHiddenNofunc").addEventListener("change",()=>{this.switchNofuncKeytable()}),document.getElementById("axp_config_button_saveShortcut").addEventListener("click",()=>{const e=new Array;e.push("// @name\tAXNOSPaintSHORTCUT\n"),e.push("// @version\t2.4.0\n");const t=document.querySelectorAll(".axpc_config_custom_key");for(const a of t){let t=a.id.slice(21)+":"+this.getSaveCustomText(a.id);e.push(t+"\n")}const a="ap_shortcut"+g(new Date,"YYYYMMDD_hhmmss")+".txt",i=new Blob(e,{type:"text/plain"}),n=document.createElement("a");n.href=URL.createObjectURL(i),n.download=a,n.click()}),document.getElementById("axp_config_button_loadShortcut").onclick=()=>{document.getElementById("axp_config_file_loadShortcut").value="",document.getElementById("axp_config_file_loadShortcut").click()},document.getElementById("axp_config_file_loadShortcut").onchange=e=>{const t=e.target.files;if(0===t.length)return;const a=new FileReader;a.readAsText(t[0]),a.onload=()=>{const e=a.result.split(/\r\n|\n/),t=e.length-1;let i=!1;if(0===t)i=!0;else{"AXNOSPaintSHORTCUT"!==e[0].split(/\t/)[1]&&(i=!0)}if(i)alert("AXNOS Paintのショートカットファイルではありません。");else{for(let a=2;a<t;a++){const t=e[a].split(":"),i="axp_config_custom_key"+t[0],n="CFUNC_"+i,s=t[1];if(!document.getElementById(i))return void alert("ショートカットファイルの内容に誤りがあるため、読込を中止しました。\n行数:"+(a+1)+" 内容:"+e[a]);{const e=document.querySelector(`#${i} select:nth-of-type(1)`);let t=s.split(",");const a=this.optionlist.find(e=>e.value===t[0]);e.value=void 0===a?"none":t[0],t.length>1?this.selectCustom(i,t[1]):this.selectCustom(i,null)}this.configObj.set(n,s)}this.saveConfig(),this.switchNofuncKeytable(),this.updateShortcutMessage(),alert("ショートカットファイルを正常に読み込みました。")}}},document.getElementById("axp_config_button_resetShortcut").onclick=()=>{ae("ショートカットを初期状態に戻します。\nよろしいですか？\n（※この処理はアンドゥできません）").then(()=>{for(let e=0;e<ne.length;e++){const t=`axp_config_custom_key${ne[e][1]}`,a=`CFUNC_${t}`,i=ne[e][2];document.querySelector(`#${t} select:nth-of-type(1)`).value=i,this.selectCustom(t),this.configObj.delete(a)}this.saveConfig(),this.switchNofuncKeytable(),this.updateShortcutMessage(),alert("ショートカットを初期化しました。")}).catch(()=>{})},document.getElementById("axp_config_checkbox_useDebugMode").onchange=e=>{this.axpObj.debugLog.isDebugMode=e.target.checked}}getSaveCustomText(e){let t;const a=document.getElementById(e),i=a.querySelector("select:nth-of-type(1)"),n=a.querySelector(".axpc_config_number_sizeValue"),s=a.querySelector(".axpc_config_number_scaleValue");switch(i.value){case"func_loupe":s.value=x(Number(s.value),Number(s.min),Number(s.max)),t=i.value+","+s.value;break;case"func_size":n.value=x(Number(n.value),Number(n.min),Number(n.max)),t=i.value+","+n.value;break;default:t=i.value}return t}saveCustom(e){this.saveConfig(`CFUNC_${e}`,this.getSaveCustomText(e))}selectCustom(e,t=null){const a=document.getElementById(e),i=a.querySelector("select:nth-of-type(1)"),n=a.querySelector(".axpc_config_select_scaleTable"),s=a.querySelector(".axpc_config_number_sizeValue"),o=a.querySelector(".axpc_config_number_scaleValue");switch(i.value){case"func_loupe":n.selectedIndex=-1,o.value=null!==t?t:100,l.show(n),l.hide(s),l.show(o);break;case"func_size":s.value=null!==t?t:1,l.hide(n),l.show(s),l.hide(o);break;default:l.hide(n),l.hide(s),l.hide(o)}if(a.dataset.linkIndex){const e=document.querySelector(`#axp_custom_div_buttons>button:nth-of-type(${a.dataset.linkIndex})`);"none"===i.value?l.hide(e):l.show(e);const t=this.optionlist.find(e=>e.value===i.value);e.dataset.msg=`カスタムボタン：[ ${t.name} ]`}}switchNofuncKeytable(){const e=document.getElementById("axp_config_checkbox_shortcutKeyHiddenNofunc").checked,t=document.getElementById("axp_config_table_shortcutKey").querySelectorAll(".axpc_config_custom_key");for(const a of t){const t=a.querySelector("select");e&&"none"===t.value?a.classList.add("axpc_NONE"):a.classList.remove("axpc_NONE")}}updateShortcutMessage(){se.clear();const e=document.querySelectorAll(".axpc_config_custom_key");for(const t of e){const e=t.querySelector("select:nth-of-type(1)");se.has(e.value)||se.set(e.value,t.querySelector("td").textContent)}const t=document.querySelectorAll(".axpc_FUNC");for(const e of t)se.has(e.dataset.function)?e.dataset.key=se.get(e.dataset.function):e.dataset.key=""}getShortcutFunction(e){let t=null;return se.has(e)&&(t=se.get(e)),t}createKeyConfigHTML(e,t){const a=t[0],i=t[1],n=t[2],s=document.createElement("tr");s.setAttribute("id",`axp_config_custom_${e}${i}`),"key"===e&&s.setAttribute("class","axpc_config_custom_key");const o=document.createElement("td");o.textContent=`[ ${a} ]`;const r=document.createElement("td"),l=document.createElement("select");l.setAttribute("id",`axp_config_select_main_${e}${i}`);let d=!1,c=null;for(const t of this.optionlist)if("optgroup"===t.value)c=document.createElement("optgroup"),c.setAttribute("label",t.name),d=!0;else if("/optgroup"===t.value)l.appendChild(c),d=!1;else{if("button"===e&&"func_size_change"===t.value)continue;const a=document.createElement("option");a.value=t.value,a.textContent=t.name,d?c.appendChild(a):l.appendChild(a)}l.value=n,l.addEventListener("change",()=>{this.selectCustom(s.id),this.saveCustom(s.id),this.updateShortcutMessage()});const p=document.createElement("input");p.setAttribute("id",`axpc_config_number_sizeValue_${e}${i}`),p.classList.add("axpc_config_number_sizeValue"),p.setAttribute("type","number"),p.setAttribute("maxlength","3"),p.setAttribute("min","1"),p.setAttribute("max","200"),p.setAttribute("size","3"),p.addEventListener("change",()=>{this.saveCustom(s.id)});const _=document.createElement("input");_.setAttribute("id",`axpc_config_number_scaleValue_${e}${i}`),_.classList.add("axpc_config_number_scaleValue"),_.setAttribute("type","number"),_.setAttribute("maxlength","4"),_.setAttribute("min","25"),_.setAttribute("max","1600"),_.setAttribute("size","4"),_.addEventListener("change",()=>{this.saveCustom(s.id)});const h=document.createElement("select");return h.setAttribute("id",`axpc_config_select_scaleTable_${e}${i}`),h.classList.add("axpc_config_select_scaleTable"),h.addEventListener("change",e=>{_.value=e.target.value,this.saveCustom(s.id)}),r.appendChild(l),r.appendChild(p),r.appendChild(_),r.appendChild(h),s.appendChild(o),s.appendChild(r),s}addCanvasSizeHistory(e,t){let a=`${e},${t}`;for(let e=0;e<this.configCanvasSizeHistory.length;e++)this.configCanvasSizeHistory[e]==a&&this.configCanvasSizeHistory.splice(e,1);this.configCanvasSizeHistory.unshift(a),this.configCanvasSizeHistory.length>this.CONST.CANVAS_SIZE_HISTORY_MAX&&this.configCanvasSizeHistory.pop(),this.saveConfig("CHIST",this.configCanvasSizeHistory)}updateCanvasSizeHistory(){let e=document.getElementById("axp_config_ul_canvasSizeHistory");for(;e.lastChild;)e.onclick=null,e.removeChild(e.lastChild);for(const t of this.configCanvasSizeHistory)e.appendChild(this.createHTMLListCanvasSizeHistory(t))}createHTMLListCanvasSizeHistory(e){const t=document.createElement("li");t.dataset.value=String(e);let a=e.split(","),i=a[0],n=a[1];return t.textContent=`${i} × ${n}`,t.onclick=e=>{const a=document.querySelectorAll("#axp_config_ul_canvasSizeHistory>li");for(const e of a)e.dataset.selected="";e.target.dataset.selected="true";let i=t.dataset.value.split(","),n=i[0],s=i[1];document.getElementById("axp_config_number_oekakiWidth").value=Number(n),document.getElementById("axp_config_number_oekakiHeight").value=Number(s)},t}set_canvas_antialiasing(){"on"===this.axpObj.config("axp_config_form_antialiasing")?this.axpObj.CANVAS.main.style.imageRendering="auto":this.axpObj.CANVAS.main.style.imageRendering="pixelated"}set_display_position(){const e=document.getElementById("axp_canvas_div_pointerPosition");switch(this.axpObj.config("axp_config_form_displayPosition")){case"off":l.hide(e);break;case"upperleft":l.show(e),e.style.right="auto",e.style.bottom="auto";break;case"lowerleft":l.show(e),e.style.right="auto",e.style.bottom="0";break;case"upperright":l.show(e),e.style.right="0",e.style.bottom="auto";break;case"lowerright":l.show(e),e.style.right="0",e.style.bottom="0"}}set_longtap_use(){"on"===this.axpObj.config("axp_config_form_useLongtap")?(document.getElementById("axp_config_form_longtapDurationValue").volume.disabled=!1,document.getElementById("axp_config_form_longtapDurationValue").style.opacity="1",document.getElementById("axp_config_form_longtapStabilizerValue").volume.disabled=!1,document.getElementById("axp_config_form_longtapStabilizerValue").style.opacity="1"):(document.getElementById("axp_config_form_longtapDurationValue").volume.disabled=!0,document.getElementById("axp_config_form_longtapDurationValue").style.opacity="0.3",document.getElementById("axp_config_form_longtapStabilizerValue").volume.disabled=!0,document.getElementById("axp_config_form_longtapStabilizerValue").style.opacity="0.3")}saveConfig(e,t){void 0!==e&&this.configObj.set(e,t),this.axpObj.saveSystem.save_config(this.configObj)}deleteConfig(e){this.configObj.delete(e),this.axpObj.saveSystem.save_config(this.configObj)}getConfig(e){return this.configObj.get(e)}restoreConfig(e){const t=(e,t)=>{let a=!1;const i=document.querySelectorAll(`#${e} input[type="radio"]`);for(const e of i)if(e.value===t){e.checked=!0,a=!0;break}return a},a=a=>{if(e.has(a)){const i=e.get(a),n=a.substring(6);t(n,i)&&(e.delete(a),this.configObj.set(a,i))}},i=(e,t,a)=>{const i=this.axpObj.penSystem.penObj;let n=!1;if(t in i)switch(n=!0,e){case"P-SIZ":i[t].size=Number(a),i[t].index=y(Number(a));break;case"P-ALP":i[t].alpha=Number(a);break;case"P-THR":i[t].threshold=Number(a);break;case"P-BLU":i[t].blurLevel=Number(a);break;case"P-TON":i[t].toneLevel=Number(a);break;case"P-DEG":i[t].gradation=Number(a);break;case"P-RAD":i[t].radius=Number(a),i[t].borderRadius=Number(a)}return n};a("RADIO_axp_config_form_saveLastWindowPosition"),a("RADIO_axp_config_form_saveLastPenValue"),e.forEach((e,a)=>{let n=!0,s=!1;const o=a.substring(0,5),r=a.substring(6);switch(o){case"RANGE":document.getElementById(r)?(document.getElementById(r).volume.value=e,document.getElementById(r).result.value=e):n=!1;break;case"CHECK":document.getElementById(r)?document.getElementById(r).checked=e:n=!1;break;case"RADIO":t(r,e)||(n=!1);break;case"TOGSW":document.getElementById(r)?document.getElementById(r).querySelector("input").checked=e:n=!1;break;case"VALUE":document.getElementById(r)?document.getElementById(r).value=e:n=!1;break;case"GRIDC":document.getElementById(r)?(document.getElementById(r).dataset.colorcode=e,document.getElementById(r).style.backgroundColor=e.substring(0,7)):n=!1;break;case"SCALE":this.axpObj.currentScaleTable=e;break;case"CHIST":this.configCanvasSizeHistory=e,this.updateCanvasSizeHistory();break;case"WDPOS":if("off"===this.axpObj.config("axp_config_form_saveLastWindowPosition"))s=!0;else{const t=e.split(",");this.axpObj.dragWindow.setInitPosition(r,t[0],t[1])||(n=!1)}break;case"WDMIN":"off"===this.axpObj.config("axp_config_form_saveLastWindowPosition")?s=!0:this.axpObj.dragWindow.restoreMinimize(r)||(n=!1);break;case"P-SIZ":case"P-ALP":case"P-THR":case"P-BLU":case"P-TON":case"P-DEG":case"P-RAD":"off"===this.axpObj.config("axp_config_form_saveLastPenValue")?s=!0:i(o,r,e)||(n=!1);break;case"CFUNC":if(document.getElementById(r)){const t=document.querySelector(`#${r} select:nth-of-type(1)`);let a=e.split(",");const i=this.optionlist.find(e=>e.value===a[0]);t.value=void 0===i?"none":a[0],a.length>1?this.selectCustom(r,a[1]):this.selectCustom(r,null)}else n=!1;break;case"PLTCO":"number"==typeof e?this.axpObj.colorPaletteSystem.currentPalette.column=Number(e):n=!1;break;case"COTAG":this.axpObj.layerSystem.resetColorTagList(e);break;default:n=!1}n&&(s||this.configObj.set(a,e))})}dispPalettebox(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);const a=t.palette.length,i=0!==t.column?t.column:a;e.style.width=8+22*i+"px";let n=`${a}色（${i}列×${Math.ceil(a/i)}行）`;0===t.column&&(n+=" ※常に１行を維持"),document.getElementById("axp_config_div_paletteText").textContent=n;const s=e=>{var t=document.createElement("div");return t.setAttribute("class","axpc_config_colorRect"),t.style.backgroundColor=e,t};for(const a of t.palette)e.appendChild(s(a))}createConfigScaleTable(e){const t=document.getElementById("axp_config_ul_scale");for(;t.firstChild;)t.removeChild(t.firstChild);for(let a=0;a<e.length;a++){const i=e[a];t.appendChild(this.createHTMLListScale(i))}}createHTMLListScale(e){const t=document.createElement("li");return t.dataset.value=String(e),t.textContent=`${e}%`,t.addEventListener("click",e=>{if("100"===e.target.dataset.value)return void this.axpObj.msg("@CAU0104");const t=document.querySelectorAll("#axp_config_ul_scale>li");for(const e of t)e.dataset.selected="";e.target.dataset.selected="true"}),t}updateKeyCustomizationScaleTable(e){const t=document.querySelectorAll(".axpc_config_select_scaleTable");for(const a of t){for(;a.firstChild;)a.removeChild(a.firstChild);for(const t of e){const e=document.createElement("option");e.value=t,e.textContent=`${t}%`,a.appendChild(e)}a.selectedIndex=-1}}}a(6518);class re{axpObj;CONST={X_POST_MAX:120,Y_POST_MAX:120};CANVAS={post:null,post_ctx:null,thumbnail:null,thumbnail_ctx:null};constructor(e){this.axpObj=e}init(){document.getElementById("axp_post").insertAdjacentHTML("afterbegin",this.axpObj.translateHTML('\x3c!-- 投稿タブ --\x3e\r\n<div id="axp_post_div_content">\r\n    <div class="axpc_post_frame">\r\n        \x3c!-- サムネイルと拡大表示ポップアップ --\x3e\r\n        <div class="axpc_post_canvas">\r\n            <p>${_("@POST.THUMBNAIL")}</p>\r\n            <input type="checkbox" id="axp_post_checkbox_popup" />\r\n            <label for="axp_post_checkbox_popup" class="axpc_post_overlay">\r\n                <label for="axp_post_checkbox_popup" class="axpc_post_overlayWindow">\r\n                    <label for="axp_post_checkbox_popup" class="axpc_post_overlayCloseButton"></label>\r\n                    <canvas id="axp_post_canvas_postingImage" class="axpc_post_overlayCanvas"></canvas>\r\n                </label>\r\n            </label>\r\n            <label for="axp_post_checkbox_popup" class="axpc_post_thumbnail">\r\n                <canvas id="axp_post_canvas_thumbnail" class="axpc_background_mesh"></canvas>\r\n            </label>\r\n            <div id="axp_post_div_thumbnailTitle">\r\n            </div>\r\n            <p class="axpc_post_thumbnailClick">${_("@POST.THUMBNAIL_CLICK")}</p>\r\n        </div>\r\n        \x3c!-- 罫線 --\x3e\r\n        <div class="axpc_post_line"></div>\r\n        \x3c!-- 入力フォーム --\x3e\r\n        <div id="axp_post_div_input">\r\n            <div class="axpc_post_input">\r\n                <div class="axpc_post_name_property">${_("@POST.NAME")}</div>\r\n                <div class="axpc_post_name_required axpc_NONE">${_("@COMMON.REQUIRED")}</div>\r\n\r\n                <input id="axp_post_text_name" type="text" spellcheck="false" />\r\n\r\n                <div class="axpc_post_title_property">${_("@POST.TITLE")}</div>\r\n                <div class="axpc_post_title_required axpc_NONE">${_("@COMMON.REQUIRED")}</div>\r\n\r\n                <input id="axp_post_text_title" type="text" spellcheck="false" />\r\n\r\n                <div class="axpc_post_message_property">${_("@POST.MESSAGE")}</div>\r\n                <div class="axpc_post_message_required axpc_NONE">${_("@COMMON.REQUIRED")}</div>\r\n\r\n                <textarea id="axp_post_textarea_message" spellcheck="false"></textarea>\r\n                <label class="axpc_post_watchList">\r\n                    <input id="axp_post_checkbox_watchList" type="checkbox" />\r\n                    ${_("@POST.WATCHLIST")}\r\n                </label>\r\n            </div>\r\n        </div>\r\n        \x3c!-- 画像ステータス --\x3e\r\n        <div class="axpc_post_status">\r\n            <div class="axpc_post_status_size_property">${_("@POST.STATUS.SIZE")}</div>\r\n            <div class="axpc_post_status_size_colon">:</div>\r\n            <div class="axpc_post_status_size_value">\r\n                <span id="axp_post_span_imageSize"></span>\r\n            </div>\r\n            <div class="axpc_post_status_bg_property">${_("@POST.STATUS.BG_TRANSPARENT")}</div>\r\n            <div class="axpc_post_status_bg_colon">:</div>\r\n            <div class="axpc_post_status_bg_value">\r\n                <span><input type="radio" id="axp_post_radio_bgWhite" name="axp_post_radio_bg" value="white"\r\n                        checked /><label for="axp_post_radio_bgWhite">${_("@COMMON.BG_WHITE")}</label></span>\r\n                <span><input type="radio" id="axp_post_radio_bgTransparent" name="axp_post_radio_bg"\r\n                        value="transparent" /><label\r\n                        for="axp_post_radio_bgTransparent">${_("@COMMON.BG_TRANSPARENT")}</label></span>\r\n            </div>\r\n            <div class="axpc_post_status_based_property">${_("@POST.STATUS.BASED")}</div>\r\n            <div class="axpc_post_status_based_colon">:</div>\r\n            <div class="axpc_post_status_bg_value">\r\n                <span id="axp_post_span_referenceOekakiId"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- 注意事項 --\x3e\r\n    <div id="axp_post_div_notice">\r\n        <u>${_("@POST.NOTICE")}</u>\r\n        <div>\r\n            <div>${_("@POST.NOTICE1")}</div>\r\n            <div>${_("@POST.NOTICE2")}</div>\r\n            <div>${_("@POST.NOTICE3")}</div>\r\n            <div>${_("@POST.NOTICE4")}</div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- 投稿ボタン --\x3e\r\n    <div id="axp_post_div_button">\r\n        <span id="axp_post_span_message"></span>\r\n        <button id="axp_post_button_upload" class="axpc_MSG axpc_button" data-msg="@POS0001">\r\n            <div id="axp_post_button_upload_label"></div>\r\n            <div id="axp_post_button_upload_loading" class="axpc_NONE"></div>\r\n        </button>\r\n    </div>\r\n</div>')),this.CANVAS.post=document.getElementById("axp_post_canvas_postingImage"),this.CANVAS.post_ctx=this.CANVAS.post.getContext("2d"),this.CANVAS.thumbnail=document.getElementById("axp_post_canvas_thumbnail"),this.CANVAS.thumbnail_ctx=this.CANVAS.thumbnail.getContext("2d")}resetCanvas(){let e,t,a=this.axpObj.x_size,i=this.axpObj.y_size;if(this.CANVAS.post.width=a,this.CANVAS.post.height=i,this.CANVAS.post_ctx.clearRect(0,0,a,i),a>120||i>120){const n=this.CONST.X_POST_MAX/Math.max(a,i);e=Math.round(a*n),t=Math.round(i*n)}else e=a,t=i;this.CANVAS.thumbnail.width=e,this.CANVAS.thumbnail.height=t,this.CANVAS.thumbnail_ctx.clearRect(0,0,e,t),document.getElementById("axp_post_span_imageSize").textContent=`${this.axpObj._("@COMMON.WIDTH")}:${a} ${this.axpObj._("@COMMON.HEIGHT")}:${i}`}startEvent(){this.axpObj.postForm.input.isDisplay?(this.axpObj.postForm.input.strName.isDisplay?(document.getElementById("axp_post_text_name").maxLength=this.axpObj.postForm.input.strName.maxLength,document.getElementById("axp_post_text_name").placeholder=this.axpObj.postForm.input.strName.placeholder,this.axpObj.postForm.input.strName.isInputRequired&&l.show(document.querySelector(".axpc_post_name_required"))):(l.hide(document.querySelector(".axpc_post_name_property")),l.hide("axp_post_text_name"),this.axpObj.postForm.input.strName.isInputRequired=!1),this.axpObj.postForm.input.strTitle.isDisplay?(document.getElementById("axp_post_text_title").maxLength=this.axpObj.postForm.input.strTitle.maxLength,document.getElementById("axp_post_text_title").placeholder=this.axpObj.postForm.input.strTitle.placeholder,this.axpObj.postForm.input.strTitle.isInputRequired&&l.show(document.querySelector(".axpc_post_title_required"))):(l.hide(document.querySelector(".axpc_post_title_property")),l.hide("axp_post_text_title"),this.axpObj.postForm.input.strTitle.isInputRequired=!1),this.axpObj.postForm.input.strMessage.isDisplay?(document.getElementById("axp_post_textarea_message").maxLength=this.axpObj.postForm.input.strMessage.maxLength,document.getElementById("axp_post_textarea_message").placeholder=this.axpObj.postForm.input.strMessage.placeholder,this.axpObj.postForm.input.strMessage.isInputRequired&&l.show(document.querySelector(".axpc_post_message_required"))):(l.hide(document.querySelector(".axpc_post_message_property")),l.hide("axp_post_textarea_message"),this.axpObj.postForm.input.strMessage.isInputRequired=!1),this.axpObj.postForm.input.strWatchList.isDisplay||l.hide(document.querySelector(".axpc_post_watchList"))):(l.hide("axp_post_div_input"),this.axpObj.postForm.input.strName.isInputRequired=!1,this.axpObj.postForm.input.strTitle.isInputRequired=!1,this.axpObj.postForm.input.strMessage.isInputRequired=!1),this.axpObj.postForm.notice.isDisplay||l.hide("axp_post_div_notice");let e=document.querySelectorAll("input[name=axp_post_radio_bg]");for(let t of e)t.onchange=()=>{this.axpObj.assistToolSystem.transparent(),this.axpObj.drawPostCanvas()};document.getElementById("axp_post_text_title").oninput=e=>{let t=e.target.value;document.getElementById("axp_post_div_thumbnailTitle").textContent=t},document.getElementById("axp_post_text_title").oninput=e=>{let t=e.target.value;document.getElementById("axp_post_div_thumbnailTitle").textContent=t},document.getElementById("axp_post_button_upload").onclick=()=>{if(this.axpObj.postForm.input.strName.isInputRequired&&document.getElementById("axp_post_text_name").value.trim().length<1)return void(document.getElementById("axp_post_span_message").textContent=`${this.axpObj._("@POST.INFO_REQUIRED")} ( ${this.axpObj._("@POST.NAME")} )`);if(this.axpObj.postForm.input.strTitle.isInputRequired&&document.getElementById("axp_post_text_title").value.trim().length<1)return void(document.getElementById("axp_post_span_message").textContent=`${this.axpObj._("@POST.INFO_REQUIRED")} ( ${this.axpObj._("@POST.TITLE")} )`);if(this.axpObj.postForm.input.strMessage.isInputRequired&&document.getElementById("axp_post_textarea_message").value.trim().length<1)return void(document.getElementById("axp_post_span_message").textContent=`${this.axpObj._("@POST.INFO_REQUIRED")} ( ${this.axpObj._("@POST.MESSAGE")} )`);l.hide("axp_post_button_upload_label"),l.show("axp_post_button_upload_loading"),document.getElementById("axp_post_button_upload").disabled=!0;let e=this.CANVAS.post.toDataURL("image/png");e=e.replace("data:image/png;base64,","");let t={strName:document.getElementById("axp_post_text_name").value.trim(),strTitle:document.getElementById("axp_post_text_title").value.trim(),strMessage:document.getElementById("axp_post_textarea_message").value.trim(),strWatchList:document.getElementById("axp_post_checkbox_watchList").checked?"t":"",oekaki_id:this.axpObj.oekaki_id,draftImageFile:this.axpObj.draftImageFile,strEncodeImg:e};(async()=>{let e;try{e=await this.axpObj.FUNCTION.post(t)}catch(e){}finally{l.show("axp_post_button_upload_label"),l.hide("axp_post_button_upload_loading"),document.getElementById("axp_post_button_upload").disabled=!1}})()},document.getElementById("axp_post_button_upload_label").textContent=this.axpObj._("@POST.BUTTON_SUBMIT")}}const le="axnospaint_db1",de="save_manual",ce="save_auto",pe="save_config",_e="save_palette";class he{axpObj;dbSystem;isDBAvailable;autosave_counter;CONST={DATA_VERSION:3};constructor(e){this.axpObj=e,this.dbSystem=new ue,this.autosave_counter=0}init(){}async initDB(){let e;try{e=await this.dbSystem.initIndexedDB(),e?this.isDBAvailable=!0:(alert("ブラウザのIndexedDBが無効になっています。\nセーブ/ロード機能などは利用できません。"),this.isDBAvailable=!1)}catch(e){alert(`エラー:IndexedDBの初期化に失敗しました。\nセーブ/ロード機能などは利用できません。\n${e}`),this.isDBAvailable=!1}return this.isDBAvailable}async autoSave(){if(this.isDBAvailable&&(this.autosave_counter++,this.autosave_counter>=10)){this.autosave_counter=0;const e={created:new Date,version:this.CONST.DATA_VERSION,src:this.axpObj.assistToolSystem.CANVAS.thumbnail.toDataURL(),x_max:this.axpObj.x_size,y_max:this.axpObj.y_size,counter:this.axpObj.layerSystem.layer_counter,layer:this.axpObj.layerSystem.layerObj,oekaki_id:this.axpObj.oekaki_id,draftImageFile:this.axpObj.draftImageFile,oekaki_bbs_pageno:this.axpObj.oekaki_bbs_pageno,oekaki_bbs_title:this.axpObj.oekaki_bbs_title,transparent:this.axpObj.assistToolSystem.getIsTransparent()};try{await this.dbSystem.autosaveToDB(e,ce)}catch(e){}}}startEvent(){document.getElementById("axp_saveload_button_close").onclick=()=>{this.closeWindow()}}closeWindow(){const e=document.getElementById("axp_saveload_div_insertHTML");for(;e.childElementCount;)e.removeChild(e.firstElementChild);this.axpObj.isModalOpen=!1,l.hide("axp_saveload")}openWindow(){if(!this.isDBAvailable)return this.axpObj.msg("@CAU0300"),!1;this.axpObj.isModalOpen=!0,l.show("axp_saveload");const e=document.getElementById("axp_saveload_div_insertHTML");for(;e.childElementCount;)e.removeChild(e.firstElementChild);return!0}createSlotHTML(e,t){const a=document.getElementById("axp_saveload_div_insertHTML"),i=t.value,n=document.createElement("div");n.setAttribute("id",`axp_saveload_div_${t.primaryKey}`),n.setAttribute("data-key",t.primaryKey),"save"===e?n.setAttribute("class","axpc_saveload_saveSlot"):n.setAttribute("class","axpc_saveload_loadSlot");const s=document.createElement("div");if(s.setAttribute("class","axpc_saveload_thumbnall"),n.appendChild(s),void 0!==i.created){const e=document.createElement("img");e.setAttribute("src",i.src),s.appendChild(e);const t=document.createElement("div"),a=document.createElement("div"),o=document.createElement("div");o.setAttribute("class","axpc_saveload_refId");let r="YYYY/MM/DD";r=r.replace(/YYYY/,i.created.getFullYear()),r=r.replace(/MM/,("0"+(i.created.getMonth()+1)).slice(-2)),r=r.replace(/DD/,("0"+i.created.getDate()).slice(-2)),t.textContent=r;let l="hh:mm:ss";l=l.replace(/hh/,("0"+i.created.getHours()).slice(-2)),l=l.replace(/mm/,("0"+i.created.getMinutes()).slice(-2)),l=l.replace(/ss/,("0"+i.created.getSeconds()).slice(-2)),a.textContent=l;let c="";void 0!==i.oekaki_id&&null!==i.oekaki_id&&(c="[基]"+i.oekaki_id),void 0!==i.draftImageFile&&null!==i.draftImageFile&&(c="[基]"+d(i.draftImageFile)),o.textContent=c,n.appendChild(t),n.appendChild(a),n.appendChild(o)}else n.appendChild(document.createTextNode("空き"));a.appendChild(n)}async save(){if(this.openWindow()){document.getElementById("axp_saveload_span_message").textContent="セーブするスロットを選択（※保存済みのスロットは上書きされます）";try{await this.dbSystem.loadEntry("save",de,this.createSlotHTML);const e=document.querySelectorAll("#axp_saveload_div_insertHTML > div");for(const t of e)t.onclick=e=>{const t=e.currentTarget.dataset.key,a={id:t,version:this.CONST.DATA_VERSION,created:new Date,src:this.axpObj.assistToolSystem.CANVAS.thumbnail.toDataURL(),x_max:this.axpObj.x_size,y_max:this.axpObj.y_size,counter:this.axpObj.layerSystem.layer_counter,layer:this.axpObj.layerSystem.layerObj,oekaki_id:this.axpObj.oekaki_id,draftImageFile:this.axpObj.draftImageFile,oekaki_bbs_pageno:this.axpObj.oekaki_bbs_pageno,oekaki_bbs_title:this.axpObj.oekaki_bbs_title,transparent:this.axpObj.assistToolSystem.getIsTransparent()};(async()=>{try{await this.dbSystem.saveToDB(a,de),this.axpObj.msg("@INF0300",t.substr(5))}catch(e){alert(`エラー：セーブデータの保存に失敗しました。\n${e}`)}finally{this.closeWindow()}})()}}catch(e){alert(`エラー：セーブデータの読込に失敗しました。\n${e}`)}}}async loadCommon(e,t){try{await this.dbSystem.loadEntry(e,t,this.createSlotHTML);const a=document.querySelectorAll("#axp_saveload_div_insertHTML > div");for(const i of a)i.onclick=a=>{let i;i="auto"===e?Number(a.currentTarget.dataset.key):a.currentTarget.dataset.key,(async()=>{try{const a=await this.dbSystem.loadFromDB(i,t);if(void 0===a.created)return void this.axpObj.msg("@CAU0301",i.substr(5));if(!m(a.x_max,this.axpObj.minWidth,this.axpObj.maxWidth)||!m(a.y_max,this.axpObj.minHeight,this.axpObj.maxHeight))return void alert(`データの画像サイズ(横:${a.x_max} 縦:${a.y_max}) が許容値を超えています。\nこのデータをロードすることはできません。`);this.restore_oekaki_id(a)?(this.restoreData(a),"auto"===e?this.axpObj.msg("@INF0302"):this.axpObj.msg("@INF0301",i.substr(5))):alert(a.oekaki_bbs_title+"\nに投稿された画像を基にしているため、別の掲示板には投稿できません。\n同一の掲示板でロードしてください。")}catch(e){alert(`エラー：セーブデータの読込に失敗しました。\n${e}`)}finally{this.closeWindow()}})()}}catch(e){alert(`エラー：セーブデータの読込に失敗しました。\n${e}`)}}load(){this.openWindow()&&(document.getElementById("axp_saveload_span_message").textContent="ロードするスロットを選択（※現在の描画内容は破棄されます）",this.loadCommon("load",de))}restore(){this.openWindow()&&(document.getElementById("axp_saveload_span_message").textContent="自動バックアップ（10ストローク毎に最大20件まで保存）を選択（※現在の描画内容は破棄されます）",this.loadCommon("auto",ce))}restore_oekaki_id(e){if(void 0!==e.draftImageFile&&null!==e.draftImageFile){if(this.axpObj.checkSameBBS&&e.oekaki_bbs_pageno!==this.axpObj.post_bbs_pageno)return!1;this.axpObj.oekaki_id=null,this.axpObj.draftImageFile=e.draftImageFile,this.axpObj.oekaki_bbs_pageno=e.oekaki_bbs_pageno,this.axpObj.oekaki_bbs_title=e.oekaki_bbs_title}else if(void 0!==e.oekaki_id&&null!==e.oekaki_id){if(this.axpObj.checkSameBBS&&e.oekaki_bbs_pageno!==this.axpObj.post_bbs_pageno)return!1;this.axpObj.oekaki_id=e.oekaki_id,this.axpObj.draftImageFile=null,this.axpObj.oekaki_bbs_pageno=e.oekaki_bbs_pageno,this.axpObj.oekaki_bbs_title=e.oekaki_bbs_title}else this.axpObj.oekaki_id=null,this.axpObj.draftImageFile=null,this.axpObj.oekaki_bbs_pageno=null,this.axpObj.oekaki_bbs_title=null;return!0}restoreData(e){if(this.axpObj.x_size=e.x_max,this.axpObj.y_size=e.y_max,this.axpObj.resetCanvas(),this.axpObj.layerSystem.setLayerCounter(e.counter),(e.version?e.version:0)<2){Array.prototype.reverse.call(e.layer);for(let t=0;t<e.layer.length;t++)e.layer[t].index=t}for(let t=0;t<e.layer.length;t++)this.axpObj.layerSystem.restoreLayer({layerObj:e.layer[t]});void 0!==e.transparent?this.axpObj.assistToolSystem.setIsTransparent(e.transparent):this.axpObj.assistToolSystem.setIsTransparent(!1),this.axpObj.layerSystem.selectCurrentLayerIndex(0),this.axpObj.layerSystem.updateBlendModeDisplayAll(),this.axpObj.layerSystem.updateCanvas()}save_config(e){if(!this.isDBAvailable)return;const t={id:"config_01",config:e};try{this.dbSystem.saveToDB(t,pe)}catch(e){}}async load_config(){if(!this.isDBAvailable)return;let e=await this.dbSystem.loadFromDB("config_01",pe);return void 0!==e.config?e.config:null}save_palette(e){if(!this.isDBAvailable)return;const t={id:"palette_01",palette:e};try{this.dbSystem.saveToDB(t,_e)}catch(e){}}async load_palette(){if(!this.isDBAvailable)return;let e=await this.dbSystem.loadFromDB("palette_01",_e);return void 0!==e.palette?e.palette:void 0}}class ue{constructor(){}initIndexedDB(){return new Promise((e,t)=>{window.indexedDB||e(!1);const a=indexedDB.open(le,2);a.onerror=()=>{t(new Error("initIndexedDB:openReq.onerror"))},a.onupgradeneeded=e=>{const t=a.result;if(e.oldVersion<=1){const e=t.createObjectStore(de,{keyPath:"id"});e.put({id:"save_01"}),e.put({id:"save_02"}),e.put({id:"save_03"}),e.put({id:"save_04"}),e.put({id:"save_05"});t.createObjectStore(ce,{autoIncrement:!0}).createIndex("created","created",{unique:!1});t.createObjectStore(pe,{keyPath:"id"}).put({id:"config_01"});t.createObjectStore(_e,{keyPath:"id"}).put({id:"palette_01"})}},a.onsuccess=()=>{e(!0)}})}loadEntry(e,t,a){return new Promise((i,n)=>{let s;const o=indexedDB.open(le,2);o.onerror=()=>{n(new Error("loadEntry:openReq.onerror"))},o.onsuccess=()=>{s=o.result;const r=s.transaction(t).objectStore(t);let l,d;"auto"===e?(l="prev",d=20):(l="next",d=5);const c=r.openCursor(null,l);let p=0;c.onerror=()=>{n(new Error("loadEntry:readReq.onerror"))},c.onsuccess=()=>{let t=c.result;t?(a(e,t),p++,p<d?t.continue():i()):"auto"===e?i():n(new Error("loadEntry:readReq.onsuccess"))}}})}saveToDB(e,t){return new Promise((a,i)=>{const n=indexedDB.open(le,2);n.onerror=()=>{i(new Error("saveToDB:openReq.onerror"))},n.onsuccess=()=>{const s=n.result.transaction(t,"readwrite").objectStore(t).put(e);s.onerror=()=>{i(new Error("saveToDB:saveReq.onerror"))},s.onsuccess=()=>{a()}}})}autosaveToDB(e,t){return new Promise((a,i)=>{const n=indexedDB.open(le,2);n.onerror=()=>{i(new Error("autosaveToDB:openReq.onerror"))},n.onsuccess=()=>{const s=n.result.transaction(t,"readwrite").objectStore(t),o=s.count();o.onerror=()=>{i(new Error("autosaveToDB:countReq.onerror"))},o.onsuccess=()=>{if(o.result>=20){const e=s.openCursor(null,"next");e.onerror=()=>{i(new Error("autosaveToDB:readReq.onerror"))},e.onsuccess=()=>{const t=e.result;if(t){const e=t.delete();e.onerror=()=>{i(new Error("autosaveToDB:deleteReq.onerror"))},e.onsuccess=()=>{}}}}};const r=s.put(e);r.onerror=()=>{i(new Error("autosaveToDB:saveReq.onerror"))},r.onsuccess=()=>{a()}}})}loadFromDB(e,t){return new Promise((a,i)=>{const n=indexedDB.open(le,2);n.onerror=()=>{i(new Error("loadFromDB:openReq.onerror"))},n.onsuccess=()=>{const s=n.result.transaction(t).objectStore(t).get(e);s.onerror=()=>{i(new Error("loadFromDB:readReq.onerror"))},s.onsuccess=()=>{void 0!==s.result?a(s.result):i(new Error("loadFromDB:readReq.onsuccess"))}}})}}class me{axpObj;constructor(e){this.axpObj=e}init(){}startEvent(){window.addEventListener("blur",()=>{this.axpObj.isSPACE&&(this.axpObj.penSystem.restorePenModeTemporary("axp_penmode_hand"),this.axpObj.isSPACE=!1),this.axpObj.isCTRL&&(this.axpObj.penSystem.restorePenModeTemporary("axp_penmode_spuit"),this.axpObj.isCTRL=!1),this.axpObj.isSHIFT&&(this.axpObj.isSHIFT=!1),this.axpObj.codeCHANGE_SIZE_KEY&&(this.axpObj.codeCHANGE_SIZE_KEY=null)}),window.addEventListener("keyup",e=>{if(!e.key)return;switch(e.key.toUpperCase()){case" ":this.axpObj.penSystem.restorePenModeTemporary("axp_penmode_hand"),this.axpObj.isSPACE=!1;break;case"CONTROL":this.axpObj.penSystem.restorePenModeTemporary("axp_penmode_spuit"),this.axpObj.isCTRL=!1;break;case"SHIFT":this.axpObj.isSHIFT=!1}e.code===this.axpObj.codeCHANGE_SIZE_KEY&&this.axpObj.penSystem.modeChangeSizeOff()}),window.addEventListener("keydown",e=>{if(this.axpObj.isClose)return;if(!this.axpObj.isCanvasOpen)return;if(this.axpObj.isModalOpen)return;if("number"===document.activeElement.type||"text"===document.activeElement.type)return;e.preventDefault();let t=e.key.toUpperCase();if(this.axpObj.isDrawing)return void("SHIFT"===t&&(this.axpObj.isLine=!0));if(e.repeat&&(" "===t||"CONTROL"===t||"ALT"===t||"SHIFT"===t))return;let a=t;switch(a){case"*":a="ASTERISK";break;case"+":a="PLUS";break;case",":a="COMMA";break;case"-":a="MINUS";break;case".":a="DOT";break;case"/":a="SLASH";break;case":":a="COLON";break;case";":a="SEMICOLON"}switch(t){case" ":this.axpObj.isSPACE=!0,this.axpObj.penSystem.changePenModeTemporary("axp_penmode_hand");break;case"CONTROL":this.axpObj.isCTRL=!0,this.axpObj.penSystem.changePenModeTemporary("axp_penmode_spuit");break;case"ALT":break;case"SHIFT":this.axpObj.isSHIFT=!0;break;default:this.axpObj.callTask(`axp_config_custom_key${a}`,t,e.repeat,e.code)}})}}const xe="@BAS0001,キャンバス：絵を描くメイン画面です。\r\n@BAS0002,設定：各種機能をカスタマイズできます。\r\n@BAS0003,投稿：描いたイラストを掲示板に投稿します。\r\n@BAS0004,拡張機能：ユーザーにより定義された拡張機能を実行します。\r\n@BAS0005,お知らせ領域です。文章が見切れる場合、クリックし続けると全文表示します。\r\n@BAS0006,機能解説などのガイドメッセージが表示されるエリアです。\r\n@BAS0100,デバッグ情報です。非表示にするには[設定]-[バージョン情報]-[デバッグ情報表示]のチェックを外してください。\r\n@LAU0001,一時的にすべてのウィンドウを非表示にします。\r\n@PEN0001,現在選択しているペンの名前が表示されます。\r\n@PEN0002,ペンの不透明度を変更します。0に近づくほど透明になります。\r\n@PEN0003,ペンの太さを変更します。\r\n@PEN0004,境界付近の塗り残しドットを目立たなくします。数字が大きいほど強く補正します。\r\n@PEN0005,グラデーションの向きを角度で指定します。\r\n@PEN0006,トーン濃度を指定します。数字が大きいほど濃くなります。\r\n@PEN0007,図形描画モードを選択できます。\r\n@PEN0008,「囲まれた領域」の判定方式を選択できます。（全ﾚｲﾔｰ判定を指定すると表示見たままで塗分けができます）\r\n@PEN0009,ぼかしの強さを指定します。数字が大きいほど描画する線がぼやけます。\r\n@PEN0010,外側の角の丸さを指定します。50で正円になります。\r\n@PEN0050,%1%2 [ 再選択 ]:ペン種別変更。\r\n@PEN0051,%1%2 [ 再選択 ]:消しゴム種別変更。\r\n@PEN0052,%1%2 [ 再選択 ]:バケツ種別変更。\r\n@PEN0053,%1%2 [ 再選択 ]:ツール種別変更。\r\n@PEN0054,%1スポイト：指定座標の色を取得し、描画色（%drawingColorName）に設定します。[ CTRL ]:押している間スポイトに変化。\r\n@PEN0100,%1丸ペン：一定の太さの線が描けるペン。[ SHIFT ]:直線描画。\r\n@PEN0101,%1角ペン：先が四角い線が描けるペン。[ SHIFT ]:直線描画。\r\n@PEN0102,%1ドットペン：ドット絵調の線が描けるペン。[ SHIFT ]:直線描画。\r\n@PEN0103,%1筆ペン：強弱のついた線が描けるペン。\r\n@PEN0104,%1クレヨン：クレヨン風の塗りができるペン。[ SHIFT ]:直線描画。\r\n@PEN0105,%1エアブラシ：エアブラシ風の塗りができるペン。\r\n@PEN0110,%1消しゴム：辺が丸い消しゴム。[ SHIFT ]:直線描画。\r\n@PEN0111,%1角消しゴム：辺が四角い消しゴム。[ SHIFT ]:直線描画。\r\n@PEN0120,%1バケツ：囲まれた領域の内側を塗り潰します。\r\n@PEN0121,%1階調バケツ：メインカラーとサブカラーのグラデーションで、囲まれた領域の内側を塗り潰します。\r\n@PEN0130,%1ハンド：ドラッグでキャンバスの位置を移動します。[ SPACE ]:押している間ハンドに変化。\r\n@PEN0131,%1移動ツール：画像を上下左右に移動するツール（現在のレイヤーのみ対象）\r\n@PEN0200,%penPreviewGuide\r\n@PEN0201,%1のプレビュー。枠内をクリックまたはドラッグで太さを変更します。\r\n@PEN0202,%1の色プレビュー。\r\n@PEN0203,%1の色プレビュー。枠内をドラッグで角度を変更します。\r\n@PEN0204,ポインタ座標の画像を拡大表示します。赤枠の色がスポイトで取得されます。\r\n@PLT0001,カラーパレットの列数を変更します。∞を指定すると常に１行になります。\r\n@PLT0002,パレットの更新／位置入れ替え／削除を行うモードに切り替えます。\r\n@PLT0003,%addPaletteNameの色をカラーパレットに登録します。\r\n@PLT0004,選択しているパレットを削除します。\r\n@LAY0001,レイヤーの合成モードを変更します。詳細はマニュアルを参照してください。\r\n@LAY0002,現在のレイヤーの不透明度を変更します。0を指定すると完全に透明になります。\r\n@LAY0003,%1現在のレイヤーは残したまま、描画内容だけを消去します。\r\n@LAY0004,%1新しいレイヤーを作成します。（最大８枚まで）\r\n@LAY0005,%1現在のレイヤーを１つ下のレイヤーに統合します。統合後は不透明度が100%に調整されます。\r\n@LAY0006,%1現在のレイヤーのコピーを作成します。\r\n@LAY0007,%1現在のレイヤーを削除します。\r\n@LAY0008,描画するレイヤーを選択します。\r\n@LAY0100,レイヤー情報サブウィンドウを閉じます。\r\n@LAY0101,レイヤー名を変更する場合、ここに新しい名前を入力します。（10文字まで）\r\n@LAY0102,レイヤーに付与した色を解除します。（レイヤー名は変更されません）\r\n@LAY0110,レイヤー単体を左右反転します。\r\n@LAY0111,レイヤー単体を上下反転します。\r\n@MKC0001,%1描画色をメインカラーに切り替えます。\r\n@MKC0002,%1描画色をサブカラーに切り替えます。一部の機能で補助的に使用します。%2\r\n@MKC0003,%1描画色を透明色に切り替えます。%2\r\n@MKC0004,カラーコードを直接入力してメインカラーを変更します。\r\n@MKC0005,%addPaletteNameの色をカラーパレットに登録します。\r\n@MKC0006,メインカラーとサブカラーを入れ替えます。\r\n@MKC0007,%drawingColorNameの赤成分を変更します。(0～255)\r\n@MKC0008,赤成分を数値入力します。(0～255)\r\n@MKC0009,%drawingColorNameの緑成分を変更します。(0～255)\r\n@MKC0010,緑成分を数値入力します。(0～255)\r\n@MKC0011,%drawingColorNameの青成分を変更します。(0～255)\r\n@MKC0012,青成分を数値入力します。(0～255)\r\n@MKC0013,%drawingColorNameの色をカラーピッカーで変更します。\r\n@AST0001,キャンバスの大きさ。（※設定で変更可能）\r\n@AST0002,サムネイル表示。枠内をクリックまたはドラッグでキャンバスの位置を移動します。\r\n@AST0003,%1拡大率を１段階縮小します。\r\n@AST0004,%1拡大率とキャンバス位置をリセットします。\r\n@AST0005,%1拡大率を１段階拡大します。\r\n@AST0006,%1直前の描画を取消して元に戻します。ボタンの数字の回数だけ遡れます。\r\n@AST0007,%1アンドゥを取消します。ボタンの数字の回数だけ遡れます。\r\n@AST0008,%1自動バックアップから復元ポイントを選んで再開します。（※現在の描画内容は消去されます）\r\n@AST0009,%1描画内容をブラウザに一時保存し、復元ポイントを作成します。\r\n@AST0010,%1作成した復元ポイントから再開します（※現在の描画内容は消去されます）\r\n@AST0011,%1全レイヤーを左右反転します。\r\n@AST0012,%1全レイヤーを上下反転します。\r\n@AST0013,%1背景色の白地/透明色を切り替えます。（※投稿画像に反映されます）\r\n@AST0014,%1補助線のON/OFFを切り替えます。\r\n@AST0015,補助線の詳細設定ウィンドウを開閉します。\r\n@AST0100,補助線の横方向の分割数を変更します。\r\n@AST0101,補助線の縦方向の分割数を変更します。\r\n@AST0102,縦横の分割数の変更を連動させて同じ値にします。\r\n@AST0103,補助線（主線）の使用を切り替えます。分割数に応じた格子状の線を引きます。\r\n@AST0104,補助線（主線）の色と不透明度を変更します。\r\n@AST0105,補助線（副線）の使用を切り替えます。主線の内部を細分する線を引きます。\r\n@AST0106,補助線（副線）の色と不透明度を変更します。\r\n@AST0107,補助線（斜め）の使用を切り替えます。分割数に応じた斜線を引きます。\r\n@AST0108,補助線（斜め）の色と不透明度を変更します。\r\n@AST0109,補助線（ピクセル指定１）の使用を切り替えます。※表示に適さない拡大率の時、自動的に非表示になります。\r\n@AST0110,補助線（ピクセル指定１）の色と不透明度を変更します。\r\n@AST0111,補助線（ピクセル指定１）のピクセル間隔を変更します。\r\n@AST0112,補助線（ピクセル指定２）の使用を切り替えます。※表示に適さない拡大率の時、自動的に非表示になります。\r\n@AST0113,補助線（ピクセル指定２）の色と不透明度を変更します。\r\n@AST0114,補助線（ピクセル指定２）のピクセル間隔を変更します。\r\n@AST0120,補助線の色を変更します。\r\n@AST0121,補助線の不透明度を変更します。\r\n@AST0122,変更を終了して、サブメニューを閉じます。\r\n@POS0001,お絵カキコを投稿します。\r\n@CFG0010,現在のポインタ座標を表示します。（位置：左下）\r\n@CFG0016,過去に使用したキャンバスサイズの履歴です。直近8件まで保存されます。\r\n@CFG0017,新規キャンバスを作成します。（現在の描画内容はすべて消去されます）\r\n@CFG0018,現在の描画内容を残したまま、キャンバスのサイズを変更します。\r\n@CFG0019,描画内容をPNG形式ファイルとしてダウンロードします。ファイル名は現在日時が付与されます。\r\n@CFG0020,ぼかし（アンチエイリアシング）を無効にします。（ドット絵がボケなくなります）\r\n@CFG0021,ぼかし（アンチエイリアシング）を有効にします。\r\n@CFG0022,現在のポインタ座標を表示しません。\r\n@CFG0023,現在のポインタ座標を表示します。（位置：左上）\r\n@CFG0024,現在のポインタ座標を表示します。（位置：右上）\r\n@CFG0025,現在のポインタ座標を表示します。（位置：右下）\r\n@CFG0026,ツール起動時、ウィンドウ配置を毎回初期化します。\r\n@CFG0027,ツール起動時、ウィンドウ配置を前回終了時の位置に復元します。\r\n@CFG0028,ウィンドウ位置の自動調整を行いません。\r\n@CFG0029,ブラウザの画面サイズを変更したとき、ウィンドウが画面内に収まるように自動調整を行います。\r\n@CFG0030,すべてのツールウィンドウの配置を初期状態に戻します。\r\n@CFG0034,ツール起動時、ペンの太さ、不透明度などを毎回初期化します。\r\n@CFG0035,ツール起動時、ペンの太さ、不透明度などを前回終了時の値に復元します。\r\n@CFG0036,アイコンボタンのサイズを変更します。\r\n@CFG0037,ウィンドウを開く際に、他のウィンドウが自動的に閉じるようになります。一括開閉ボタンは無効になります。\r\n@CFG0040,全ペン共通の手ぶれ補正の強さを変更します。数値が大きいほど強い補正がかかります。0を指定すると補正を行いません。\r\n@CFG0041,ペンツールウィンドウ内にレンジスライダーを表示して、キャンバス画面でも手ぶれ補正を変更できるようにします。\r\n@CFG0043,自動切換機能を使用しません。\r\n@CFG0044,スポイトで色を取得した時、自動的にペンに切り替えます。\r\n@CFG0045,長押しスポイト機能を使用しません。\r\n@CFG0046,キャンバス上の取得したい色の位置で、ペン（またはマウスクリック）を長押しすることでスポイトが動作します。\r\n@CFG0047,長押し入力として認識するために、押し続ける必要がある時間を設定します。1000ミリ秒=１秒\r\n@CFG0048,長押し入力時に許容する手ぶれの範囲を設定します。数値が大きいほど長押しが認識されやすくなりますが、通常描画に影響がでます。\r\n@CFG0049,トーン濃度レンジスライダーを使用しません。\r\n@CFG0050,トーン濃度レンジスライダーをペンツールに追加します。\r\n@CFG0051,太さレンジスライダーを上に表示します。\r\n@CFG0052,不透明度レンジスライダーを上に表示します。\r\n@CFG0053,混色パレットを使用しません。\r\n@CFG0054,混色パレットを使用します。\r\n@CFG0055,RGBスライダーを使用しません。\r\n@CFG0056,光の三原色（赤、緑、青）強さを指定して色作成するスライダーを使用します。\r\n@CFG0057,カラーピッカーを使用しません。\r\n@CFG0058,HSV色空間（色相、彩度、明度）を指定するカラーピッカーを使用します。\r\n@CFG0059,ツール起動時、カラーパレットを毎回初期化します。\r\n@CFG0060,ツール起動時、カラーパレットを前回終了時の色に復元します。\r\n@CFG0062,パレット編集モード時にレンジスライダーを表示して、キャンバス画面でも横幅を変更できるようにします。\r\n@CFG0063,カラーパレットの列数を変更します。∞を指定すると常に１行になります。\r\n@CFG0064,現在のカラーパレットの内容をテキストファイルとしてダウンロードします。\r\n@CFG0065,色保存で作成したテキストファイルを読み込み、カラーパレットを更新します。\r\n@CFG0066,カラーパレットを初期状態に戻します。\r\n@CFG0067,アンドゥ／リドゥの可能回数を変更します。メモリ不足で動作が不安定になる場合は値を小さく設定してください。\r\n@CFG0070,拡大率を追加します。\r\n@CFG0071,選択している拡大率を削除します。\r\n@CFG0072,拡大率を初期状態に戻します。\r\n@CFG0080,カスタムボタンを使用しません。\r\n@CFG0081,カスタムボタンツールウィンドウを画面に追加します。\r\n@CFG0082,ボタンに機能を割り当てません。\r\n@CFG0083,ボタンでアンドゥを実行します。\r\n@CFG0084,ボタンでスポイトを実行します。\r\n@CFG0085,ボタンを押しながらドラッグでキャンバスの位置を移動します。\r\n@CFG0086,ボタンで拡大率とキャンバス位置をリセットします。\r\n@CFG0087,ボタンでメインカラーとサブカラーを切り替えます。\r\n@CFG0088,ボタンでメインカラーと透明色を切り替えます。\r\n@CFG0089,ホイールに機能を割り当てません。\r\n@CFG0090,ホイールでキャンバスを拡大/縮小します。\r\n@CFG0091,ホイールでキャンバスの位置を移動します。\r\n@CFG0092,操作を無効にします。タッチペン使用時、指による誤描画を防止します。\r\n@CFG0093,１本指タッチで描画を行います。指で線を描くことができます。\r\n@CFG0094,１本指タッチでハンドツールを操作します。指でキャンバスを移動できます。\r\n@CFG0095,操作を無効にします。\r\n@CFG0096,２本指スワイプ操作でキャンバスの移動を行います。\r\n@CFG0097,操作を無効にします。\r\n@CFG0098,ピンチアウト／ピンチイン操作でキャンバスの拡大／縮小を行います。\r\n@CFG0099,操作を無効にします。\r\n@CFG0100,２本指タップ操作でアンドゥを行います。\r\n@CFG0101,操作を無効にします。\r\n@CFG0102,３本指タップ操作でリドゥを行います。\r\n@CFG0103,タップ入力として認識するために、触れた指を離すまでの制限時間を設定します。1000ミリ秒=１秒\r\n@CFG0108,１回のボタン操作でスクロールする量を設定します。\r\n@CFG0111,機能が割り当てられていないキーを省略します。非表示のキーに機能を割り当てる場合はチェックを外してください。\r\n@CFG0112,キーと割り当てられている機能の対応表です。セレクトボックスから機能を選んで割り当てを変更することができます。\r\n@CFG0113,現在のショートカット設定をテキストファイルとしてダウンロードします。\r\n@CFG0114,ショートカットファイルを読み込み、ショートカット設定を更新します。\r\n@CFG0115,ショートカット設定を初期状態に戻します。\r\n@CFG0120,合成モードを表示しません。\r\n@CFG0121,合成モードをレイヤー名の下に表示します。\r\n@CFG0122,合成モードをレイヤー名の下に表示します。（合成モードが通常の場合は表示を省略します）\r\n@CFG0123,登録されているレイヤー名を変更します。（最大8文字）\r\n@CFG0124,登録されているレイヤー名を初期状態にリセットします。\r\n@CFG0200,ぼかし度レンジスライダーを使用しません。\r\n@CFG0201,ぼかし度レンジスライダーをペンツールに追加します。\r\n@CFG0211,追加する拡大率を入力します。\r\n@CFG0212,現在設定されている拡大率の一覧です。クリックで拡大率を選択します。\r\n@CFG0220,マウスホイールの回転方向を反転して入力を受け付けます。\r\n@CFG0221,１回のホイール操作でスクロールする量を設定します。\r\n@CFG0222,連続してマウスホイールを回転させた時、入力を抑止する時間を設定します。1000ミリ秒=１秒\r\n@CFG0223,マウスポインタの位置を参照し、キャンバスの狙った位置を拡大／縮小できるようにします。\r\n@CFG0230,画面スクロールの向きを反転します。上スクロールは下スクロールに、左スクロールは右スクロールに変換されます。\r\n@CFG0300,キャンバスの幅（横のサイズ）を入力します。（下のボタンで変更を確定します）\r\n@CFG0301,キャンバスの高さ（縦のサイズ）を入力します。（下のボタンで変更を確定します）\r\n@CFG0400,選択中のペンを使って透明色で描画します。（描画中だけ透明色に切り替わります）\r\n@CFG0401,タップ入力時に許容する手ぶれの範囲を設定します。\r\n@CFG2001,キャンバス全般に関する設定を行います。\r\n@CFG2002,ツールウィンドウ全般に関する設定を行います。\r\n@CFG2003,ペンツールの機能設定を行います。\r\n@CFG2004,色作成の機能設定を行います。\r\n@CFG2005,パレットの機能設定を行います。\r\n@CFG2006,レイヤーの機能設定を行います。\r\n@CFG2007,補助ツールの機能設定を行います。\r\n@CFG2008,カスタムボタンの機能設定を行います。\r\n@CFG2009,マウス／タッチパッド（トラックパッド）の設定を行います。\r\n@CFG2010,タッチパネルの設定を行います。\r\n@CFG2011,キーボードのキーコンフィグなどの設定を行います。\r\n@CFG2013,AXNOS Paint起動時の設定を行います。\r\n@CFG2020,バージョン情報を表示します。\r\n@COL0001,%drawingColorName RGB:(%1)\r\n@COL0002,透明色\r\n@COL0003,メインカラー RGB:(%1) / サブカラー (%2)\r\n@COL0004,混色パレット(%1%) RGB:(%2)\r\n@AXP0001,拡大率：%1%\r\n@AXP0003,%1の不透明度：%2\r\n@AXP0004,補助線分割数 横：%1 / 縦：%2\r\n@AXP0010,%1ペン／消しゴム切替(%2)\r\n@AXP2000,描画色を混色パレット(%1%)に変更します。RGB:(%2)\r\n@AXP3000,[編集モード] ドラッグで位置を入れ替え。色作成ウィンドウで選択中パレットの色を更新。\r\n@AXP3001,%drawingColorNameを指定色に変更します。RGB:(%1)\r\n@AXP4000,レイヤーの%1を切り替えます。(現在の状態:%2)\r\n@AXP4001,ドラッグで表示順序を入れ替え。ダブルクリックでレイヤー名変更。\r\n@AXP4010,レイヤー名の変更を決定して、サブメニューを閉じます。\r\n@AXP4012,登録された名前に変更し、色を付与します。\r\n@AXP4013,新しいレイヤー名を入力してください。\r\n@AXP5000,%1の太さ：%2\r\n@AXP5001,%1の不透明度：%2\r\n@AXP5002,%1の塗り残し補正：%2\r\n@AXP5003,%1の角度：%2\r\n@AXP5004,%1のトーン濃度：%2\r\n@AXP5005,[ CTRL ]: 押している間、ペンがスポイトに変化します。\r\n@AXP5006,[ SPACE ]: 押している間、ペンがハンドに変化します。\r\n@AXP5007,%1押している間、その場でペンの太さレンジスライダーを操作できます。\r\n@AXP5008,%1のぼかし度：%2\r\n@AXP5009,%1の丸み：%2\r\n@AXP5010,ペンツールの種別選択中です。\r\n@INF0001,%1は透明部分をロックしています。既に描画されている部分のみ上書き描画できます。\r\n@INF0002,拡大率とキャンバスの位置をリセットしました。\r\n@INF0003,ツールウィンドウの位置を初期化しました。\r\n@INF0005,背景のタイルプレビューを切り替えました。(現在の状態:%1)\r\n@INF0006,%1を全面塗り潰ししました。\r\n@INF0007,%1を90°回転しました。\r\n@INF0008,%1はクリッピングです。描画内容は%2の形に切り抜かれます。\r\n@INF0009,キャンバス全体のぼかしを切り替えました。(現在の状態:%1)\r\n@INF0050,[ %1 ]を読み込みました。(画像サイズ 横:%2 × 縦:%3)\r\n@INF0100,拡大率%1%を追加しました。\r\n@INF0101,拡大率%1%を削除しました。\r\n@INF0300,スロット%1にセーブしました。\r\n@INF0301,スロット%1をロードしました。\r\n@INF0302,自動保存されたデータをロードしました。\r\n@INF0400,%1をアンドゥしました。（残り回数：%2）\r\n@INF0401,%1をリドゥしました。（残り回数：%2）\r\n@INF1000,全レイヤーの左右を反転しました。\r\n@INF1001,選択中レイヤーの左右を反転しました。\r\n@INF1002,全レイヤーの上下を反転しました。\r\n@INF1003,選択中レイヤーの上下を反転しました。\r\n@INF1004,補助線の表示を切り替えました。（現在の状態:%1）\r\n@INF1005,背景を切り替えました。（現在の状態:%1）\r\n@INF2000,カラーコードの入力を受け付けました。%1 / RGB:(%2)\r\n@INF3000,パレット編集モードに切り替えました。（パレットの更新／位置入れ替え／削除が行えます）\r\n@INF3001,パレット編集モードを解除しました。\r\n@INF3002,カラーパレットを削除しました。\r\n@INF3003,カラーパレットを登録しました。RGB:(%1)\r\n@INF4000,%1をクリアしました。\r\n@INF4001,%1を作成しました。\r\n@INF4002,%1を複製して、%2を作成しました。\r\n@INF4003,%1を削除しました。\r\n@INF4004,%1と%2を統合しました。\r\n@INF4005,レイヤー名を[%1]に変更しました。\r\n@INF4006,レイヤーの%1を切り替えました。(現在の状態:%2)\r\n@INF4008,カラータグ名を[%1]に変更しました。\r\n@INF4009,レイヤーに付与した色を解除しました。\r\n@CAU0001,%1が%2のため、描画を禁止しています。\r\n@CAU0002,[ %1 ]キーには機能が割り当てられていません。（※設定で変更可能）\r\n@CAU0003,%1が%2のため、全面塗り潰しできません。\r\n@CAU0004,全面塗り潰しを使用する際は、ペン、消しゴム、バケツのいずれかを選択した状態にしてください。\r\n@CAU0005,%1が%2のため、90°回転できません。\r\n@CAU0006,%1の下層に親レイヤーが存在しないため、クリッピングが無効になっています。\r\n@CAU0100,追加できる拡大率は%1個までです。\r\n@CAU0101,拡大率%1%は既に追加されています。\r\n@CAU0102,追加できる拡大率は%1～%2%です。\r\n@CAU0103,削除する拡大率が選択されていません。\r\n@CAU0104,拡大率100%は変更できません。\r\n@CAU0200,%1の不透明度は変更できません。\r\n@CAU0201,%1の不透明度は100が最大値です。\r\n@CAU0202,%1の不透明度は5が最小値です。\r\n@CAU0203,%1の太さは変更できません。\r\n@CAU0204,%1の太さは200が最大値です。\r\n@CAU0205,%1の太さは1が最小値です。\r\n@CAU0206,補助線が表示されているときに有効なショートカットです。\r\n@CAU0300,現在セーブ/ロード機能は使用できません。ヘルプをご確認下さい。\r\n@CAU0301,スロット%1にはデータがありません。\r\n@CAU0400,これ以上アンドゥできません。\r\n@CAU0401,これ以上リドゥできません。\r\n@CAU0500,%1は透明色を使用できません。\r\n@CAU2000,カラーコードが正しくありません。入力例：#ffffff または #fff（#は省略可）\r\n@CAU3000,すべてのパレットを削除することはできません。\r\n@CAU3001,登録できるパレット数は%1個までです。\r\n@CAU4000,%1がロック状態のため、クリアできません。\r\n@CAU4001,%1は空白のレイヤーです。\r\n@CAU4002,レイヤーは%1枚までです。\r\n@CAU4003,%1がロック状態のため、削除できません。\r\n@CAU4004,レイヤーをすべて削除することはできません。\r\n@CAU4005,最下層のレイヤーは統合できません。\r\n@CAU4006,%1が%2のため、統合できません。\r\n@CAU4007,レイヤー名を空白にすることはできません。\r\n@CAU4008,カラータグ名を空白にすることはできません。\r\n@CAU5000,[ CTRL ]キーでスポイトに変化中です。別のペンは選択できません。\r\n@CAU5001,[ SPACE ]キーでハンドに変化中です。別のペンは選択できません。\r\n@CAU5002,スポイトを使用するにはキャンバス内を指定してください。".split(/\r\n|\n/),ge=new Map;for(let e=0;e<xe.length;e++){let t=xe[e].split(","),a=t[0],i=t[1];if(""===t[1])throw`メッセージデータに不正があります type:${a} index:${e}`;if(ge.has(a))throw`メッセージデータにID重複があります type:${a} index:${e}`;ge.set(a,i)}class be{static getMessage(e){let t="";return ge.has(e)&&(t=ge.get(e)),t}}class Ae{elementDiv;elementStatus;elementLog;mode=!1;lineCount=0;constructor(e,t){this.elementDiv=document.getElementById(e),this.elementStatus=this.elementDiv.querySelector("div:nth-of-type(1)"),this.elementLog=this.elementDiv.querySelector("div:nth-of-type(2)"),t&&(this.mode=!0,l.show(this.elementDiv))}status(e,t,a,i,n){if(!this.mode)return;const s=a?"O":"-",o=i?"O":"-",r=n?"O":"-";this.elementStatus.textContent=`タッチ数:${e} max(${t}) 開始:${s} 確定:${o} 中止:${r}`}log(e){if(!this.mode)return;let t="",a="";switch(e.substring(0,7)){case"[DRAW_]":t='<span style="color:#0f0">';break;case"[MOVE_]":t='<span style="color:#aaa">';break;case"[EXEC_]":t='<span style="color:#f0f">';break;case"[TIMER]":t='<span style="color:#ff0">';break;default:t="<span>"}a=t+e+"</span><br>",this.lineCount>=300?(this.elementLog.removeChild(this.elementLog.firstChild),this.elementLog.removeChild(this.elementLog.firstChild)):this.lineCount++,this.elementLog.insertAdjacentHTML("beforeend",a),this.elementLog.scrollTop=this.elementLog.scrollHeight}get isDebugMode(){return this.mode}set isDebugMode(e){e?(this.mode=!0,l.show(this.elementDiv)):(this.mode=!1,l.hide(this.elementDiv))}}const ve=JSON.parse('{"@VERSION":"2.4.0","@LANGUAGE":"ja","@COMMON.OPACITY":"不透明度","@COMMON.RED":"赤","@COMMON.GREEN":"緑","@COMMON.BLUE":"青","@COMMON.ALPHA":"透","@COMMON.BUTTON_CLOSE":"閉じる","@COMMON.WIDTH":"横","@COMMON.HEIGHT":"縦","@COMMON.BG_WHITE":"白地","@COMMON.BG_TRANSPARENT":"透過","@COMMON.DRAW_NEW":"いちから描いた","@COMMON.DRAW_BASED":"もとの絵あるよ","@COMMON.REQUIRED":"必須","@TAB.CANVAS":"キャンバス","@TAB.SETTINGS":"設定","@TAB.POST":"投稿","@WINDOW.LAUNCHER":"表示","@WINDOW.PEN_TOOL":"ペンツール","@WINDOW.COLOR":"色作成","@WINDOW.SWATCHES":"パレット","@WINDOW.LAYER":"レイヤー","@WINDOW.MISC":"補助ツール","@WINDOW.CUSTOM_BUTTONS":"ｶｽﾀﾑ","@PEN.SIZE":"太さ","@PEN.GROW_FILL_AREA":"塗り残し補正","@PEN.ANGLE":"角度","@PEN.ROUNDNESS":"丸み","@PEN.BLUR":"ぼかし度","@PEN.TONE_DENSITY":"トーン濃度","@PEN.STABILIZER":"手ぶれ補正","@PEN.OPTION_FREE_HAND":"手描き","@PEN.OPTION_STRAIGHT":"直線","@PEN.OPTION_RECT":"長方形","@PEN.OPTION_CIRCLE":"円","@PEN.OPTION_FILL_SAMPLE_ALL":"全ﾚｲﾔｰ判定","@PEN.OPTION_FILL_SAMPLE_CURRENT":"現ﾚｲﾔｰ判定","@PEN.TYPE":"種別","@PENGROUP.PEN":"ペン","@PENGROUP.TOOL":"ツール","@PENGROUP.ERASER":"消しゴム","@PENGROUP.FILL":"バケツ","@PENGROUP.EYEDROPPER":"スポイト","@PENNAME.ROUND":"丸ペン","@PENNAME.SQUARE":"角ペン","@PENNAME.DOT":"ドットペン","@PENNAME.CALLIGRAPHY":"筆ペン","@PENNAME.CRAYON":"クレヨン","@PENNAME.AIRBRUSH":"エアブラシ","@PENNAME.ERASER":"消しゴム","@PENNAME.SQUARE_ERASER":"角消しゴム","@PENNAME.FILL":"バケツ","@PENNAME.GRADATION_FILL":"階調バケツ","@PENNAME.EYEDROPPER":"スポイト","@PENNAME.HAND":"ハンド","@PENNAME.MOVE_TOOL":"移動ツール","@SWATCHES.COLUMNS":"横幅","@SWATCHES.EDIT":"編集","@SWATCHES.SET":"登録","@SWATCHES.DEL":"削除","@LAYER.NEWLAYER_TEMPLATE":"レイヤー","@LAYER.OPTION_NORMAL":"通常","@LAYER.OPTION_CLIPING":"クリッピング","@LAYER.OPTION_MULTIPLY":"乗算","@LAYER.OPTION_SCREEN":"スクリーン","@LAYER.OPTION_OVERLAY":"オーバーレイ","@LAYER.OPTION_DARKEN":"比較（暗）","@LAYER.OPTION_LIGHTEN":"比較（明）","@LAYER.OPTION_DODGE":"覆い焼き","@LAYER.OPTION_BURN":"焼き込み","@LAYER.OPTION_HARD_LIGHT":"ハードライト","@LAYER.OPTION_SOFT_LIGHT":"ソフトライト","@LAYER.OPTION_DIFFERENCE":"差の絶対値","@LAYER.OPTION_EXCLUSION":"除外","@LAYER.BUTTON_CLEAR":"ｸﾘｱ","@LAYER.BUTTON_NEW":"新規","@LAYER.BUTTON_MERGE":"統","@LAYER.BUTTON_COPY":"複","@LAYER.BUTTON_DEL":"削","@LAYER.BUTTON_RENAME_OK":"決定","@LAYER.BUTTON_CLEAR_COLOR":"色解除","@LAYER.LAYERS_INFO":"レイヤー情報","@LAYER.PRESET_NAME":"登録名","@MISC.BUTTON_UNDO":"アンドゥ","@MISC.BUTTON_REDO":"リドゥ","@MISC.BUTTON_RESTORE_AUTOSAVE":"自動保存から復元","@MISC.BUTTON_SAVE":"セーブ","@MISC.BUTTON_LOAD":"ロード","@MISC.BUTTON_FLIP_H":"左右反転","@MISC.BUTTON_FLIP_V":"上下反転","@MISC.BUTTON_BG_ALPHA":"背景透過","@MISC.BUTTON_GRID":"補助線","@GRID.MAIN":"主線","@GRID.SUB":"副線","@GRID.DIAG":"斜め","@GRID.DIVISIONS_H":"分割数：横","@GRID.DIVISIONS_V":"分割数：縦","@GRID.CONSTRAIN":"縦横を連動","@GRID.LINE_COLOR":"補助線の色","@SETTINGS.MENU_CANVAS":"キャンバス","@SETTINGS.MENU_TOOL_WINDOWS":"ツールウィンドウ","@SETTINGS.MENU_PEN_TOOL":"ペンツール","@SETTINGS.MENU_COLOR":"色作成","@SETTINGS.MENU_SWATCHES":"パレット","@SETTINGS.MENU_LAYER":"レイヤー","@SETTINGS.MENU_MISC":"補助ツール","@SETTINGS.MENU_CUSTOM_BUTTONS":"カスタムボタン","@SETTINGS.MENU_MOUSE":"マウス","@SETTINGS.MENU_TOUCH_PANEL":"タッチパネル","@SETTINGS.MENU_KEYBOARD":"キーボード","@SETTINGS.MENU_STARTUP":"起動時","@SETTINGS.MENU_VER_INFO":"バージョン情報","@POST.POSTPICTURE":"投稿するお絵カキコ","@POST.THUMBNAIL":"サムネイル","@POST.THUMBNAIL_CLICK":"※クリックで拡大表示","@POST.INPUT":"投稿情報の入力","@POST.NAME":"投稿者名","@POST.TITLE":"タイトル","@POST.MESSAGE":"本文","@POST.WATCHLIST":"ウォッチリストに登録","@POST.STATUS.SIZE":"画像サイズ","@POST.STATUS.BG_TRANSPARENT":"背景の透過","@POST.STATUS.BASED":"もとの絵","@POST.BUTTON_SUBMIT":"お絵カキコする！","@POST.INFO_REQUIRED":"※必須項目が入力されていません。","@POST.NOTICE":"投稿前の注意事項","@POST.NOTICE1":"投稿時にすべてのレイヤーが統合されます。","@POST.NOTICE2":"","@POST.NOTICE3":"","@POST.NOTICE4":""}');class fe{CONST={APP_TITLE:"AXNOS Paint",MIN_SYSTEM_WIDTH:8,MIN_SYSTEM_HEIGHT:8,MAX_SYSTEM_WIDTH:2e3,MAX_SYSTEM_HEIGHT:2e3,CANVAS_X_MAX:800,CANVAS_Y_MAX:800,CANVAS_X_MIN:8,CANVAS_Y_MIN:8,CANVAS_X_DEFAULT:317,CANVAS_Y_DEFAULT:317,DRAW_FREEHAND:Symbol(),DRAW_LINE:Symbol(),DRAW_RECT:Symbol(),DRAW_CIRCLE:Symbol(),SCALE_MAX:1600,SCALE_MIN:25,SCALE_VALUE:[25,33,50,66,100,150,200,250,300,400,600,800,1200,1600],SCALE_TABLE_MAX:50,MESSAGE_KEEP_TIME:2e3,DRAW_MULTI:1};CANVAS={main:null,main_ctx:null};ELEMENT={view:null,cursor:null,info:null,base:null,grid:null,grid_dot:null};FUNCTION={post:null};TASK=[];dragWindow;toolWindow=[];layerSystem;colorPaletteSystem;colorMakerSystem;penSystem;assistToolSystem;customButtonSystem;isModalOpen;isCanvasOpen;isClose;isBackgroundimage;isSPACE=!1;isCTRL=!1;isSHIFT=!1;isDrawing=!1;isDrawn=!1;isDrawCancel=!1;isLine;isRect;codeCHANGE_SIZE_KEY=null;ENV={multiCanvas:!1,isMobileWidth:!1,isFirstLaunch:!1};paintBodyElement;browser;checkSameBBS;restrictDraftCanvasResizing;restrictPost;expansionTab;option_height;option_width;oekaki_id=null;oekaki_width;oekaki_height;oekakiURL;oekakiTimeout;draftImageFile;oekaki_base;post_bbs_pageno;post_bbs_title;oekaki_bbs_pageno=null;oekaki_bbs_title=null;minWidth;minHeight;maxWidth;maxHeight;x_size;y_size;ctx_map_shift_x;ctx_map_shift_y;scale=100;cameraX=0;cameraY=0;url_backgroundimage;base_x;base_y;baseClientX;baseClientY;evCache=[];baseTouchX=-1;baseTouchY=-1;baseDiff=-1;baseScale=-1;baseCameraX=-1;baseCameraY=-1;longPressTimerID=null;touchTimerID=null;fingerCount=0;wheelTimeStamp=Date.now();undo_max;exTool=null;currentScaleTable=this.CONST.SCALE_VALUE;debugLog=null;additionalDictionaryJSON;postForm={input:{isDisplay:!0,strName:{isDisplay:!0,isInputRequired:!1,maxLength:32,placeholder:""},strTitle:{isDisplay:!0,isInputRequired:!1,maxLength:32,placeholder:""},strMessage:{isDisplay:!0,isInputRequired:!1,maxLength:1024,placeholder:""},strWatchList:{isDisplay:!0}},notice:{isDisplay:!0}};constructor(e){this.additionalDictionaryJSON=e,this.toolWindow.push(this.launcher=new J(this)),this.toolWindow.push(this.penSystem=new R(this)),this.toolWindow.push(this.colorMakerSystem=new q(this)),this.toolWindow.push(this.colorPaletteSystem=new H(this)),this.toolWindow.push(this.layerSystem=new V(this)),this.toolWindow.push(this.assistToolSystem=new K(this)),this.toolWindow.push(this.customButtonSystem=new Q(this)),this.keyboardSystem=new me(this),this.undoSystem=new Z(this),this.configSystem=new oe(this),this.saveSystem=new he(this),this.postSystem=new re(this),this.minWidth=this.CONST.CANVAS_X_MIN,this.minHeight=this.CONST.CANVAS_Y_MIN,this.maxWidth=this.CONST.CANVAS_X_MAX,this.maxHeight=this.CONST.CANVAS_Y_MAX}_(e){return this.additionalDictionaryJSON&&e in this.additionalDictionaryJSON?this.additionalDictionaryJSON[e]:e in ve?ve[e]:e}translateHTML(e){return e.replace(/\$\{.*?\}/g,e=>{const t=e.slice(5,-3);return this._(t)})}init(){this.CANVAS.main=document.getElementById("axp_canvas_canvas_main"),this.CANVAS.main_ctx=this.CANVAS.main.getContext("2d",{willReadFrequently:!0}),this.ELEMENT.base=document.getElementById("axp_canvas"),this.ELEMENT.view=document.getElementById("axp_canvas_div_grayBackground"),this.ELEMENT.cursor=document.getElementById("axp_canvas_div_penCursor"),this.ELEMENT.info=document.getElementById("axp_footer_div_message");for(const e of this.toolWindow)e.init();this.dragWindow=new o(this);for(const e of this.toolWindow)this.dragWindow.add(e);this.keyboardSystem.init(),this.undoSystem.init(),this.configSystem.init(),this.saveSystem.init(),this.postSystem.init(),this.initTask();const e=document.querySelectorAll(".axpc_FUNC");for(const t of e)t.addEventListener("click",()=>{this.TASK[t.dataset.function]()})}resetCanvas(){this.CANVAS.main.style.width=this.x_size+"px",this.CANVAS.main.style.height=this.y_size+"px",this.CANVAS.main.width=this.x_size,this.CANVAS.main.height=this.y_size,this.updateGrid(),this.zoomReset(),this.refreshCanvas(),this.layerSystem.resetCanvas(),this.penSystem.resetCanvas(),this.assistToolSystem.resetCanvas(),this.undoSystem.resetCanvas(),this.postSystem.resetCanvas()}startEvent(){this.debugLog=new Ae("axp_canvas_div_debugInfo",document.getElementById("axp_config_checkbox_useDebugMode").checked);for(const e of this.toolWindow)e.startEvent();this.keyboardSystem.startEvent(),this.configSystem.startEvent(),this.saveSystem.startEvent(),this.postSystem.startEvent(),document.addEventListener("dblclick",function(e){e.preventDefault()},{passive:!1}),this.ELEMENT.view.addEventListener("touchstart",e=>{e.preventDefault()},{passive:!1}),document.addEventListener("touchstart",e=>{e.touches.length>1&&e.preventDefault()},{passive:!1}),this.ELEMENT.base.addEventListener("pointerleave",()=>{this.ELEMENT.cursor.style.visibility="hidden"}),this.ELEMENT.base.addEventListener("pointerdown",e=>{const t={};if(this.isModalOpen)return;let a=this.calcScaleCoordinates(e);if(this.longPressTimerID&&(this.debugLog.log(`[TIMER] longPressTimerID:${this.longPressTimerID} -> CANCEL(DOWN)`),clearTimeout(this.longPressTimerID),this.longPressTimerID=null),"touch"===e.pointerType){if(0===this.evCache.length){const t=Number(document.getElementById("axp_config_form_touchDurationValue").volume.value);this.touchTimerID=setTimeout(()=>{this.debugLog.log(`[TIMER] touchTimerID:${this.touchTimerID} -> TIMEOUT(${t}ミリ秒経過)`),this.touchTimerID=null},t),this.debugLog.log(`[TIMER] touchTimerID:${this.touchTimerID} -> SET`),this.baseCameraX=this.cameraX,this.baseCameraY=this.cameraY,this.baseTouchX=e.clientX,this.baseTouchY=e.clientY,this.baseScale=this.scale}this.evCache.push(e),this.fingerCount<this.evCache.length&&(this.fingerCount=this.evCache.length),2===this.evCache.length&&(this.isDrawn||(this.isDrawCancel=!0),this.baseDiff=c(this.evCache[0].clientX,this.evCache[0].clientY,this.evCache[1].clientX,this.evCache[1].clientY))}let i=this.penSystem.getPenMode();if(e.isPrimary){if(2===e.buttons||4===e.buttons){e.preventDefault();const a=2===e.buttons?this.config("axp_config_form_mouseRightButton"):this.config("axp_config_form_mouseWheelButton");switch(a){case"undo":this.TASK.func_undo();break;case"spuit":this.penSystem.spuit(e),this.penSystem.autoChangePen();break;case"hand":i="axp_penmode_hand";break;case"loupe":this.TASK.func_loupe_reset();break;case"swapcolor":this.TASK.func_swap_maincolor();break;case"swaptrans":this.TASK.func_swap_transparent();break;case"transdraw":t.task="transdraw"}if("hand"!==a&&"transdraw"!==a)return}if(this.baseClientX=e.clientX,this.baseClientY=e.clientY,"none"===this.config("axp_config_form_touchDrawType")&&"touch"===e.pointerType||("hand"===this.config("axp_config_form_touchDrawType")&&"touch"===e.pointerType&&(i="axp_penmode_hand"),this.base_x=a.x,this.base_y=a.y,this.penSystem.start(a.x,a.y,e,i,t)),"on"===this.config("axp_config_form_useLongtap")){const t=Number(document.getElementById("axp_config_form_longtapDurationValue").volume.value);this.longPressTimerID=setTimeout(()=>{this.isDrawCancel=!0,this.debugStatus(),this.debugLog.log(`[TIMER] longPressTimerID:${this.longPressTimerID} -> TIMEOUT(${t}ミリ秒長押し)`),this.debugLog.log("[EXEC_] スポイト実行"),this.longPressTimerID=null,this.penSystem.spuit(e),this.penSystem.autoChangePen()},t),this.debugLog.log(`[TIMER] longPressTimerID:${this.longPressTimerID} -> SET`)}}this.debugStatus();const n=`[DOWN_] ID:${e.pointerId}(${e.pointerType}) P:${e.isPrimary?"O":"-"} (${Math.trunc(e.clientX)},${Math.trunc(e.clientY)})`;this.debugLog.log(n)}),this.ELEMENT.base.addEventListener("pointermove",e=>{if(this.isModalOpen)return;if(e.isPrimary){if(this.longPressTimerID){if(c(this.baseClientX,this.baseClientY,e.clientX,e.clientY)<Number(document.getElementById("axp_config_form_longtapStabilizerValue").volume.value))return;this.debugLog.log(`[TIMER] longPressTimerID:${this.longPressTimerID} -> CANCEL(MOVE)`),clearTimeout(this.longPressTimerID),this.longPressTimerID=null}let t=this.calcScaleCoordinates(e);const a=e.target;if(a===this.CANVAS.main||a===this.ELEMENT.view){const e=this.layerSystem.getName(),t=this.layerSystem.getReasonTextForWriteProtection();if(null!==t)this.msg("@CAU0001",e,t);else{let t=!1,a=!1;"source-atop"===this.layerSystem.getMode()&&("invalid"===this.layerSystem.getClupMode()?(this.msg("@CAU0006",e),t=!0):a=!0),!t&&this.layerSystem.getMasked()?this.msg("@INF0001",e):a&&this.msg("@INF0008",e,this.layerSystem.getClupParentName())}}let i;const n=e=>{let t=Math.max(Math.min(e,1e3),-1e3);return("    "+(Math.abs(t)<1e3?t.toString():"NaN")).slice(-4)};i=this.isLine||this.isRect?`(${n(this.base_x)},${n(this.base_y)})→(${n(t.x)},${n(t.y)})`:`(${n(t.x)},${n(t.y)})`,document.getElementById("axp_canvas_div_pointerPosition").textContent=i,this.penSystem.move(t.x,t.y,e)}if("touch"===e.pointerType){const t=this.evCache.findIndex(t=>t.pointerId===e.pointerId);if(-1!==t&&(this.evCache[t]=e),this.touchTimerID&&this.isDrawn&&(this.debugLog.log(`[TIMER] touchTimerID:${this.touchTimerID} -> CANCEL(描画済み)`),clearTimeout(this.touchTimerID),this.touchTimerID=null),2===this.evCache.length&&this.isDrawCancel){const e=c(this.evCache[0].clientX,this.evCache[0].clientY,this.evCache[1].clientX,this.evCache[1].clientY),t=Math.round(e-this.baseDiff),a=this.baseTouchX-this.evCache[0].clientX,i=this.baseTouchY-this.evCache[0].clientY,n=Math.abs(t)+Math.abs(a)+Math.abs(i)>Number(document.getElementById("axp_config_form_touchThresholdValue").volume.value);this.touchTimerID&&n&&(this.debugLog.log(`[TIMER] touchTimerID:${this.touchTimerID} -> CANCEL(スワイプ開始)`),clearTimeout(this.touchTimerID),this.touchTimerID=null),null===this.touchTimerID&&("on"===this.config("axp_config_form_touchZoom")&&(this.scale=x(this.baseScale+t,this.CONST.SCALE_MIN,this.CONST.SCALE_MAX)),"on"===this.config("axp_config_form_touchHand")&&(this.cameraX=Math.round(this.baseCameraX+100*a/this.scale),this.cameraY=Math.round(this.baseCameraY+100*i/this.scale)),this.refreshCanvas())}}this.debugStatus();let t="";t=this.isDrawing&&!this.isDrawCancel?"[DRAW_]":"[MOVE_]";const a=t+` ID:${e.pointerId}(${e.pointerType}) P:${e.isPrimary?"O":"-"} (${Math.trunc(e.clientX)},${Math.trunc(e.clientY)})`;this.debugLog.log(a)});const e=e=>{if(this.longPressTimerID&&(this.debugLog.log(`[TIMER] longPressTimerID:${this.longPressTimerID} -> CANCEL(UP)`),clearTimeout(this.longPressTimerID),this.longPressTimerID=null),"touch"===e.pointerType){const t=this.evCache.findIndex(t=>t.pointerId===e.pointerId);-1!==t&&this.evCache.splice(t,1)}if(e.isPrimary){let t=this.calcScaleCoordinates(e);this.penSystem.end(t.x,t.y,e)}};this.ELEMENT.base.addEventListener("pointerup",t=>{if("touch"===t.pointerType){const e=this.evCache.findIndex(e=>e.pointerId===t.pointerId);if(-1!==e&&this.evCache.splice(e,1),this.touchTimerID&&this.isDrawn&&(this.debugLog.log(`[TIMER] touchTimerID:${this.touchTimerID} -> CANCEL(描画済み)`),clearTimeout(this.touchTimerID),this.touchTimerID=null),0===this.evCache.length){if(this.touchTimerID)switch(this.debugLog.log(`[TIMER] touchTimerID:${this.touchTimerID} -> CANCEL(タッチ数=0)`),clearTimeout(this.touchTimerID),this.touchTimerID=null,this.fingerCount){case 2:"on"===this.config("axp_config_form_touchUndo")&&(this.debugLog.log(`[EXEC_] アンドゥ実行(最大タッチ数=${this.fingerCount})`),this.isDrawCancel=!0,this.TASK.func_undo());break;case 3:"on"===this.config("axp_config_form_touchRedo")&&(this.debugLog.log(`[EXEC_] リドゥ実行(最大タッチ数=${this.fingerCount})`),this.isDrawCancel=!0,this.TASK.func_redo())}this.fingerCount=0}}e(t),this.debugStatus();const a=`[UP___] ID:${t.pointerId}(${t.pointerType}) P:${t.isPrimary?"O":"-"} (${Math.trunc(t.clientX)},${Math.trunc(t.clientY)})`;this.debugLog.log(a)}),this.ELEMENT.base.addEventListener("pointercancel",t=>{e(t)}),this.ELEMENT.base.addEventListener("pointerleave",t=>{e(t)}),document.addEventListener("wheel",e=>{this.mouseWheel(e)},{passive:!1}),document.oncontextmenu=()=>"number"===document.activeElement.type||"text"===document.activeElement.type||"textarea"===document.activeElement.type||"none"===this.config("axp_config_form_mouseRightButton")&&void 0;const t=document.querySelectorAll(".axpc_MSG");for(const e of t)e.addEventListener("pointerenter",e=>{let t=e.currentTarget.dataset.msg;this.msg(t)});const a=document.querySelectorAll(".axpc_FUNC");for(const e of a)e.addEventListener("pointerenter",e=>{let t=e.currentTarget.dataset.msg,a="";e.currentTarget.dataset.key&&(a=`${e.currentTarget.dataset.key}:`);let i,n="";switch(e.currentTarget.dataset.function){case"func_switch_pen":case"func_switch_eraser":case"func_switch_fill":case"func_switch_hand":n=be.getMessage(e.currentTarget.dataset.addmsg).slice(2),this.msg(t,a,n);break;case"func_switch_subcolor":i=this.configSystem.getShortcutFunction("func_swap_maincolor"),i&&(n=`${i}:メイン／サブカラー切替`),this.msg(t,a,n);break;case"func_switch_transparent":i=this.configSystem.getShortcutFunction("func_swap_transparent"),i&&(n=`${i}:メイン／透明色切替`),this.msg(t,a,n);break;default:this.msg(t,a)}});this.selectTab("0");document.querySelectorAll("#axp_main_div_tab_menu > div").forEach(e=>{e.addEventListener("click",e=>{this.selectTab(e.currentTarget.dataset.idx)})}),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&(this.layerSystem.updateCanvas(),this.colorMakerSystem.colorWheel.redraw(),this.penSystem.previewPenSize(),this.drawPostCanvas())})}refreshCanvas(){const e=this.ELEMENT.view.getBoundingClientRect(),t=e.width/2,a=e.height/2,i=Math.round(this.x_size*(this.scale/100)),n=Math.round(this.y_size*(this.scale/100));this.CANVAS.main.style.left=Math.round(t-(this.x_size/2+this.cameraX)*this.scale/100)+"px",this.CANVAS.main.style.top=Math.round(a-(this.y_size/2+this.cameraY)*this.scale/100)+"px",this.CANVAS.main.style.width=i+"px",this.CANVAS.main.style.height=n+"px";const s=document.getElementById("axp_canvas_div_grid");s.style.left=this.CANVAS.main.style.left,s.style.top=this.CANVAS.main.style.top,s.style.width=this.CANVAS.main.style.width,s.style.height=this.CANVAS.main.style.height;document.getElementById("axp_canvas_svg_grid").setAttribute("viewBox",`-0.5, -0.5, ${i}, ${n}`),this.updateGrid(),document.getElementById("axp_tool_button_loupeReset").textContent=`${Math.round(this.scale)}%`,this.penSystem.previewPenSize(),this.assistToolSystem.mapguide()}updateGrid(){const e=document.getElementById("axp_canvas_div_grid").getBoundingClientRect(),t=document.getElementById("axp_canvas_svg_grid"),a=t.getElementsByTagNameNS("http://www.w3.org/2000/svg","rect");for(;a.length;)a[0].remove();const i=e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","rect");return t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("fill",`url(#${e})`),t},n=(t,a,i,n)=>{const s=e.width/a,o=e.height/i;t.setAttribute("viewBox",`0 0 ${s} ${o}`),t.setAttribute("width",`${s}`),t.setAttribute("height",`${o}`);const r=t.querySelector("path");r.setAttribute("d",`M ${s} 0 L ${s} ${o} L 0 ${o}`),r.setAttribute("stroke",n)};"true"===document.getElementById("axp_tool_checkbox_gridVH").dataset.checked&&(n(document.getElementById("axp_canvas_pattern_gridVH"),parseInt(document.getElementById("axp_tool_range_gridH").value),parseInt(document.getElementById("axp_tool_range_gridV").value),document.getElementById("axp_tool_color_gridVH").dataset.colorcode),t.appendChild(i("axp_canvas_pattern_gridVH"))),"true"===document.getElementById("axp_tool_checkbox_gridSubDivision").dataset.checked&&(n(document.getElementById("axp_canvas_pattern_gridSubDivision"),2*parseInt(document.getElementById("axp_tool_range_gridH").value),2*parseInt(document.getElementById("axp_tool_range_gridV").value),document.getElementById("axp_tool_color_gridSubDivision").dataset.colorcode),t.appendChild(i("axp_canvas_pattern_gridSubDivision")));"true"===document.getElementById("axp_tool_checkbox_gridDiagonal").dataset.checked&&(((t,a,i,n)=>{const s=e.width/a,o=e.height/i;t.setAttribute("viewBox",`0 0 ${s} ${o}`),t.setAttribute("width",`${s}`),t.setAttribute("height",`${o}`);const r=t.querySelector("path");r.setAttribute("d",`M 0 0 L ${s} ${o} M ${s} 0 L 0 ${o}`),r.setAttribute("stroke",n)})(document.getElementById("axp_canvas_pattern_gridDiagonal"),parseInt(document.getElementById("axp_tool_range_gridH").value),parseInt(document.getElementById("axp_tool_range_gridV").value),document.getElementById("axp_tool_color_gridDiagonal").dataset.colorcode),t.appendChild(i("axp_canvas_pattern_gridDiagonal")));const s=(e,t,a)=>{e.setAttribute("viewBox",`0 0 ${t} ${t}`),e.setAttribute("width",`${t}`),e.setAttribute("height",`${t}`);const i=e.querySelector("path");i.setAttribute("d",`M ${t} 0 L ${t} ${t} L 0 ${t}`),i.setAttribute("stroke",a)};"true"===document.getElementById("axp_tool_checkbox_gridPixel1").dataset.checked&&this.scale/800*document.getElementById("axp_tool_number_gridPixel1").value>=1&&(s(document.getElementById("axp_canvas_pattern_gridPixel1"),parseInt(document.getElementById("axp_tool_number_gridPixel1").value)*this.scale/100,document.getElementById("axp_tool_color_gridPixel1").dataset.colorcode),t.appendChild(i("axp_canvas_pattern_gridPixel1"))),"true"===document.getElementById("axp_tool_checkbox_gridPixel2").dataset.checked&&this.scale/800*document.getElementById("axp_tool_number_gridPixel2").value>=1&&(s(document.getElementById("axp_canvas_pattern_gridPixel2"),parseInt(document.getElementById("axp_tool_number_gridPixel2").value)*this.scale/100,document.getElementById("axp_tool_color_gridPixel2").dataset.colorcode),t.appendChild(i("axp_canvas_pattern_gridPixel2")))}setScale(e){this.scale=x(e,this.CONST.SCALE_MIN,this.CONST.SCALE_MAX),this.refreshCanvas(),this.msg("@AXP0001",this.scale)}zoomOutCanvas(){if(this.scale<=this.CONST.SCALE_MIN)return;let e=0;for(let t=1;t<this.currentScaleTable.length;t++)if(this.scale<=this.currentScaleTable[t]){e=t-1;break}this.scale=this.currentScaleTable[e]}zoomInCanvas(){if(this.scale>=this.CONST.SCALE_MAX)return;let e=0;for(let t=this.currentScaleTable.length-2;t>=0;t--)if(this.scale>=this.currentScaleTable[t]){e=t+1;break}this.scale=this.currentScaleTable[e]}zoomReset(){this.scale=100,this.cameraX=0,this.cameraY=0}calcScaleCoordinates(e){let t=this.CANVAS.main.getBoundingClientRect();return{x:Math.floor(100*(e.clientX-t.left)/this.scale),y:Math.floor(100*(e.clientY-t.top)/this.scale)}}mouseWheel(e){if(this.isClose)return;if(!this.isCanvasOpen)return;if(this.isModalOpen)return;if(e.preventDefault(),"wheel"!==e.type)return;let t=e.deltaX,a=e.deltaY;document.getElementById("axp_config_checkbox_mouseWheelDirection").checked&&(t=-t,a=-a);if(!!(e.deltaY%1)&&"on"===this.config("axp_config_form_mouseWheelZoom"))return this.scale=x(this.scale-10*e.deltaY,this.CONST.SCALE_MIN,this.CONST.SCALE_MAX),void this.refreshCanvas();const i=Number(document.getElementById("axp_config_number_mouseWheelSleepTime").value);if(i){const t=Date.now();if(!e.wheelDelta)return void(this.wheelTimeStamp=t);if(t-this.wheelTimeStamp<i)return;this.wheelTimeStamp=t}let n=this.calcScaleCoordinates(e),s=this.scale;const o=()=>{if(this.scale!==s){const t=this.ELEMENT.view.getBoundingClientRect(),a=t.width/2,i=t.height/2;let s=e.clientX-a,o=e.clientY-i-t.top,r=(x(n.x,0,this.x_size-1)-this.x_size/2)*this.scale/100,l=(x(n.y,0,this.y_size-1)-this.y_size/2)*this.scale/100,d=100*(r-s)/this.scale,c=100*(l-o)/this.scale;this.cameraX=d,this.cameraY=c}};switch(this.config("axp_config_form_mouseWheelRotate")){case"none":break;case"loupe":a<0&&this.zoomOutCanvas(),a>0&&this.zoomInCanvas(),document.getElementById("axp_config_checkbox_mouseWheelPointerTracking").checked&&o(),this.msg("@AXP0001",this.scale),this.refreshCanvas(),e.target.id!==this.CANVAS.main.id&&e.target.id!==this.ELEMENT.view.id||this.penSystem.penObj[this.penSystem.pen_mode].drawCursor(e);break;case"scroll":{const e=Number(document.getElementById("axp_config_number_mouseWheelMoveSize").value);a<0&&this.moveCanvas(0,e),a>0&&this.moveCanvas(0,-e),t<0&&this.moveCanvas(e,0),t>0&&this.moveCanvas(-e,0);break}}}setCanvasSize(e,t){let a=Number(e),i=Number(t);isNaN(a)&&(a=this.CONST.CANVAS_X_DEFAULT),a=x(a,this.minWidth,this.maxWidth),isNaN(i)&&(i=this.CONST.CANVAS_Y_DEFAULT),i=x(i,this.minHeight,this.maxHeight),this.x_size=a,this.y_size=i}checkCanvasSize_x(e){let t=Number(e);return t=x(t,this.minWidth,this.maxWidth),t}checkCanvasSize_y(e){let t=Number(e);return t=x(t,this.minHeight,this.maxHeight),t}getCanvasSize_X(){return this.x_size}getCanvasSize_Y(){return this.y_size}drawPostCanvas(){this.assistToolSystem.getIsTransparent()?(this.postSystem.CANVAS.post_ctx.clearRect(0,0,this.x_size,this.y_size),this.postSystem.CANVAS.post_ctx.drawImage(this.layerSystem.CANVAS.backscreen_trans,0,0),this.postSystem.CANVAS.thumbnail_ctx.clearRect(0,0,this.postSystem.CANVAS.thumbnail.width,this.postSystem.CANVAS.thumbnail.height),this.postSystem.CANVAS.thumbnail_ctx.drawImage(this.layerSystem.CANVAS.backscreen_trans,0,0,this.postSystem.CANVAS.thumbnail.width,this.postSystem.CANVAS.thumbnail.height)):(this.postSystem.CANVAS.post_ctx.drawImage(this.layerSystem.CANVAS.backscreen_white,0,0),this.postSystem.CANVAS.thumbnail_ctx.fillStyle="#ffffff",this.postSystem.CANVAS.thumbnail_ctx.fillRect(0,0,this.postSystem.CANVAS.thumbnail.width,this.postSystem.CANVAS.thumbnail.height),this.postSystem.CANVAS.thumbnail_ctx.drawImage(this.layerSystem.CANVAS.backscreen_white,0,0,this.postSystem.CANVAS.thumbnail.width,this.postSystem.CANVAS.thumbnail.height))}selectTab(e){const t=document.getElementById("axp_main_checkbox_hamburger");if(t.checked&&(t.checked=!1),"3"==e){if(this.expansionTab.link)return;return this.expansionTab.function?void this.expansionTab.function():void alert("ユーザー拡張機能のプログラムが正しく設定されていません。")}if("2"==e){if(this.restrictPost)return void alert("投稿先掲示板が指定されていないため、投稿することができません。");if(!this.FUNCTION.post)return void alert("投稿用プログラムが正しく設定されていないため、投稿することができません。")}document.querySelectorAll("#axp_main_div_tab_menu > div").forEach(t=>{t.dataset.idx===e?t.dataset.selected="true":t.dataset.selected="false"});var a=document.querySelectorAll("#axp_main_div_tabContent > article");switch(a.forEach(e=>{e.style.display="none"}),a[Number(e)].style.display="flex",e){case"0":this.isCanvasOpen=!0;break;case"1":this.isCanvasOpen=!1,this.configSystem.dispPalettebox(document.getElementById("axp_config_div_paletteBox"),this.colorPaletteSystem.currentPalette);break;case"2":{this.isCanvasOpen=!1,this.drawPostCanvas(),l.show("axp_post_button_upload_label"),l.hide("axp_post_button_upload_loading"),document.getElementById("axp_post_button_upload").disabled=!1;let e=document.getElementById("axp_post_span_referenceOekakiId");null!==this.draftImageFile?e.textContent=`${this._("@COMMON.DRAW_BASED")}:${d(this.draftImageFile)}`:null!==this.oekaki_id?e.textContent=`${this._("@COMMON.DRAW_BASED")}:${this.oekaki_id}.png`:e.textContent=`${this._("@COMMON.DRAW_NEW")}`;break}}}get selectedTab(){let e=null;const t=document.querySelectorAll("#axp_main_div_tab_menu > div");for(let a of t)if("true"===a.dataset.selected){e=a.dataset.idx;break}return e}moveCanvas(e,t){this.cameraX+=-e,this.cameraY+=-t,this.refreshCanvas()}callTask(e,t,a=!1,i=null){const n=document.getElementById(e);if(!n)return;const s=n.querySelector("select:nth-of-type(1)"),o=n.querySelector(".axpc_config_number_sizeValue"),r=n.querySelector(".axpc_config_number_scaleValue");if(!a||"func_scroll_up"===s.value||"func_scroll_down"===s.value||"func_scroll_left"===s.value||"func_scroll_right"===s.value)switch(s.value){case"func_loupe":this.setScale(Number(r.value));break;case"func_size":this.penSystem.setPenSize(Number(o.value));break;case"none":this.msg("@CAU0002",t);break;default:this.TASK[s.value](t,i)}}initTask(){this.TASK.func_loupe_down=()=>{this.zoomOutCanvas(),this.msg("@AXP0001",this.scale),this.refreshCanvas()},this.TASK.func_loupe_up=()=>{this.zoomInCanvas(),this.msg("@AXP0001",this.scale),this.refreshCanvas()},this.TASK.func_loupe_reset=()=>{this.zoomReset(),this.msg("@INF0002"),this.refreshCanvas()};const e=(e,t)=>{const a=document.getElementById(e);this.penSystem.switchMainButton(a,t),this.msg(a.dataset.msg,a.dataset.key?`${a.dataset.key}:`:"",be.getMessage(a.dataset.addmsg).slice(2))};this.TASK.func_switch_pen=t=>{e("axp_pen_button_penBase",t)},this.TASK.func_switch_eraser=t=>{e("axp_pen_button_eraserBase",t)},this.TASK.func_switch_fill=t=>{e("axp_pen_button_fillBase",t)},this.TASK.func_switch_hand=t=>{e("axp_pen_button_handBase",t)},this.TASK.func_switch_spuit=t=>{e("axp_pen_button_spuitBase",t)},this.TASK.func_switch_toggle=e=>{const t="true"!==document.getElementById("axp_pen_button_penBase").dataset.selected;t?this.penSystem.switchMainButton(document.getElementById("axp_pen_button_penBase"),e):this.penSystem.switchMainButton(document.getElementById("axp_pen_button_eraserBase"),e);let a="";const i=this.configSystem.getShortcutFunction("func_switch_toggle");i&&(a=`${i}:`),this.msg("@AXP0010",a,t?"ペン":"消しゴム")};const t=e=>{const t=document.getElementById(e);this.penSystem.switchSubButton(t),this.msg(t.dataset.msg,t.dataset.key?`${t.dataset.key}:`:"")};this.TASK.func_switch_axp_penmode_round=()=>{t("axp_penmode_round")},this.TASK.func_switch_axp_penmode_square=()=>{t("axp_penmode_square")},this.TASK.func_switch_axp_penmode_dot=()=>{t("axp_penmode_dot")},this.TASK.func_switch_axp_penmode_fude=()=>{t("axp_penmode_fude")},this.TASK.func_switch_axp_penmode_crayon=()=>{t("axp_penmode_crayon")},this.TASK.func_switch_axp_penmode_brush=()=>{t("axp_penmode_brush")},this.TASK.func_switch_axp_penmode_eraser_round=()=>{t("axp_penmode_eraser_round")},this.TASK.func_switch_axp_penmode_eraser_dot=()=>{t("axp_penmode_eraser_dot")},this.TASK.func_switch_axp_penmode_fill=()=>{t("axp_penmode_fill")},this.TASK.func_switch_axp_penmode_fillgradation=()=>{t("axp_penmode_fillgradation")},this.TASK.func_switch_axp_penmode_hand=()=>{t("axp_penmode_hand")},this.TASK.func_switch_axp_penmode_move=()=>{t("axp_penmode_move")},this.TASK.func_undo=()=>{this.undoSystem.undo()},this.TASK.func_redo=()=>{this.undoSystem.redo()},this.TASK.func_restore=()=>{this.saveSystem.restore()},this.TASK.func_save=()=>{this.saveSystem.save()},this.TASK.func_load=()=>{this.saveSystem.load()},this.TASK.func_flip_h=()=>{this.assistToolSystem.flip_h()},this.TASK.func_flip_v=()=>{this.assistToolSystem.flip_v()},this.TASK.func_transparent=()=>{this.assistToolSystem.transparent()},this.TASK.func_grid=()=>{this.assistToolSystem.grid()},this.TASK.func_init_window_positon=()=>{this.dragWindow.resetPosition(),this.msg("@INF0003")},this.TASK.func_backgroundimage=()=>{this.isBackgroundimage=!this.isBackgroundimage,this.isBackgroundimage?(this.url_backgroundimage=this.layerSystem.CANVAS.backscreen_white.toDataURL("image/png"),this.ELEMENT.view.style.backgroundImage="url("+this.url_backgroundimage+")"):this.ELEMENT.view.style.backgroundImage=null;var e=this.isBackgroundimage?"表示":"非表示";this.msg("@INF0005",e)},this.TASK.func_download=()=>{this.layerSystem.downloadImage()},this.TASK.func_switch_maincolor=()=>{this.colorMakerSystem.selectMainColor()},this.TASK.func_switch_subcolor=()=>{this.colorMakerSystem.selectSubColor()},this.TASK.func_switch_transparent=()=>{this.colorMakerSystem.selectTransparent()},this.TASK.func_swap_maincolor=()=>{this.colorMakerSystem.swap_maincolor()},this.TASK.func_swap_transparent=()=>{this.colorMakerSystem.swap_transparent()},this.TASK.func_layer_create=()=>{this.layerSystem.buttonCreateLayer()},this.TASK.func_layer_integrate=()=>{this.layerSystem.buttonIntegrateLayer()},this.TASK.func_layer_copy=()=>{this.layerSystem.buttonCopyLayer()},this.TASK.func_layer_delete=()=>{this.layerSystem.buttonDeleteLayer()},this.TASK.func_layer_clear=()=>{this.layerSystem.buttonClearLayer()},this.TASK.func_fill_all=()=>{if(this.layerSystem.isWriteProtection()){let e=this.layerSystem.getName(),t=this.layerSystem.getReasonTextForWriteProtection();return void this.msg("@CAU0003",e,t)}switch(this.penSystem.getType()){case"draw":case"eraser":case"fill":break;default:return void this.msg("@CAU0004")}this.penSystem.fillAll();let e=this.layerSystem.getName();this.msg("@INF0006",e)},this.TASK.func_rotate=()=>{if(this.layerSystem.isWriteProtection()){let e=this.layerSystem.getName(),t=this.layerSystem.getReasonTextForWriteProtection();return void this.msg("@CAU0005",e,t)}this.penSystem.rotate90();let e=this.layerSystem.getName();this.msg("@INF0007",e)},this.TASK.func_size_down=()=>{this.penSystem.downPenSize()},this.TASK.func_size_up=()=>{this.penSystem.upPenSize()},this.TASK.func_alpha_down=()=>{this.penSystem.changePenAlpha("down")},this.TASK.func_alpha_up=()=>{this.penSystem.changePenAlpha("up")},this.TASK.func_swap_pixelated=()=>{const e=document.getElementById("axp_config_form_antialiasing"),t="on"!==this.config("axp_config_form_antialiasing");t?e.elements[1].checked=!0:e.elements[0].checked=!0,this.configSystem.set_canvas_antialiasing(),this.configSystem.saveConfig("RADIO_axp_config_form_antialiasing",t?"on":"off"),this.msg("@INF0009",t?"あり":"なし")};const a=(e,t)=>{const a=Number(document.getElementById("axp_config_number_moveSize").value),i=document.getElementById("axp_config_checkbox_moveDirection").checked?-1:1;this.moveCanvas(e*a*i,t*a*i)};this.TASK.func_scroll_up=()=>{a(0,1)},this.TASK.func_scroll_down=()=>{a(0,-1)},this.TASK.func_scroll_left=()=>{a(1,0)},this.TASK.func_scroll_right=()=>{a(-1,0)};const i=e=>{if(this.assistToolSystem.isGrid){let t=document.getElementById("axp_tool_form_gridH").volume.value,a=document.getElementById("axp_tool_form_gridV").volume.value;switch(e){case"up_v":a<16&&a++,document.getElementById("axp_tool_checkbox_gridVHLink").checked&&(t=a);break;case"down_v":a>2&&a--,document.getElementById("axp_tool_checkbox_gridVHLink").checked&&(t=a);break;case"up_h":t<16&&t++,document.getElementById("axp_tool_checkbox_gridVHLink").checked&&(a=t);break;case"down_h":t>2&&t--,document.getElementById("axp_tool_checkbox_gridVHLink").checked&&(a=t)}document.getElementById("axp_tool_form_gridH").volume.value=t,document.getElementById("axp_tool_form_gridH").result.value=t,document.getElementById("axp_tool_form_gridV").volume.value=a,document.getElementById("axp_tool_form_gridV").result.value=a,this.updateGrid(),this.configSystem.saveConfig("RANGE_axp_tool_form_gridH",t),this.configSystem.saveConfig("RANGE_axp_tool_form_gridV",a),this.msg("@AXP0004",t,a)}else this.msg("@CAU0206")};this.TASK.func_grid_up_h=()=>{i("up_h")},this.TASK.func_grid_down_h=()=>{i("down_h")},this.TASK.func_grid_up_v=()=>{i("up_v")},this.TASK.func_grid_down_v=()=>{i("down_v")},this.TASK.func_size_change=(e,t)=>{if(!e)throw new Error("内部エラー：引数にキーが指定されていません（キーボード専用機能です）");this.penSystem.modeChangeSizeOn(e,t)}}msg(e,...t){let a=e.substring(0,4),i=!1;switch(a){case"@INF":case"@CAU":case"@ERR":i=!0}if(!i&&this.messageTimerID)return;let n,s=document.getElementById("axp_footer_div_icon");switch(s.classList.remove(...s.classList),a){case"@INF":s.classList.add("axpc_icon_msg_information");break;case"@CAU":s.classList.add("axpc_icon_msg_caution");break;case"@COL":s.classList.add("axpc_icon_msg_color");break;case"@ERR":s.classList.add("axpc_icon_msg_ng")}if("@"===e.substring(0,1)){const t=e.substring(0,8);n=be.getMessage(t)}else n=e;if("%penPreviewGuide"===n){let e=this.penSystem.getName();switch(this.penSystem.getType()){case"draw":case"eraser":this.msg("@PEN0201",e);break;case"fill":"axp_penmode_fillgradation"===this.penSystem.pen_mode?this.msg("@PEN0203",e):this.msg("@PEN0202",e);break;case"spuit":this.msg("@PEN0204")}return}n=n.replace("%drawingColorName",this.colorMakerSystem.drawingColorName),n=n.replace("%addPaletteName",this.colorMakerSystem.addPaletteName);for(let e=0;e<t.length;e++)-1!==n.indexOf(`%${e+1}`)&&(n=n.replace(`%${e+1}`,t[e]));this.ELEMENT.info.textContent=n,i&&(this.messageTimerID=setTimeout(()=>{this.messageTimerID=null},this.CONST.MESSAGE_KEEP_TIME))}drawBackground(){let e=this.layerSystem.CANVAS.backscreen_white.toDataURL("image/png");this.ELEMENT.view.style.backgroundImage="url("+e+"),url("+this.url_backgroundimage+")",this.url_backgroundimage=e}getURLParms(){const e=new URL(window.location.href);let t=e.searchParams;this.oekaki_id=t.get("oekaki_id"),this.oekaki_width=t.get("oekaki_width"),this.oekaki_height=t.get("oekaki_height"),this.post_bbs_pageno=e.pathname,this.post_bbs_title=document.getElementsByTagName("title")[0].innerText}exec(){(async()=>{this.getURLParms(),this.option_width?this.x_size=Number(this.option_width):this.x_size=this.CONST.CANVAS_X_DEFAULT,this.option_height?this.y_size=Number(this.option_height):this.y_size=this.CONST.CANVAS_Y_DEFAULT;let e=!1,t=null,a=null;var i,n;if(null!==this.draftImageFile?(t=this.draftImageFile,this.oekaki_id=null):null!==this.oekakiURL&&null!==this.oekaki_id?t=this.oekakiURL+this.oekaki_id+".png":this.oekaki_id=null,null!==t?(a=d(t),document.getElementById("axp_footer_div_message").textContent=`[${a}]を読み込みしています...`,await(i=t,n=this.oekakiTimeout,new Promise((e,t)=>{let a=new Image,s=setTimeout(()=>{a.src="",t(new Error("タイムアウトしました"))},n);a.onload=()=>{clearTimeout(s),e(a)},a.onerror=()=>{clearTimeout(s),t(new Error("画像の読み込みエラー"))},a.src=i})).then(t=>{this.oekaki_base=t;const a=document.createElement("canvas").getContext("2d");a.drawImage(this.oekaki_base,0,0),a.getImageData(0,0,1,1),this.x_size=this.oekaki_base.naturalWidth,this.y_size=this.oekaki_base.naturalHeight,this.oekaki_bbs_pageno=this.post_bbs_pageno,this.oekaki_bbs_title=this.post_bbs_title,e=!0}).catch(e=>{alert(`下書き画像の読み込みに失敗しました。\n新規キャンバスを作成します。\n${e}`),document.getElementById("axp_footer_div_message").textContent="",this.oekaki_id=null,this.draftImageFile=null})):(this.oekaki_width&&(this.x_size=Number(this.oekaki_width)),this.oekaki_height&&(this.y_size=Number(this.oekaki_height))),this.setCanvasSize(this.x_size,this.y_size),this.init(),this.configSystem.deployHTML(),this.resetCanvas(),await this.saveSystem.initDB()){let e;try{e=await this.saveSystem.load_config(),e?this.configSystem.restoreConfig(e):this.ENV.isFirstLaunch=!0}catch(e){alert("エラー:ユーザー設定の読み込みに失敗しました。デフォルト設定で起動します。")}if("off"===this.config("axp_config_form_saveLastPalleteColor"));else{let e;try{e=await this.saveSystem.load_palette(),e&&this.colorPaletteSystem.setPaletteArray(e)}catch(e){alert("エラー:ユーザーパレットの読み込みに失敗しました。デフォルト設定で起動します。")}}}(this.oekaki_width||this.oekaki_height)&&(this.configSystem.addCanvasSizeHistory(this.x_size,this.y_size),this.configSystem.updateCanvasSizeHistory()),this.layerSystem.newLayer(),this.undo_max=document.getElementById("axp_config_form_undoMaxValue").result.value,this.dispCustomButton(),this.colorMakerSystem.updateMakeColorType(),this.colorPaletteSystem.createPalette(),this.configSystem.createConfigScaleTable(this.currentScaleTable),this.configSystem.updateKeyCustomizationScaleTable(this.currentScaleTable),this.configSystem.switchNofuncKeytable(),this.configSystem.updateShortcutMessage(),this.configSystem.set_canvas_antialiasing(),this.configSystem.set_display_position(),this.configSystem.set_longtap_use(),this.dragWindow.initPosition(),this.penSystem.changePenMode(),this.ENV.isFirstLaunch&&this.ENV.isMobileWidth?(document.getElementById("axp_config_checkbox_singleWindowMode").checked=!0,this.configSystem.saveConfig("CHECK_axp_config_checkbox_singleWindowMode",!0),this.launcher.setSingleWindowMode(!0,!1),alert("* 初回起動設定 *\n画面幅が600px未満のため、単一ウィンドウモードに設定しました。[設定]-[ツールウィンドウ]で変更が可能です。")):document.getElementById("axp_config_checkbox_singleWindowMode").checked&&this.launcher.setSingleWindowMode(!0,!0),e&&(this.layerSystem.CANVAS.tmp_ctx.drawImage(this.oekaki_base,0,0),this.layerSystem.write(this.layerSystem.CANVAS.tmp_ctx.getImageData(0,0,this.x_size,this.y_size)),this.msg("@INF0050",a,this.x_size,this.y_size)),this.layerSystem.updateCanvas();let s=this.paintBodyElement.clientWidth,o=this.paintBodyElement.clientHeight-62,r=s/2-this.x_size/2,l=o/2-this.y_size/2;this.CANVAS.main.style.left=r+"px",this.CANVAS.main.style.top=l+"px",this.startEvent(),this.exTool&&this.exTool.startEvent()})()}config(e){let t=document.getElementById(e);if(t)return t.elements[e].value}dispCustomButton(){const e=document.querySelectorAll("#axp_config_div_customButtonFunction > select,#axp_config_div_customButtonFunction > input");if("on"===this.config("axp_config_form_useCustomButton")){this.customButtonSystem.windowElement.style.display="";for(const t of e)t.disabled=!1;document.getElementById("axp_config_div_customButtonFunction").style.opacity="1"}else{this.customButtonSystem.windowElement.style.display="none";for(const t of e)t.disabled=!0;document.getElementById("axp_config_div_customButtonFunction").style.opacity="0.5"}}closeSubwindow=e=>{this.isModalOpen=!1,l.hide(e)};openSubwindow=(e,t)=>{this.isModalOpen=!0,l.show(e);const a=document.querySelector(`#${e}>div`),i=document.getElementById("axp_canvas").getBoundingClientRect(),n=a.getBoundingClientRect().height,s=t.getBoundingClientRect();let o,r;o=s.left-i.left,r=i.top+i.height-s.bottom>n?s.bottom-i.top:s.top-n-i.top,a.style.marginLeft=`${o}px`,a.style.marginTop=`${r}px`};debugStatus(){this.debugLog.status(this.evCache.length,this.fingerCount,this.isDrawing,this.isDrawn,this.isDrawCancel)}}a(3243),a(1043),a(3447),a(9184),a(7971),a(7996),a(6766),a(9128),a(4984),a(6535),a(8063),a(3524);const ye=class{axpObj;constructor(e){(async()=>{let t=null;if(void 0!==e.dictionary&&null!==e.dictionary){let a=await async function(e){if(await async function(e){try{return(await fetch(e,{method:"HEAD"})).ok}catch(e){return!1}}(e)){return await async function(e){try{const t=await fetch(e);return await t.json()}catch(e){return!1}}(e)||"SYNTAX_ERROR"}return"NOT_FOUND"}(e.dictionary);"NOT_FOUND"===a?alert(`ERROR:起動オプションdictionaryで指定されたファイル\n[ ${e.dictionary} ] が見つかりません。\n通常辞書で起動します。`):"SYNTAX_ERROR"===a?alert(`ERROR:起動オプションdictionaryで指定されたファイル\n[ ${e.dictionary} ] に問題があります。\n通常辞書で起動します。`):t=a}if(this.axpObj=new fe(t),void 0===e.bodyId)return void alert("ERROR:起動オプションbodyIdが指定されていません");if(this.axpObj.paintBodyElement=document.getElementById(e.bodyId),null===this.axpObj.paintBodyElement)return void alert("ERROR:起動オプションbodyIdの指定が正しくありません");if(this.axpObj.paintBodyElement.style.display="flex",this.axpObj.paintBodyElement.style.flexGrow="1",this.axpObj.paintBodyElement.style.flexDirection="column",this.axpObj.paintBodyElement.style.overflow="hidden",this.axpObj.FUNCTION.post=e.post||null,this.axpObj.checkSameBBS=e.checkSameBBS||!1,this.axpObj.oekakiURL=e.oekakiURL||null,this.axpObj.draftImageFile=e.draftImageFile||null,this.axpObj.oekakiTimeout=isNaN(e.oekakiTimeout)?15e3:e.oekakiTimeout,"number"==typeof e.minWidth){if(!m(e.minWidth,this.axpObj.CONST.MIN_SYSTEM_WIDTH,this.axpObj.CONST.MAX_SYSTEM_WIDTH))return void alert(`ERROR:\n起動オプションminWidthの指定が正しくありません。\n有効範囲は${this.axpObj.CONST.MIN_SYSTEM_WIDTH}～${this.axpObj.CONST.MAX_SYSTEM_WIDTH}です。`);this.axpObj.minWidth=e.minWidth}if("number"==typeof e.minHeight){if(!m(e.minHeight,this.axpObj.CONST.MIN_SYSTEM_HEIGHT,this.axpObj.CONST.MAX_SYSTEM_HEIGHT))return void alert(`ERROR:\n起動オプションminHeightの指定が正しくありません。\n有効範囲は${this.axpObj.CONST.MIN_SYSTEM_HEIGHT}～${this.axpObj.CONST.MAX_SYSTEM_HEIGHT}です。`);this.axpObj.minHeight=e.minHeight}if("number"==typeof e.maxWidth){if(!m(e.maxWidth,this.axpObj.CONST.MIN_SYSTEM_WIDTH,this.axpObj.CONST.MAX_SYSTEM_WIDTH))return void alert(`ERROR:\n起動オプションmaxWidthの指定が正しくありません。\n有効範囲は${this.axpObj.CONST.MIN_SYSTEM_WIDTH}～${this.axpObj.CONST.MAX_SYSTEM_WIDTH}です。`);this.axpObj.maxWidth=e.maxWidth}if("number"==typeof e.maxHeight){if(!m(e.maxHeight,this.axpObj.CONST.MIN_SYSTEM_HEIGHT,this.axpObj.CONST.MAX_SYSTEM_HEIGHT))return void alert(`ERROR:\n起動オプションmaxHeightの指定が正しくありません。\n有効範囲は${this.axpObj.CONST.MIN_SYSTEM_HEIGHT}～${this.axpObj.CONST.MAX_SYSTEM_HEIGHT}です。`);this.axpObj.maxHeight=e.maxHeight}if(this.axpObj.minWidth>this.axpObj.maxWidth||this.axpObj.minHeight>this.axpObj.maxHeight)return void alert("ERROR:\n起動オプションminWidth,minHeight,maxWidth,maxHeightの指定の組み合わせが正しくありません。");this.axpObj.option_height=e.height||null,this.axpObj.option_width=e.width||null,this.axpObj.restrictDraftCanvasResizing=e.restrictDraftCanvasResizing||!1,this.axpObj.restrictPost=e.restrictPost||!1,this.axpObj.expansionTab=e.expansionTab||null;let a=!1,i=null;const n=e=>"boolean"==typeof e,s=e=>"string"==typeof e,o=e=>"number"==typeof e&&m(e,1,1024),r=(e,t,n)=>!!t(e)||(a=!0,i=`ERROR:\n起動オプションの指定が正しくありません。\nキー: ${n}\n値: ${e}`,!1);if(void 0!==e.postForm&&("input"in e.postForm&&!a&&("isDisplay"in e.postForm.input&&!a&&r(e.postForm.input.isDisplay,n,"postForm.input.isDisplay")&&(this.axpObj.postForm.input.isDisplay=e.postForm.input.isDisplay),"strName"in e.postForm.input&&!a&&("isDisplay"in e.postForm.input.strName&&!a&&r(e.postForm.input.strName.isDisplay,n,"postForm.input.strName.isDisplay")&&(this.axpObj.postForm.input.strName.isDisplay=e.postForm.input.strName.isDisplay),"isInputRequired"in e.postForm.input.strName&&!a&&r(e.postForm.input.strName.isInputRequired,n,"postForm.input.strName.isInputRequired")&&(this.axpObj.postForm.input.strName.isInputRequired=e.postForm.input.strName.isInputRequired),"maxLength"in e.postForm.input.strName&&!a&&r(e.postForm.input.strName.maxLength,o,"postForm.input.strName.maxLength")&&(this.axpObj.postForm.input.strName.maxLength=e.postForm.input.strName.maxLength),"placeholder"in e.postForm.input.strName&&!a&&r(e.postForm.input.strName.placeholder,s,"postForm.input.strName.placeholder")&&(this.axpObj.postForm.input.strName.placeholder=e.postForm.input.strName.placeholder)),"strTitle"in e.postForm.input&&!a&&("isDisplay"in e.postForm.input.strTitle&&!a&&r(e.postForm.input.strTitle.isDisplay,n,"postForm.input.strTitle.isDisplay")&&(this.axpObj.postForm.input.strTitle.isDisplay=e.postForm.input.strTitle.isDisplay),"isInputRequired"in e.postForm.input.strTitle&&!a&&r(e.postForm.input.strTitle.isInputRequired,n,"postForm.input.strTitle.input.isInputRequired")&&(this.axpObj.postForm.input.strTitle.isInputRequired=e.postForm.input.strTitle.isInputRequired),"maxLength"in e.postForm.input.strTitle&&!a&&r(e.postForm.input.strTitle.maxLength,o,"postForm.input.strTitle.maxLength")&&(this.axpObj.postForm.input.strTitle.maxLength=e.postForm.input.strTitle.maxLength),"placeholder"in e.postForm.input.strTitle&&!a&&r(e.postForm.input.strTitle.placeholder,s,"postForm.input.strTitle.placeholder")&&(this.axpObj.postForm.input.strTitle.placeholder=e.postForm.input.strTitle.placeholder)),"strMessage"in e.postForm.input&&!a&&("isDisplay"in e.postForm.input.strMessage&&!a&&r(e.postForm.input.strMessage.isDisplay,n,"postForm.input.strMessage.isDisplay")&&(this.axpObj.postForm.input.strMessage.isDisplay=e.postForm.input.strMessage.isDisplay),"isInputRequired"in e.postForm.input.strMessage&&!a&&r(e.postForm.input.strMessage.isInputRequired,n,"postForm.input.strMessage.isInputRequired")&&(this.axpObj.postForm.input.strMessage.isInputRequired=e.postForm.input.strMessage.isInputRequired),"maxLength"in e.postForm.input.strMessage&&!a&&r(e.postForm.input.strMessage.maxLength,o,"postForm.input.strMessage.maxLength")&&(this.axpObj.postForm.input.strMessage.maxLength=e.postForm.input.strMessage.maxLength),"placeholder"in e.postForm.input.strMessage&&!a&&r(e.postForm.input.strMessage.placeholder,s,"postForm.input.strMessage.placeholder")&&(this.axpObj.postForm.input.strMessage.placeholder=e.postForm.input.strMessage.placeholder)),"strWatchList"in e.postForm.input&&!a&&"isDisplay"in e.postForm.input.strWatchList&&!a&&r(e.postForm.input.strWatchList.isDisplay,n,"postForm.input.strWatchList.isDisplay")&&(this.axpObj.postForm.input.strWatchList.isDisplay=e.postForm.input.strWatchList.isDisplay)),"notice"in e.postForm&&!a&&"isDisplay"in e.postForm.notice&&!a&&r(e.postForm.notice.isDisplay,n,"postForm.notice.isDisplay")&&(this.axpObj.postForm.notice.isDisplay=e.postForm.notice.isDisplay)),a)return void alert(i);this.axpObj.paintBodyElement.insertAdjacentHTML("afterbegin",this.axpObj.translateHTML('\x3c!-- AXNOS Paintメイン --\x3e\r\n<div id="axp_main" class="axpc_main">\r\n\t\x3c!-- 切り替えタブ --\x3e\r\n\t<div id="axp_main_div_tab">\r\n\t\t\x3c!-- ハンバーガーメニューボタン --\x3e\r\n\t\t<input type="checkbox" id="axp_main_checkbox_hamburger">\r\n\t\t<label id="axp_main_label_hamburger" for="axp_main_checkbox_hamburger">\r\n\t\t\t<div class="axpc_icon_humburger"></div>\r\n\t\t</label>\r\n\t\t<div id="axp_main_div_tab_menu">\r\n\t\t\t<div data-idx="0" class="axpc_MSG" data-msg="@BAS0001">${_("@TAB.CANVAS")}</div>\r\n\t\t\t<div data-idx="1" class="axpc_MSG" data-msg="@BAS0002">${_("@TAB.SETTINGS")}</div>\r\n\t\t\t<div data-idx="2" class="axpc_MSG" data-msg="@BAS0003">${_("@TAB.POST")}</div>\r\n\t\t\t<div data-idx="3" class="axpc_MSG" data-msg="@BAS0004"></div>\r\n\t\t</div>\r\n\t\t<div id="axp_main_div_headerText" class="axpc_MSG" data-msg="@BAS0005"></div>\r\n\t</div>\r\n\r\n\t\x3c!-- タブにより切り替わる画面 --\x3e\r\n\t<div id="axp_main_div_tabContent">\r\n\t\t\x3c!-- キャンバス --\x3e\r\n\t\t<article>\r\n\t\t\t<div id="axp_canvas">\r\n\t\t\t\t\x3c!-- ペンの太さを表示する補助円 --\x3e\r\n\t\t\t\t<div id="axp_canvas_div_penCursor"></div>\r\n\r\n\t\t\t\t\x3c!-- ポインタ座標表示領域 --\x3e\r\n\t\t\t\t<div id="axp_canvas_div_pointerPosition" class="axpc_NONE"></div>\r\n\r\n\t\t\t\t\x3c!-- デバッグ情報表示 --\x3e\r\n\t\t\t\t<div id="axp_canvas_div_debugInfo" class="axpc_NONE axpc_MSG" data-msg="@BAS0100">\r\n\t\t\t\t\t<div></div>\r\n\t\t\t\t\t<div></div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t\x3c!-- 描画エリア --\x3e\r\n\t\t\t\t<div id="axp_canvas_div_grayBackground">\r\n\t\t\t\t\t\x3c!-- 補助線 --\x3e\r\n\t\t\t\t\t<div id="axp_canvas_div_grid" class="axpc_NONE">\r\n\t\t\t\t\t\t<svg id="axp_canvas_svg_grid" xmlns="http://www.w3.org/2000/svg">\r\n\t\t\t\t\t\t\t<defs>\r\n\t\t\t\t\t\t\t\t<pattern id="axp_canvas_pattern_gridVH" patternUnits="userSpaceOnUse">\r\n\t\t\t\t\t\t\t\t\t<path fill="none" />\r\n\t\t\t\t\t\t\t\t</pattern>\r\n\t\t\t\t\t\t\t\t<pattern id="axp_canvas_pattern_gridSubDivision" patternUnits="userSpaceOnUse">\r\n\t\t\t\t\t\t\t\t\t<path fill="none" />\r\n\t\t\t\t\t\t\t\t</pattern>\r\n\t\t\t\t\t\t\t\t<pattern id="axp_canvas_pattern_gridDiagonal" patternUnits="userSpaceOnUse">\r\n\t\t\t\t\t\t\t\t\t<path fill="none" />\r\n\t\t\t\t\t\t\t\t</pattern>\r\n\t\t\t\t\t\t\t\t<pattern id="axp_canvas_pattern_gridPixel1" patternUnits="userSpaceOnUse">\r\n\t\t\t\t\t\t\t\t\t<path fill="none" />\r\n\t\t\t\t\t\t\t\t</pattern>\r\n\t\t\t\t\t\t\t\t<pattern id="axp_canvas_pattern_gridPixel2" patternUnits="userSpaceOnUse">\r\n\t\t\t\t\t\t\t\t\t<path fill="none" />\r\n\t\t\t\t\t\t\t\t</pattern>\r\n\t\t\t\t\t\t\t</defs>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\x3c!-- canvas要素 --\x3e\r\n\t\t\t\t\t<canvas id="axp_canvas_canvas_main" class="axpc_background_mesh"></canvas>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t\x3c!-- セーブロードサブウィンドウ --\x3e\r\n\t\t\t\t<div id="axp_saveload" class="axpc_NONE">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<span id="axp_saveload_span_message"></span>\r\n\t\t\t\t\t\t<div id="axp_saveload_div_insertHTML"></div>\r\n\t\t\t\t\t\t<button id="axp_saveload_button_close" class="axpc_button">${_("@COMMON.BUTTON_CLOSE")}</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t\x3c!-- レイヤー名変更サブウィンドウ --\x3e\r\n\t\t\t\t<div id="axp_renamelayer" class="axpc_subwindow axpc_NONE">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div class="axpc_button_closeContainer">\r\n\t\t\t\t\t\t\t<span>${_("@LAYER.LAYERS_INFO")}</span>\r\n\t\t\t\t\t\t\t<button id="axp_renamelayer_button_close" class="axpc_MSG axpc_button axpc_button_close"\r\n\t\t\t\t\t\t\t\tdata-msg="@LAY0100"></button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div id="axp_renamelayer_div_textarea">\r\n\t\t\t\t\t\t\t<input id="axp_renamelayer_text_newLayerName" type="text" size="15" maxlength="10"\r\n\t\t\t\t\t\t\t\tautocomplete="off" class="axpc_MSG" data-msg="@LAY0101" placeholder="空白にはできません">\r\n\t\t\t\t\t\t\t\x3c!-- 状態によりMSG変化 --\x3e\r\n\t\t\t\t\t\t\t<button id="axp_renamelayer_button_confirm"\r\n\t\t\t\t\t\t\t\tclass="axpc_button">${_("@LAYER.BUTTON_RENAME_OK")}</button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div id="axp_renamelayer_div_buttonarea">\r\n\t\t\t\t\t\t\t<button id="axp_renamelayer_button_flipH" class="axpc_MSG axpc_button"\r\n\t\t\t\t\t\t\t\tdata-msg="@LAY0110"></button>\r\n\t\t\t\t\t\t\t<button id="axp_renamelayer_button_flipV" class="axpc_MSG axpc_button"\r\n\t\t\t\t\t\t\t\tdata-msg="@LAY0111"></button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div id="axp_renamelayer_div_colorTagContainer">\r\n\t\t\t\t\t\t\t<span>${_("@LAYER.PRESET_NAME")}</span>\r\n\t\t\t\t\t\t\t<button id="axp_renamelayer_button_colorReset" class="axpc_MSG axpc_button"\r\n\t\t\t\t\t\t\t\tdata-msg="@LAY0102">${_("@LAYER.BUTTON_CLEAR_COLOR")}</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div id="axp_renamelayer_div_colorTag"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t\x3c!-- 補助線の色変更サブウィンドウ --\x3e\r\n\t\t\t\t<div id="axp_gridconfig" class="axpc_subwindow axpc_NONE">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div class="axpc_button_closeContainer">\r\n\t\t\t\t\t\t\t<span>${_("@GRID.LINE_COLOR")}</span>\r\n\t\t\t\t\t\t\t<button id="axp_gridconfig_button_confirm" class="axpc_MSG axpc_button axpc_button_close"\r\n\t\t\t\t\t\t\t\tdata-msg="@AST0122"></button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div id="axp_gridconfig_div_colorPicker" class="axpc_MSG" data-msg="@AST0120"></div>\r\n\t\t\t\t\t\t<form id="axp_gridconfig_form_gridColor" class="axpc_range axpc_text_border"\r\n\t\t\t\t\t\t\toninput="result.value=parseInt(volume.value)">\r\n\t\t\t\t\t\t\t<input type="range" id="axp_gridconfig_range_gridColor" name="volume" min="5" max="100"\r\n\t\t\t\t\t\t\t\tstep="5" value="100" class="axpc_MSG" data-msg="@AST0121">\r\n\t\t\t\t\t\t\t<div class="axpc_range_label">${_("@COMMON.OPACITY")}</div>\r\n\t\t\t\t\t\t\t<div class="axpc_range_value"><output name="result">100</output></div>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</article>\r\n\t\t\x3c!-- 設定 --\x3e\r\n\t\t<article>\r\n\t\t\t<div id="axp_config"></div>\r\n\t\t</article>\r\n\t\t\x3c!-- 投稿 --\x3e\r\n\t\t<article>\r\n\t\t\t<div id="axp_post"></div>\r\n\t\t</article>\r\n\t</div>\r\n</div>\r\n\x3c!-- フッター --\x3e\r\n<div id="axp_footer" class="axpc_MSG" data-msg="@BAS0006">\r\n\t<div id="axp_footer_div_icon"></div>\r\n\t<div id="axp_footer_div_message">AXNOS Paint（アクノスペイント）</div>\r\n</div>'));let l=document.querySelectorAll("#axp_main_div_tab > div > div");if(this.axpObj.restrictPost&&(l[2].style.display="none"),null!==this.axpObj.expansionTab){if(this.axpObj.expansionTab.name)if(this.axpObj.expansionTab.link){const e=document.createElement("a");e.setAttribute("href",this.axpObj.expansionTab.link),e.setAttribute("target","_blank"),e.setAttribute("rel","noopener"),e.setAttribute("style","width:100%;text-decoration:none;color:#fff");const t=document.createElement("div");t.textContent=this.axpObj.expansionTab.name,e.appendChild(t),l[3].appendChild(e)}else l[3].textContent=this.axpObj.expansionTab.name;this.axpObj.expansionTab.msg&&(l[3].dataset.msg=this.axpObj.expansionTab.msg)}else l[3].style.display="none";let d;var c;d="string"==typeof(c=e.headerText)||c instanceof String?e.headerText.length>1024?e.headerText.slice(0,1024):e.headerText:"",document.getElementById("axp_main_div_headerText").textContent=d,document.getElementById&&(window.alert=function(e){!function(e){if(document.getElementById("axp_alert_div_modalContainer"))return;const t=ee(e);t.btn_ok.onclick=function(){return te(),!0},t.alertObj.style.display="block"}(e)}),this.axpObj.browser=function(){const e=window.navigator.userAgent.toLowerCase();let t;return t=-1!=e.indexOf("msie")||-1!=e.indexOf("trident")?"IE":-1!=e.indexOf("edg")||-1!=e.indexOf("edge")?"Edge":-1!=e.indexOf("opr")||-1!=e.indexOf("opera")?"Opera":-1!=e.indexOf("chrome")?"Chrome":-1!=e.indexOf("safari")?"Safari":-1!=e.indexOf("firefox")?"FireFox":"unknown",t}(),"Safari"===this.axpObj.browser&&(this.axpObj.ENV.multiCanvas=!0),window.screen.width<600&&(this.axpObj.ENV.isMobileWidth=!0),this.axpObj.exec(),document.getElementById("axp_main").style.display="flex"})()}version(){return`${this.axpObj.CONST.APP_TITLE} version 2.4.0 (2026-01-10T08:13:09.457Z)`}on(){this.axpObj.paintBodyElement.style.display="flex",this.axpObj.isClose=!1}off(){this.axpObj.paintBodyElement.style.display="none",this.axpObj.isClose=!0}static ver(){return"version 2.4.0 (2026-01-10T08:13:09.457Z)"}};return s=s.default})());